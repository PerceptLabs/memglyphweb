var He=Object.defineProperty;var qe=(t,e,n)=>e in t?He(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var D=(t,e,n)=>qe(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const _ of r.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var Q,v,we,T,le,Ne,Ee,Se,re,J,X,$={},Ce=[],Ae=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,z=Array.isArray;function x(t,e){for(var n in e)t[n]=e[n];return t}function oe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function $e(t,e,n){var o,i,r,_={};for(r in e)r=="key"?o=e[r]:r=="ref"?i=e[r]:_[r]=e[r];if(arguments.length>2&&(_.children=arguments.length>3?Q.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)_[r]===void 0&&(_[r]=t.defaultProps[r]);return U(t,_,o,i,null)}function U(t,e,n,o,i){var r={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++we,__i:-1,__u:0};return i==null&&v.vnode!=null&&v.vnode(r),r}function O(t){return t.children}function G(t,e){this.props=t,this.context=e}function q(t,e){if(e==null)return t.__?q(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?q(t):null}function Le(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Le(t)}}function ae(t){(!t.__d&&(t.__d=!0)&&T.push(t)&&!j.__r++||le!=v.debounceRendering)&&((le=v.debounceRendering)||Ne)(j)}function j(){for(var t,e,n,o,i,r,_,c=1;T.length;)T.length>c&&T.sort(Ee),t=T.shift(),c=T.length,t.__d&&(n=void 0,o=void 0,i=(o=(e=t).__v).__e,r=[],_=[],e.__P&&((n=x({},o)).__v=o.__v+1,v.vnode&&v.vnode(n),ie(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[i]:null,r,i??q(o),!!(32&o.__u),_),n.__v=o.__v,n.__.__k[n.__i]=n,Re(r,n,_),o.__e=o.__=null,n.__e!=i&&Le(n)));j.__r=0}function Pe(t,e,n,o,i,r,_,c,h,a,p){var s,d,u,k,S,b,g,m=o&&o.__k||Ce,C=e.length;for(h=Oe(n,e,m,h,C),s=0;s<C;s++)(u=n.__k[s])!=null&&(d=u.__i==-1?$:m[u.__i]||$,u.__i=s,b=ie(t,u,d,i,r,_,c,h,a,p),k=u.__e,u.ref&&d.ref!=u.ref&&(d.ref&&se(d.ref,null,u),p.push(u.ref,u.__c||k,u)),S==null&&k!=null&&(S=k),(g=!!(4&u.__u))||d.__k===u.__k?h=xe(u,h,t,g):typeof u.type=="function"&&b!==void 0?h=b:k&&(h=k.nextSibling),u.__u&=-7);return n.__e=S,h}function Oe(t,e,n,o,i){var r,_,c,h,a,p=n.length,s=p,d=0;for(t.__k=new Array(i),r=0;r<i;r++)(_=e[r])!=null&&typeof _!="boolean"&&typeof _!="function"?(h=r+d,(_=t.__k[r]=typeof _=="string"||typeof _=="number"||typeof _=="bigint"||_.constructor==String?U(null,_,null,null,null):z(_)?U(O,{children:_},null,null,null):_.constructor==null&&_.__b>0?U(_.type,_.props,_.key,_.ref?_.ref:null,_.__v):_).__=t,_.__b=t.__b+1,c=null,(a=_.__i=We(_,n,h,s))!=-1&&(s--,(c=n[a])&&(c.__u|=2)),c==null||c.__v==null?(a==-1&&(i>p?d--:i<p&&d++),typeof _.type!="function"&&(_.__u|=4)):a!=h&&(a==h-1?d--:a==h+1?d++:(a>h?d--:d++,_.__u|=4))):t.__k[r]=null;if(s)for(r=0;r<p;r++)(c=n[r])!=null&&!(2&c.__u)&&(c.__e==o&&(o=q(c)),Fe(c,c));return o}function xe(t,e,n,o){var i,r;if(typeof t.type=="function"){for(i=t.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=t,e=xe(i[r],e,n,o));return e}t.__e!=e&&(o&&(e&&t.type&&!e.parentNode&&(e=q(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function We(t,e,n,o){var i,r,_,c=t.key,h=t.type,a=e[n],p=a!=null&&(2&a.__u)==0;if(a===null&&t.key==null||p&&c==a.key&&h==a.type)return n;if(o>(p?1:0)){for(i=n-1,r=n+1;i>=0||r<e.length;)if((a=e[_=i>=0?i--:r++])!=null&&!(2&a.__u)&&c==a.key&&h==a.type)return _}return-1}function ce(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Ae.test(e)?n:n+"px"}function I(t,e,n,o,i){var r,_;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||ce(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||ce(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(Se,"$1")),_=e.toLowerCase(),e=_ in t||e=="onFocusOut"||e=="onFocusIn"?_.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?o?n.u=o.u:(n.u=re,t.addEventListener(e,r?X:J,r)):t.removeEventListener(e,r?X:J,r);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function de(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=re++;else if(e.t<n.u)return;return n(v.event?v.event(e):e)}}}function ie(t,e,n,o,i,r,_,c,h,a){var p,s,d,u,k,S,b,g,m,C,L,M,F,W,H,f,w,y=e.type;if(e.constructor!=null)return null;128&n.__u&&(h=!!(32&n.__u),r=[c=e.__e=n.__e]),(p=v.__b)&&p(e);e:if(typeof y=="function")try{if(g=e.props,m="prototype"in y&&y.prototype.render,C=(p=y.contextType)&&o[p.__c],L=p?C?C.props.value:p.__:o,n.__c?b=(s=e.__c=n.__c).__=s.__E:(m?e.__c=s=new y(g,L):(e.__c=s=new G(g,L),s.constructor=y,s.render=Ue),C&&C.sub(s),s.props=g,s.state||(s.state={}),s.context=L,s.__n=o,d=s.__d=!0,s.__h=[],s._sb=[]),m&&s.__s==null&&(s.__s=s.state),m&&y.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=x({},s.__s)),x(s.__s,y.getDerivedStateFromProps(g,s.__s))),u=s.props,k=s.state,s.__v=e,d)m&&y.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),m&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(m&&y.getDerivedStateFromProps==null&&g!==u&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(g,L),!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(g,s.__s,L)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(s.props=g,s.state=s.__s,s.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(R){R&&(R.__=e)}),M=0;M<s._sb.length;M++)s.__h.push(s._sb[M]);s._sb=[],s.__h.length&&_.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(g,s.__s,L),m&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(u,k,S)})}if(s.context=L,s.props=g,s.__P=t,s.__e=!1,F=v.__r,W=0,m){for(s.state=s.__s,s.__d=!1,F&&F(e),p=s.render(s.props,s.state,s.context),H=0;H<s._sb.length;H++)s.__h.push(s._sb[H]);s._sb=[]}else do s.__d=!1,F&&F(e),p=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++W<25);s.state=s.__s,s.getChildContext!=null&&(o=x(x({},o),s.getChildContext())),m&&!d&&s.getSnapshotBeforeUpdate!=null&&(S=s.getSnapshotBeforeUpdate(u,k)),f=p,p!=null&&p.type===O&&p.key==null&&(f=De(p.props.children)),c=Pe(t,z(f)?f:[f],e,n,o,i,r,_,c,h,a),s.base=e.__e,e.__u&=-161,s.__h.length&&_.push(s),b&&(s.__E=s.__=null)}catch(R){if(e.__v=null,h||r!=null)if(R.then){for(e.__u|=h?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,e.__e=c}else{for(w=r.length;w--;)oe(r[w]);Z(e)}else e.__e=n.__e,e.__k=n.__k,R.then||Z(e);v.__e(R,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):c=e.__e=Ie(n.__e,e,n,o,i,r,_,h,a);return(p=v.diffed)&&p(e),128&e.__u?void 0:c}function Z(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(Z)}function Re(t,e,n){for(var o=0;o<n.length;o++)se(n[o],n[++o],n[++o]);v.__c&&v.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(r){r.call(i)})}catch(r){v.__e(r,i.__v)}})}function De(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:z(t)?t.map(De):x({},t)}function Ie(t,e,n,o,i,r,_,c,h){var a,p,s,d,u,k,S,b=n.props,g=e.props,m=e.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(a=0;a<r.length;a++)if((u=r[a])&&"setAttribute"in u==!!m&&(m?u.localName==m:u.nodeType==3)){t=u,r[a]=null;break}}if(t==null){if(m==null)return document.createTextNode(g);t=document.createElementNS(i,m,g.is&&g),c&&(v.__m&&v.__m(e,r),c=!1),r=null}if(m==null)b===g||c&&t.data==g||(t.data=g);else{if(r=r&&Q.call(t.childNodes),b=n.props||$,!c&&r!=null)for(b={},a=0;a<t.attributes.length;a++)b[(u=t.attributes[a]).name]=u.value;for(a in b)if(u=b[a],a!="children"){if(a=="dangerouslySetInnerHTML")s=u;else if(!(a in g)){if(a=="value"&&"defaultValue"in g||a=="checked"&&"defaultChecked"in g)continue;I(t,a,null,u,i)}}for(a in g)u=g[a],a=="children"?d=u:a=="dangerouslySetInnerHTML"?p=u:a=="value"?k=u:a=="checked"?S=u:c&&typeof u!="function"||b[a]===u||I(t,a,u,b[a],i);if(p)c||s&&(p.__html==s.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(s&&(t.innerHTML=""),Pe(e.type=="template"?t.content:t,z(d)?d:[d],e,n,o,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,_,r?r[0]:n.__k&&q(n,0),c,h),r!=null)for(a=r.length;a--;)oe(r[a]);c||(a="value",m=="progress"&&k==null?t.removeAttribute("value"):k!=null&&(k!==t[a]||m=="progress"&&!k||m=="option"&&k!=b[a])&&I(t,a,k,b[a],i),a="checked",S!=null&&S!=t[a]&&I(t,a,S,b[a],i))}return t}function se(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(i){v.__e(i,n)}}function Fe(t,e,n){var o,i;if(v.unmount&&v.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||se(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){v.__e(r,e)}o.base=o.__P=null}if(o=t.__k)for(i=0;i<o.length;i++)o[i]&&Fe(o[i],e,n||typeof t.type!="function");n||oe(t.__e),t.__c=t.__=t.__e=void 0}function Ue(t,e,n){return this.constructor(t,n)}function Ge(t,e,n){var o,i,r,_;e==document&&(e=document.documentElement),v.__&&v.__(t,e),i=(o=!1)?null:e.__k,r=[],_=[],ie(e,t=e.__k=$e(O,null,[t]),i||$,$,e.namespaceURI,i?null:e.firstChild?Q.call(e.childNodes):null,r,i?i.__e:e.firstChild,o,_),Re(r,t,_)}Q=Ce.slice,v={__e:function(t,e,n,o){for(var i,r,_;e=e.__;)if((i=e.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(t)),_=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,o||{}),_=i.__d),_)return i.__E=i}catch(c){t=c}throw t}},we=0,G.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=x({},this.state),typeof t=="function"&&(t=t(x({},n),this.props)),t&&x(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ae(this))},G.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ae(this))},G.prototype.render=O,T=[],Ne=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ee=function(t,e){return t.__v.__b-e.__v.__b},j.__r=0,Se=/(PointerCapture)$|Capture$/i,re=0,J=de(!1),X=de(!0);var Be=0;function l(t,e,n,o,i,r){e||(e={});var _,c,h=e;if("ref"in h)for(c in h={},e)c=="ref"?_=e[c]:h[c]=e[c];var a={type:t,props:h,key:n,ref:_,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Be,__i:-1,__u:0,__source:i,__self:r};if(typeof t=="function"&&(_=t.defaultProps))for(c in _)h[c]===void 0&&(h[c]=_[c]);return v.vnode&&v.vnode(a),a}var ee,N,V,ue,te=0,Te=[],E=v,he=E.__b,pe=E.__r,fe=E.diffed,me=E.__c,ge=E.unmount,ye=E.__;function je(t,e){E.__h&&E.__h(N,t,te||e),te=0;var n=N.__H||(N.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function P(t){return te=1,Qe(Me,t)}function Qe(t,e,n){var o=je(ee++,2);if(o.t=t,!o.__c&&(o.__=[Me(void 0,e),function(c){var h=o.__N?o.__N[0]:o.__[0],a=o.t(h,c);h!==a&&(o.__N=[a,o.__[1]],o.__c.setState({}))}],o.__c=N,!N.__f)){var i=function(c,h,a){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(d){return!!d.__c});if(p.every(function(d){return!d.__N}))return!r||r.call(this,c,h,a);var s=o.__c.props!==c;return p.forEach(function(d){if(d.__N){var u=d.__[0];d.__=d.__N,d.__N=void 0,u!==d.__[0]&&(s=!0)}}),r&&r.call(this,c,h,a)||s};N.__f=!0;var r=N.shouldComponentUpdate,_=N.componentWillUpdate;N.componentWillUpdate=function(c,h,a){if(this.__e){var p=r;r=void 0,i(c,h,a),r=p}_&&_.call(this,c,h,a)},N.shouldComponentUpdate=i}return o.__N||o.__}function ze(){for(var t;t=Te.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(B),t.__H.__h.forEach(ne),t.__H.__h=[]}catch(e){t.__H.__h=[],E.__e(e,t.__v)}}E.__b=function(t){N=null,he&&he(t)},E.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),ye&&ye(t,e)},E.__r=function(t){pe&&pe(t),ee=0;var e=(N=t.__c).__H;e&&(V===N?(e.__h=[],N.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(B),e.__h.forEach(ne),e.__h=[],ee=0)),V=N},E.diffed=function(t){fe&&fe(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Te.push(e)!==1&&ue===E.requestAnimationFrame||((ue=E.requestAnimationFrame)||Ve)(ze)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),V=N=null},E.__c=function(t,e){e.some(function(n){try{n.__h.forEach(B),n.__h=n.__h.filter(function(o){return!o.__||ne(o)})}catch(o){e.some(function(i){i.__h&&(i.__h=[])}),e=[],E.__e(o,n.__v)}}),me&&me(t,e)},E.unmount=function(t){ge&&ge(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{B(o)}catch(i){e=i}}),n.__H=void 0,e&&E.__e(e,n.__v))};var ve=typeof requestAnimationFrame=="function";function Ve(t){var e,n=function(){clearTimeout(o),ve&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);ve&&(e=requestAnimationFrame(n))}function B(t){var e=N,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),N=e}function ne(t){var e=N;t.__c=t.__(),N=e}function Me(t,e){return typeof e=="function"?e(t):e}class Ye{constructor(){D(this,"worker",null);D(this,"nextId",1);D(this,"pending",new Map);this.initWorker()}initWorker(){this.worker=new Worker(new URL("/assets/sqlite.worker-ChcN1mGI.js",import.meta.url),{type:"module"}),this.worker.onmessage=e=>{const n=e.data;if("type"in n&&n.type==="READY"){console.log("[DbClient] Worker ready");return}const{id:o,response:i}=n,r=this.pending.get(o);r&&(this.pending.delete(o),r.resolve(i))},this.worker.onerror=e=>{console.error("[DbClient] Worker error:",e);for(const n of this.pending.values())n.reject(new Error("Worker error"));this.pending.clear()}}async sendRequest(e){if(!this.worker)throw new Error("Worker not initialized");const n=this.nextId++;return new Promise((o,i)=>{this.pending.set(n,{resolve:_=>{_.ok?o(_.data):i(new Error(_.error))},reject:i});const r={id:n,request:e};this.worker.postMessage(r)})}async openFromFile(e){return this.sendRequest({type:"OPEN_FROM_FILE",file:e})}async openDemo(){return this.sendRequest({type:"OPEN_DEMO"})}async close(){return this.sendRequest({type:"CLOSE"})}async searchFts(e,n=20){return this.sendRequest({type:"FTS_SEARCH",query:e,limit:n})}async searchHybrid(e,n=20,o){return this.sendRequest({type:"HYBRID_SEARCH",query:e,limit:n,weights:o})}async listEntities(e,n=100){return this.sendRequest({type:"LIST_ENTITIES",entityType:e,limit:n})}async getPageList(e=100,n=0){return this.sendRequest({type:"GET_PAGE_LIST",limit:e,offset:n})}async getPageBlob(e){return this.sendRequest({type:"GET_PAGE_BLOB",name:e})}async verifyPage(e){return this.sendRequest({type:"VERIFY_PAGE",gid:e})}async getCheckpoints(){return this.sendRequest({type:"GET_CHECKPOINTS"})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null),this.pending.clear()}}let Y=null;function be(){return Y||(Y=new Ye),Y}class Ke{constructor(){D(this,"worker",null);D(this,"nextId",1);D(this,"pending",new Map);D(this,"progressCallback",null);this.initWorker()}initWorker(){this.worker=new Worker(new URL("/assets/llm.worker-BdN3tlj5.js",import.meta.url),{type:"module"}),this.worker.onmessage=e=>{const n=e.data;if("type"in n&&n.type==="READY"){console.log("[LlmClient] Worker ready");return}if("type"in n&&n.type==="PROGRESS"){this.progressCallback&&this.progressCallback(n.data);return}const{id:o,response:i}=n,r=this.pending.get(o);r&&(this.pending.delete(o),r.resolve(i))},this.worker.onerror=e=>{console.error("[LlmClient] Worker error:",e);for(const n of this.pending.values())n.reject(new Error("Worker error"));this.pending.clear()}}async sendRequest(e){if(!this.worker)throw new Error("Worker not initialized");const n=this.nextId++;return new Promise((o,i)=>{this.pending.set(n,{resolve:_=>{_.ok?o(_.data):i(new Error(_.error))},reject:i});const r={id:n,request:e};this.worker.postMessage(r)})}onProgress(e){this.progressCallback=e}async loadModel(e){return this.sendRequest({type:"LOAD_MODEL",modelUrl:e})}async reason(e){return this.sendRequest({type:"REASON",request:e})}async unloadModel(){return this.sendRequest({type:"UNLOAD_MODEL"})}async getStatus(){return this.sendRequest({type:"GET_STATUS"})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null),this.pending.clear(),this.progressCallback=null}}let K=null;function ke(){return K||(K=new Ke),K}const Je={"0.5b":"https://huggingface.co/ggml-org/Qwen2.5-0.5B-Instruct-GGUF/resolve/main/qwen2.5-0.5b-instruct-q4_k_m.gguf","1.5b":"https://huggingface.co/ggml-org/Qwen2.5-1.5B-Instruct-GGUF/resolve/main/qwen2.5-1.5b-instruct-q4_k_m.gguf"};function Xe(){const[t,e]=P(null),[n,o]=P(!1),[i,r]=P(null),[_,c]=P(null),[h,a]=P(""),[p,s]=P(!1),[d,u]=P(null),[k,S]=P(!1),[b,g]=P(null),[m,C]=P(null),L=async()=>{o(!0),r(null);try{const w=await be().openDemo();e(w),console.log("Capsule info:",w)}catch(f){r(String(f)),console.error("Failed to open capsule:",f)}finally{o(!1)}},M=async f=>{if(t){o(!0),r(null),a(f),C(null);try{const y=await be().searchHybrid(f,10);c(y),console.log("Search results:",y),p&&(d!=null&&d.loaded)&&y.length>0&&await H(f,y)}catch(w){r(String(w)),console.error("Search failed:",w)}finally{o(!1)}}},F=async()=>{S(!0),r(null),g(null);try{const f=ke();f.onProgress(y=>{g(y)});const w=await f.loadModel(Je["0.5b"]);u(w),g(null),console.log("Model loaded:",w)}catch(f){r(String(f)),console.error("Failed to load model:",f)}finally{S(!1)}},W=async()=>{p?(s(!1),C(null)):(d!=null&&d.loaded||await F(),s(!0))},H=async(f,w)=>{if(d!=null&&d.loaded){S(!0),r(null);try{const y=ke(),R=w.slice(0,5).map(A=>({gid:A.gid,pageNo:A.pageNo,title:A.title,text:A.snippet||"",score:A.scores.final})),_e=await y.reason({question:f,snippets:R,maxTokens:256,temperature:.7});C(_e),console.log("Reasoning complete:",_e)}catch(y){r(String(y)),console.error("Reasoning failed:",y)}finally{S(!1)}}};return l("div",{className:"app",children:[l("header",{className:"app-header",children:[l("h1",{children:"Glyphcapsule Explorer"}),l("p",{children:"Hybrid Retrieval Demo for MemGlyph"})]}),l("main",{className:"app-main",children:t?l("div",{className:"capsule-view",children:[l("div",{className:"capsule-info",children:[l("h2",{children:["ðŸ“¦ ",t.fileName]}),l("dl",{children:[l("dt",{children:"File Size:"}),l("dd",{children:[(t.fileSize/1024).toFixed(1)," KB"]}),l("dt",{children:"Doc ID:"}),l("dd",{children:l("code",{children:[t.docId.slice(0,24),"..."]})}),l("dt",{children:"Pages:"}),l("dd",{children:t.pageCount}),l("dt",{children:"Entities:"}),l("dd",{children:t.entityCount}),l("dt",{children:"Graph Edges:"}),l("dd",{children:t.edgeCount}),t.hasVectors&&l(O,{children:[l("dt",{children:"Vectors:"}),l("dd",{children:["âœ… ",t.vectorModel," (",t.vectorDim,"-dim)"]})]})]}),l("div",{className:"llm-toggle",children:[l("label",{className:"toggle-label",children:[l("input",{type:"checkbox",checked:p,onChange:W,disabled:k}),l("span",{className:"toggle-text",children:"ðŸ¤– Enable LLM Reasoning (Qwen 0.5B)"})]}),(d==null?void 0:d.loaded)&&l("span",{className:"model-status",children:"âœ… Model loaded"}),b&&l("div",{className:"llm-progress",children:[b.message," (",(b.progress*100).toFixed(0),"%)"]})]})]}),l("div",{className:"search-section",children:[l("h3",{children:"ðŸ” Hybrid Search"}),l("p",{className:"search-hint",children:["Try searching: ",l("em",{children:'"vector search"'}),", ",l("em",{children:'"LEANN"'}),", ",l("em",{children:'"SQLite"'}),", or ",l("em",{children:'"hybrid retrieval"'})]}),l("form",{onSubmit:f=>{f.preventDefault();const y=new FormData(f.currentTarget).get("query");y.trim()&&M(y.trim())},children:l("div",{className:"search-bar",children:[l("input",{type:"text",name:"query",placeholder:"Search the capsule...",className:"search-input",disabled:n}),l("button",{type:"submit",className:"btn-search",disabled:n,children:"Search"})]})}),_&&l("div",{className:"search-results",children:[l("p",{className:"results-header",children:["Found ",_.length," results for ",l("strong",{children:['"',h,'"']})]}),_.map(f=>l("div",{className:"result-item",children:[l("div",{className:"result-header",children:[l("span",{className:"result-page",children:["Page ",f.pageNo]}),l("span",{className:"result-score",children:["Score: ",f.scores.final.toFixed(3)]})]}),l("h4",{className:"result-title",children:f.title}),f.snippet&&l("p",{className:"result-snippet",dangerouslySetInnerHTML:{__html:f.snippet}}),l("div",{className:"result-scores",children:[l("span",{children:["FTS: ",f.scores.fts.toFixed(2)]}),l("span",{children:["Entity: ",f.scores.entity.toFixed(2)]}),l("span",{children:["Graph: ",f.scores.graph.toFixed(2)]})]})]},f.gid))]}),m&&l("div",{className:"reasoning-output",children:[l("div",{className:"reasoning-header",children:[l("h4",{children:"ðŸ¤– LLM Reasoning"}),l("span",{className:"reasoning-meta",children:[m.inferenceTimeMs.toFixed(0),"ms Â· ",m.tokensGenerated," tokens"]})]}),l("div",{className:"reasoning-answer",children:m.answer}),m.usedSnippets.length>0&&l("div",{className:"reasoning-citations",children:[l("strong",{children:"ðŸ“‘ Cited sources:"}),m.usedSnippets.map(f=>{const w=_==null?void 0:_.find(y=>y.gid===f);return l("span",{className:"citation",children:["Page ",(w==null?void 0:w.pageNo)||"?"]},f)})]})]}),k&&!m&&l("div",{className:"reasoning-loading",children:[l("div",{className:"spinner"}),l("p",{children:"LLM is reasoning..."})]})]})]}):l("div",{className:"welcome",children:[l("h2",{children:"Welcome!"}),l("p",{children:"This is an offline-capable PWA for exploring MemGlyph Glyphcapsules with hybrid retrieval (FTS + Vector + Entity + Graph)."}),l("p",{children:[l("strong",{children:"Demo capsule:"})," memglyph-demo.mgx.sqlite",l("br",{}),"(8 pages, 25 entities, 11 edges, 384-dim vectors)"]}),i&&l("div",{className:"error",children:[l("strong",{children:"Error:"})," ",i]}),l("button",{className:"btn-primary",onClick:L,disabled:n,children:n?"Opening...":"Open Demo Capsule"})]})}),l("footer",{className:"app-footer",children:l("p",{children:"Built with Preact + SQLite WASM + OPFS"})})]})}Ge(l(Xe,{}),document.getElementById("app"));
