var ms=Object.defineProperty;var Jn=e=>{throw TypeError(e)};var gs=(e,t,r)=>t in e?ms(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Je=(e,t,r)=>gs(e,typeof t!="symbol"?t+"":t,r),dn=(e,t,r)=>t.has(e)||Jn("Cannot "+r);var _e=(e,t,r)=>(dn(e,t,"read from private field"),r?r.call(e):t.get(e)),lt=(e,t,r)=>t.has(e)?Jn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ft=(e,t,r,l)=>(dn(e,t,"write to private field"),l?l.call(e,r):t.set(e,r),r),Bt=(e,t,r)=>(dn(e,t,"access private method"),r);function V(e,t,r){function l(x,W){var te;Object.defineProperty(x,"_zod",{value:x._zod??{},enumerable:!1}),(te=x._zod).traits??(te.traits=new Set),x._zod.traits.add(e),t(x,W);for(const ce in q.prototype)ce in x||Object.defineProperty(x,ce,{value:q.prototype[ce].bind(x)});x._zod.constr=q,x._zod.def=W}const _=(r==null?void 0:r.Parent)??Object;class g extends _{}Object.defineProperty(g,"name",{value:e});function q(x){var W;const te=r!=null&&r.Parent?new g:this;l(te,x),(W=te._zod).deferred??(W.deferred=[]);for(const ce of te._zod.deferred)ce();return te}return Object.defineProperty(q,"init",{value:l}),Object.defineProperty(q,Symbol.hasInstance,{value:x=>{var W,te;return r!=null&&r.Parent&&x instanceof r.Parent?!0:(te=(W=x==null?void 0:x._zod)==null?void 0:W.traits)==null?void 0:te.has(e)}}),Object.defineProperty(q,"name",{value:e}),q}class xt extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class br extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const yr={};function qt(e){return yr}function bs(e){const t=Object.values(e).filter(l=>typeof l=="number");return Object.entries(e).filter(([l,_])=>t.indexOf(+l)===-1).map(([l,_])=>_)}function mn(e,t){return typeof t=="bigint"?t.toString():t}function Xt(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function vn(e){return e==null}function wn(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function ys(e,t){const r=(e.toString().split(".")[1]||"").length,l=t.toString();let _=(l.split(".")[1]||"").length;if(_===0&&/\d?e-\d?/.test(l)){const W=l.match(/\d?e-(\d?)/);W!=null&&W[1]&&(_=Number.parseInt(W[1]))}const g=r>_?r:_,q=Number.parseInt(e.toFixed(g).replace(".","")),x=Number.parseInt(t.toFixed(g).replace(".",""));return q%x/10**g}const Yn=Symbol("evaluating");function Me(e,t,r){let l;Object.defineProperty(e,t,{get(){if(l!==Yn)return l===void 0&&(l=Yn,l=r()),l},set(_){Object.defineProperty(e,t,{value:_})},configurable:!0})}function St(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function kt(...e){const t={};for(const r of e){const l=Object.getOwnPropertyDescriptors(r);Object.assign(t,l)}return Object.defineProperties({},t)}function Xn(e){return JSON.stringify(e)}const vr="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Rt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const vs=Xt(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function zt(e){if(Rt(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(Rt(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function wr(e){return zt(e)?{...e}:Array.isArray(e)?[...e]:e}const ws=new Set(["string","number","symbol"]);function Ft(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function gt(e,t,r){const l=new e._zod.constr(t??e._zod.def);return(!t||r!=null&&r.parent)&&(l._zod.parent=e),l}function qe(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function qs(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Es={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Ss(e,t){const r=e._zod.def,l=kt(e._zod.def,{get shape(){const _={};for(const g in t){if(!(g in r.shape))throw new Error(`Unrecognized key: "${g}"`);t[g]&&(_[g]=r.shape[g])}return St(this,"shape",_),_},checks:[]});return gt(e,l)}function ks(e,t){const r=e._zod.def,l=kt(e._zod.def,{get shape(){const _={...e._zod.def.shape};for(const g in t){if(!(g in r.shape))throw new Error(`Unrecognized key: "${g}"`);t[g]&&delete _[g]}return St(this,"shape",_),_},checks:[]});return gt(e,l)}function As(e,t){if(!zt(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const _=kt(e._zod.def,{get shape(){const g={...e._zod.def.shape,...t};return St(this,"shape",g),g},checks:[]});return gt(e,_)}function Is(e,t){if(!zt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const l={...e._zod.def.shape,...t};return St(this,"shape",l),l},checks:e._zod.def.checks};return gt(e,r)}function Ts(e,t){const r=kt(e._zod.def,{get shape(){const l={...e._zod.def.shape,...t._zod.def.shape};return St(this,"shape",l),l},get catchall(){return t._zod.def.catchall},checks:[]});return gt(e,r)}function Os(e,t,r){const l=kt(t._zod.def,{get shape(){const _=t._zod.def.shape,g={..._};if(r)for(const q in r){if(!(q in _))throw new Error(`Unrecognized key: "${q}"`);r[q]&&(g[q]=e?new e({type:"optional",innerType:_[q]}):_[q])}else for(const q in _)g[q]=e?new e({type:"optional",innerType:_[q]}):_[q];return St(this,"shape",g),g},checks:[]});return gt(t,l)}function xs(e,t,r){const l=kt(t._zod.def,{get shape(){const _=t._zod.def.shape,g={..._};if(r)for(const q in r){if(!(q in g))throw new Error(`Unrecognized key: "${q}"`);r[q]&&(g[q]=new e({type:"nonoptional",innerType:_[q]}))}else for(const q in _)g[q]=new e({type:"nonoptional",innerType:_[q]});return St(this,"shape",g),g},checks:[]});return gt(t,l)}function Ot(e,t=0){var r;if(e.aborted===!0)return!0;for(let l=t;l<e.issues.length;l++)if(((r=e.issues[l])==null?void 0:r.continue)!==!0)return!0;return!1}function qr(e,t){return t.map(r=>{var l;return(l=r).path??(l.path=[]),r.path.unshift(e),r})}function Wt(e){return typeof e=="string"?e:e==null?void 0:e.message}function Et(e,t,r){var _,g,q,x,W,te;const l={...e,path:e.path??[]};if(!e.message){const ce=Wt((q=(g=(_=e.inst)==null?void 0:_._zod.def)==null?void 0:g.error)==null?void 0:q.call(g,e))??Wt((x=t==null?void 0:t.error)==null?void 0:x.call(t,e))??Wt((W=r.customError)==null?void 0:W.call(r,e))??Wt((te=r.localeError)==null?void 0:te.call(r,e))??"Invalid input";l.message=ce}return delete l.inst,delete l.continue,t!=null&&t.reportInput||delete l.input,l}function qn(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Dt(...e){const[t,r,l]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:l}:{...t}}const Er=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,mn,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Sr=V("$ZodError",Er),kr=V("$ZodError",Er,{Parent:Error});function Fs(e,t=r=>r.message){const r={},l=[];for(const _ of e.issues)_.path.length>0?(r[_.path[0]]=r[_.path[0]]||[],r[_.path[0]].push(t(_))):l.push(t(_));return{formErrors:l,fieldErrors:r}}function Ps(e,t=r=>r.message){const r={_errors:[]},l=_=>{for(const g of _.issues)if(g.code==="invalid_union"&&g.errors.length)g.errors.map(q=>l({issues:q}));else if(g.code==="invalid_key")l({issues:g.issues});else if(g.code==="invalid_element")l({issues:g.issues});else if(g.path.length===0)r._errors.push(t(g));else{let q=r,x=0;for(;x<g.path.length;){const W=g.path[x];x===g.path.length-1?(q[W]=q[W]||{_errors:[]},q[W]._errors.push(t(g))):q[W]=q[W]||{_errors:[]},q=q[W],x++}}};return l(e),r}const En=e=>(t,r,l,_)=>{const g=l?Object.assign(l,{async:!1}):{async:!1},q=t._zod.run({value:r,issues:[]},g);if(q instanceof Promise)throw new xt;if(q.issues.length){const x=new((_==null?void 0:_.Err)??e)(q.issues.map(W=>Et(W,g,qt())));throw vr(x,_==null?void 0:_.callee),x}return q.value},Sn=e=>async(t,r,l,_)=>{const g=l?Object.assign(l,{async:!0}):{async:!0};let q=t._zod.run({value:r,issues:[]},g);if(q instanceof Promise&&(q=await q),q.issues.length){const x=new((_==null?void 0:_.Err)??e)(q.issues.map(W=>Et(W,g,qt())));throw vr(x,_==null?void 0:_.callee),x}return q.value},en=e=>(t,r,l)=>{const _=l?{...l,async:!1}:{async:!1},g=t._zod.run({value:r,issues:[]},_);if(g instanceof Promise)throw new xt;return g.issues.length?{success:!1,error:new(e??Sr)(g.issues.map(q=>Et(q,_,qt())))}:{success:!0,data:g.value}},Ns=en(kr),tn=e=>async(t,r,l)=>{const _=l?Object.assign(l,{async:!0}):{async:!0};let g=t._zod.run({value:r,issues:[]},_);return g instanceof Promise&&(g=await g),g.issues.length?{success:!1,error:new e(g.issues.map(q=>Et(q,_,qt())))}:{success:!0,data:g.value}},Ls=tn(kr),Cs=e=>(t,r,l)=>{const _=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return En(e)(t,r,_)},Rs=e=>(t,r,l)=>En(e)(t,r,l),zs=e=>async(t,r,l)=>{const _=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return Sn(e)(t,r,_)},Ds=e=>async(t,r,l)=>Sn(e)(t,r,l),Ms=e=>(t,r,l)=>{const _=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return en(e)(t,r,_)},js=e=>(t,r,l)=>en(e)(t,r,l),$s=e=>async(t,r,l)=>{const _=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return tn(e)(t,r,_)},Us=e=>async(t,r,l)=>tn(e)(t,r,l),Bs=/^[cC][^\s-]{8,}$/,Ws=/^[0-9a-z]+$/,Zs=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Qs=/^[0-9a-vA-V]{20}$/,Hs=/^[A-Za-z0-9]{27}$/,Vs=/^[a-zA-Z0-9_-]{21}$/,Gs=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Ks=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,er=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Js=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Ys="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Xs(){return new RegExp(Ys,"u")}const eo=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,to=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,no=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,ro=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,io=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Ar=/^[A-Za-z0-9_-]*$/,so=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,oo=/^\+(?:[0-9]){6,14}[0-9]$/,Ir="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ao=new RegExp(`^${Ir}$`);function Tr(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function lo(e){return new RegExp(`^${Tr(e)}$`)}function co(e){const t=Tr({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const l=`${t}(?:${r.join("|")})`;return new RegExp(`^${Ir}T(?:${l})$`)}const uo=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},fo=/^-?\d+$/,_o=/^-?\d+(?:\.\d+)?/,po=/^(?:true|false)$/i,ho=/^null$/i,mo=/^[^A-Z]*$/,go=/^[^a-z]*$/,ct=V("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),Or={number:"number",bigint:"bigint",object:"date"},xr=V("$ZodCheckLessThan",(e,t)=>{ct.init(e,t);const r=Or[typeof t.value];e._zod.onattach.push(l=>{const _=l._zod.bag,g=(t.inclusive?_.maximum:_.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<g&&(t.inclusive?_.maximum=t.value:_.exclusiveMaximum=t.value)}),e._zod.check=l=>{(t.inclusive?l.value<=t.value:l.value<t.value)||l.issues.push({origin:r,code:"too_big",maximum:t.value,input:l.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Fr=V("$ZodCheckGreaterThan",(e,t)=>{ct.init(e,t);const r=Or[typeof t.value];e._zod.onattach.push(l=>{const _=l._zod.bag,g=(t.inclusive?_.minimum:_.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>g&&(t.inclusive?_.minimum=t.value:_.exclusiveMinimum=t.value)}),e._zod.check=l=>{(t.inclusive?l.value>=t.value:l.value>t.value)||l.issues.push({origin:r,code:"too_small",minimum:t.value,input:l.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),bo=V("$ZodCheckMultipleOf",(e,t)=>{ct.init(e,t),e._zod.onattach.push(r=>{var l;(l=r._zod.bag).multipleOf??(l.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):ys(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),yo=V("$ZodCheckNumberFormat",(e,t)=>{var q;ct.init(e,t),t.format=t.format||"float64";const r=(q=t.format)==null?void 0:q.includes("int"),l=r?"int":"number",[_,g]=Es[t.format];e._zod.onattach.push(x=>{const W=x._zod.bag;W.format=t.format,W.minimum=_,W.maximum=g,r&&(W.pattern=fo)}),e._zod.check=x=>{const W=x.value;if(r){if(!Number.isInteger(W)){x.issues.push({expected:l,format:t.format,code:"invalid_type",continue:!1,input:W,inst:e});return}if(!Number.isSafeInteger(W)){W>0?x.issues.push({input:W,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:l,continue:!t.abort}):x.issues.push({input:W,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:l,continue:!t.abort});return}}W<_&&x.issues.push({origin:"number",input:W,code:"too_small",minimum:_,inclusive:!0,inst:e,continue:!t.abort}),W>g&&x.issues.push({origin:"number",input:W,code:"too_big",maximum:g,inst:e})}}),vo=V("$ZodCheckMaxLength",(e,t)=>{var r;ct.init(e,t),(r=e._zod.def).when??(r.when=l=>{const _=l.value;return!vn(_)&&_.length!==void 0}),e._zod.onattach.push(l=>{const _=l._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<_&&(l._zod.bag.maximum=t.maximum)}),e._zod.check=l=>{const _=l.value;if(_.length<=t.maximum)return;const q=qn(_);l.issues.push({origin:q,code:"too_big",maximum:t.maximum,inclusive:!0,input:_,inst:e,continue:!t.abort})}}),wo=V("$ZodCheckMinLength",(e,t)=>{var r;ct.init(e,t),(r=e._zod.def).when??(r.when=l=>{const _=l.value;return!vn(_)&&_.length!==void 0}),e._zod.onattach.push(l=>{const _=l._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>_&&(l._zod.bag.minimum=t.minimum)}),e._zod.check=l=>{const _=l.value;if(_.length>=t.minimum)return;const q=qn(_);l.issues.push({origin:q,code:"too_small",minimum:t.minimum,inclusive:!0,input:_,inst:e,continue:!t.abort})}}),qo=V("$ZodCheckLengthEquals",(e,t)=>{var r;ct.init(e,t),(r=e._zod.def).when??(r.when=l=>{const _=l.value;return!vn(_)&&_.length!==void 0}),e._zod.onattach.push(l=>{const _=l._zod.bag;_.minimum=t.length,_.maximum=t.length,_.length=t.length}),e._zod.check=l=>{const _=l.value,g=_.length;if(g===t.length)return;const q=qn(_),x=g>t.length;l.issues.push({origin:q,...x?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:l.value,inst:e,continue:!t.abort})}}),nn=V("$ZodCheckStringFormat",(e,t)=>{var r,l;ct.init(e,t),e._zod.onattach.push(_=>{const g=_._zod.bag;g.format=t.format,t.pattern&&(g.patterns??(g.patterns=new Set),g.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=_=>{t.pattern.lastIndex=0,!t.pattern.test(_.value)&&_.issues.push({origin:"string",code:"invalid_format",format:t.format,input:_.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(l=e._zod).check??(l.check=()=>{})}),Eo=V("$ZodCheckRegex",(e,t)=>{nn.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),So=V("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=mo),nn.init(e,t)}),ko=V("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=go),nn.init(e,t)}),Ao=V("$ZodCheckIncludes",(e,t)=>{ct.init(e,t);const r=Ft(t.includes),l=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=l,e._zod.onattach.push(_=>{const g=_._zod.bag;g.patterns??(g.patterns=new Set),g.patterns.add(l)}),e._zod.check=_=>{_.value.includes(t.includes,t.position)||_.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:_.value,inst:e,continue:!t.abort})}}),Io=V("$ZodCheckStartsWith",(e,t)=>{ct.init(e,t);const r=new RegExp(`^${Ft(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(l=>{const _=l._zod.bag;_.patterns??(_.patterns=new Set),_.patterns.add(r)}),e._zod.check=l=>{l.value.startsWith(t.prefix)||l.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:l.value,inst:e,continue:!t.abort})}}),To=V("$ZodCheckEndsWith",(e,t)=>{ct.init(e,t);const r=new RegExp(`.*${Ft(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(l=>{const _=l._zod.bag;_.patterns??(_.patterns=new Set),_.patterns.add(r)}),e._zod.check=l=>{l.value.endsWith(t.suffix)||l.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:l.value,inst:e,continue:!t.abort})}}),Oo=V("$ZodCheckOverwrite",(e,t)=>{ct.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class xo{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const l=t.split(`
`).filter(q=>q),_=Math.min(...l.map(q=>q.length-q.trimStart().length)),g=l.map(q=>q.slice(_)).map(q=>" ".repeat(this.indent*2)+q);for(const q of g)this.content.push(q)}compile(){const t=Function,r=this==null?void 0:this.args,_=[...((this==null?void 0:this.content)??[""]).map(g=>`  ${g}`)];return new t(...r,_.join(`
`))}}const Fo={major:4,minor:1,patch:12},Be=V("$ZodType",(e,t)=>{var _;var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Fo;const l=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&l.unshift(e);for(const g of l)for(const q of g._zod.onattach)q(e);if(l.length===0)(r=e._zod).deferred??(r.deferred=[]),(_=e._zod.deferred)==null||_.push(()=>{e._zod.run=e._zod.parse});else{const g=(x,W,te)=>{let ce=Ot(x),Y;for(const de of W){if(de._zod.def.when){if(!de._zod.def.when(x))continue}else if(ce)continue;const be=x.issues.length,Re=de._zod.check(x);if(Re instanceof Promise&&(te==null?void 0:te.async)===!1)throw new xt;if(Y||Re instanceof Promise)Y=(Y??Promise.resolve()).then(async()=>{await Re,x.issues.length!==be&&(ce||(ce=Ot(x,be)))});else{if(x.issues.length===be)continue;ce||(ce=Ot(x,be))}}return Y?Y.then(()=>x):x},q=(x,W,te)=>{if(Ot(x))return x.aborted=!0,x;const ce=g(W,l,te);if(ce instanceof Promise){if(te.async===!1)throw new xt;return ce.then(Y=>e._zod.parse(Y,te))}return e._zod.parse(ce,te)};e._zod.run=(x,W)=>{if(W.skipChecks)return e._zod.parse(x,W);if(W.direction==="backward"){const ce=e._zod.parse({value:x.value,issues:[]},{...W,skipChecks:!0});return ce instanceof Promise?ce.then(Y=>q(Y,x,W)):q(ce,x,W)}const te=e._zod.parse(x,W);if(te instanceof Promise){if(W.async===!1)throw new xt;return te.then(ce=>g(ce,l,W))}return g(te,l,W)}}e["~standard"]={validate:g=>{var q;try{const x=Ns(e,g);return x.success?{value:x.data}:{issues:(q=x.error)==null?void 0:q.issues}}catch{return Ls(e,g).then(W=>{var te;return W.success?{value:W.data}:{issues:(te=W.error)==null?void 0:te.issues}})}},vendor:"zod",version:1}}),kn=V("$ZodString",(e,t)=>{var r;Be.init(e,t),e._zod.pattern=[...((r=e==null?void 0:e._zod.bag)==null?void 0:r.patterns)??[]].pop()??uo(e._zod.bag),e._zod.parse=(l,_)=>{if(t.coerce)try{l.value=String(l.value)}catch{}return typeof l.value=="string"||l.issues.push({expected:"string",code:"invalid_type",input:l.value,inst:e}),l}}),Ue=V("$ZodStringFormat",(e,t)=>{nn.init(e,t),kn.init(e,t)}),Po=V("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Ks),Ue.init(e,t)}),No=V("$ZodUUID",(e,t)=>{if(t.version){const l={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(l===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=er(l))}else t.pattern??(t.pattern=er());Ue.init(e,t)}),Lo=V("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Js),Ue.init(e,t)}),Co=V("$ZodURL",(e,t)=>{Ue.init(e,t),e._zod.check=r=>{try{const l=r.value.trim(),_=new URL(l);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(_.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:so.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(_.protocol.endsWith(":")?_.protocol.slice(0,-1):_.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=_.href:r.value=l;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),Ro=V("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Xs()),Ue.init(e,t)}),zo=V("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Vs),Ue.init(e,t)}),Do=V("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Bs),Ue.init(e,t)}),Mo=V("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Ws),Ue.init(e,t)}),jo=V("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Zs),Ue.init(e,t)}),$o=V("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Qs),Ue.init(e,t)}),Uo=V("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Hs),Ue.init(e,t)}),Bo=V("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=co(t)),Ue.init(e,t)}),Wo=V("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=ao),Ue.init(e,t)}),Zo=V("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=lo(t)),Ue.init(e,t)}),Qo=V("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Gs),Ue.init(e,t)}),Ho=V("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=eo),Ue.init(e,t),e._zod.onattach.push(r=>{const l=r._zod.bag;l.format="ipv4"})}),Vo=V("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=to),Ue.init(e,t),e._zod.onattach.push(r=>{const l=r._zod.bag;l.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Go=V("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=no),Ue.init(e,t)}),Ko=V("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=ro),Ue.init(e,t),e._zod.check=r=>{const l=r.value.split("/");try{if(l.length!==2)throw new Error;const[_,g]=l;if(!g)throw new Error;const q=Number(g);if(`${q}`!==g)throw new Error;if(q<0||q>128)throw new Error;new URL(`http://[${_}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function Pr(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Jo=V("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=io),Ue.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{Pr(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Yo(e){if(!Ar.test(e))return!1;const t=e.replace(/[-_]/g,l=>l==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Pr(r)}const Xo=V("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Ar),Ue.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{Yo(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),ea=V("$ZodE164",(e,t)=>{t.pattern??(t.pattern=oo),Ue.init(e,t)});function ta(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[l]=r;if(!l)return!1;const _=JSON.parse(atob(l));return!("typ"in _&&(_==null?void 0:_.typ)!=="JWT"||!_.alg||t&&(!("alg"in _)||_.alg!==t))}catch{return!1}}const na=V("$ZodJWT",(e,t)=>{Ue.init(e,t),e._zod.check=r=>{ta(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),Nr=V("$ZodNumber",(e,t)=>{Be.init(e,t),e._zod.pattern=e._zod.bag.pattern??_o,e._zod.parse=(r,l)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const _=r.value;if(typeof _=="number"&&!Number.isNaN(_)&&Number.isFinite(_))return r;const g=typeof _=="number"?Number.isNaN(_)?"NaN":Number.isFinite(_)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:_,inst:e,...g?{received:g}:{}}),r}}),ra=V("$ZodNumber",(e,t)=>{yo.init(e,t),Nr.init(e,t)}),ia=V("$ZodBoolean",(e,t)=>{Be.init(e,t),e._zod.pattern=po,e._zod.parse=(r,l)=>{if(t.coerce)try{r.value=!!r.value}catch{}const _=r.value;return typeof _=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:_,inst:e}),r}}),sa=V("$ZodNull",(e,t)=>{Be.init(e,t),e._zod.pattern=ho,e._zod.values=new Set([null]),e._zod.parse=(r,l)=>{const _=r.value;return _===null||r.issues.push({expected:"null",code:"invalid_type",input:_,inst:e}),r}}),oa=V("$ZodUnknown",(e,t)=>{Be.init(e,t),e._zod.parse=r=>r}),aa=V("$ZodNever",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function tr(e,t,r){e.issues.length&&t.issues.push(...qr(r,e.issues)),t.value[r]=e.value}const la=V("$ZodArray",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>{const _=r.value;if(!Array.isArray(_))return r.issues.push({expected:"array",code:"invalid_type",input:_,inst:e}),r;r.value=Array(_.length);const g=[];for(let q=0;q<_.length;q++){const x=_[q],W=t.element._zod.run({value:x,issues:[]},l);W instanceof Promise?g.push(W.then(te=>tr(te,r,q))):tr(W,r,q)}return g.length?Promise.all(g).then(()=>r):r}});function Kt(e,t,r,l){e.issues.length&&t.issues.push(...qr(r,e.issues)),e.value===void 0?r in l&&(t.value[r]=void 0):t.value[r]=e.value}function Lr(e){var l,_,g,q;const t=Object.keys(e.shape);for(const x of t)if(!((q=(g=(_=(l=e.shape)==null?void 0:l[x])==null?void 0:_._zod)==null?void 0:g.traits)!=null&&q.has("$ZodType")))throw new Error(`Invalid element at key "${x}": expected a Zod schema`);const r=qs(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function Cr(e,t,r,l,_,g){const q=[],x=_.keySet,W=_.catchall._zod,te=W.def.type;for(const ce of Object.keys(t)){if(x.has(ce))continue;if(te==="never"){q.push(ce);continue}const Y=W.run({value:t[ce],issues:[]},l);Y instanceof Promise?e.push(Y.then(de=>Kt(de,r,ce,t))):Kt(Y,r,ce,t)}return q.length&&r.issues.push({code:"unrecognized_keys",keys:q,input:t,inst:g}),e.length?Promise.all(e).then(()=>r):r}const ca=V("$ZodObject",(e,t)=>{Be.init(e,t);const r=Object.getOwnPropertyDescriptor(t,"shape");if(!(r!=null&&r.get)){const x=t.shape;Object.defineProperty(t,"shape",{get:()=>{const W={...x};return Object.defineProperty(t,"shape",{value:W}),W}})}const l=Xt(()=>Lr(t));Me(e._zod,"propValues",()=>{const x=t.shape,W={};for(const te in x){const ce=x[te]._zod;if(ce.values){W[te]??(W[te]=new Set);for(const Y of ce.values)W[te].add(Y)}}return W});const _=Rt,g=t.catchall;let q;e._zod.parse=(x,W)=>{q??(q=l.value);const te=x.value;if(!_(te))return x.issues.push({expected:"object",code:"invalid_type",input:te,inst:e}),x;x.value={};const ce=[],Y=q.shape;for(const de of q.keys){const Re=Y[de]._zod.run({value:te[de],issues:[]},W);Re instanceof Promise?ce.push(Re.then(Ze=>Kt(Ze,x,de,te))):Kt(Re,x,de,te)}return g?Cr(ce,te,x,W,l.value,e):ce.length?Promise.all(ce).then(()=>x):x}}),ua=V("$ZodObjectJIT",(e,t)=>{ca.init(e,t);const r=e._zod.parse,l=Xt(()=>Lr(t)),_=de=>{const be=new xo(["shape","payload","ctx"]),Re=l.value,Ze=Ge=>{const Ye=Xn(Ge);return`shape[${Ye}]._zod.run({ value: input[${Ye}], issues: [] }, ctx)`};be.write("const input = payload.value;");const rt=Object.create(null);let it=0;for(const Ge of Re.keys)rt[Ge]=`key_${it++}`;be.write("const newResult = {};");for(const Ge of Re.keys){const Ye=rt[Ge],Oe=Xn(Ge);be.write(`const ${Ye} = ${Ze(Ge)};`),be.write(`
        if (${Ye}.issues.length) {
          payload.issues = payload.issues.concat(${Ye}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Oe}, ...iss.path] : [${Oe}]
          })));
        }
        
        
        if (${Ye}.value === undefined) {
          if (${Oe} in input) {
            newResult[${Oe}] = undefined;
          }
        } else {
          newResult[${Oe}] = ${Ye}.value;
        }
        
      `)}be.write("payload.value = newResult;"),be.write("return payload;");const at=be.compile();return(Ge,Ye)=>at(de,Ge,Ye)};let g;const q=Rt,x=!yr.jitless,te=x&&vs.value,ce=t.catchall;let Y;e._zod.parse=(de,be)=>{Y??(Y=l.value);const Re=de.value;return q(Re)?x&&te&&(be==null?void 0:be.async)===!1&&be.jitless!==!0?(g||(g=_(t.shape)),de=g(de,be),ce?Cr([],Re,de,be,Y,e):de):r(de,be):(de.issues.push({expected:"object",code:"invalid_type",input:Re,inst:e}),de)}});function nr(e,t,r,l){for(const g of e)if(g.issues.length===0)return t.value=g.value,t;const _=e.filter(g=>!Ot(g));return _.length===1?(t.value=_[0].value,_[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(g=>g.issues.map(q=>Et(q,l,qt())))}),t)}const Rr=V("$ZodUnion",(e,t)=>{Be.init(e,t),Me(e._zod,"optin",()=>t.options.some(_=>_._zod.optin==="optional")?"optional":void 0),Me(e._zod,"optout",()=>t.options.some(_=>_._zod.optout==="optional")?"optional":void 0),Me(e._zod,"values",()=>{if(t.options.every(_=>_._zod.values))return new Set(t.options.flatMap(_=>Array.from(_._zod.values)))}),Me(e._zod,"pattern",()=>{if(t.options.every(_=>_._zod.pattern)){const _=t.options.map(g=>g._zod.pattern);return new RegExp(`^(${_.map(g=>wn(g.source)).join("|")})$`)}});const r=t.options.length===1,l=t.options[0]._zod.run;e._zod.parse=(_,g)=>{if(r)return l(_,g);let q=!1;const x=[];for(const W of t.options){const te=W._zod.run({value:_.value,issues:[]},g);if(te instanceof Promise)x.push(te),q=!0;else{if(te.issues.length===0)return te;x.push(te)}}return q?Promise.all(x).then(W=>nr(W,_,e,g)):nr(x,_,e,g)}}),fa=V("$ZodDiscriminatedUnion",(e,t)=>{Rr.init(e,t);const r=e._zod.parse;Me(e._zod,"propValues",()=>{const _={};for(const g of t.options){const q=g._zod.propValues;if(!q||Object.keys(q).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(g)}"`);for(const[x,W]of Object.entries(q)){_[x]||(_[x]=new Set);for(const te of W)_[x].add(te)}}return _});const l=Xt(()=>{var q;const _=t.options,g=new Map;for(const x of _){const W=(q=x._zod.propValues)==null?void 0:q[t.discriminator];if(!W||W.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(x)}"`);for(const te of W){if(g.has(te))throw new Error(`Duplicate discriminator value "${String(te)}"`);g.set(te,x)}}return g});e._zod.parse=(_,g)=>{const q=_.value;if(!Rt(q))return _.issues.push({code:"invalid_type",expected:"object",input:q,inst:e}),_;const x=l.value.get(q==null?void 0:q[t.discriminator]);return x?x._zod.run(_,g):t.unionFallback?r(_,g):(_.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:q,path:[t.discriminator],inst:e}),_)}}),_a=V("$ZodIntersection",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>{const _=r.value,g=t.left._zod.run({value:_,issues:[]},l),q=t.right._zod.run({value:_,issues:[]},l);return g instanceof Promise||q instanceof Promise?Promise.all([g,q]).then(([W,te])=>rr(r,W,te)):rr(r,g,q)}});function gn(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(zt(e)&&zt(t)){const r=Object.keys(t),l=Object.keys(e).filter(g=>r.indexOf(g)!==-1),_={...e,...t};for(const g of l){const q=gn(e[g],t[g]);if(!q.valid)return{valid:!1,mergeErrorPath:[g,...q.mergeErrorPath]};_[g]=q.data}return{valid:!0,data:_}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let l=0;l<e.length;l++){const _=e[l],g=t[l],q=gn(_,g);if(!q.valid)return{valid:!1,mergeErrorPath:[l,...q.mergeErrorPath]};r.push(q.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function rr(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),Ot(e))return e;const l=gn(t.value,r.value);if(!l.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(l.mergeErrorPath)}`);return e.value=l.data,e}const da=V("$ZodEnum",(e,t)=>{Be.init(e,t);const r=bs(t.entries),l=new Set(r);e._zod.values=l,e._zod.pattern=new RegExp(`^(${r.filter(_=>ws.has(typeof _)).map(_=>typeof _=="string"?Ft(_):_.toString()).join("|")})$`),e._zod.parse=(_,g)=>{const q=_.value;return l.has(q)||_.issues.push({code:"invalid_value",values:r,input:q,inst:e}),_}}),pa=V("$ZodLiteral",(e,t)=>{if(Be.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?Ft(r):r?Ft(r.toString()):String(r)).join("|")})$`),e._zod.parse=(r,l)=>{const _=r.value;return e._zod.values.has(_)||r.issues.push({code:"invalid_value",values:t.values,input:_,inst:e}),r}}),ha=V("$ZodTransform",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>{if(l.direction==="backward")throw new br(e.constructor.name);const _=t.transform(r.value,r);if(l.async)return(_ instanceof Promise?_:Promise.resolve(_)).then(q=>(r.value=q,r));if(_ instanceof Promise)throw new xt;return r.value=_,r}});function ir(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const ma=V("$ZodOptional",(e,t)=>{Be.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Me(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),Me(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${wn(r.source)})?$`):void 0}),e._zod.parse=(r,l)=>{if(t.innerType._zod.optin==="optional"){const _=t.innerType._zod.run(r,l);return _ instanceof Promise?_.then(g=>ir(g,r.value)):ir(_,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,l)}}),ga=V("$ZodNullable",(e,t)=>{Be.init(e,t),Me(e._zod,"optin",()=>t.innerType._zod.optin),Me(e._zod,"optout",()=>t.innerType._zod.optout),Me(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${wn(r.source)}|null)$`):void 0}),Me(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,l)=>r.value===null?r:t.innerType._zod.run(r,l)}),ba=V("$ZodDefault",(e,t)=>{Be.init(e,t),e._zod.optin="optional",Me(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,l)=>{if(l.direction==="backward")return t.innerType._zod.run(r,l);if(r.value===void 0)return r.value=t.defaultValue,r;const _=t.innerType._zod.run(r,l);return _ instanceof Promise?_.then(g=>sr(g,t)):sr(_,t)}});function sr(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const ya=V("$ZodPrefault",(e,t)=>{Be.init(e,t),e._zod.optin="optional",Me(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,l)=>(l.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,l))}),va=V("$ZodNonOptional",(e,t)=>{Be.init(e,t),Me(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(l=>l!==void 0)):void 0}),e._zod.parse=(r,l)=>{const _=t.innerType._zod.run(r,l);return _ instanceof Promise?_.then(g=>or(g,e)):or(_,e)}});function or(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const wa=V("$ZodCatch",(e,t)=>{Be.init(e,t),Me(e._zod,"optin",()=>t.innerType._zod.optin),Me(e._zod,"optout",()=>t.innerType._zod.optout),Me(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,l)=>{if(l.direction==="backward")return t.innerType._zod.run(r,l);const _=t.innerType._zod.run(r,l);return _ instanceof Promise?_.then(g=>(r.value=g.value,g.issues.length&&(r.value=t.catchValue({...r,error:{issues:g.issues.map(q=>Et(q,l,qt()))},input:r.value}),r.issues=[]),r)):(r.value=_.value,_.issues.length&&(r.value=t.catchValue({...r,error:{issues:_.issues.map(g=>Et(g,l,qt()))},input:r.value}),r.issues=[]),r)}}),qa=V("$ZodPipe",(e,t)=>{Be.init(e,t),Me(e._zod,"values",()=>t.in._zod.values),Me(e._zod,"optin",()=>t.in._zod.optin),Me(e._zod,"optout",()=>t.out._zod.optout),Me(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,l)=>{if(l.direction==="backward"){const g=t.out._zod.run(r,l);return g instanceof Promise?g.then(q=>Zt(q,t.in,l)):Zt(g,t.in,l)}const _=t.in._zod.run(r,l);return _ instanceof Promise?_.then(g=>Zt(g,t.out,l)):Zt(_,t.out,l)}});function Zt(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const Ea=V("$ZodReadonly",(e,t)=>{Be.init(e,t),Me(e._zod,"propValues",()=>t.innerType._zod.propValues),Me(e._zod,"values",()=>t.innerType._zod.values),Me(e._zod,"optin",()=>t.innerType._zod.optin),Me(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,l)=>{if(l.direction==="backward")return t.innerType._zod.run(r,l);const _=t.innerType._zod.run(r,l);return _ instanceof Promise?_.then(ar):ar(_)}});function ar(e){return e.value=Object.freeze(e.value),e}const Sa=V("$ZodCustom",(e,t)=>{ct.init(e,t),Be.init(e,t),e._zod.parse=(r,l)=>r,e._zod.check=r=>{const l=r.value,_=t.fn(l);if(_ instanceof Promise)return _.then(g=>lr(g,r,l,e));lr(_,r,l,e)}});function lr(e,t,r,l){if(!e){const _={code:"custom",input:r,inst:l,path:[...l._zod.def.path??[]],continue:!l._zod.def.abort};l._zod.def.params&&(_.params=l._zod.def.params),t.issues.push(Dt(_))}}class ka{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const l=r[0];if(this._map.set(t,l),l&&typeof l=="object"&&"id"in l){if(this._idmap.has(l.id))throw new Error(`ID ${l.id} already exists in the registry`);this._idmap.set(l.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const l={...this.get(r)??{}};delete l.id;const _={...l,...this._map.get(t)};return Object.keys(_).length?_:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Aa(){return new ka}const Qt=Aa();function Ia(e,t){return new e({type:"string",...qe(t)})}function Ta(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...qe(t)})}function cr(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...qe(t)})}function Oa(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...qe(t)})}function xa(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...qe(t)})}function Fa(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...qe(t)})}function Pa(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...qe(t)})}function Na(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...qe(t)})}function La(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...qe(t)})}function Ca(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...qe(t)})}function Ra(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...qe(t)})}function za(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...qe(t)})}function Da(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...qe(t)})}function Ma(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...qe(t)})}function ja(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...qe(t)})}function $a(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...qe(t)})}function Ua(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...qe(t)})}function Ba(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...qe(t)})}function Wa(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...qe(t)})}function Za(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...qe(t)})}function Qa(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...qe(t)})}function Ha(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...qe(t)})}function Va(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...qe(t)})}function Ga(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...qe(t)})}function Ka(e,t){return new e({type:"string",format:"date",check:"string_format",...qe(t)})}function Ja(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...qe(t)})}function Ya(e,t){return new e({type:"string",format:"duration",check:"string_format",...qe(t)})}function Xa(e,t){return new e({type:"number",checks:[],...qe(t)})}function el(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...qe(t)})}function tl(e,t){return new e({type:"boolean",...qe(t)})}function nl(e,t){return new e({type:"null",...qe(t)})}function rl(e){return new e({type:"unknown"})}function il(e,t){return new e({type:"never",...qe(t)})}function ur(e,t){return new xr({check:"less_than",...qe(t),value:e,inclusive:!1})}function pn(e,t){return new xr({check:"less_than",...qe(t),value:e,inclusive:!0})}function fr(e,t){return new Fr({check:"greater_than",...qe(t),value:e,inclusive:!1})}function hn(e,t){return new Fr({check:"greater_than",...qe(t),value:e,inclusive:!0})}function _r(e,t){return new bo({check:"multiple_of",...qe(t),value:e})}function zr(e,t){return new vo({check:"max_length",...qe(t),maximum:e})}function Jt(e,t){return new wo({check:"min_length",...qe(t),minimum:e})}function Dr(e,t){return new qo({check:"length_equals",...qe(t),length:e})}function sl(e,t){return new Eo({check:"string_format",format:"regex",...qe(t),pattern:e})}function ol(e){return new So({check:"string_format",format:"lowercase",...qe(e)})}function al(e){return new ko({check:"string_format",format:"uppercase",...qe(e)})}function ll(e,t){return new Ao({check:"string_format",format:"includes",...qe(t),includes:e})}function cl(e,t){return new Io({check:"string_format",format:"starts_with",...qe(t),prefix:e})}function ul(e,t){return new To({check:"string_format",format:"ends_with",...qe(t),suffix:e})}function Mt(e){return new Oo({check:"overwrite",tx:e})}function fl(e){return Mt(t=>t.normalize(e))}function _l(){return Mt(e=>e.trim())}function dl(){return Mt(e=>e.toLowerCase())}function pl(){return Mt(e=>e.toUpperCase())}function hl(e,t,r){return new e({type:"array",element:t,...qe(r)})}function ml(e,t,r){return new e({type:"custom",check:"custom",fn:t,...qe(r)})}function gl(e){const t=bl(r=>(r.addIssue=l=>{if(typeof l=="string")r.issues.push(Dt(l,r.value,t._zod.def));else{const _=l;_.fatal&&(_.continue=!1),_.code??(_.code="custom"),_.input??(_.input=r.value),_.inst??(_.inst=t),_.continue??(_.continue=!t._zod.def.abort),r.issues.push(Dt(_))}},e(r.value,r)));return t}function bl(e,t){const r=new ct({check:"custom",...qe(t)});return r._zod.check=e,r}const yl=V("ZodISODateTime",(e,t)=>{Bo.init(e,t),We.init(e,t)});function vl(e){return Ga(yl,e)}const wl=V("ZodISODate",(e,t)=>{Wo.init(e,t),We.init(e,t)});function ql(e){return Ka(wl,e)}const El=V("ZodISOTime",(e,t)=>{Zo.init(e,t),We.init(e,t)});function Sl(e){return Ja(El,e)}const kl=V("ZodISODuration",(e,t)=>{Qo.init(e,t),We.init(e,t)});function Al(e){return Ya(kl,e)}const Il=(e,t)=>{Sr.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>Ps(e,r)},flatten:{value:r=>Fs(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,mn,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,mn,2)}},isEmpty:{get(){return e.issues.length===0}}})},ut=V("ZodError",Il,{Parent:Error}),Tl=En(ut),Ol=Sn(ut),xl=en(ut),Fl=tn(ut),Pl=Cs(ut),Nl=Rs(ut),Ll=zs(ut),Cl=Ds(ut),Rl=Ms(ut),zl=js(ut),Dl=$s(ut),Ml=Us(ut),Qe=V("ZodType",(e,t)=>(Be.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(kt(t,{checks:[...t.checks??[],...r.map(l=>typeof l=="function"?{_zod:{check:l,def:{check:"custom"},onattach:[]}}:l)]})),e.clone=(r,l)=>gt(e,r,l),e.brand=()=>e,e.register=(r,l)=>(r.add(e,l),e),e.parse=(r,l)=>Tl(e,r,l,{callee:e.parse}),e.safeParse=(r,l)=>xl(e,r,l),e.parseAsync=async(r,l)=>Ol(e,r,l,{callee:e.parseAsync}),e.safeParseAsync=async(r,l)=>Fl(e,r,l),e.spa=e.safeParseAsync,e.encode=(r,l)=>Pl(e,r,l),e.decode=(r,l)=>Nl(e,r,l),e.encodeAsync=async(r,l)=>Ll(e,r,l),e.decodeAsync=async(r,l)=>Cl(e,r,l),e.safeEncode=(r,l)=>Rl(e,r,l),e.safeDecode=(r,l)=>zl(e,r,l),e.safeEncodeAsync=async(r,l)=>Dl(e,r,l),e.safeDecodeAsync=async(r,l)=>Ml(e,r,l),e.refine=(r,l)=>e.check(Pc(r,l)),e.superRefine=r=>e.check(Nc(r)),e.overwrite=r=>e.check(Mt(r)),e.optional=()=>hr(e),e.nullable=()=>mr(e),e.nullish=()=>hr(mr(e)),e.nonoptional=r=>Ac(e,r),e.array=()=>An(e),e.or=r=>In([e,r]),e.and=r=>mc(e,r),e.transform=r=>gr(e,vc(r)),e.default=r=>Ec(e,r),e.prefault=r=>kc(e,r),e.catch=r=>Tc(e,r),e.pipe=r=>gr(e,r),e.readonly=()=>Fc(e),e.describe=r=>{const l=e.clone();return Qt.add(l,{description:r}),l},Object.defineProperty(e,"description",{get(){var r;return(r=Qt.get(e))==null?void 0:r.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Qt.get(e);const l=e.clone();return Qt.add(l,r[0]),l},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Mr=V("_ZodString",(e,t)=>{kn.init(e,t),Qe.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...l)=>e.check(sl(...l)),e.includes=(...l)=>e.check(ll(...l)),e.startsWith=(...l)=>e.check(cl(...l)),e.endsWith=(...l)=>e.check(ul(...l)),e.min=(...l)=>e.check(Jt(...l)),e.max=(...l)=>e.check(zr(...l)),e.length=(...l)=>e.check(Dr(...l)),e.nonempty=(...l)=>e.check(Jt(1,...l)),e.lowercase=l=>e.check(ol(l)),e.uppercase=l=>e.check(al(l)),e.trim=()=>e.check(_l()),e.normalize=(...l)=>e.check(fl(...l)),e.toLowerCase=()=>e.check(dl()),e.toUpperCase=()=>e.check(pl())}),jl=V("ZodString",(e,t)=>{kn.init(e,t),Mr.init(e,t),e.email=r=>e.check(Ta($l,r)),e.url=r=>e.check(Na(Ul,r)),e.jwt=r=>e.check(Va(rc,r)),e.emoji=r=>e.check(La(Bl,r)),e.guid=r=>e.check(cr(dr,r)),e.uuid=r=>e.check(Oa(Ht,r)),e.uuidv4=r=>e.check(xa(Ht,r)),e.uuidv6=r=>e.check(Fa(Ht,r)),e.uuidv7=r=>e.check(Pa(Ht,r)),e.nanoid=r=>e.check(Ca(Wl,r)),e.guid=r=>e.check(cr(dr,r)),e.cuid=r=>e.check(Ra(Zl,r)),e.cuid2=r=>e.check(za(Ql,r)),e.ulid=r=>e.check(Da(Hl,r)),e.base64=r=>e.check(Za(ec,r)),e.base64url=r=>e.check(Qa(tc,r)),e.xid=r=>e.check(Ma(Vl,r)),e.ksuid=r=>e.check(ja(Gl,r)),e.ipv4=r=>e.check($a(Kl,r)),e.ipv6=r=>e.check(Ua(Jl,r)),e.cidrv4=r=>e.check(Ba(Yl,r)),e.cidrv6=r=>e.check(Wa(Xl,r)),e.e164=r=>e.check(Ha(nc,r)),e.datetime=r=>e.check(vl(r)),e.date=r=>e.check(ql(r)),e.time=r=>e.check(Sl(r)),e.duration=r=>e.check(Al(r))});function Ae(e){return Ia(jl,e)}const We=V("ZodStringFormat",(e,t)=>{Ue.init(e,t),Mr.init(e,t)}),$l=V("ZodEmail",(e,t)=>{Lo.init(e,t),We.init(e,t)}),dr=V("ZodGUID",(e,t)=>{Po.init(e,t),We.init(e,t)}),Ht=V("ZodUUID",(e,t)=>{No.init(e,t),We.init(e,t)}),Ul=V("ZodURL",(e,t)=>{Co.init(e,t),We.init(e,t)}),Bl=V("ZodEmoji",(e,t)=>{Ro.init(e,t),We.init(e,t)}),Wl=V("ZodNanoID",(e,t)=>{zo.init(e,t),We.init(e,t)}),Zl=V("ZodCUID",(e,t)=>{Do.init(e,t),We.init(e,t)}),Ql=V("ZodCUID2",(e,t)=>{Mo.init(e,t),We.init(e,t)}),Hl=V("ZodULID",(e,t)=>{jo.init(e,t),We.init(e,t)}),Vl=V("ZodXID",(e,t)=>{$o.init(e,t),We.init(e,t)}),Gl=V("ZodKSUID",(e,t)=>{Uo.init(e,t),We.init(e,t)}),Kl=V("ZodIPv4",(e,t)=>{Ho.init(e,t),We.init(e,t)}),Jl=V("ZodIPv6",(e,t)=>{Vo.init(e,t),We.init(e,t)}),Yl=V("ZodCIDRv4",(e,t)=>{Go.init(e,t),We.init(e,t)}),Xl=V("ZodCIDRv6",(e,t)=>{Ko.init(e,t),We.init(e,t)}),ec=V("ZodBase64",(e,t)=>{Jo.init(e,t),We.init(e,t)}),tc=V("ZodBase64URL",(e,t)=>{Xo.init(e,t),We.init(e,t)}),nc=V("ZodE164",(e,t)=>{ea.init(e,t),We.init(e,t)}),rc=V("ZodJWT",(e,t)=>{na.init(e,t),We.init(e,t)}),jr=V("ZodNumber",(e,t)=>{Nr.init(e,t),Qe.init(e,t),e.gt=(l,_)=>e.check(fr(l,_)),e.gte=(l,_)=>e.check(hn(l,_)),e.min=(l,_)=>e.check(hn(l,_)),e.lt=(l,_)=>e.check(ur(l,_)),e.lte=(l,_)=>e.check(pn(l,_)),e.max=(l,_)=>e.check(pn(l,_)),e.int=l=>e.check(pr(l)),e.safe=l=>e.check(pr(l)),e.positive=l=>e.check(fr(0,l)),e.nonnegative=l=>e.check(hn(0,l)),e.negative=l=>e.check(ur(0,l)),e.nonpositive=l=>e.check(pn(0,l)),e.multipleOf=(l,_)=>e.check(_r(l,_)),e.step=(l,_)=>e.check(_r(l,_)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function Ne(e){return Xa(jr,e)}const ic=V("ZodNumberFormat",(e,t)=>{ra.init(e,t),jr.init(e,t)});function pr(e){return el(ic,e)}const sc=V("ZodBoolean",(e,t)=>{ia.init(e,t),Qe.init(e,t)});function $r(e){return tl(sc,e)}const oc=V("ZodNull",(e,t)=>{sa.init(e,t),Qe.init(e,t)});function ac(e){return nl(oc,e)}const lc=V("ZodUnknown",(e,t)=>{oa.init(e,t),Qe.init(e,t)});function bn(){return rl(lc)}const cc=V("ZodNever",(e,t)=>{aa.init(e,t),Qe.init(e,t)});function uc(e){return il(cc,e)}const fc=V("ZodArray",(e,t)=>{la.init(e,t),Qe.init(e,t),e.element=t.element,e.min=(r,l)=>e.check(Jt(r,l)),e.nonempty=r=>e.check(Jt(1,r)),e.max=(r,l)=>e.check(zr(r,l)),e.length=(r,l)=>e.check(Dr(r,l)),e.unwrap=()=>e.element});function An(e,t){return hl(fc,e,t)}const _c=V("ZodObject",(e,t)=>{ua.init(e,t),Qe.init(e,t),Me(e,"shape",()=>t.shape),e.keyof=()=>gc(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:bn()}),e.loose=()=>e.clone({...e._zod.def,catchall:bn()}),e.strict=()=>e.clone({...e._zod.def,catchall:uc()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>As(e,r),e.safeExtend=r=>Is(e,r),e.merge=r=>Ts(e,r),e.pick=r=>Ss(e,r),e.omit=r=>ks(e,r),e.partial=(...r)=>Os(Br,e,r[0]),e.required=(...r)=>xs(Wr,e,r[0])});function Ce(e,t){const r={type:"object",shape:e??{},...qe(t)};return new _c(r)}const Ur=V("ZodUnion",(e,t)=>{Rr.init(e,t),Qe.init(e,t),e.options=t.options});function In(e,t){return new Ur({type:"union",options:e,...qe(t)})}const dc=V("ZodDiscriminatedUnion",(e,t)=>{Ur.init(e,t),fa.init(e,t)});function pc(e,t,r){return new dc({type:"union",options:t,discriminator:e,...qe(r)})}const hc=V("ZodIntersection",(e,t)=>{_a.init(e,t),Qe.init(e,t)});function mc(e,t){return new hc({type:"intersection",left:e,right:t})}const yn=V("ZodEnum",(e,t)=>{da.init(e,t),Qe.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(l,_)=>{const g={};for(const q of l)if(r.has(q))g[q]=t.entries[q];else throw new Error(`Key ${q} not found in enum`);return new yn({...t,checks:[],...qe(_),entries:g})},e.exclude=(l,_)=>{const g={...t.entries};for(const q of l)if(r.has(q))delete g[q];else throw new Error(`Key ${q} not found in enum`);return new yn({...t,checks:[],...qe(_),entries:g})}});function gc(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(l=>[l,l])):e;return new yn({type:"enum",entries:r,...qe(t)})}const bc=V("ZodLiteral",(e,t)=>{pa.init(e,t),Qe.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function Ve(e,t){return new bc({type:"literal",values:Array.isArray(e)?e:[e],...qe(t)})}const yc=V("ZodTransform",(e,t)=>{ha.init(e,t),Qe.init(e,t),e._zod.parse=(r,l)=>{if(l.direction==="backward")throw new br(e.constructor.name);r.addIssue=g=>{if(typeof g=="string")r.issues.push(Dt(g,r.value,t));else{const q=g;q.fatal&&(q.continue=!1),q.code??(q.code="custom"),q.input??(q.input=r.value),q.inst??(q.inst=e),r.issues.push(Dt(q))}};const _=t.transform(r.value,r);return _ instanceof Promise?_.then(g=>(r.value=g,r)):(r.value=_,r)}});function vc(e){return new yc({type:"transform",transform:e})}const Br=V("ZodOptional",(e,t)=>{ma.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function hr(e){return new Br({type:"optional",innerType:e})}const wc=V("ZodNullable",(e,t)=>{ga.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function mr(e){return new wc({type:"nullable",innerType:e})}const qc=V("ZodDefault",(e,t)=>{ba.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Ec(e,t){return new qc({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():wr(t)}})}const Sc=V("ZodPrefault",(e,t)=>{ya.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function kc(e,t){return new Sc({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():wr(t)}})}const Wr=V("ZodNonOptional",(e,t)=>{va.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ac(e,t){return new Wr({type:"nonoptional",innerType:e,...qe(t)})}const Ic=V("ZodCatch",(e,t)=>{wa.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Tc(e,t){return new Ic({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Oc=V("ZodPipe",(e,t)=>{qa.init(e,t),Qe.init(e,t),e.in=t.in,e.out=t.out});function gr(e,t){return new Oc({type:"pipe",in:e,out:t})}const xc=V("ZodReadonly",(e,t)=>{Ea.init(e,t),Qe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Fc(e){return new xc({type:"readonly",innerType:e})}const Zr=V("ZodCustom",(e,t)=>{Sa.init(e,t),Qe.init(e,t)});function Pc(e,t={}){return ml(Zr,e,t)}function Nc(e){return gl(e)}function Qr(e,t={error:`Input not instance of ${e.name}`}){const r=new Zr({type:"custom",check:"custom",fn:l=>l instanceof e,abort:!0,...qe(t)});return r._zod.bag.Class=e,r}const Lc=Ce({type:Ve("OPEN_FROM_FILE"),file:Qr(File)}),Cc=Ce({type:Ve("OPEN_FROM_OPFS"),path:Ae()}),Rc=Ce({type:Ve("OPEN_DEMO")}),zc=Ce({type:Ve("SAVE_TO_OPFS"),path:Ae()}),Dc=Ce({type:Ve("REMOVE_FROM_OPFS"),path:Ae()}),Mc=Ce({type:Ve("LIST_OPFS_FILES")}),jc=Ce({type:Ve("CLOSE")}),$c=Ce({type:Ve("FTS_SEARCH"),query:Ae(),limit:Ne().int().positive().max(200).optional().default(20),entityType:Ae().optional(),entityValue:Ae().optional()}),Uc=Ce({type:Ve("VECTOR_SEARCH"),queryVector:Qr(Float32Array),limit:Ne().int().positive().max(200).optional().default(20)}),Bc=Ce({fts:Ne().min(0).max(1),vector:Ne().min(0).max(1),entity:Ne().min(0).max(1),graph:Ne().min(0).max(1)}).partial(),Wc=Ce({type:Ve("HYBRID_SEARCH"),query:Ae(),limit:Ne().int().positive().max(200).optional().default(20),weights:Bc.optional()}),Zc=Ce({type:Ve("LIST_ENTITIES"),entityType:Ae().optional(),limit:Ne().int().positive().max(500).optional().default(100)}),Qc=Ce({type:Ve("GRAPH_HOPS"),seedGid:Ae(),predicate:Ae().optional(),maxHops:Ne().int().positive().max(5).optional().default(3),limit:Ne().int().positive().max(200).optional().default(50)}),Hc=Ce({type:Ve("GET_PAGE_BLOB"),name:Ae()}),Vc=Ce({type:Ve("GET_PAGE_LIST"),limit:Ne().int().positive().max(500).optional().default(100),offset:Ne().int().nonnegative().optional().default(0)}),Gc=Ce({type:Ve("VERIFY_PAGE"),gid:Ae()}),Kc=Ce({type:Ve("GET_CHECKPOINTS")}),Jc=Ce({type:Ve("QUERY"),sql:Ae(),params:An(In([Ae(),Ne(),ac()])).optional().default([])}),Yc=Ce({type:Ve("EXPORT_DATABASE")}),Xc=pc("type",[Lc,Cc,Rc,zc,Dc,Mc,jc,$c,Uc,Wc,Zc,Qc,Hc,Vc,Gc,Kc,Jc,Yc]);Ce({fileName:Ae(),fileSize:Ne(),docId:Ae(),pageCount:Ne(),entityCount:Ne(),edgeCount:Ne(),hasVectors:$r(),vectorModel:Ae().optional(),vectorDim:Ne().optional(),opfsPath:Ae().optional()});Ce({gid:Ae(),pageNo:Ne(),title:Ae().nullable(),snippet:Ae(),rank:Ne(),score:Ne()});Ce({gid:Ae(),pageNo:Ne(),title:Ae().nullable(),similarity:Ne()});Ce({gid:Ae(),pageNo:Ne(),title:Ae().nullable(),snippet:Ae().nullable(),scores:Ce({fts:Ne(),vector:Ne(),entity:Ne(),graph:Ne(),final:Ne()})});Ce({entityType:Ae(),normalizedValue:Ae().nullable(),count:Ne()});Ce({gid:Ae(),pageNo:Ne(),title:Ae().nullable()});Ce({fromGid:Ae(),toGid:Ae(),predicate:Ae(),weight:Ne()});Ce({gid:Ae(),docId:Ae(),pageNo:Ne(),title:Ae().nullable(),tags:Ae().nullable(),updatedTs:Ae()});Ce({epoch:Ae(),merkleRoot:Ae(),pagesCount:Ne(),createdTs:Ae(),anchors:An(Ae()).nullable()});Ce({gid:Ae(),contentSha:Ae(),expectedSha:Ae().nullable(),verified:$r(),signer:Ae().nullable(),signature:Ae().nullable(),epoch:Ae().nullable(),merkleRoot:Ae().nullable()});Ce({path:Ae(),size:Ne(),lastModified:Ne()});Ce({id:Ne(),request:Xc});Ce({id:Ne(),response:In([Ce({ok:Ve(!0),data:bn()}),Ce({ok:Ve(!1),error:Ae()})])});function Yt(e){return{ok:!0,data:e}}function rn(e){return{ok:!1,error:e instanceof Error?e.message:e}}async function Tn(e={}){var Gn;var t,r=e,l=typeof window=="object",_=typeof WorkerGlobalScope<"u";typeof process=="object"&&((Gn=process.versions)!=null&&Gn.node)&&process.type!="renderer",function(n){const s=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{console.warn("globalThis.sqlite3InitModuleState is missing")}});delete globalThis.sqlite3InitModuleState,s.debugModule("pre-js.js sqlite3InitModuleState =",s),n.locateFile=(function(c,i){return new URL(c,import.meta.url).href}).bind(s),n.instantiateWasm=(function(i,p){const a=this,o=n.locateFile(a.wasmFilename,typeof x>"u"?"":x);a.debugModule("instantiateWasm() uri =",o,"sIMS =",this);const h=()=>fetch(o,{credentials:"same-origin"}),C=ae=>{ae.imports=i,a.instantiateWasm=ae,p(ae.instance,ae.module)};return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(h(),i).then(C):async()=>h().then(ae=>ae.arrayBuffer()).then(ae=>WebAssembly.instantiate(ae,i)).then(C))()}).bind(s)}(r);var g="./this.program",q=import.meta.url,x="";function W(n){return r.locateFile?r.locateFile(n,x):x+n}var te,ce;if(l||_){try{x=new URL(".",q).href}catch{}_&&(ce=n=>{var s=new XMLHttpRequest;return s.open("GET",n,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),te=async n=>{var s=await fetch(n,{credentials:"same-origin"});if(s.ok)return s.arrayBuffer();throw new Error(s.status+" : "+s.url)}}var Y=console.log.bind(console),de=console.error.bind(console),be,Re=!1,Ze,rt,it,at,Ge,Ye,Oe,Ke,st,xn=!1;function Fn(){var n=it.buffer;at=new Int8Array(n),Ye=new Int16Array(n),Ge=new Uint8Array(n),Oe=new Int32Array(n),Ke=new Uint32Array(n),st=new BigInt64Array(n),new BigUint64Array(n)}function Yr(){if(r.wasmMemory)it=r.wasmMemory;else{var n=r.INITIAL_MEMORY||8388608;it=new WebAssembly.Memory({initial:n/65536,maximum:32768})}Fn()}function Xr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)fi(r.preRun.shift());Nn(Cn)}function ei(){xn=!0,!r.noFSInit&&!d.initialized&&d.init(),Tt.__wasm_call_ctors(),d.ignorePermissions=!1}function ti(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)ui(r.postRun.shift());Nn(Ln)}var yt=0,Pt=null;function Pn(n){var s;yt++,(s=r.monitorRunDependencies)==null||s.call(r,yt)}function sn(n){var c;if(yt--,(c=r.monitorRunDependencies)==null||c.call(r,yt),yt==0&&Pt){var s=Pt;Pt=null,s()}}function ni(n){var c;(c=r.onAbort)==null||c.call(r,n),n="Aborted("+n+")",de(n),Re=!0,n+=". Build with -sASSERTIONS for more info.";var s=new WebAssembly.RuntimeError(n);throw rt==null||rt(s),s}var on;function ri(){return r.locateFile?W("sqlite3.wasm"):new URL("/assets/sqlite3-1f8bVu-G.wasm",import.meta.url).href}function ii(n){if(n==on&&be)return new Uint8Array(be);if(ce)return ce(n);throw"both async and sync fetching of the wasm failed"}async function si(n){if(!be)try{var s=await te(n);return new Uint8Array(s)}catch{}return ii(n)}async function oi(n,s){try{var c=await si(n),i=await WebAssembly.instantiate(c,s);return i}catch(p){de(`failed to asynchronously prepare wasm: ${p}`),ni(p)}}async function ai(n,s,c){if(!n)try{var i=fetch(s,{credentials:"same-origin"}),p=await WebAssembly.instantiateStreaming(i,c);return p}catch(a){de(`wasm streaming compile failed: ${a}`),de("falling back to ArrayBuffer instantiation")}return oi(s,c)}function li(){return{env:Vn,wasi_snapshot_preview1:Vn}}async function ci(){function n(a,o){return Tt=a.exports,fs(Tt),sn(),Tt}Pn();function s(a){return n(a.instance)}var c=li();if(r.instantiateWasm)return new Promise((a,o)=>{r.instantiateWasm(c,(h,C)=>{a(n(h))})});on??(on=ri());var i=await ai(be,on,c),p=s(i);return p}var Nn=n=>{for(;n.length>0;)n.shift()(r)},Ln=[],ui=n=>Ln.push(n),Cn=[],fi=n=>Cn.push(n),De={isAbs:n=>n.charAt(0)==="/",splitPath:n=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return s.exec(n).slice(1)},normalizeArray:(n,s)=>{for(var c=0,i=n.length-1;i>=0;i--){var p=n[i];p==="."?n.splice(i,1):p===".."?(n.splice(i,1),c++):c&&(n.splice(i,1),c--)}if(s)for(;c;c--)n.unshift("..");return n},normalize:n=>{var s=De.isAbs(n),c=n.slice(-1)==="/";return n=De.normalizeArray(n.split("/").filter(i=>!!i),!s).join("/"),!n&&!s&&(n="."),n&&c&&(n+="/"),(s?"/":"")+n},dirname:n=>{var s=De.splitPath(n),c=s[0],i=s[1];return!c&&!i?".":(i&&(i=i.slice(0,-1)),c+i)},basename:n=>n&&n.match(/([^\/]+|\/)\/*$/)[1],join:(...n)=>De.normalize(n.join("/")),join2:(n,s)=>De.normalize(n+"/"+s)},_i=()=>n=>crypto.getRandomValues(n),Rn=n=>{(Rn=_i())(n)},At={resolve:(...n)=>{for(var s="",c=!1,i=n.length-1;i>=-1&&!c;i--){var p=i>=0?n[i]:d.cwd();if(typeof p!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!p)return"";s=p+"/"+s,c=De.isAbs(p)}return s=De.normalizeArray(s.split("/").filter(a=>!!a),!c).join("/"),(c?"/":"")+s||"."},relative:(n,s)=>{n=At.resolve(n).slice(1),s=At.resolve(s).slice(1);function c(M){for(var ae=0;ae<M.length&&M[ae]==="";ae++);for(var H=M.length-1;H>=0&&M[H]==="";H--);return ae>H?[]:M.slice(ae,H-ae+1)}for(var i=c(n.split("/")),p=c(s.split("/")),a=Math.min(i.length,p.length),o=a,h=0;h<a;h++)if(i[h]!==p[h]){o=h;break}for(var C=[],h=o;h<i.length;h++)C.push("..");return C=C.concat(p.slice(o)),C.join("/")}},zn=new TextDecoder,Dn=(n,s,c,i)=>{for(var p=s+c;n[s]&&!(s>=p);)++s;return s},Nt=(n,s=0,c,i)=>{var p=Dn(n,s,c);return zn.decode(n.buffer?n.subarray(s,p):new Uint8Array(n.slice(s,p)))},an=[],$t=n=>{for(var s=0,c=0;c<n.length;++c){var i=n.charCodeAt(c);i<=127?s++:i<=2047?s+=2:i>=55296&&i<=57343?(s+=4,++c):s+=3}return s},Mn=(n,s,c,i)=>{if(!(i>0))return 0;for(var p=c,a=c+i-1,o=0;o<n.length;++o){var h=n.codePointAt(o);if(h<=127){if(c>=a)break;s[c++]=h}else if(h<=2047){if(c+1>=a)break;s[c++]=192|h>>6,s[c++]=128|h&63}else if(h<=65535){if(c+2>=a)break;s[c++]=224|h>>12,s[c++]=128|h>>6&63,s[c++]=128|h&63}else{if(c+3>=a)break;s[c++]=240|h>>18,s[c++]=128|h>>12&63,s[c++]=128|h>>6&63,s[c++]=128|h&63,o++}}return s[c]=0,c-p},ln=(n,s,c)=>{var i=$t(n)+1,p=new Array(i),a=Mn(n,p,0,p.length);return p.length=a,p},di=()=>{if(!an.length){var n=null;if(typeof window<"u"&&typeof window.prompt=="function"&&(n=window.prompt("Input: "),n!==null&&(n+=`
`)),!n)return null;an=ln(n)}return an.shift()},vt={ttys:[],init(){},shutdown(){},register(n,s){vt.ttys[n]={input:[],output:[],ops:s},d.registerDevice(n,vt.stream_ops)},stream_ops:{open(n){var s=vt.ttys[n.node.rdev];if(!s)throw new d.ErrnoError(43);n.tty=s,n.seekable=!1},close(n){n.tty.ops.fsync(n.tty)},fsync(n){n.tty.ops.fsync(n.tty)},read(n,s,c,i,p){if(!n.tty||!n.tty.ops.get_char)throw new d.ErrnoError(60);for(var a=0,o=0;o<i;o++){var h;try{h=n.tty.ops.get_char(n.tty)}catch{throw new d.ErrnoError(29)}if(h===void 0&&a===0)throw new d.ErrnoError(6);if(h==null)break;a++,s[c+o]=h}return a&&(n.node.atime=Date.now()),a},write(n,s,c,i,p){if(!n.tty||!n.tty.ops.put_char)throw new d.ErrnoError(60);try{for(var a=0;a<i;a++)n.tty.ops.put_char(n.tty,s[c+a])}catch{throw new d.ErrnoError(29)}return i&&(n.node.mtime=n.node.ctime=Date.now()),a}},default_tty_ops:{get_char(n){return di()},put_char(n,s){s===null||s===10?(Y(Nt(n.output)),n.output=[]):s!=0&&n.output.push(s)},fsync(n){var s;((s=n.output)==null?void 0:s.length)>0&&(Y(Nt(n.output)),n.output=[])},ioctl_tcgets(n){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(n,s,c){return 0},ioctl_tiocgwinsz(n){return[24,80]}},default_tty1_ops:{put_char(n,s){s===null||s===10?(de(Nt(n.output)),n.output=[]):s!=0&&n.output.push(s)},fsync(n){var s;((s=n.output)==null?void 0:s.length)>0&&(de(Nt(n.output)),n.output=[])}}},pi=(n,s)=>Ge.fill(0,n,n+s),jn=(n,s)=>Math.ceil(n/s)*s,$n=n=>{n=jn(n,65536);var s=Hn(65536,n);return s&&pi(s,n),s},Te={ops_table:null,mount(n){return Te.createNode(null,"/",16895,0)},createNode(n,s,c,i){if(d.isBlkdev(c)||d.isFIFO(c))throw new d.ErrnoError(63);Te.ops_table||(Te.ops_table={dir:{node:{getattr:Te.node_ops.getattr,setattr:Te.node_ops.setattr,lookup:Te.node_ops.lookup,mknod:Te.node_ops.mknod,rename:Te.node_ops.rename,unlink:Te.node_ops.unlink,rmdir:Te.node_ops.rmdir,readdir:Te.node_ops.readdir,symlink:Te.node_ops.symlink},stream:{llseek:Te.stream_ops.llseek}},file:{node:{getattr:Te.node_ops.getattr,setattr:Te.node_ops.setattr},stream:{llseek:Te.stream_ops.llseek,read:Te.stream_ops.read,write:Te.stream_ops.write,mmap:Te.stream_ops.mmap,msync:Te.stream_ops.msync}},link:{node:{getattr:Te.node_ops.getattr,setattr:Te.node_ops.setattr,readlink:Te.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Te.node_ops.getattr,setattr:Te.node_ops.setattr},stream:d.chrdev_stream_ops}});var p=d.createNode(n,s,c,i);return d.isDir(p.mode)?(p.node_ops=Te.ops_table.dir.node,p.stream_ops=Te.ops_table.dir.stream,p.contents={}):d.isFile(p.mode)?(p.node_ops=Te.ops_table.file.node,p.stream_ops=Te.ops_table.file.stream,p.usedBytes=0,p.contents=null):d.isLink(p.mode)?(p.node_ops=Te.ops_table.link.node,p.stream_ops=Te.ops_table.link.stream):d.isChrdev(p.mode)&&(p.node_ops=Te.ops_table.chrdev.node,p.stream_ops=Te.ops_table.chrdev.stream),p.atime=p.mtime=p.ctime=Date.now(),n&&(n.contents[s]=p,n.atime=n.mtime=n.ctime=p.atime),p},getFileDataAsTypedArray(n){return n.contents?n.contents.subarray?n.contents.subarray(0,n.usedBytes):new Uint8Array(n.contents):new Uint8Array(0)},expandFileStorage(n,s){var c=n.contents?n.contents.length:0;if(!(c>=s)){var i=1024*1024;s=Math.max(s,c*(c<i?2:1.125)>>>0),c!=0&&(s=Math.max(s,256));var p=n.contents;n.contents=new Uint8Array(s),n.usedBytes>0&&n.contents.set(p.subarray(0,n.usedBytes),0)}},resizeFileStorage(n,s){if(n.usedBytes!=s)if(s==0)n.contents=null,n.usedBytes=0;else{var c=n.contents;n.contents=new Uint8Array(s),c&&n.contents.set(c.subarray(0,Math.min(s,n.usedBytes))),n.usedBytes=s}},node_ops:{getattr(n){var s={};return s.dev=d.isChrdev(n.mode)?n.id:1,s.ino=n.id,s.mode=n.mode,s.nlink=1,s.uid=0,s.gid=0,s.rdev=n.rdev,d.isDir(n.mode)?s.size=4096:d.isFile(n.mode)?s.size=n.usedBytes:d.isLink(n.mode)?s.size=n.link.length:s.size=0,s.atime=new Date(n.atime),s.mtime=new Date(n.mtime),s.ctime=new Date(n.ctime),s.blksize=4096,s.blocks=Math.ceil(s.size/s.blksize),s},setattr(n,s){for(const c of["mode","atime","mtime","ctime"])s[c]!=null&&(n[c]=s[c]);s.size!==void 0&&Te.resizeFileStorage(n,s.size)},lookup(n,s){throw Te.doesNotExistError||(Te.doesNotExistError=new d.ErrnoError(44),Te.doesNotExistError.stack="<generic error, no stack>"),Te.doesNotExistError},mknod(n,s,c,i){return Te.createNode(n,s,c,i)},rename(n,s,c){var i;try{i=d.lookupNode(s,c)}catch{}if(i){if(d.isDir(n.mode))for(var p in i.contents)throw new d.ErrnoError(55);d.hashRemoveNode(i)}delete n.parent.contents[n.name],s.contents[c]=n,n.name=c,s.ctime=s.mtime=n.parent.ctime=n.parent.mtime=Date.now()},unlink(n,s){delete n.contents[s],n.ctime=n.mtime=Date.now()},rmdir(n,s){var c=d.lookupNode(n,s);for(var i in c.contents)throw new d.ErrnoError(55);delete n.contents[s],n.ctime=n.mtime=Date.now()},readdir(n){return[".","..",...Object.keys(n.contents)]},symlink(n,s,c){var i=Te.createNode(n,s,41471,0);return i.link=c,i},readlink(n){if(!d.isLink(n.mode))throw new d.ErrnoError(28);return n.link}},stream_ops:{read(n,s,c,i,p){var a=n.node.contents;if(p>=n.node.usedBytes)return 0;var o=Math.min(n.node.usedBytes-p,i);if(o>8&&a.subarray)s.set(a.subarray(p,p+o),c);else for(var h=0;h<o;h++)s[c+h]=a[p+h];return o},write(n,s,c,i,p,a){if(s.buffer===at.buffer&&(a=!1),!i)return 0;var o=n.node;if(o.mtime=o.ctime=Date.now(),s.subarray&&(!o.contents||o.contents.subarray)){if(a)return o.contents=s.subarray(c,c+i),o.usedBytes=i,i;if(o.usedBytes===0&&p===0)return o.contents=s.slice(c,c+i),o.usedBytes=i,i;if(p+i<=o.usedBytes)return o.contents.set(s.subarray(c,c+i),p),i}if(Te.expandFileStorage(o,p+i),o.contents.subarray&&s.subarray)o.contents.set(s.subarray(c,c+i),p);else for(var h=0;h<i;h++)o.contents[p+h]=s[c+h];return o.usedBytes=Math.max(o.usedBytes,p+i),i},llseek(n,s,c){var i=s;if(c===1?i+=n.position:c===2&&d.isFile(n.node.mode)&&(i+=n.node.usedBytes),i<0)throw new d.ErrnoError(28);return i},mmap(n,s,c,i,p){if(!d.isFile(n.node.mode))throw new d.ErrnoError(43);var a,o,h=n.node.contents;if(!(p&2)&&h&&h.buffer===at.buffer)o=!1,a=h.byteOffset;else{if(o=!0,a=$n(s),!a)throw new d.ErrnoError(48);h&&((c>0||c+s<h.length)&&(h.subarray?h=h.subarray(c,c+s):h=Array.prototype.slice.call(h,c,c+s)),at.set(h,a))}return{ptr:a,allocated:o}},msync(n,s,c,i,p){return Te.stream_ops.write(n,s,0,i,c,!1),0}}},hi=async n=>{var s=await te(n);return new Uint8Array(s)},mi=(...n)=>d.createDataFile(...n),Un=[],gi=(n,s,c,i)=>{typeof Browser<"u"&&Browser.init();var p=!1;return Un.forEach(a=>{p||a.canHandle(s)&&(a.handle(n,s,c,i),p=!0)}),p},bi=(n,s,c,i,p,a,o,h,C,M)=>{var ae=s?At.resolve(De.join2(n,s)):n;function H(N){function z(R){M==null||M(),h||mi(n,s,R,i,p,C),a==null||a(),sn()}gi(N,ae,z,()=>{o==null||o(),sn()})||z(N)}Pn(),typeof c=="string"?hi(c).then(H,o):H(c)},yi=n=>{var s={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},c=s[n];if(typeof c>"u")throw new Error(`Unknown file open mode: ${n}`);return c},cn=(n,s)=>{var c=0;return n&&(c|=365),s&&(c|=146),c},d={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(n){Je(this,"name","ErrnoError");this.errno=n}},FSStream:class{constructor(){Je(this,"shared",{})}get object(){return this.node}set object(n){this.node=n}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(n){this.shared.flags=n}get position(){return this.shared.position}set position(n){this.shared.position=n}},FSNode:class{constructor(n,s,c,i){Je(this,"node_ops",{});Je(this,"stream_ops",{});Je(this,"readMode",365);Je(this,"writeMode",146);Je(this,"mounted",null);n||(n=this),this.parent=n,this.mount=n.mount,this.id=d.nextInode++,this.name=s,this.mode=c,this.rdev=i,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(n){n?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(n){n?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return d.isDir(this.mode)}get isDevice(){return d.isChrdev(this.mode)}},lookupPath(n,s={}){if(!n)throw new d.ErrnoError(44);s.follow_mount??(s.follow_mount=!0),De.isAbs(n)||(n=d.cwd()+"/"+n);e:for(var c=0;c<40;c++){for(var i=n.split("/").filter(M=>!!M),p=d.root,a="/",o=0;o<i.length;o++){var h=o===i.length-1;if(h&&s.parent)break;if(i[o]!=="."){if(i[o]===".."){if(a=De.dirname(a),d.isRoot(p)){n=a+"/"+i.slice(o+1).join("/"),c--;continue e}else p=p.parent;continue}a=De.join2(a,i[o]);try{p=d.lookupNode(p,i[o])}catch(M){if((M==null?void 0:M.errno)===44&&h&&s.noent_okay)return{path:a};throw M}if(d.isMountpoint(p)&&(!h||s.follow_mount)&&(p=p.mounted.root),d.isLink(p.mode)&&(!h||s.follow)){if(!p.node_ops.readlink)throw new d.ErrnoError(52);var C=p.node_ops.readlink(p);De.isAbs(C)||(C=De.dirname(a)+"/"+C),n=C+"/"+i.slice(o+1).join("/");continue e}}}return{path:a,node:p}}throw new d.ErrnoError(32)},getPath(n){for(var s;;){if(d.isRoot(n)){var c=n.mount.mountpoint;return s?c[c.length-1]!=="/"?`${c}/${s}`:c+s:c}s=s?`${n.name}/${s}`:n.name,n=n.parent}},hashName(n,s){for(var c=0,i=0;i<s.length;i++)c=(c<<5)-c+s.charCodeAt(i)|0;return(n+c>>>0)%d.nameTable.length},hashAddNode(n){var s=d.hashName(n.parent.id,n.name);n.name_next=d.nameTable[s],d.nameTable[s]=n},hashRemoveNode(n){var s=d.hashName(n.parent.id,n.name);if(d.nameTable[s]===n)d.nameTable[s]=n.name_next;else for(var c=d.nameTable[s];c;){if(c.name_next===n){c.name_next=n.name_next;break}c=c.name_next}},lookupNode(n,s){var c=d.mayLookup(n);if(c)throw new d.ErrnoError(c);for(var i=d.hashName(n.id,s),p=d.nameTable[i];p;p=p.name_next){var a=p.name;if(p.parent.id===n.id&&a===s)return p}return d.lookup(n,s)},createNode(n,s,c,i){var p=new d.FSNode(n,s,c,i);return d.hashAddNode(p),p},destroyNode(n){d.hashRemoveNode(n)},isRoot(n){return n===n.parent},isMountpoint(n){return!!n.mounted},isFile(n){return(n&61440)===32768},isDir(n){return(n&61440)===16384},isLink(n){return(n&61440)===40960},isChrdev(n){return(n&61440)===8192},isBlkdev(n){return(n&61440)===24576},isFIFO(n){return(n&61440)===4096},isSocket(n){return(n&49152)===49152},flagsToPermissionString(n){var s=["r","w","rw"][n&3];return n&512&&(s+="w"),s},nodePermissions(n,s){return d.ignorePermissions?0:s.includes("r")&&!(n.mode&292)||s.includes("w")&&!(n.mode&146)||s.includes("x")&&!(n.mode&73)?2:0},mayLookup(n){if(!d.isDir(n.mode))return 54;var s=d.nodePermissions(n,"x");return s||(n.node_ops.lookup?0:2)},mayCreate(n,s){if(!d.isDir(n.mode))return 54;try{var c=d.lookupNode(n,s);return 20}catch{}return d.nodePermissions(n,"wx")},mayDelete(n,s,c){var i;try{i=d.lookupNode(n,s)}catch(a){return a.errno}var p=d.nodePermissions(n,"wx");if(p)return p;if(c){if(!d.isDir(i.mode))return 54;if(d.isRoot(i)||d.getPath(i)===d.cwd())return 10}else if(d.isDir(i.mode))return 31;return 0},mayOpen(n,s){return n?d.isLink(n.mode)?32:d.isDir(n.mode)&&(d.flagsToPermissionString(s)!=="r"||s&576)?31:d.nodePermissions(n,d.flagsToPermissionString(s)):44},checkOpExists(n,s){if(!n)throw new d.ErrnoError(s);return n},MAX_OPEN_FDS:4096,nextfd(){for(var n=0;n<=d.MAX_OPEN_FDS;n++)if(!d.streams[n])return n;throw new d.ErrnoError(33)},getStreamChecked(n){var s=d.getStream(n);if(!s)throw new d.ErrnoError(8);return s},getStream:n=>d.streams[n],createStream(n,s=-1){return n=Object.assign(new d.FSStream,n),s==-1&&(s=d.nextfd()),n.fd=s,d.streams[s]=n,n},closeStream(n){d.streams[n]=null},dupStream(n,s=-1){var i,p;var c=d.createStream(n,s);return(p=(i=c.stream_ops)==null?void 0:i.dup)==null||p.call(i,c),c},doSetAttr(n,s,c){var i=n==null?void 0:n.stream_ops.setattr,p=i?n:s;i??(i=s.node_ops.setattr),d.checkOpExists(i,63),i(p,c)},chrdev_stream_ops:{open(n){var c,i;var s=d.getDevice(n.node.rdev);n.stream_ops=s.stream_ops,(i=(c=n.stream_ops).open)==null||i.call(c,n)},llseek(){throw new d.ErrnoError(70)}},major:n=>n>>8,minor:n=>n&255,makedev:(n,s)=>n<<8|s,registerDevice(n,s){d.devices[n]={stream_ops:s}},getDevice:n=>d.devices[n],getMounts(n){for(var s=[],c=[n];c.length;){var i=c.pop();s.push(i),c.push(...i.mounts)}return s},syncfs(n,s){typeof n=="function"&&(s=n,n=!1),d.syncFSRequests++,d.syncFSRequests>1&&de(`warning: ${d.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var c=d.getMounts(d.root.mount),i=0;function p(o){return d.syncFSRequests--,s(o)}function a(o){if(o)return a.errored?void 0:(a.errored=!0,p(o));++i>=c.length&&p(null)}c.forEach(o=>{if(!o.type.syncfs)return a(null);o.type.syncfs(o,n,a)})},mount(n,s,c){var i=c==="/",p=!c,a;if(i&&d.root)throw new d.ErrnoError(10);if(!i&&!p){var o=d.lookupPath(c,{follow_mount:!1});if(c=o.path,a=o.node,d.isMountpoint(a))throw new d.ErrnoError(10);if(!d.isDir(a.mode))throw new d.ErrnoError(54)}var h={type:n,opts:s,mountpoint:c,mounts:[]},C=n.mount(h);return C.mount=h,h.root=C,i?d.root=C:a&&(a.mounted=h,a.mount&&a.mount.mounts.push(h)),C},unmount(n){var s=d.lookupPath(n,{follow_mount:!1});if(!d.isMountpoint(s.node))throw new d.ErrnoError(28);var c=s.node,i=c.mounted,p=d.getMounts(i);Object.keys(d.nameTable).forEach(o=>{for(var h=d.nameTable[o];h;){var C=h.name_next;p.includes(h.mount)&&d.destroyNode(h),h=C}}),c.mounted=null;var a=c.mount.mounts.indexOf(i);c.mount.mounts.splice(a,1)},lookup(n,s){return n.node_ops.lookup(n,s)},mknod(n,s,c){var i=d.lookupPath(n,{parent:!0}),p=i.node,a=De.basename(n);if(!a)throw new d.ErrnoError(28);if(a==="."||a==="..")throw new d.ErrnoError(20);var o=d.mayCreate(p,a);if(o)throw new d.ErrnoError(o);if(!p.node_ops.mknod)throw new d.ErrnoError(63);return p.node_ops.mknod(p,a,s,c)},statfs(n){return d.statfsNode(d.lookupPath(n,{follow:!0}).node)},statfsStream(n){return d.statfsNode(n.node)},statfsNode(n){var s={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:d.nextInode,ffree:d.nextInode-1,fsid:42,flags:2,namelen:255};return n.node_ops.statfs&&Object.assign(s,n.node_ops.statfs(n.mount.opts.root)),s},create(n,s=438){return s&=4095,s|=32768,d.mknod(n,s,0)},mkdir(n,s=511){return s&=1023,s|=16384,d.mknod(n,s,0)},mkdirTree(n,s){var c=n.split("/"),i="";for(var p of c)if(p){(i||De.isAbs(n))&&(i+="/"),i+=p;try{d.mkdir(i,s)}catch(a){if(a.errno!=20)throw a}}},mkdev(n,s,c){return typeof c>"u"&&(c=s,s=438),s|=8192,d.mknod(n,s,c)},symlink(n,s){if(!At.resolve(n))throw new d.ErrnoError(44);var c=d.lookupPath(s,{parent:!0}),i=c.node;if(!i)throw new d.ErrnoError(44);var p=De.basename(s),a=d.mayCreate(i,p);if(a)throw new d.ErrnoError(a);if(!i.node_ops.symlink)throw new d.ErrnoError(63);return i.node_ops.symlink(i,p,n)},rename(n,s){var c=De.dirname(n),i=De.dirname(s),p=De.basename(n),a=De.basename(s),o,h,C;if(o=d.lookupPath(n,{parent:!0}),h=o.node,o=d.lookupPath(s,{parent:!0}),C=o.node,!h||!C)throw new d.ErrnoError(44);if(h.mount!==C.mount)throw new d.ErrnoError(75);var M=d.lookupNode(h,p),ae=At.relative(n,i);if(ae.charAt(0)!==".")throw new d.ErrnoError(28);if(ae=At.relative(s,c),ae.charAt(0)!==".")throw new d.ErrnoError(55);var H;try{H=d.lookupNode(C,a)}catch{}if(M!==H){var N=d.isDir(M.mode),z=d.mayDelete(h,p,N);if(z)throw new d.ErrnoError(z);if(z=H?d.mayDelete(C,a,N):d.mayCreate(C,a),z)throw new d.ErrnoError(z);if(!h.node_ops.rename)throw new d.ErrnoError(63);if(d.isMountpoint(M)||H&&d.isMountpoint(H))throw new d.ErrnoError(10);if(C!==h&&(z=d.nodePermissions(h,"w"),z))throw new d.ErrnoError(z);d.hashRemoveNode(M);try{h.node_ops.rename(M,C,a),M.parent=C}catch(R){throw R}finally{d.hashAddNode(M)}}},rmdir(n){var s=d.lookupPath(n,{parent:!0}),c=s.node,i=De.basename(n),p=d.lookupNode(c,i),a=d.mayDelete(c,i,!0);if(a)throw new d.ErrnoError(a);if(!c.node_ops.rmdir)throw new d.ErrnoError(63);if(d.isMountpoint(p))throw new d.ErrnoError(10);c.node_ops.rmdir(c,i),d.destroyNode(p)},readdir(n){var s=d.lookupPath(n,{follow:!0}),c=s.node,i=d.checkOpExists(c.node_ops.readdir,54);return i(c)},unlink(n){var s=d.lookupPath(n,{parent:!0}),c=s.node;if(!c)throw new d.ErrnoError(44);var i=De.basename(n),p=d.lookupNode(c,i),a=d.mayDelete(c,i,!1);if(a)throw new d.ErrnoError(a);if(!c.node_ops.unlink)throw new d.ErrnoError(63);if(d.isMountpoint(p))throw new d.ErrnoError(10);c.node_ops.unlink(c,i),d.destroyNode(p)},readlink(n){var s=d.lookupPath(n),c=s.node;if(!c)throw new d.ErrnoError(44);if(!c.node_ops.readlink)throw new d.ErrnoError(28);return c.node_ops.readlink(c)},stat(n,s){var c=d.lookupPath(n,{follow:!s}),i=c.node,p=d.checkOpExists(i.node_ops.getattr,63);return p(i)},fstat(n){var s=d.getStreamChecked(n),c=s.node,i=s.stream_ops.getattr,p=i?s:c;return i??(i=c.node_ops.getattr),d.checkOpExists(i,63),i(p)},lstat(n){return d.stat(n,!0)},doChmod(n,s,c,i){d.doSetAttr(n,s,{mode:c&4095|s.mode&-4096,ctime:Date.now(),dontFollow:i})},chmod(n,s,c){var i;if(typeof n=="string"){var p=d.lookupPath(n,{follow:!c});i=p.node}else i=n;d.doChmod(null,i,s,c)},lchmod(n,s){d.chmod(n,s,!0)},fchmod(n,s){var c=d.getStreamChecked(n);d.doChmod(c,c.node,s,!1)},doChown(n,s,c){d.doSetAttr(n,s,{timestamp:Date.now(),dontFollow:c})},chown(n,s,c,i){var p;if(typeof n=="string"){var a=d.lookupPath(n,{follow:!i});p=a.node}else p=n;d.doChown(null,p,i)},lchown(n,s,c){d.chown(n,s,c,!0)},fchown(n,s,c){var i=d.getStreamChecked(n);d.doChown(i,i.node,!1)},doTruncate(n,s,c){if(d.isDir(s.mode))throw new d.ErrnoError(31);if(!d.isFile(s.mode))throw new d.ErrnoError(28);var i=d.nodePermissions(s,"w");if(i)throw new d.ErrnoError(i);d.doSetAttr(n,s,{size:c,timestamp:Date.now()})},truncate(n,s){if(s<0)throw new d.ErrnoError(28);var c;if(typeof n=="string"){var i=d.lookupPath(n,{follow:!0});c=i.node}else c=n;d.doTruncate(null,c,s)},ftruncate(n,s){var c=d.getStreamChecked(n);if(s<0||!(c.flags&2097155))throw new d.ErrnoError(28);d.doTruncate(c,c.node,s)},utime(n,s,c){var i=d.lookupPath(n,{follow:!0}),p=i.node,a=d.checkOpExists(p.node_ops.setattr,63);a(p,{atime:s,mtime:c})},open(n,s,c=438){if(n==="")throw new d.ErrnoError(44);s=typeof s=="string"?yi(s):s,s&64?c=c&4095|32768:c=0;var i,p;if(typeof n=="object")i=n;else{p=n.endsWith("/");var a=d.lookupPath(n,{follow:!(s&131072),noent_okay:!0});i=a.node,n=a.path}var o=!1;if(s&64)if(i){if(s&128)throw new d.ErrnoError(20)}else{if(p)throw new d.ErrnoError(31);i=d.mknod(n,c|511,0),o=!0}if(!i)throw new d.ErrnoError(44);if(d.isChrdev(i.mode)&&(s&=-513),s&65536&&!d.isDir(i.mode))throw new d.ErrnoError(54);if(!o){var h=d.mayOpen(i,s);if(h)throw new d.ErrnoError(h)}s&512&&!o&&d.truncate(i,0),s&=-131713;var C=d.createStream({node:i,path:d.getPath(i),flags:s,seekable:!0,position:0,stream_ops:i.stream_ops,ungotten:[],error:!1});return C.stream_ops.open&&C.stream_ops.open(C),o&&d.chmod(i,c&511),r.logReadFiles&&!(s&1)&&(n in d.readFiles||(d.readFiles[n]=1)),C},close(n){if(d.isClosed(n))throw new d.ErrnoError(8);n.getdents&&(n.getdents=null);try{n.stream_ops.close&&n.stream_ops.close(n)}catch(s){throw s}finally{d.closeStream(n.fd)}n.fd=null},isClosed(n){return n.fd===null},llseek(n,s,c){if(d.isClosed(n))throw new d.ErrnoError(8);if(!n.seekable||!n.stream_ops.llseek)throw new d.ErrnoError(70);if(c!=0&&c!=1&&c!=2)throw new d.ErrnoError(28);return n.position=n.stream_ops.llseek(n,s,c),n.ungotten=[],n.position},read(n,s,c,i,p){if(i<0||p<0)throw new d.ErrnoError(28);if(d.isClosed(n))throw new d.ErrnoError(8);if((n.flags&2097155)===1)throw new d.ErrnoError(8);if(d.isDir(n.node.mode))throw new d.ErrnoError(31);if(!n.stream_ops.read)throw new d.ErrnoError(28);var a=typeof p<"u";if(!a)p=n.position;else if(!n.seekable)throw new d.ErrnoError(70);var o=n.stream_ops.read(n,s,c,i,p);return a||(n.position+=o),o},write(n,s,c,i,p,a){if(i<0||p<0)throw new d.ErrnoError(28);if(d.isClosed(n))throw new d.ErrnoError(8);if(!(n.flags&2097155))throw new d.ErrnoError(8);if(d.isDir(n.node.mode))throw new d.ErrnoError(31);if(!n.stream_ops.write)throw new d.ErrnoError(28);n.seekable&&n.flags&1024&&d.llseek(n,0,2);var o=typeof p<"u";if(!o)p=n.position;else if(!n.seekable)throw new d.ErrnoError(70);var h=n.stream_ops.write(n,s,c,i,p,a);return o||(n.position+=h),h},mmap(n,s,c,i,p){if(i&2&&!(p&2)&&(n.flags&2097155)!==2)throw new d.ErrnoError(2);if((n.flags&2097155)===1)throw new d.ErrnoError(2);if(!n.stream_ops.mmap)throw new d.ErrnoError(43);if(!s)throw new d.ErrnoError(28);return n.stream_ops.mmap(n,s,c,i,p)},msync(n,s,c,i,p){return n.stream_ops.msync?n.stream_ops.msync(n,s,c,i,p):0},ioctl(n,s,c){if(!n.stream_ops.ioctl)throw new d.ErrnoError(59);return n.stream_ops.ioctl(n,s,c)},readFile(n,s={}){if(s.flags=s.flags||0,s.encoding=s.encoding||"binary",s.encoding!=="utf8"&&s.encoding!=="binary")throw new Error(`Invalid encoding type "${s.encoding}"`);var c=d.open(n,s.flags),i=d.stat(n),p=i.size,a=new Uint8Array(p);return d.read(c,a,0,p,0),s.encoding==="utf8"&&(a=Nt(a)),d.close(c),a},writeFile(n,s,c={}){c.flags=c.flags||577;var i=d.open(n,c.flags,c.mode);if(typeof s=="string"&&(s=new Uint8Array(ln(s))),ArrayBuffer.isView(s))d.write(i,s,0,s.byteLength,void 0,c.canOwn);else throw new Error("Unsupported data type");d.close(i)},cwd:()=>d.currentPath,chdir(n){var s=d.lookupPath(n,{follow:!0});if(s.node===null)throw new d.ErrnoError(44);if(!d.isDir(s.node.mode))throw new d.ErrnoError(54);var c=d.nodePermissions(s.node,"x");if(c)throw new d.ErrnoError(c);d.currentPath=s.path},createDefaultDirectories(){d.mkdir("/tmp"),d.mkdir("/home"),d.mkdir("/home/web_user")},createDefaultDevices(){d.mkdir("/dev"),d.registerDevice(d.makedev(1,3),{read:()=>0,write:(i,p,a,o,h)=>o,llseek:()=>0}),d.mkdev("/dev/null",d.makedev(1,3)),vt.register(d.makedev(5,0),vt.default_tty_ops),vt.register(d.makedev(6,0),vt.default_tty1_ops),d.mkdev("/dev/tty",d.makedev(5,0)),d.mkdev("/dev/tty1",d.makedev(6,0));var n=new Uint8Array(1024),s=0,c=()=>(s===0&&(Rn(n),s=n.byteLength),n[--s]);d.createDevice("/dev","random",c),d.createDevice("/dev","urandom",c),d.mkdir("/dev/shm"),d.mkdir("/dev/shm/tmp")},createSpecialDirectories(){d.mkdir("/proc");var n=d.mkdir("/proc/self");d.mkdir("/proc/self/fd"),d.mount({mount(){var s=d.createNode(n,"fd",16895,73);return s.stream_ops={llseek:Te.stream_ops.llseek},s.node_ops={lookup(c,i){var p=+i,a=d.getStreamChecked(p),o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>a.path},id:p+1};return o.parent=o,o},readdir(){return Array.from(d.streams.entries()).filter(([c,i])=>i).map(([c,i])=>c.toString())}},s}},{},"/proc/self/fd")},createStandardStreams(n,s,c){n?d.createDevice("/dev","stdin",n):d.symlink("/dev/tty","/dev/stdin"),s?d.createDevice("/dev","stdout",null,s):d.symlink("/dev/tty","/dev/stdout"),c?d.createDevice("/dev","stderr",null,c):d.symlink("/dev/tty1","/dev/stderr"),d.open("/dev/stdin",0),d.open("/dev/stdout",1),d.open("/dev/stderr",1)},staticInit(){d.nameTable=new Array(4096),d.mount(Te,{},"/"),d.createDefaultDirectories(),d.createDefaultDevices(),d.createSpecialDirectories(),d.filesystems={MEMFS:Te}},init(n,s,c){d.initialized=!0,n??(n=r.stdin),s??(s=r.stdout),c??(c=r.stderr),d.createStandardStreams(n,s,c)},quit(){d.initialized=!1;for(var n of d.streams)n&&d.close(n)},findObject(n,s){var c=d.analyzePath(n,s);return c.exists?c.object:null},analyzePath(n,s){try{var c=d.lookupPath(n,{follow:!s});n=c.path}catch{}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var c=d.lookupPath(n,{parent:!0});i.parentExists=!0,i.parentPath=c.path,i.parentObject=c.node,i.name=De.basename(n),c=d.lookupPath(n,{follow:!s}),i.exists=!0,i.path=c.path,i.object=c.node,i.name=c.node.name,i.isRoot=c.path==="/"}catch(p){i.error=p.errno}return i},createPath(n,s,c,i){n=typeof n=="string"?n:d.getPath(n);for(var p=s.split("/").reverse();p.length;){var a=p.pop();if(a){var o=De.join2(n,a);try{d.mkdir(o)}catch(h){if(h.errno!=20)throw h}n=o}}return o},createFile(n,s,c,i,p){var a=De.join2(typeof n=="string"?n:d.getPath(n),s),o=cn(i,p);return d.create(a,o)},createDataFile(n,s,c,i,p,a){var o=s;n&&(n=typeof n=="string"?n:d.getPath(n),o=s?De.join2(n,s):n);var h=cn(i,p),C=d.create(o,h);if(c){if(typeof c=="string"){for(var M=new Array(c.length),ae=0,H=c.length;ae<H;++ae)M[ae]=c.charCodeAt(ae);c=M}d.chmod(C,h|146);var N=d.open(C,577);d.write(N,c,0,c.length,0,a),d.close(N),d.chmod(C,h)}},createDevice(n,s,c,i){var h;var p=De.join2(typeof n=="string"?n:d.getPath(n),s),a=cn(!!c,!!i);(h=d.createDevice).major??(h.major=64);var o=d.makedev(d.createDevice.major++,0);return d.registerDevice(o,{open(C){C.seekable=!1},close(C){var M;(M=i==null?void 0:i.buffer)!=null&&M.length&&i(10)},read(C,M,ae,H,N){for(var z=0,R=0;R<H;R++){var j;try{j=c()}catch{throw new d.ErrnoError(29)}if(j===void 0&&z===0)throw new d.ErrnoError(6);if(j==null)break;z++,M[ae+R]=j}return z&&(C.node.atime=Date.now()),z},write(C,M,ae,H,N){for(var z=0;z<H;z++)try{i(M[ae+z])}catch{throw new d.ErrnoError(29)}return H&&(C.node.mtime=C.node.ctime=Date.now()),z}}),d.mkdev(p,a,o)},forceLoadFile(n){if(n.isDevice||n.isFolder||n.link||n.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{n.contents=ce(n.url),n.usedBytes=n.contents.length}catch{throw new d.ErrnoError(29)}},createLazyFile(n,s,c,i,p){class a{constructor(){Je(this,"lengthKnown",!1);Je(this,"chunks",[])}get(z){if(!(z>this.length-1||z<0)){var R=z%this.chunkSize,j=z/this.chunkSize|0;return this.getter(j)[R]}}setDataGetter(z){this.getter=z}cacheLength(){var z=new XMLHttpRequest;if(z.open("HEAD",c,!1),z.send(null),!(z.status>=200&&z.status<300||z.status===304))throw new Error("Couldn't load "+c+". Status: "+z.status);var R=Number(z.getResponseHeader("Content-length")),j,oe=(j=z.getResponseHeader("Accept-Ranges"))&&j==="bytes",K=(j=z.getResponseHeader("Content-Encoding"))&&j==="gzip",S=1024*1024;oe||(S=R);var I=(D,F)=>{if(D>F)throw new Error("invalid range ("+D+", "+F+") or no bytes requested!");if(F>R-1)throw new Error("only "+R+" bytes available! programmer error!");var P=new XMLHttpRequest;if(P.open("GET",c,!1),R!==S&&P.setRequestHeader("Range","bytes="+D+"-"+F),P.responseType="arraybuffer",P.overrideMimeType&&P.overrideMimeType("text/plain; charset=x-user-defined"),P.send(null),!(P.status>=200&&P.status<300||P.status===304))throw new Error("Couldn't load "+c+". Status: "+P.status);return P.response!==void 0?new Uint8Array(P.response||[]):ln(P.responseText||"")},T=this;T.setDataGetter(D=>{var F=D*S,P=(D+1)*S-1;if(P=Math.min(P,R-1),typeof T.chunks[D]>"u"&&(T.chunks[D]=I(F,P)),typeof T.chunks[D]>"u")throw new Error("doXHR failed!");return T.chunks[D]}),(K||!R)&&(S=R=1,R=this.getter(0).length,S=R,Y("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=R,this._chunkSize=S,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!_)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var o=new a,h={isDevice:!1,contents:o}}else var h={isDevice:!1,url:c};var C=d.createFile(n,s,h,i,p);h.contents?C.contents=h.contents:h.url&&(C.contents=null,C.url=h.url),Object.defineProperties(C,{usedBytes:{get:function(){return this.contents.length}}});var M={},ae=Object.keys(C.stream_ops);ae.forEach(N=>{var z=C.stream_ops[N];M[N]=(...R)=>(d.forceLoadFile(C),z(...R))});function H(N,z,R,j,oe){var K=N.node.contents;if(oe>=K.length)return 0;var S=Math.min(K.length-oe,j);if(K.slice)for(var I=0;I<S;I++)z[R+I]=K[oe+I];else for(var I=0;I<S;I++)z[R+I]=K.get(oe+I);return S}return M.read=(N,z,R,j,oe)=>(d.forceLoadFile(C),H(N,z,R,j,oe)),M.mmap=(N,z,R,j,oe)=>{d.forceLoadFile(C);var K=$n(z);if(!K)throw new d.ErrnoError(48);return H(N,at,K,z,R),{ptr:K,allocated:!0}},C.stream_ops=M,C}},vi=(n,s,c)=>{if(!n)return"";var i=Dn(Ge,n,s);return zn.decode(Ge.subarray(n,i))},Fe={DEFAULT_POLLMASK:5,calculateAt(n,s,c){if(De.isAbs(s))return s;var i;if(n===-100)i=d.cwd();else{var p=Fe.getStreamFromFD(n);i=p.path}if(s.length==0){if(!c)throw new d.ErrnoError(44);return i}return i+"/"+s},writeStat(n,s){Oe[n>>2]=s.dev,Oe[n+4>>2]=s.mode,Ke[n+8>>2]=s.nlink,Oe[n+12>>2]=s.uid,Oe[n+16>>2]=s.gid,Oe[n+20>>2]=s.rdev,st[n+24>>3]=BigInt(s.size),Oe[n+32>>2]=4096,Oe[n+36>>2]=s.blocks;var c=s.atime.getTime(),i=s.mtime.getTime(),p=s.ctime.getTime();return st[n+40>>3]=BigInt(Math.floor(c/1e3)),Ke[n+48>>2]=c%1e3*1e3*1e3,st[n+56>>3]=BigInt(Math.floor(i/1e3)),Ke[n+64>>2]=i%1e3*1e3*1e3,st[n+72>>3]=BigInt(Math.floor(p/1e3)),Ke[n+80>>2]=p%1e3*1e3*1e3,st[n+88>>3]=BigInt(s.ino),0},writeStatFs(n,s){Oe[n+4>>2]=s.bsize,Oe[n+60>>2]=s.bsize,st[n+8>>3]=BigInt(s.blocks),st[n+16>>3]=BigInt(s.bfree),st[n+24>>3]=BigInt(s.bavail),st[n+32>>3]=BigInt(s.files),st[n+40>>3]=BigInt(s.ffree),Oe[n+48>>2]=s.fsid,Oe[n+64>>2]=s.flags,Oe[n+56>>2]=s.namelen},doMsync(n,s,c,i,p){if(!d.isFile(s.node.mode))throw new d.ErrnoError(43);if(i&2)return 0;var a=Ge.slice(n,n+c);d.msync(s,a,p,c,i)},getStreamFromFD(n){var s=d.getStreamChecked(n);return s},varargs:void 0,getStr(n){var s=vi(n);return s}};function wi(n,s){try{return n=Fe.getStr(n),d.chmod(n,s),0}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function qi(n,s,c,i){try{if(s=Fe.getStr(s),s=Fe.calculateAt(n,s),c&-8)return-28;var p=d.lookupPath(s,{follow:!0}),a=p.node;if(!a)return-44;var o="";return c&4&&(o+="r"),c&2&&(o+="w"),c&1&&(o+="x"),o&&d.nodePermissions(a,o)?-2:0}catch(h){if(typeof d>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}function Ei(n,s){try{return d.fchmod(n,s),0}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Si(n,s,c){try{return d.fchown(n,s,c),0}catch(i){if(typeof d>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}var Ut=()=>{var n=Oe[+Fe.varargs>>2];return Fe.varargs+=4,n},It=Ut;function ki(n,s,c){Fe.varargs=c;try{var i=Fe.getStreamFromFD(n);switch(s){case 0:{var p=Ut();if(p<0)return-28;for(;d.streams[p];)p++;var a;return a=d.dupStream(i,p),a.fd}case 1:case 2:return 0;case 3:return i.flags;case 4:{var p=Ut();return i.flags|=p,0}case 12:{var p=It(),o=0;return Ye[p+o>>1]=2,0}case 13:case 14:return 0}return-28}catch(h){if(typeof d>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}function Ai(n,s){try{return Fe.writeStat(s,d.fstat(n))}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var Ii=9007199254740992,Ti=-9007199254740992,Lt=n=>n<Ti||n>Ii?NaN:Number(n);function Oi(n,s){s=Lt(s);try{return isNaN(s)?-61:(d.ftruncate(n,s),0)}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var wt=(n,s,c)=>Mn(n,Ge,s,c);function xi(n,s){try{if(s===0)return-28;var c=d.cwd(),i=$t(c)+1;return s<i?-68:(wt(c,n,s),i)}catch(p){if(typeof d>"u"||p.name!=="ErrnoError")throw p;return-p.errno}}function Fi(n,s,c){Fe.varargs=c;try{var i=Fe.getStreamFromFD(n);switch(s){case 21509:return i.tty?0:-59;case 21505:{if(!i.tty)return-59;if(i.tty.ops.ioctl_tcgets){var p=i.tty.ops.ioctl_tcgets(i),a=It();Oe[a>>2]=p.c_iflag||0,Oe[a+4>>2]=p.c_oflag||0,Oe[a+8>>2]=p.c_cflag||0,Oe[a+12>>2]=p.c_lflag||0;for(var o=0;o<32;o++)at[a+o+17]=p.c_cc[o]||0;return 0}return 0}case 21510:case 21511:case 21512:return i.tty?0:-59;case 21506:case 21507:case 21508:{if(!i.tty)return-59;if(i.tty.ops.ioctl_tcsets){for(var a=It(),h=Oe[a>>2],C=Oe[a+4>>2],M=Oe[a+8>>2],ae=Oe[a+12>>2],H=[],o=0;o<32;o++)H.push(at[a+o+17]);return i.tty.ops.ioctl_tcsets(i.tty,s,{c_iflag:h,c_oflag:C,c_cflag:M,c_lflag:ae,c_cc:H})}return 0}case 21519:{if(!i.tty)return-59;var a=It();return Oe[a>>2]=0,0}case 21520:return i.tty?-28:-59;case 21537:case 21531:{var a=It();return d.ioctl(i,s,a)}case 21523:{if(!i.tty)return-59;if(i.tty.ops.ioctl_tiocgwinsz){var N=i.tty.ops.ioctl_tiocgwinsz(i.tty),a=It();Ye[a>>1]=N[0],Ye[a+2>>1]=N[1]}return 0}case 21524:return i.tty?0:-59;case 21515:return i.tty?0:-59;default:return-28}}catch(z){if(typeof d>"u"||z.name!=="ErrnoError")throw z;return-z.errno}}function Pi(n,s){try{return n=Fe.getStr(n),Fe.writeStat(s,d.lstat(n))}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Ni(n,s,c){try{return s=Fe.getStr(s),s=Fe.calculateAt(n,s),d.mkdir(s,c,0),0}catch(i){if(typeof d>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function Li(n,s,c,i){try{s=Fe.getStr(s);var p=i&256,a=i&4096;return i=i&-6401,s=Fe.calculateAt(n,s,a),Fe.writeStat(c,p?d.lstat(s):d.stat(s))}catch(o){if(typeof d>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Ci(n,s,c,i){Fe.varargs=i;try{s=Fe.getStr(s),s=Fe.calculateAt(n,s);var p=i?Ut():0;return d.open(s,c,p).fd}catch(a){if(typeof d>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}function Ri(n,s,c,i){try{if(s=Fe.getStr(s),s=Fe.calculateAt(n,s),i<=0)return-28;var p=d.readlink(s),a=Math.min(i,$t(p)),o=at[c+a];return wt(p,c,i+1),at[c+a]=o,a}catch(h){if(typeof d>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}function zi(n){try{return n=Fe.getStr(n),d.rmdir(n),0}catch(s){if(typeof d>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Di(n,s){try{return n=Fe.getStr(n),Fe.writeStat(s,d.stat(n))}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Mi(n,s,c){try{if(s=Fe.getStr(s),s=Fe.calculateAt(n,s),!c)d.unlink(s);else if(c===512)d.rmdir(s);else return-28;return 0}catch(i){if(typeof d>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}var Bn=n=>Ke[n>>2]+Oe[n+4>>2]*4294967296;function ji(n,s,c,i){try{s=Fe.getStr(s),s=Fe.calculateAt(n,s,!0);var p=Date.now(),a,o;if(!c)a=p,o=p;else{var h=Bn(c),C=Oe[c+8>>2];C==1073741823?a=p:C==1073741822?a=null:a=h*1e3+C/(1e3*1e3),c+=16,h=Bn(c),C=Oe[c+8>>2],C==1073741823?o=p:C==1073741822?o=null:o=h*1e3+C/(1e3*1e3)}return(o??a)!==null&&d.utime(s,a,o),0}catch(M){if(typeof d>"u"||M.name!=="ErrnoError")throw M;return-M.errno}}var $i=n=>n%4===0&&(n%100!==0||n%400===0),Ui=[0,31,60,91,121,152,182,213,244,274,305,335],Bi=[0,31,59,90,120,151,181,212,243,273,304,334],Wi=n=>{var s=$i(n.getFullYear()),c=s?Ui:Bi,i=c[n.getMonth()]+n.getDate()-1;return i};function Zi(n,s){n=Lt(n);var c=new Date(n*1e3);Oe[s>>2]=c.getSeconds(),Oe[s+4>>2]=c.getMinutes(),Oe[s+8>>2]=c.getHours(),Oe[s+12>>2]=c.getDate(),Oe[s+16>>2]=c.getMonth(),Oe[s+20>>2]=c.getFullYear()-1900,Oe[s+24>>2]=c.getDay();var i=Wi(c)|0;Oe[s+28>>2]=i,Oe[s+36>>2]=-(c.getTimezoneOffset()*60);var p=new Date(c.getFullYear(),0,1),a=new Date(c.getFullYear(),6,1).getTimezoneOffset(),o=p.getTimezoneOffset(),h=(a!=o&&c.getTimezoneOffset()==Math.min(o,a))|0;Oe[s+32>>2]=h}function Qi(n,s,c,i,p,a,o){p=Lt(p);try{var h=Fe.getStreamFromFD(i),C=d.mmap(h,n,p,s,c),M=C.ptr;return Oe[a>>2]=C.allocated,Ke[o>>2]=M,0}catch(ae){if(typeof d>"u"||ae.name!=="ErrnoError")throw ae;return-ae.errno}}function Hi(n,s,c,i,p,a){a=Lt(a);try{var o=Fe.getStreamFromFD(p);c&2&&Fe.doMsync(n,o,s,i,a)}catch(h){if(typeof d>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}var Vi=(n,s,c,i)=>{var p=new Date().getFullYear(),a=new Date(p,0,1),o=new Date(p,6,1),h=a.getTimezoneOffset(),C=o.getTimezoneOffset(),M=Math.max(h,C);Ke[n>>2]=M*60,Oe[s>>2]=+(h!=C);var ae=z=>{var R=z>=0?"-":"+",j=Math.abs(z),oe=String(Math.floor(j/60)).padStart(2,"0"),K=String(j%60).padStart(2,"0");return`UTC${R}${oe}${K}`},H=ae(h),N=ae(C);C<h?(wt(H,c,17),wt(N,i,17)):(wt(H,i,17),wt(N,c,17))},Wn=()=>performance.now(),Zn=()=>Date.now(),Gi=n=>n>=0&&n<=3;function Ki(n,s,c){if(!Gi(n))return 28;var i;n===0?i=Zn():i=Wn();var p=Math.round(i*1e3*1e3);return st[c>>3]=BigInt(p),0}var Qn=()=>2147483648,Ji=()=>Qn(),Yi=n=>{var s=it.buffer.byteLength,c=(n-s+65535)/65536|0;try{return it.grow(c),Fn(),1}catch{}},Xi=n=>{var s=Ge.length;n>>>=0;var c=Qn();if(n>c)return!1;for(var i=1;i<=4;i*=2){var p=s*(1+.2/i);p=Math.min(p,n+100663296);var a=Math.min(c,jn(Math.max(n,p),65536)),o=Yi(a);if(o)return!0}return!1},un={},es=()=>g||"./this.program",Ct=()=>{if(!Ct.strings){var n=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:n,_:es()};for(var c in un)un[c]===void 0?delete s[c]:s[c]=un[c];var i=[];for(var c in s)i.push(`${c}=${s[c]}`);Ct.strings=i}return Ct.strings},ts=(n,s)=>{var c=0,i=0;for(var p of Ct()){var a=s+c;Ke[n+i>>2]=a,c+=wt(p,a,1/0)+1,i+=4}return 0},ns=(n,s)=>{var c=Ct();Ke[n>>2]=c.length;var i=0;for(var p of c)i+=$t(p)+1;return Ke[s>>2]=i,0};function rs(n){try{var s=Fe.getStreamFromFD(n);return d.close(s),0}catch(c){if(typeof d>"u"||c.name!=="ErrnoError")throw c;return c.errno}}function is(n,s){try{var c=0,i=0,p=0,a=Fe.getStreamFromFD(n),o=a.tty?2:d.isDir(a.mode)?3:d.isLink(a.mode)?7:4;return at[s]=o,Ye[s+2>>1]=p,st[s+8>>3]=BigInt(c),st[s+16>>3]=BigInt(i),0}catch(h){if(typeof d>"u"||h.name!=="ErrnoError")throw h;return h.errno}}var ss=(n,s,c,i)=>{for(var p=0,a=0;a<c;a++){var o=Ke[s>>2],h=Ke[s+4>>2];s+=8;var C=d.read(n,at,o,h,i);if(C<0)return-1;if(p+=C,C<h)break}return p};function os(n,s,c,i){try{var p=Fe.getStreamFromFD(n),a=ss(p,s,c);return Ke[i>>2]=a,0}catch(o){if(typeof d>"u"||o.name!=="ErrnoError")throw o;return o.errno}}function as(n,s,c,i){s=Lt(s);try{if(isNaN(s))return 61;var p=Fe.getStreamFromFD(n);return d.llseek(p,s,c),st[i>>3]=BigInt(p.position),p.getdents&&s===0&&c===0&&(p.getdents=null),0}catch(a){if(typeof d>"u"||a.name!=="ErrnoError")throw a;return a.errno}}function ls(n){var c;try{var s=Fe.getStreamFromFD(n);return(c=s.stream_ops)!=null&&c.fsync?s.stream_ops.fsync(s):0}catch(i){if(typeof d>"u"||i.name!=="ErrnoError")throw i;return i.errno}}var cs=(n,s,c,i)=>{for(var p=0,a=0;a<c;a++){var o=Ke[s>>2],h=Ke[s+4>>2];s+=8;var C=d.write(n,at,o,h,i);if(C<0)return-1;if(p+=C,C<h)break}return p};function us(n,s,c,i){try{var p=Fe.getStreamFromFD(n),a=cs(p,s,c);return Ke[i>>2]=a,0}catch(o){if(typeof d>"u"||o.name!=="ErrnoError")throw o;return o.errno}}d.createPreloadedFile=bi,d.staticInit(),Yr(),r.noExitRuntime&&r.noExitRuntime,r.preloadPlugins&&(Un=r.preloadPlugins),r.print&&(Y=r.print),r.printErr&&(de=r.printErr),r.wasmBinary&&(be=r.wasmBinary),r.arguments&&r.arguments,r.thisProgram&&(g=r.thisProgram),r.wasmMemory=it;var Hn;function fs(n){r._sqlite3_status64=n.sqlite3_status64,r._sqlite3_status=n.sqlite3_status,r._sqlite3_db_status64=n.sqlite3_db_status64,r._sqlite3_msize=n.sqlite3_msize,r._sqlite3_db_status=n.sqlite3_db_status,r._sqlite3_vfs_find=n.sqlite3_vfs_find,r._sqlite3_initialize=n.sqlite3_initialize,r._sqlite3_malloc=n.sqlite3_malloc,r._sqlite3_free=n.sqlite3_free,r._sqlite3_vfs_register=n.sqlite3_vfs_register,r._sqlite3_vfs_unregister=n.sqlite3_vfs_unregister,r._sqlite3_malloc64=n.sqlite3_malloc64,r._sqlite3_realloc=n.sqlite3_realloc,r._sqlite3_realloc64=n.sqlite3_realloc64,r._sqlite3_value_text=n.sqlite3_value_text,r._sqlite3_randomness=n.sqlite3_randomness,r._sqlite3_stricmp=n.sqlite3_stricmp,r._sqlite3_strnicmp=n.sqlite3_strnicmp,r._sqlite3_uri_parameter=n.sqlite3_uri_parameter,r._sqlite3_uri_boolean=n.sqlite3_uri_boolean,r._sqlite3_serialize=n.sqlite3_serialize,r._sqlite3_prepare_v2=n.sqlite3_prepare_v2,r._sqlite3_step=n.sqlite3_step,r._sqlite3_column_int64=n.sqlite3_column_int64,r._sqlite3_reset=n.sqlite3_reset,r._sqlite3_exec=n.sqlite3_exec,r._sqlite3_column_int=n.sqlite3_column_int,r._sqlite3_finalize=n.sqlite3_finalize,r._sqlite3_file_control=n.sqlite3_file_control,r._sqlite3_column_name=n.sqlite3_column_name,r._sqlite3_column_text=n.sqlite3_column_text,r._sqlite3_column_type=n.sqlite3_column_type,r._sqlite3_errmsg=n.sqlite3_errmsg,r._sqlite3_deserialize=n.sqlite3_deserialize,r._sqlite3_clear_bindings=n.sqlite3_clear_bindings,r._sqlite3_value_blob=n.sqlite3_value_blob,r._sqlite3_value_bytes=n.sqlite3_value_bytes,r._sqlite3_value_double=n.sqlite3_value_double,r._sqlite3_value_int=n.sqlite3_value_int,r._sqlite3_value_int64=n.sqlite3_value_int64,r._sqlite3_value_subtype=n.sqlite3_value_subtype,r._sqlite3_value_pointer=n.sqlite3_value_pointer,r._sqlite3_value_type=n.sqlite3_value_type,r._sqlite3_value_nochange=n.sqlite3_value_nochange,r._sqlite3_value_frombind=n.sqlite3_value_frombind,r._sqlite3_value_dup=n.sqlite3_value_dup,r._sqlite3_value_free=n.sqlite3_value_free,r._sqlite3_result_blob=n.sqlite3_result_blob,r._sqlite3_result_error_toobig=n.sqlite3_result_error_toobig,r._sqlite3_result_error_nomem=n.sqlite3_result_error_nomem,r._sqlite3_result_double=n.sqlite3_result_double,r._sqlite3_result_error=n.sqlite3_result_error,r._sqlite3_result_int=n.sqlite3_result_int,r._sqlite3_result_int64=n.sqlite3_result_int64,r._sqlite3_result_null=n.sqlite3_result_null,r._sqlite3_result_pointer=n.sqlite3_result_pointer,r._sqlite3_result_subtype=n.sqlite3_result_subtype,r._sqlite3_result_text=n.sqlite3_result_text,r._sqlite3_result_zeroblob=n.sqlite3_result_zeroblob,r._sqlite3_result_zeroblob64=n.sqlite3_result_zeroblob64,r._sqlite3_result_error_code=n.sqlite3_result_error_code,r._sqlite3_user_data=n.sqlite3_user_data,r._sqlite3_context_db_handle=n.sqlite3_context_db_handle,r._sqlite3_vtab_nochange=n.sqlite3_vtab_nochange,r._sqlite3_vtab_in_first=n.sqlite3_vtab_in_first,r._sqlite3_vtab_in_next=n.sqlite3_vtab_in_next,r._sqlite3_aggregate_context=n.sqlite3_aggregate_context,r._sqlite3_get_auxdata=n.sqlite3_get_auxdata,r._sqlite3_set_auxdata=n.sqlite3_set_auxdata,r._sqlite3_column_count=n.sqlite3_column_count,r._sqlite3_data_count=n.sqlite3_data_count,r._sqlite3_column_blob=n.sqlite3_column_blob,r._sqlite3_column_bytes=n.sqlite3_column_bytes,r._sqlite3_column_double=n.sqlite3_column_double,r._sqlite3_column_value=n.sqlite3_column_value,r._sqlite3_column_decltype=n.sqlite3_column_decltype,r._sqlite3_column_database_name=n.sqlite3_column_database_name,r._sqlite3_column_table_name=n.sqlite3_column_table_name,r._sqlite3_column_origin_name=n.sqlite3_column_origin_name,r._sqlite3_bind_blob=n.sqlite3_bind_blob,r._sqlite3_bind_double=n.sqlite3_bind_double,r._sqlite3_bind_int=n.sqlite3_bind_int,r._sqlite3_bind_int64=n.sqlite3_bind_int64,r._sqlite3_bind_null=n.sqlite3_bind_null,r._sqlite3_bind_pointer=n.sqlite3_bind_pointer,r._sqlite3_bind_text=n.sqlite3_bind_text,r._sqlite3_bind_parameter_count=n.sqlite3_bind_parameter_count,r._sqlite3_bind_parameter_name=n.sqlite3_bind_parameter_name,r._sqlite3_bind_parameter_index=n.sqlite3_bind_parameter_index,r._sqlite3_db_handle=n.sqlite3_db_handle,r._sqlite3_stmt_readonly=n.sqlite3_stmt_readonly,r._sqlite3_stmt_isexplain=n.sqlite3_stmt_isexplain,r._sqlite3_stmt_explain=n.sqlite3_stmt_explain,r._sqlite3_stmt_busy=n.sqlite3_stmt_busy,r._sqlite3_stmt_status=n.sqlite3_stmt_status,r._sqlite3_sql=n.sqlite3_sql,r._sqlite3_expanded_sql=n.sqlite3_expanded_sql,r._sqlite3_preupdate_old=n.sqlite3_preupdate_old,r._sqlite3_preupdate_count=n.sqlite3_preupdate_count,r._sqlite3_preupdate_depth=n.sqlite3_preupdate_depth,r._sqlite3_preupdate_blobwrite=n.sqlite3_preupdate_blobwrite,r._sqlite3_preupdate_new=n.sqlite3_preupdate_new,r._sqlite3_value_numeric_type=n.sqlite3_value_numeric_type,r._sqlite3_set_authorizer=n.sqlite3_set_authorizer,r._sqlite3_strglob=n.sqlite3_strglob,r._sqlite3_strlike=n.sqlite3_strlike,r._sqlite3_auto_extension=n.sqlite3_auto_extension,r._sqlite3_cancel_auto_extension=n.sqlite3_cancel_auto_extension,r._sqlite3_reset_auto_extension=n.sqlite3_reset_auto_extension,r._sqlite3_prepare_v3=n.sqlite3_prepare_v3,r._sqlite3_create_module=n.sqlite3_create_module,r._sqlite3_create_module_v2=n.sqlite3_create_module_v2,r._sqlite3_drop_modules=n.sqlite3_drop_modules,r._sqlite3_declare_vtab=n.sqlite3_declare_vtab,r._sqlite3_vtab_on_conflict=n.sqlite3_vtab_on_conflict,r._sqlite3_vtab_collation=n.sqlite3_vtab_collation,r._sqlite3_vtab_in=n.sqlite3_vtab_in,r._sqlite3_vtab_rhs_value=n.sqlite3_vtab_rhs_value,r._sqlite3_vtab_distinct=n.sqlite3_vtab_distinct,r._sqlite3_keyword_name=n.sqlite3_keyword_name,r._sqlite3_keyword_count=n.sqlite3_keyword_count,r._sqlite3_keyword_check=n.sqlite3_keyword_check,r._sqlite3_complete=n.sqlite3_complete,r._sqlite3_libversion=n.sqlite3_libversion,r._sqlite3_libversion_number=n.sqlite3_libversion_number,r._sqlite3_shutdown=n.sqlite3_shutdown,r._sqlite3_last_insert_rowid=n.sqlite3_last_insert_rowid,r._sqlite3_set_last_insert_rowid=n.sqlite3_set_last_insert_rowid,r._sqlite3_changes64=n.sqlite3_changes64,r._sqlite3_changes=n.sqlite3_changes,r._sqlite3_total_changes64=n.sqlite3_total_changes64,r._sqlite3_total_changes=n.sqlite3_total_changes,r._sqlite3_txn_state=n.sqlite3_txn_state,r._sqlite3_close_v2=n.sqlite3_close_v2,r._sqlite3_busy_handler=n.sqlite3_busy_handler,r._sqlite3_progress_handler=n.sqlite3_progress_handler,r._sqlite3_busy_timeout=n.sqlite3_busy_timeout,r._sqlite3_interrupt=n.sqlite3_interrupt,r._sqlite3_is_interrupted=n.sqlite3_is_interrupted,r._sqlite3_create_function=n.sqlite3_create_function,r._sqlite3_create_function_v2=n.sqlite3_create_function_v2,r._sqlite3_create_window_function=n.sqlite3_create_window_function,r._sqlite3_overload_function=n.sqlite3_overload_function,r._sqlite3_trace_v2=n.sqlite3_trace_v2,r._sqlite3_commit_hook=n.sqlite3_commit_hook,r._sqlite3_update_hook=n.sqlite3_update_hook,r._sqlite3_rollback_hook=n.sqlite3_rollback_hook,r._sqlite3_preupdate_hook=n.sqlite3_preupdate_hook,r._sqlite3_set_errmsg=n.sqlite3_set_errmsg,r._sqlite3_error_offset=n.sqlite3_error_offset,r._sqlite3_errcode=n.sqlite3_errcode,r._sqlite3_extended_errcode=n.sqlite3_extended_errcode,r._sqlite3_errstr=n.sqlite3_errstr,r._sqlite3_limit=n.sqlite3_limit,r._sqlite3_open=n.sqlite3_open,r._sqlite3_open_v2=n.sqlite3_open_v2,r._sqlite3_create_collation=n.sqlite3_create_collation,r._sqlite3_create_collation_v2=n.sqlite3_create_collation_v2,r._sqlite3_collation_needed=n.sqlite3_collation_needed,r._sqlite3_get_autocommit=n.sqlite3_get_autocommit,r._sqlite3_table_column_metadata=n.sqlite3_table_column_metadata,r._sqlite3_extended_result_codes=n.sqlite3_extended_result_codes,r._sqlite3_uri_key=n.sqlite3_uri_key,r._sqlite3_uri_int64=n.sqlite3_uri_int64,r._sqlite3_db_name=n.sqlite3_db_name,r._sqlite3_db_filename=n.sqlite3_db_filename,r._sqlite3_db_readonly=n.sqlite3_db_readonly,r._sqlite3_compileoption_used=n.sqlite3_compileoption_used,r._sqlite3_compileoption_get=n.sqlite3_compileoption_get,r._sqlite3session_diff=n.sqlite3session_diff,r._sqlite3session_attach=n.sqlite3session_attach,r._sqlite3session_create=n.sqlite3session_create,r._sqlite3session_delete=n.sqlite3session_delete,r._sqlite3session_table_filter=n.sqlite3session_table_filter,r._sqlite3session_changeset=n.sqlite3session_changeset,r._sqlite3session_changeset_strm=n.sqlite3session_changeset_strm,r._sqlite3session_patchset_strm=n.sqlite3session_patchset_strm,r._sqlite3session_patchset=n.sqlite3session_patchset,r._sqlite3session_enable=n.sqlite3session_enable,r._sqlite3session_indirect=n.sqlite3session_indirect,r._sqlite3session_isempty=n.sqlite3session_isempty,r._sqlite3session_memory_used=n.sqlite3session_memory_used,r._sqlite3session_object_config=n.sqlite3session_object_config,r._sqlite3session_changeset_size=n.sqlite3session_changeset_size,r._sqlite3changeset_start=n.sqlite3changeset_start,r._sqlite3changeset_start_v2=n.sqlite3changeset_start_v2,r._sqlite3changeset_start_strm=n.sqlite3changeset_start_strm,r._sqlite3changeset_start_v2_strm=n.sqlite3changeset_start_v2_strm,r._sqlite3changeset_next=n.sqlite3changeset_next,r._sqlite3changeset_op=n.sqlite3changeset_op,r._sqlite3changeset_pk=n.sqlite3changeset_pk,r._sqlite3changeset_old=n.sqlite3changeset_old,r._sqlite3changeset_new=n.sqlite3changeset_new,r._sqlite3changeset_conflict=n.sqlite3changeset_conflict,r._sqlite3changeset_fk_conflicts=n.sqlite3changeset_fk_conflicts,r._sqlite3changeset_finalize=n.sqlite3changeset_finalize,r._sqlite3changeset_invert=n.sqlite3changeset_invert,r._sqlite3changeset_invert_strm=n.sqlite3changeset_invert_strm,r._sqlite3changeset_apply_v2=n.sqlite3changeset_apply_v2,r._sqlite3changeset_apply_v3=n.sqlite3changeset_apply_v3,r._sqlite3changeset_apply=n.sqlite3changeset_apply,r._sqlite3changeset_apply_v3_strm=n.sqlite3changeset_apply_v3_strm,r._sqlite3changeset_apply_v2_strm=n.sqlite3changeset_apply_v2_strm,r._sqlite3changeset_apply_strm=n.sqlite3changeset_apply_strm,r._sqlite3changegroup_new=n.sqlite3changegroup_new,r._sqlite3changegroup_add=n.sqlite3changegroup_add,r._sqlite3changegroup_output=n.sqlite3changegroup_output,r._sqlite3changegroup_add_strm=n.sqlite3changegroup_add_strm,r._sqlite3changegroup_output_strm=n.sqlite3changegroup_output_strm,r._sqlite3changegroup_delete=n.sqlite3changegroup_delete,r._sqlite3changeset_concat=n.sqlite3changeset_concat,r._sqlite3changeset_concat_strm=n.sqlite3changeset_concat_strm,r._sqlite3session_config=n.sqlite3session_config,r._sqlite3_sourceid=n.sqlite3_sourceid,r._sqlite3__wasm_pstack_ptr=n.sqlite3__wasm_pstack_ptr,r._sqlite3__wasm_pstack_restore=n.sqlite3__wasm_pstack_restore,r._sqlite3__wasm_pstack_alloc=n.sqlite3__wasm_pstack_alloc,r._sqlite3__wasm_pstack_remaining=n.sqlite3__wasm_pstack_remaining,r._sqlite3__wasm_pstack_quota=n.sqlite3__wasm_pstack_quota,r._sqlite3__wasm_test_struct=n.sqlite3__wasm_test_struct,r._sqlite3__wasm_enum_json=n.sqlite3__wasm_enum_json,r._sqlite3__wasm_vfs_unlink=n.sqlite3__wasm_vfs_unlink,r._sqlite3__wasm_db_vfs=n.sqlite3__wasm_db_vfs,r._sqlite3__wasm_db_reset=n.sqlite3__wasm_db_reset,r._sqlite3__wasm_db_export_chunked=n.sqlite3__wasm_db_export_chunked,r._sqlite3__wasm_db_serialize=n.sqlite3__wasm_db_serialize,r._sqlite3__wasm_vfs_create_file=n.sqlite3__wasm_vfs_create_file,r._sqlite3__wasm_posix_create_file=n.sqlite3__wasm_posix_create_file,r._sqlite3__wasm_kvvfsMakeKeyOnPstack=n.sqlite3__wasm_kvvfsMakeKeyOnPstack,r._sqlite3__wasm_kvvfs_methods=n.sqlite3__wasm_kvvfs_methods,r._sqlite3__wasm_vtab_config=n.sqlite3__wasm_vtab_config,r._sqlite3__wasm_db_config_ip=n.sqlite3__wasm_db_config_ip,r._sqlite3__wasm_db_config_pii=n.sqlite3__wasm_db_config_pii,r._sqlite3__wasm_db_config_s=n.sqlite3__wasm_db_config_s,r._sqlite3__wasm_config_i=n.sqlite3__wasm_config_i,r._sqlite3__wasm_config_ii=n.sqlite3__wasm_config_ii,r._sqlite3__wasm_config_j=n.sqlite3__wasm_config_j,r._sqlite3__wasm_qfmt_token=n.sqlite3__wasm_qfmt_token,r._sqlite3__wasm_init_wasmfs=n.sqlite3__wasm_init_wasmfs,r._sqlite3__wasm_test_intptr=n.sqlite3__wasm_test_intptr,r._sqlite3__wasm_test_voidptr=n.sqlite3__wasm_test_voidptr,r._sqlite3__wasm_test_int64_max=n.sqlite3__wasm_test_int64_max,r._sqlite3__wasm_test_int64_min=n.sqlite3__wasm_test_int64_min,r._sqlite3__wasm_test_int64_times2=n.sqlite3__wasm_test_int64_times2,r._sqlite3__wasm_test_int64_minmax=n.sqlite3__wasm_test_int64_minmax,r._sqlite3__wasm_test_int64ptr=n.sqlite3__wasm_test_int64ptr,r._sqlite3__wasm_test_stack_overflow=n.sqlite3__wasm_test_stack_overflow,r._sqlite3__wasm_test_str_hello=n.sqlite3__wasm_test_str_hello,r._sqlite3__wasm_SQLTester_strglob=n.sqlite3__wasm_SQLTester_strglob,r._malloc=n.malloc,r._free=n.free,r._realloc=n.realloc,Hn=n.emscripten_builtin_memalign,n._emscripten_stack_restore,n._emscripten_stack_alloc,n.emscripten_stack_get_current}var Vn={__syscall_chmod:wi,__syscall_faccessat:qi,__syscall_fchmod:Ei,__syscall_fchown32:Si,__syscall_fcntl64:ki,__syscall_fstat64:Ai,__syscall_ftruncate64:Oi,__syscall_getcwd:xi,__syscall_ioctl:Fi,__syscall_lstat64:Pi,__syscall_mkdirat:Ni,__syscall_newfstatat:Li,__syscall_openat:Ci,__syscall_readlinkat:Ri,__syscall_rmdir:zi,__syscall_stat64:Di,__syscall_unlinkat:Mi,__syscall_utimensat:ji,_localtime_js:Zi,_mmap_js:Qi,_munmap_js:Hi,_tzset_js:Vi,clock_time_get:Ki,emscripten_date_now:Zn,emscripten_get_heap_max:Ji,emscripten_get_now:Wn,emscripten_resize_heap:Xi,environ_get:ts,environ_sizes_get:ns,fd_close:rs,fd_fdstat_get:is,fd_read:os,fd_seek:as,fd_sync:ls,fd_write:us,memory:it},Tt=await ci();function fn(){if(yt>0){Pt=fn;return}if(Xr(),yt>0){Pt=fn;return}function n(){var s;r.calledRun=!0,!Re&&(ei(),Ze==null||Ze(r),(s=r.onRuntimeInitialized)==null||s.call(r),ti())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),n()},1)):n()}function _s(){if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()()}return _s(),fn(),r.runSQLite3PostLoadInit=function(n,s,c){if(delete s.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function i(p=globalThis.sqlite3ApiConfig||i.defaultConfig){if(i.sqlite3)return(i.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),i.sqlite3;const a=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},p||{});Object.assign(a,{allocExportName:a.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:a.useStdAlloc?"free":"sqlite3_free",reallocExportName:a.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(m=>{typeof a[m]=="function"&&(a[m]=a[m]())}),delete globalThis.sqlite3ApiConfig,delete i.defaultConfig;const o=Object.create(null),h=Object.create(null),C=m=>o.sqlite3_js_rc_str&&o.sqlite3_js_rc_str(m)||"Unknown result code #"+m,M=m=>typeof m=="number"&&m===(m|0)&&m<=2147483647&&m>=-2147483648;class ae extends Error{constructor(...y){let A;if(y.length)if(M(y[0]))if(A=y[0],y.length===1)super(C(y[0]));else{const Z=C(A);typeof y[1]=="object"?super(Z,y[1]):(y[0]=Z+":",super(y.join(" ")))}else y.length===2&&typeof y[1]=="object"?super(...y):super(y.join(" "));this.resultCode=A||o.SQLITE_ERROR,this.name="SQLite3Error"}}ae.toss=(...m)=>{throw new ae(...m)};const H=ae.toss;a.wasmfsOpfsDir&&!/^\/[^/]+$/.test(a.wasmfsOpfsDir)&&H("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const N=function m(y){return m._max||(m._max=BigInt("0x7fffffffffffffff"),m._min=~m._max),y>=m._min&&y<=m._max},z=m=>m>=-0x7fffffffn-1n&&m<=0x7fffffffn,R=function m(y){return m._min||(m._min=Number.MIN_SAFE_INTEGER,m._max=Number.MAX_SAFE_INTEGER),y>=m._min&&y<=m._max},j=m=>m&&m.constructor&&M(m.constructor.BYTES_PER_ELEMENT)?m:!1,oe=m=>m&&(m instanceof Uint8Array||m instanceof Int8Array||m instanceof ArrayBuffer),K=m=>m&&(m instanceof Uint8Array||m instanceof Int8Array||m instanceof ArrayBuffer),S=m=>oe(m)||H("Value is not of a supported TypedArray type."),I=function(m){return K(m)?h.typedArrayToString(m instanceof ArrayBuffer?new Uint8Array(m):m,0,m.length):Array.isArray(m)?m.join(""):(h.isPtr(m)&&(m=h.cstrToJs(m)),m)};class T extends Error{constructor(...y){y.length===2&&typeof y[1]=="object"?super(...y):y.length?super(y.join(" ")):super("Allocation failed."),this.resultCode=o.SQLITE_NOMEM,this.name="WasmAllocError"}}T.toss=(...m)=>{throw new T(...m)},Object.assign(o,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(m,y,A,Z,ne,me,ge,w,u)=>{},sqlite3_create_function:(m,y,A,Z,ne,me,ge,w)=>{},sqlite3_create_window_function:(m,y,A,Z,ne,me,ge,w,u,f)=>{},sqlite3_prepare_v3:(m,y,A,Z,ne,me)=>{},sqlite3_prepare_v2:(m,y,A,Z,ne)=>{},sqlite3_exec:(m,y,A,Z,ne)=>{},sqlite3_randomness:(m,y)=>{}});const D={affirmBindableTypedArray:S,flexibleString:I,bigIntFits32:z,bigIntFits64:N,bigIntFitsDouble:R,isBindableTypedArray:oe,isInt32:M,isSQLableTypedArray:K,isTypedArray:j,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...m){throw new Error(m.join(" "))},toss3:H,typedArrayPart:h.typedArrayPart,affirmDbHeader:function(m){m instanceof ArrayBuffer&&(m=new Uint8Array(m));const y="SQLite format 3";y.length>m.byteLength&&H("Input does not contain an SQLite3 database header.");for(let A=0;A<y.length;++A)y.charCodeAt(A)!==m[A]&&H("Input does not contain an SQLite3 database header.")},affirmIsDb:function(m){m instanceof ArrayBuffer&&(m=new Uint8Array(m));const y=m.byteLength;(y<512||y%512!==0)&&H("Byte array size",y,"is invalid for an SQLite3 db."),D.affirmDbHeader(m)}};Object.assign(h,{pointerIR:a.wasmPtrIR,bigIntEnabled:!!a.bigIntEnabled,exports:a.exports||H("Missing API config.exports (WASM module exports)."),memory:a.memory||a.exports.memory||H("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),functionTable:a.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),h.allocFromTypedArray=function(m){m instanceof ArrayBuffer&&(m=new Uint8Array(m)),S(m);const y=h.heapForSize(m.constructor),A=h.alloc(m.byteLength||1);return y.set(m.byteLength?m:[0],Number(A)),A};{const m=a.allocExportName,y=a.deallocExportName,A=a.reallocExportName;for(const Z of[m,y,A])h.exports[Z]instanceof Function||H("Missing required exports[",Z,"] function.");h.alloc=function Z(ne){return Z.impl(ne)||T.toss("Failed to allocate",ne," bytes.")},h.alloc.impl=h.exports[m],h.realloc=function Z(ne,me){const ge=Z.impl(h.ptr.coerce(ne),me);return me?ge||T.toss("Failed to reallocate",me," bytes."):h.ptr.null},h.realloc.impl=h.exports[A],h.dealloc=function Z(ne){Z.impl(h.ptr.coerce(ne))},h.dealloc.impl=h.exports[y]}h.compileOptionUsed=function m(y){if(arguments.length){if(Array.isArray(y)){const A=Object.create(null);return y.forEach(Z=>{A[Z]=o.sqlite3_compileoption_used(Z)}),A}else if(typeof y=="object")return Object.keys(y).forEach(A=>{y[A]=o.sqlite3_compileoption_used(A)}),y}else{if(m._result)return m._result;m._opt||(m._rx=/^([^=]+)=(.+)/,m._rxInt=/^-?\d+$/,m._opt=function(ge,w){const u=m._rx.exec(ge);w[0]=u?u[1]:ge,w[1]=u?m._rxInt.test(u[2])?+u[2]:u[2]:!0});const A=Object.create(null),Z=[0,0];let ne=0,me;for(;me=o.sqlite3_compileoption_get(ne++);)m._opt(me,Z),A[Z[0]]=Z[1];return m._result=A}return typeof y=="string"?!!o.sqlite3_compileoption_used(y):!1},h.pstack=Object.assign(Object.create(null),{restore:h.exports.sqlite3__wasm_pstack_restore,alloc:function(m){return typeof m=="string"&&!(m=h.sizeofIR(m))&&T.toss("Invalid value for pstack.alloc(",arguments[0],")"),h.exports.sqlite3__wasm_pstack_alloc(m)||T.toss("Could not allocate",m,"bytes from the pstack.")},allocChunks:function(m,y){typeof y=="string"&&!(y=h.sizeofIR(y))&&T.toss("Invalid size value for allocChunks(",arguments[1],")");const A=h.pstack.alloc(m*y),Z=[A];let ne=1,me=y;for(;ne<m;++ne,me+=y)Z.push(h.ptr.add(A,me));return Z},allocPtr:(m=1,y=!0)=>m===1?h.pstack.alloc(y?8:h.ptr.size):h.pstack.allocChunks(m,y?8:h.ptr.size),call:function(m){const y=h.pstack.pointer;try{return m($)}finally{h.pstack.restore(y)}}}),Object.defineProperties(h.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:h.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:h.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:h.exports.sqlite3__wasm_pstack_remaining}}),o.sqlite3_randomness=(...m)=>{if(m.length===1&&D.isTypedArray(m[0])&&m[0].BYTES_PER_ELEMENT===1){const y=m[0];if(y.byteLength===0)return h.exports.sqlite3_randomness(0,h.ptr.null),y;const A=h.pstack.pointer;try{let Z=y.byteLength,ne=0;const me=h.exports.sqlite3_randomness,ge=h.heap8u(),w=Z<512?Z:512,u=h.pstack.alloc(w);do{const f=Z>w?w:Z;me(f,u),y.set(h.typedArrayPart(ge,u,h.ptr.add(u,f)),ne),Z-=f,ne+=f}while(Z>0)}catch(Z){a.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",Z)}finally{h.pstack.restore(A)}return y}h.exports.sqlite3_randomness(...m)};let F;if(o.sqlite3_wasmfs_opfs_dir=function(){if(F!==void 0)return F;const m=a.wasmfsOpfsDir;if(!m||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!h.exports.sqlite3__wasm_init_wasmfs)return F="";try{return m&&h.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],m)===0?F=m:F=""}catch{return F=""}},o.sqlite3_wasmfs_filename_is_persistent=function(m){const y=o.sqlite3_wasmfs_opfs_dir();return y&&m?m.startsWith(y+"/"):!1},o.sqlite3_js_db_uses_vfs=function(m,y,A=0){try{const Z=o.sqlite3_vfs_find(y);return Z?m?Z===o.sqlite3_js_db_vfs(m,A)?Z:!1:Z===o.sqlite3_vfs_find(0)?Z:!1:!1}catch{return!1}},o.sqlite3_js_vfs_list=function(){const m=[];let y=o.sqlite3_vfs_find(h.ptr.coerce(0));for(;y;){const A=new o.sqlite3_vfs(y);m.push(h.cstrToJs(A.$zName)),y=A.$pNext,A.dispose()}return m},o.sqlite3_js_db_export=function(m,y=0){m=h.xWrap.testConvertArg("sqlite3*",m),m||H("Invalid sqlite3* argument."),h.bigIntEnabled||H("BigInt support is not enabled.");const A=h.scopedAllocPush();let Z;try{const ne=h.scopedAlloc(8+h.ptr.size),me=h.ptr.add(ne,8),ge=y?h.isPtr(y)?y:h.scopedAllocCString(""+y):h.ptr.null;let w=h.exports.sqlite3__wasm_db_serialize(m,ge,me,ne,0);w&&H("Database serialization failed with code",$.capi.sqlite3_js_rc_str(w)),Z=h.peekPtr(me);const u=h.peek(ne,"i64");return w=u?h.heap8u().slice(Number(Z),Number(Z)+Number(u)):new Uint8Array,w}finally{Z&&h.exports.sqlite3_free(Z),h.scopedAllocPop(A)}},o.sqlite3_js_db_vfs=(m,y=0)=>D.sqlite3__wasm_db_vfs(m,y),o.sqlite3_js_aggregate_context=(m,y)=>o.sqlite3_aggregate_context(m,y)||(y?T.toss("Cannot allocate",y,"bytes for sqlite3_aggregate_context()"):0),o.sqlite3_js_posix_create_file=function(m,y,A){let Z;y&&h.isPtr(y)?Z=y:y instanceof ArrayBuffer||y instanceof Uint8Array?(Z=h.allocFromTypedArray(y),(arguments.length<3||!D.isInt32(A)||A<0)&&(A=y.byteLength)):ae.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!D.isInt32(A)||A<0)&&ae.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const ne=D.sqlite3__wasm_posix_create_file(m,Z,A);ne&&ae.toss("Creation of file failed with sqlite3 result code",o.sqlite3_js_rc_str(ne))}finally{Z&&Z!==y&&h.dealloc(Z)}},o.sqlite3_js_vfs_create_file=function(m,y,A,Z){a.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let ne;A?h.isPtr(A)?ne=A:(A instanceof ArrayBuffer&&(A=new Uint8Array(A)),A instanceof Uint8Array?(ne=h.allocFromTypedArray(A),(arguments.length<4||!D.isInt32(Z)||Z<0)&&(Z=A.byteLength)):ae.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):ne=0,(!D.isInt32(Z)||Z<0)&&(ne&&ne!==A&&h.dealloc(ne),ae.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const me=D.sqlite3__wasm_vfs_create_file(m,y,ne,Z);me&&ae.toss("Creation of file failed with sqlite3 result code",o.sqlite3_js_rc_str(me))}finally{ne&&ne!==A&&h.dealloc(ne)}},o.sqlite3_js_sql_to_string=m=>{if(typeof m=="string")return m;const y=I(v);return y===v?void 0:y},D.isUIThread()){const m=function(y){const A=Object.create(null);return A.prefix="kvvfs-"+y,A.stores=[],(y==="session"||y==="")&&A.stores.push(globalThis.sessionStorage),(y==="local"||y==="")&&A.stores.push(globalThis.localStorage),A};o.sqlite3_js_kvvfs_clear=function(y=""){let A=0;const Z=m(y);return Z.stores.forEach(ne=>{const me=[];let ge;for(ge=0;ge<ne.length;++ge){const w=ne.key(ge);w.startsWith(Z.prefix)&&me.push(w)}me.forEach(w=>ne.removeItem(w)),A+=me.length}),A},o.sqlite3_js_kvvfs_size=function(y=""){let A=0;const Z=m(y);return Z.stores.forEach(ne=>{let me;for(me=0;me<ne.length;++me){const ge=ne.key(me);ge.startsWith(Z.prefix)&&(A+=ge.length,A+=ne.getItem(ge).length)}}),A*2}}o.sqlite3_db_config=(function(m,y,...A){switch(y){case o.SQLITE_DBCONFIG_ENABLE_FKEY:case o.SQLITE_DBCONFIG_ENABLE_TRIGGER:case o.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case o.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case o.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case o.SQLITE_DBCONFIG_ENABLE_QPSG:case o.SQLITE_DBCONFIG_TRIGGER_EQP:case o.SQLITE_DBCONFIG_RESET_DATABASE:case o.SQLITE_DBCONFIG_DEFENSIVE:case o.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case o.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case o.SQLITE_DBCONFIG_DQS_DML:case o.SQLITE_DBCONFIG_DQS_DDL:case o.SQLITE_DBCONFIG_ENABLE_VIEW:case o.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case o.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case o.SQLITE_DBCONFIG_STMT_SCANSTATUS:case o.SQLITE_DBCONFIG_REVERSE_SCANORDER:case o.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case o.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case o.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=h.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(m,y,A[0],A[1]||0);case o.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=h.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(m,y,A[0],A[1],A[2]);case o.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=h.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(m,y,A[0]);default:return o.SQLITE_MISUSE}}).bind(Object.create(null)),o.sqlite3_value_to_js=function(m,y=!0){let A;const Z=o.sqlite3_value_type(m);switch(Z){case o.SQLITE_INTEGER:h.bigIntEnabled?(A=o.sqlite3_value_int64(m),D.bigIntFitsDouble(A)&&(A=Number(A))):A=o.sqlite3_value_double(m);break;case o.SQLITE_FLOAT:A=o.sqlite3_value_double(m);break;case o.SQLITE_TEXT:A=o.sqlite3_value_text(m);break;case o.SQLITE_BLOB:{const ne=o.sqlite3_value_bytes(m),me=o.sqlite3_value_blob(m);ne&&!me&&$.WasmAllocError.toss("Cannot allocate memory for blob argument of",ne,"byte(s)"),A=ne?h.heap8u().slice(Number(me),Number(me)+Number(ne)):null;break}case o.SQLITE_NULL:A=null;break;default:y&&H(o.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",Z),A=void 0}return A},o.sqlite3_values_to_js=function(m,y,A=!0){let Z;const ne=[];for(Z=0;Z<m;++Z)ne.push(o.sqlite3_value_to_js(h.peekPtr(h.ptr.add(y,h.ptr.size*Z)),A));return ne},o.sqlite3_result_error_js=function(m,y){y instanceof T?o.sqlite3_result_error_nomem(m):o.sqlite3_result_error(m,""+y,-1)},o.sqlite3_result_js=function(m,y){if(y instanceof Error){o.sqlite3_result_error_js(m,y);return}try{switch(typeof y){case"undefined":break;case"boolean":o.sqlite3_result_int(m,y?1:0);break;case"bigint":D.bigIntFits32(y)?o.sqlite3_result_int(m,Number(y)):D.bigIntFitsDouble(y)?o.sqlite3_result_double(m,Number(y)):h.bigIntEnabled?D.bigIntFits64(y)?o.sqlite3_result_int64(m,y):H("BigInt value",y.toString(),"is too BigInt for int64."):H("BigInt value",y.toString(),"is too BigInt.");break;case"number":{let A;D.isInt32(y)?A=o.sqlite3_result_int:h.bigIntEnabled&&Number.isInteger(y)&&D.bigIntFits64(BigInt(y))?A=o.sqlite3_result_int64:A=o.sqlite3_result_double,A(m,y);break}case"string":{const[A,Z]=h.allocCString(y,!0);o.sqlite3_result_text(m,A,Z,o.SQLITE_WASM_DEALLOC);break}case"object":if(y===null){o.sqlite3_result_null(m);break}else if(D.isBindableTypedArray(y)){const A=h.allocFromTypedArray(y);o.sqlite3_result_blob(m,A,y.byteLength,o.SQLITE_WASM_DEALLOC);break}default:H("Don't not how to handle this UDF result value:",typeof y,y)}}catch(A){o.sqlite3_result_error_js(m,A)}},o.sqlite3_column_js=function(m,y,A=!0){const Z=o.sqlite3_column_value(m,y);return Z===0?void 0:o.sqlite3_value_to_js(Z,A)};const P=(function(m,y,A){A=o[A],this.ptr?h.pokePtr(this.ptr,0):this.ptr=h.allocPtr();const Z=A(m,y,this.ptr);if(Z)return ae.toss(Z,arguments[2]+"() failed with code "+Z);const ne=h.peekPtr(this.ptr);return ne?o.sqlite3_value_to_js(ne,!0):void 0}).bind(Object.create(null));o.sqlite3_preupdate_new_js=(m,y)=>P(m,y,"sqlite3_preupdate_new"),o.sqlite3_preupdate_old_js=(m,y)=>P(m,y,"sqlite3_preupdate_old"),o.sqlite3changeset_new_js=(m,y)=>P(m,y,"sqlite3changeset_new"),o.sqlite3changeset_old_js=(m,y)=>P(m,y,"sqlite3changeset_old");const $={WasmAllocError:T,SQLite3Error:ae,capi:o,util:D,wasm:h,config:a,version:Object.create(null),client:void 0,asyncPostInit:async function m(){if(m.isReady instanceof Promise)return m.isReady;let y=i.initializersAsync;delete i.initializersAsync;const A=async()=>($.__isUnderTest||(delete $.util,delete $.StructBinder),$),Z=me=>{throw a.error("an async sqlite3 initializer failed:",me),me};if(!y||!y.length)return m.isReady=A().catch(Z);y=y.map(me=>me instanceof Function?async ge=>me($):me),y.push(A);let ne=Promise.resolve($);for(;y.length;)ne=ne.then(y.shift());return m.isReady=ne.catch(Z)},scriptInfo:void 0};try{i.initializers.forEach(m=>{m($)})}catch(m){throw console.error("sqlite3 bootstrap initializer threw:",m),m}if(delete i.initializers,i.sqlite3=$,delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig,n.debugModule("sqlite3ApiBootstrap() complete",$),$.scriptInfo=n,$.__isUnderTest=c){$.config.emscripten=s;const m=n.instantiateWasm;m&&($.wasm.module=m.module,$.wasm.instance=m.instance,$.wasm.imports=m.imports)}return $.asyncPostInit().then(m=>(n.debugModule("sqlite3.asyncPostInit() complete",$),delete m.asyncPostInit,delete m.scriptInfo,delete m.emscripten,m))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(i){i.bigIntEnabled===void 0&&(i.bigIntEnabled=!!globalThis.BigInt64Array);const p=(...u)=>{throw new Error(u.join(" "))};i.pointerSize&&!i.pointerIR&&(i.pointerIR=i.pointerSize===4?"i32":"i64");const a=i.pointerIR??(i.pointerIR="i32"),o=i.pointerSize??(i.pointerSize=a==="i32"?4:a==="i64"?8:0);delete i.pointerSize,delete i.pointerIR,a!=="i32"&&a!=="i64"?p("Invalid pointerIR:",a):o!==8&&o!==4&&p("Invalid pointerSize:",o);const h=i.bigIntEnabled?u=>BigInt(u||0):u=>p("BigInt support is disabled in this build."),M=o===4?u=>Number(u||0):h,ae=M(0),H=function(...u){let f=M(0);for(const b of u)f+=M(b);return f};{const u=Object.create(null);Object.defineProperty(i,"ptr",{enumerable:!0,get:()=>u,set:()=>p("The ptr property is read-only.")}),function f(b,E){return Object.defineProperty(u,b,{enumerable:!0,get:()=>E,set:()=>p("ptr["+b+"] is read-only.")}),f}("null",ae)("size",o)("ir",a)("coerce",M)("add",H)("addn",a===4?H:(...f)=>Number(H(...f)))}i.exports||Object.defineProperty(i,"exports",{enumerable:!0,configurable:!0,get:()=>{var u;return(u=i.instance)==null?void 0:u.exports}});const N=Object.create(null);N.heapSize=0,N.memory=null,N.freeFuncIndexes=[],N.scopedAlloc=[],N.scopedAlloc.pushPtr=u=>(N.scopedAlloc[N.scopedAlloc.length-1].push(u),u),N.utf8Decoder=new TextDecoder,N.utf8Encoder=new TextEncoder("utf-8"),i.sizeofIR=u=>{switch(u){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return o;default:return(""+u).endsWith("*")?o:void 0}};const z=function(){if(!N.memory)N.memory=i.memory instanceof WebAssembly.Memory?i.memory:i.exports.memory;else if(N.heapSize===N.memory.buffer.byteLength)return N;const u=N.memory.buffer;return N.HEAP8=new Int8Array(u),N.HEAP8U=new Uint8Array(u),N.HEAP16=new Int16Array(u),N.HEAP16U=new Uint16Array(u),N.HEAP32=new Int32Array(u),N.HEAP32U=new Uint32Array(u),N.HEAP32F=new Float32Array(u),N.HEAP64F=new Float64Array(u),i.bigIntEnabled&&(typeof BigInt64Array<"u"?(N.HEAP64=new BigInt64Array(u),N.HEAP64U=new BigUint64Array(u)):p("BigInt support is enabled, but the BigInt64Array type is missing.")),N.heapSize=u.byteLength,N};i.heap8=()=>z().HEAP8,i.heap8u=()=>z().HEAP8U,i.heap16=()=>z().HEAP16,i.heap16u=()=>z().HEAP16U,i.heap32=()=>z().HEAP32,i.heap32u=()=>z().HEAP32U,i.heapForSize=function(u,f=!0){const b=N.memory&&N.heapSize===N.memory.buffer.byteLength?N:z();switch(u){case Int8Array:return b.HEAP8;case Uint8Array:return b.HEAP8U;case Int16Array:return b.HEAP16;case Uint16Array:return b.HEAP16U;case Int32Array:return b.HEAP32;case Uint32Array:return b.HEAP32U;case 8:return f?b.HEAP8U:b.HEAP8;case 16:return f?b.HEAP16U:b.HEAP16;case 32:return f?b.HEAP32U:b.HEAP32;case 64:if(b.HEAP64)return f?b.HEAP64U:b.HEAP64;break;default:if(i.bigIntEnabled){if(u===globalThis.BigUint64Array)return b.HEAP64U;if(u===globalThis.BigInt64Array)return b.HEAP64;break}}p("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const R=i.functionTable;delete i.functionTable,i.functionTable=R?()=>R:()=>i.exports.__indirect_function_table,i.functionEntry=function(u){const f=i.functionTable();return u<f.length?f.get(M(u)):void 0},i.jsFuncToWasm=function u(f,b){if(u._||(u._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:a,P:a,s:a,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(he,ie,Ee)=>{Ee<128?he[ie](Ee):he[ie](Ee%128|128,Ee>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:he=>{const ie=u._.rxJSig.exec(he);return ie?ie[2]:he.substr(1)},letterType:he=>u._.sigTypes[he]||p("Invalid signature letter:",he),pushSigType:(he,ie)=>he.push(u._.typeCodes[u._.letterType(ie)])}),typeof f=="string"){const he=b;b=f,f=he}const E=u._,Q=E.sigParams(b),ee=[1,96];E.uleb128Encode(ee,"push",Q.length);for(const he of Q)E.pushSigType(ee,he);return b[0]==="v"?ee.push(0):(ee.push(1),E.pushSigType(ee,b[0])),E.uleb128Encode(ee,"unshift",ee.length),ee.unshift(0,97,115,109,1,0,0,0,1),ee.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(ee)),{e:{f}}).exports.f};const j=function(f,b,E){if(E&&!N.scopedAlloc.length&&p("No scopedAllocPush() scope is active."),typeof f=="string"){const ie=b;b=f,f=ie}(typeof b!="string"||!(f instanceof Function))&&p("Invalid arguments: expecting (function,signature) or (signature,function).");const Q=i.functionTable(),ee=M(Q.length);let he;for(;N.freeFuncIndexes.length&&(he=N.freeFuncIndexes.pop(),Q.get(he));){he=null;continue}he||(he=M(ee),Q.grow(M(1)));try{return Q.set(he,f),E&&N.scopedAlloc.pushPtr(he),he}catch(ie){if(!(ie instanceof TypeError))throw he===ee&&N.freeFuncIndexes.push(ee),ie}try{const ie=i.jsFuncToWasm(f,b);Q.set(he,ie),E&&N.scopedAlloc.pushPtr(he)}catch(ie){throw he===ee&&N.freeFuncIndexes.push(ee),ie}return he};i.installFunction=(u,f)=>j(u,f,!1),i.scopedInstallFunction=(u,f)=>j(u,f,!0),i.uninstallFunction=function(u){if(!u&&u!==0)return;const f=N.freeFuncIndexes,b=i.functionTable();f.push(u);const E=b.get(u);return b.set(u,null),E},i.peek=function(f,b="i8"){b.endsWith("*")&&(b=a);const E=N.memory&&N.heapSize===N.memory.buffer.byteLength?N:z(),Q=Array.isArray(f)?[]:void 0;let ee;do{switch(Q&&(f=arguments[0].shift()),b){case"i1":case"i8":ee=E.HEAP8[Number(f)>>0];break;case"i16":ee=E.HEAP16[Number(f)>>1];break;case"i32":ee=E.HEAP32[Number(f)>>2];break;case"float":case"f32":ee=E.HEAP32F[Number(f)>>2];break;case"double":case"f64":ee=Number(E.HEAP64F[Number(f)>>3]);break;case"i64":if(E.HEAP64){ee=h(E.HEAP64[Number(f)>>3]);break}default:p("Invalid type for peek():",b)}Q&&Q.push(ee)}while(Q&&arguments[0].length);return Q||ee},i.poke=function(u,f,b="i8"){b.endsWith("*")&&(b=a);const E=N.memory&&N.heapSize===N.memory.buffer.byteLength?N:z();for(const Q of Array.isArray(u)?u:[u])switch(b){case"i1":case"i8":E.HEAP8[Number(Q)>>0]=f;continue;case"i16":E.HEAP16[Number(Q)>>1]=f;continue;case"i32":E.HEAP32[Number(Q)>>2]=f;continue;case"float":case"f32":E.HEAP32F[Number(Q)>>2]=f;continue;case"double":case"f64":E.HEAP64F[Number(Q)>>3]=f;continue;case"i64":if(E.HEAP64){E.HEAP64[Number(Q)>>3]=h(f);continue}default:p("Invalid type for poke(): "+b)}return this},i.peekPtr=(...u)=>i.peek(u.length===1?u[0]:u,a),i.pokePtr=(u,f=0)=>i.poke(u,f,a),i.peek8=(...u)=>i.peek(u.length===1?u[0]:u,"i8"),i.poke8=(u,f)=>i.poke(u,f,"i8"),i.peek16=(...u)=>i.peek(u.length===1?u[0]:u,"i16"),i.poke16=(u,f)=>i.poke(u,f,"i16"),i.peek32=(...u)=>i.peek(u.length===1?u[0]:u,"i32"),i.poke32=(u,f)=>i.poke(u,f,"i32"),i.peek64=(...u)=>i.peek(u.length===1?u[0]:u,"i64"),i.poke64=(u,f)=>i.poke(u,f,"i64"),i.peek32f=(...u)=>i.peek(u.length===1?u[0]:u,"f32"),i.poke32f=(u,f)=>i.poke(u,f,"f32"),i.peek64f=(...u)=>i.peek(u.length===1?u[0]:u,"f64"),i.poke64f=(u,f)=>i.poke(u,f,"f64"),i.getMemValue=i.peek,i.getPtrValue=i.peekPtr,i.setMemValue=i.poke,i.setPtrValue=i.pokePtr,i.isPtr32=u=>typeof u=="number"&&u>=0&&u===(u|0),i.isPtr64=u=>typeof u=="bigint"?u>=0:i.isPtr32(u),i.isPtr=o===4?i.isPtr32:i.isPtr64,i.cstrlen=function(u){if(!u||!i.isPtr(u))return null;u=Number(u);const f=z().HEAP8U;let b=u;for(;f[b]!==0;++b);return Number(b-u)};const oe=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,K=u=>u.buffer instanceof oe;i.isSharedTypedArray=K;const S=(u,f,b)=>(o===8&&(typeof f=="bigint"&&(f=Number(f)),typeof b=="bigint"&&(b=Number(b))),K(u)?u.slice(f,b):u.subarray(f,b));i.typedArrayPart=S;const I=(u,f,b)=>N.utf8Decoder.decode(S(u,f,b));i.typedArrayToString=I,i.cstrToJs=function(u){const f=i.cstrlen(u);return f?I(z().HEAP8U,Number(u),Number(u)+f):f===null?f:""},i.jstrlen=function(u){if(typeof u!="string")return null;const f=u.length;let b=0;for(let E=0;E<f;++E){let Q=u.charCodeAt(E);Q>=55296&&Q<=57343&&(Q=65536+((Q&1023)<<10)|u.charCodeAt(++E)&1023),Q<=127?++b:Q<=2047?b+=2:Q<=65535?b+=3:b+=4}return b},i.jstrcpy=function(u,f,b=0,E=-1,Q=!0){if((!f||!(f instanceof Int8Array)&&!(f instanceof Uint8Array))&&p("jstrcpy() target must be an Int8Array or Uint8Array."),E=Number(E),b=Number(b),E<0&&(E=f.length-b),!(E>0)||!(b>=0))return 0;let ee=0,he=u.length;const ie=b,Ee=b+E-(Q?1:0);for(;ee<he&&b<Ee;++ee){let ye=u.charCodeAt(ee);if(ye>=55296&&ye<=57343&&(ye=65536+((ye&1023)<<10)|u.charCodeAt(++ee)&1023),ye<=127){if(b>=Ee)break;f[b++]=ye}else if(ye<=2047){if(b+1>=Ee)break;f[b++]=192|ye>>6,f[b++]=128|ye&63}else if(ye<=65535){if(b+2>=Ee)break;f[b++]=224|ye>>12,f[b++]=128|ye>>6&63,f[b++]=128|ye&63}else{if(b+3>=Ee)break;f[b++]=240|ye>>18,f[b++]=128|ye>>12&63,f[b++]=128|ye>>6&63,f[b++]=128|ye&63}}return Q&&(f[b++]=0),b-ie},i.cstrncpy=function(u,f,b){if((!u||!f)&&p("cstrncpy() does not accept NULL strings."),b<0)b=i.cstrlen(strPtr)+1;else if(!(b>0))return 0;const E=i.heap8u();let Q=0,ee;const he=Number(u),ie=Number(f);for(;Q<b&&(ee=E[ie+Q]);++Q)E[he+Q]=ee;return Q<b&&(E[he+Q++]=0),Q},i.jstrToUintArray=(u,f=!1)=>N.utf8Encoder.encode(f?u+"\0":u);const T=(u,f)=>{(!(u.alloc instanceof Function)||!(u.dealloc instanceof Function))&&p("Object is missing alloc() and/or dealloc() function(s)","required by",f+"().")},D=function(u,f,b,E){if(T(i,E),typeof u!="string")return null;const Q=N.utf8Encoder.encode(u),ee=b(Q.length+1);let he=ee;try{const ie=z().HEAP8U;return ie.set(Q,Number(ee)),ie[H(ee,Q.length)]=0,he=ae,f?[ee,Q.length]:ee}finally{he&&i.dealloc(he)}};i.allocCString=(u,f=!1)=>D(u,f,i.alloc,"allocCString()"),i.scopedAllocPush=function(){T(i,"scopedAllocPush");const u=[];return N.scopedAlloc.push(u),u},i.scopedAllocPop=function(u){T(i,"scopedAllocPop");const f=arguments.length?N.scopedAlloc.indexOf(u):N.scopedAlloc.length-1;f<0&&p("Invalid state object for scopedAllocPop()."),arguments.length===0&&(u=N.scopedAlloc[f]),N.scopedAlloc.splice(f,1);for(let b;b=u.pop();)i.functionEntry(b)?i.uninstallFunction(b):i.dealloc(b)},i.scopedAlloc=function(u){N.scopedAlloc.length||p("No scopedAllocPush() scope is active.");const f=M(i.alloc(u));return N.scopedAlloc.pushPtr(f)},Object.defineProperty(i.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>N.scopedAlloc.length,set:()=>p("The 'active' property is read-only.")}),i.scopedAllocCString=(u,f=!1)=>D(u,f,i.scopedAlloc,"scopedAllocCString()");const F=function(u,f){const b=i[u?"scopedAlloc":"alloc"]((f.length+1)*i.ptr.size);let E=0;return f.forEach(Q=>{i.pokePtr(H(b,i.ptr.size*E++),i[u?"scopedAllocCString":"allocCString"](""+Q))}),i.pokePtr(H(b,i.ptr.size*E),0),b};i.scopedAllocMainArgv=u=>F(!0,u),i.allocMainArgv=u=>F(!1,u),i.cArgvToJs=(u,f)=>{const b=[];for(let E=0;E<u;++E){const Q=i.peekPtr(H(f,i.ptr.size*E));b.push(Q?i.cstrToJs(Q):null)}return b},i.scopedAllocCall=function(u){i.scopedAllocPush();try{return u()}finally{i.scopedAllocPop()}};const P=function(u,f,b){T(i,b);const E=f?"i64":a;let Q=i[b](u*(f?8:o));if(i.poke(Q,0,E),u===1)return Q;const ee=[Q];for(let he=1;he<u;++he)Q=H(Q,f?8:o),ee[he]=Q,i.poke(Q,0,E);return ee};i.allocPtr=(u=1,f=!0)=>P(u,f,"alloc"),i.scopedAllocPtr=(u=1,f=!0)=>P(u,f,"scopedAlloc"),i.xGet=function(u){return i.exports[u]||p("Cannot find exported symbol:",u)};const $=(u,f)=>p(u+"() requires",f,"argument(s).");i.xCall=function(u,...f){const b=u instanceof Function?u:i.xGet(u);return b instanceof Function||p("Exported symbol",u,"is not a function."),b.length!==f.length&&$(b===u?b.name:u,b.length),arguments.length===2&&Array.isArray(arguments[1])?b.apply(null,arguments[1]):b.apply(null,f)},N.xWrap=Object.create(null),N.xWrap.convert=Object.create(null),N.xWrap.convert.arg=new Map,N.xWrap.convert.result=new Map;const m=N.xWrap.convert.arg,y=N.xWrap.convert.result,A=M;m.set("i64",h).set("i32",u=>u|0).set("i16",u=>(u|0)&65535).set("i8",u=>(u|0)&255).set("f32",u=>Number(u).valueOf()).set("float",m.get("f32")).set("f64",m.get("f32")).set("double",m.get("f64")).set("int",m.get("i32")).set("null",u=>u).set(null,m.get("null")).set("**",A).set("*",A),y.set("*",A).set("pointer",A).set("number",u=>Number(u)).set("void",u=>{}).set(void 0,y.get("void")).set("null",u=>u).set(null,y.get("null"));for(const u of["i8","i16","i32","i64","int","f32","float","f64","double"])m.set(u+"*",A),y.set(u+"*",A),y.set(u,m.get(u)||p("Maintenance required: missing arg converter for",u));const Z=u=>typeof u=="string"?i.scopedAllocCString(u):M(u);m.set("string",Z).set("utf8",Z),y.set("string",u=>i.cstrToJs(u)).set("utf8",y.get("string")).set("string:dealloc",u=>{try{return u?i.cstrToJs(u):null}finally{i.dealloc(u)}}).set("utf8:dealloc",y.get("string:dealloc")).set("json",u=>JSON.parse(i.cstrToJs(u))).set("json:dealloc",u=>{try{return u?JSON.parse(i.cstrToJs(u)):null}finally{i.dealloc(u)}});const ne=class{constructor(u){this.name=u.name||"unnamed adapter"}convertArg(u,f,b){p("AbstractArgAdapter must be subclassed.")}};m.FuncPtrAdapter=class mt extends ne{constructor(f){super(f),m.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",f),this.name=f.name||"unnamed",this.signature=f.signature,f.contextKey instanceof Function&&(this.contextKey=f.contextKey,f.bindScope||(f.bindScope="context")),this.bindScope=f.bindScope||p("FuncPtrAdapter options requires a bindScope (explicit or implied)."),mt.bindScopes.indexOf(f.bindScope)<0&&p("Invalid options.bindScope ("+f.bindMod+") for FuncPtrAdapter. Expecting one of: ("+mt.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=f.callProxy instanceof Function?f.callProxy:void 0}contextKey(f,b){return this}contextMap(f){const b=this.__cmap||(this.__cmap=new Map);let E=b.get(f);return E===void 0&&b.set(f,E=[]),E}convertArg(f,b,E){let Q=this.singleton;if(!Q&&this.isContext&&(Q=this.contextMap(this.contextKey(b,E))),Q&&Q.length===2&&Q[0]===f)return Q[1];if(f instanceof Function){this.callProxy&&(f=this.callProxy(f));const ee=j(f,this.signature,this.isTransient);if(mt.debugFuncInstall&&mt.debugOut("FuncPtrAdapter installed",this,this.contextKey(b,E),"@"+ee,f),Q){if(Q[1]){mt.debugFuncInstall&&mt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(b,E),"@"+Q[1],f);try{N.scopedAlloc.pushPtr(Q[1])}catch{}}Q[0]=arguments[0]||ae,Q[1]=ee}return ee}else if(i.isPtr(f)||f===null||f===void 0){if(Q&&Q[1]&&Q[1]!==f){mt.debugFuncInstall&&mt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(b,E),"@"+Q[1],f);try{N.scopedAlloc.pushPtr(Q[1])}catch{}Q[0]=Q[1]=f||ae}return f||ae}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},m.FuncPtrAdapter.warnOnUse=!1,m.FuncPtrAdapter.debugFuncInstall=!1,m.FuncPtrAdapter.debugOut=console.debug.bind(console),m.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const me=u=>m.get(u)||p("Argument adapter not found:",u),ge=u=>y.get(u)||p("Result adapter not found:",u);N.xWrap.convertArg=(u,...f)=>me(u)(...f),N.xWrap.convertArgNoCheck=(u,...f)=>m.get(u)(...f),N.xWrap.convertResult=(u,f)=>u===null?f:u?ge(u)(f):void 0,N.xWrap.convertResultNoCheck=(u,f)=>u===null?f:u?y.get(u)(f):void 0,i.xWrap=function u(f,b,...E){arguments.length===3&&Array.isArray(arguments[2])&&(E=arguments[2]),i.isPtr(f)&&(f=i.functionEntry(f)||p("Function pointer not found in WASM function table."));const Q=f instanceof Function,ee=Q?f:i.xGet(f);if(Q&&(f=ee.name||"unnamed function"),E.length!==ee.length&&$(f,ee.length),ee.length===0&&(b===null||b==="null"))return ee;ge(b);for(const ie of E)ie instanceof ne?m.set(ie,(...Ee)=>ie.convertArg(...Ee)):me(ie);const he=N.xWrap;return ee.length===0?(...ie)=>ie.length?$(f,ee.length):he.convertResult(b,ee.call(null)):function(...ie){ie.length!==ee.length&&$(f,ee.length);const Ee=i.scopedAllocPush();try{let ye=0;for(u.debug&&console.debug("xWrap() preparing: resultType ",b,"xf",ee,"argTypes",E,"args",ie);ye<ie.length;++ye)ie[ye]=he.convertArgNoCheck(E[ye],ie[ye],ie,ye);return u.debug&&console.debug("xWrap() calling: resultType ",b,"xf",ee,"argTypes",E,"args",ie),he.convertResultNoCheck(b,ee.apply(null,ie))}finally{i.scopedAllocPop(Ee)}}};const w=function(u,f,b,E,Q,ee){if(typeof b=="string"){if(f===1)return ee.get(b);if(f===2){if(E)E instanceof Function||p(Q,"requires a function argument.");else return ee.delete(b),u;return ee.set(b,E),u}}p("Invalid arguments to",Q)};return i.xWrap.resultAdapter=function u(f,b){return w(u,arguments.length,f,b,"resultAdapter()",y)},i.xWrap.argAdapter=function u(f,b){return w(u,arguments.length,f,b,"argAdapter()",m)},i.xWrap.FuncPtrAdapter=m.FuncPtrAdapter,i.xCallWrapped=function(u,f,b,...E){return Array.isArray(arguments[3])&&(E=arguments[3]),i.xWrap(u,f,b||[]).apply(null,E||[])},i.xWrap.testConvertArg=N.xWrap.convertArg,i.xWrap.testConvertResult=N.xWrap.convertResult,i},globalThis.WhWasmUtilInstaller.yawl=(function(i){const p=()=>fetch(i.uri,{credentials:"same-origin"}),a=this,o=function(C){var M,ae;if(i.wasmUtilTarget){const H=(...z)=>{throw new Error(z.join(" "))},N=i.wasmUtilTarget;if(N.module=C.module,N.instance=C.instance,N.instance.exports.memory||(N.memory=((ae=(M=i==null?void 0:i.imports)==null?void 0:M.env)==null?void 0:ae.memory)||H("Missing 'memory' object!")),!N.alloc&&C.instance.exports.malloc){const z=C.instance.exports;N.alloc=function(R){return z.malloc(R)||H("Allocation of",R,"bytes failed.")},N.dealloc=function(R){z.free(R)}}a(N)}return C.config=i,i.onload&&i.onload(C),C};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(p(),i.imports||{}).then(o):()=>p().then(C=>C.arrayBuffer()).then(C=>WebAssembly.instantiate(C,i.imports||{})).then(o)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function i(p){const a=(...L)=>{throw new Error(L.join(" "))};!(p.heap instanceof WebAssembly.Memory)&&!(p.heap instanceof Function)&&a("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(L){p[L]instanceof Function||a("Config option '"+L+"' must be a function.")});const o=p.heap,h=i,C=o||(()=>new Uint8Array(o.buffer)),M=p.alloc,ae=p.dealloc,H=p.log||console.debug.bind(console),N=p.memberPrefix||"",z=p.memberSuffix||"",R=globalThis.BigInt,j=globalThis.BigInt64Array,oe=p.bigIntEnabled??!!j,K=p.pointerIR||p.ptrIR||"i32",S=p.ptrSize||(K==="i32"?4:8);K!=="i32"&&K!=="i64"&&a("Invalid pointer representation:",K),S!==4&&S!==8&&a("Invalid pointer size:",S);const I=oe&&R?L=>R(L||0):L=>a("BigInt support is disabled in this build."),T=K=="i32"?Number:I,D=T(0),F=function(...L){let se=D;for(let pe=0;pe<L.length;++pe)se+=T(L[pe]);return se};h.debugFlags||(h.__makeDebugFlags=function(L=null){L&&L.__flags&&(L=L.__flags);const se=function pe(we){return arguments.length===0?pe.__flags:(we<0?(delete pe.__flags.getter,delete pe.__flags.setter,delete pe.__flags.alloc,delete pe.__flags.dealloc):(pe.__flags.getter=(1&we)!==0,pe.__flags.setter=(2&we)!==0,pe.__flags.alloc=(4&we)!==0,pe.__flags.dealloc=(8&we)!==0),pe._flags)};return Object.defineProperty(se,"__flags",{iterable:!1,writable:!1,value:Object.create(L)}),L||se(0),se},h.debugFlags=h.__makeDebugFlags());const P=function(){const L=new ArrayBuffer(2);return new DataView(L).setInt16(0,256,!0),new Int16Array(L)[0]===256}(),$=L=>L[1]==="(",m=L=>L==="P",y=L=>$(L)?"p":L[0],A=function(L){switch(y(L)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return K;case"j":return"i64";case"f":return"float";case"d":return"double"}a("Unhandled signature IR:",L)},Z=j?()=>!0:()=>a("BigInt64Array is not available."),ne=function(L){switch(y(L)){case"p":case"P":case"s":{switch(S){case 4:return"getInt32";case 8:return Z()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return Z()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}a("Unhandled DataView getter for signature:",L)},me=function(L){switch(y(L)){case"p":case"P":case"s":{switch(S){case 4:return"setInt32";case 8:return Z()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return Z()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}a("Unhandled DataView setter for signature:",L)},ge=function(L){switch(y(L)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return I;case"p":case"P":case"s":switch(S){case 4:return Number;case 8:return I}break}a("Unhandled DataView set wrapper for signature:",L)},w=(L,se)=>L+"::"+se,u=function(L,se){return()=>a(w(L,se),"is read-only.")},f=new WeakMap,b="(pointer-is-external)",E=L=>typeof L=="number"&&L===(L|0)&&L>=0,ee=S===4?E:L=>typeof L=="bigint"&&L>=0||E(L),he=function(L,se,pe){if(pe||(pe=f.get(se)),pe){if(f.delete(se),Array.isArray(se.ondispose)){let we;for(;we=se.ondispose.shift();)try{we instanceof Function?we.call(se):we instanceof ue?we.dispose():ee(we)&&ae(we)}catch(je){console.warn("ondispose() for",L.structName,"@",pe,"threw. NOT propagating it.",je)}}else if(se.ondispose instanceof Function)try{se.ondispose()}catch(we){console.warn("ondispose() for",L.structName,"@",pe,"threw. NOT propagating it.",we)}delete se.ondispose,L.debugFlags.__flags.dealloc&&H("debug.dealloc:",se[b]?"EXTERNAL":"",L.structName,"instance:",L.structInfo.sizeof,"bytes @"+pe),se[b]||ae(pe)}},ie=L=>({configurable:!1,writable:!1,iterable:!1,value:L}),Ee=function(L,se,pe){let we=!pe;pe?Object.defineProperty(se,b,ie(pe)):(pe=M(L.structInfo.sizeof),pe||a("Allocation of",L.structName,"structure failed."));try{L.debugFlags.__flags.alloc&&H("debug.alloc:",we?"":"EXTERNAL",L.structName,"instance:",L.structInfo.sizeof,"bytes @"+pe),we&&C().fill(0,Number(pe),Number(pe)+L.structInfo.sizeof),f.set(se,pe)}catch(je){throw he(L,se,pe),je}},ye=function(){const L=this.pointer;return L?new Uint8Array(C().slice(Number(L),Number(L)+this.structInfo.sizeof)):null},xe=ie(L=>N+L+z),ze=function(L,se,pe=!0){let we=L.members[se];if(!we&&(N||z)){for(const je of Object.values(L.members))if(je.key===se){we=je;break}!we&&pe&&a(w(L.name,se),"is not a mapped struct member.")}return we},Xe=function L(se,pe,we=!1){L._||(L._=et=>et.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const je=ze(se.structInfo,pe,!0);return we?L._(je.signature):je.signature},O={configurable:!1,enumerable:!1,get:function(){return f.get(this)},set:()=>a("Cannot assign the 'pointer' property of a struct.")},G=ie(function(){const L=[];for(const se of Object.keys(this.structInfo.members))L.push(this.memberKey(se));return L}),J=new TextDecoder("utf-8"),fe=new TextEncoder,le=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,Se=function(L,se,pe){return S===8&&(se=Number(se),pe=Number(pe)),J.decode(L.buffer instanceof le?L.slice(se,pe):L.subarray(se,pe))},ve=function(L,se,pe=!1){const we=ze(L.structInfo,se,pe);return we&&we.signature.length===1&&we.signature[0]==="s"?we:!1},B=function(L){L.signature!=="s"&&a("Invalid member type signature for C-string value:",JSON.stringify(L))},k=function(se,pe){const we=ze(se.structInfo,pe,!0);B(we);const je=se[we.key];if(!je)return null;let et=je;const tt=C();for(;tt[et]!==0;++et);return je===et?"":Se(tt,je,et)},U=function(L,...se){L.ondispose?Array.isArray(L.ondispose)||(L.ondispose=[L.ondispose]):L.ondispose=[],L.ondispose.push(...se)},X=function(L){const se=fe.encode(L),pe=M(se.length+1);pe||a("Allocation error while duplicating string:",L);const we=C();return we.set(se,Number(pe)),we[F(pe,se.length)]=0,pe},re=function(L,se,pe){const we=ze(L.structInfo,se,!0);B(we);const je=X(pe);return L[we.key]=je,U(L,je),L},ue=function(se,pe){arguments[2]!==ie&&a("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:ie(se),structInfo:ie(pe)})};ue.prototype=Object.create(null,{dispose:ie(function(){he(this.constructor,this)}),lookupMember:ie(function(L,se=!0){return ze(this.structInfo,L,se)}),memberToJsString:ie(function(L){return k(this,L)}),memberIsString:ie(function(L,se=!0){return ve(this,L,se)}),memberKey:xe,memberKeys:G,memberSignature:ie(function(L,se=!1){return Xe(this,L,se)}),memoryDump:ie(ye),pointer:O,setMemberCString:ie(function(L,se){return re(this,L,se)})}),Object.assign(ue.prototype,{addOnDispose:function(...L){return U(this,...L),this}}),Object.defineProperties(ue,{allocCString:ie(X),isA:ie(L=>L instanceof ue),hasExternalPointer:ie(L=>L instanceof ue&&!!L[b]),memberKey:xe});const ke=function L(se,pe,we){if(!L._){L._={getters:{},setters:{},sw:{}};const ot=["i","c","C","p","P","s","f","d","v()"];oe&&ot.push("j"),ot.forEach(function(pt){L._.getters[pt]=ne(pt),L._.setters[pt]=me(pt),L._.sw[pt]=ge(pt)});const ds=/^[ipPsjfdcC]$/,ps=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;L.sigCheck=function(pt,hs,Kn,_n){Object.prototype.hasOwnProperty.call(pt,Kn)&&a(pt.structName,"already has a property named",Kn+"."),ds.test(_n)||ps.test(_n)||a("Malformed signature for",w(pt.structName,hs)+":",_n)}}const je=se.memberKey(pe);L.sigCheck(se.prototype,pe,je,we.signature),we.key=je,we.name=pe;const et=y(we.signature),tt=w(se.prototype.structName,je),He=se.prototype.debugFlags.__flags,$e=Object.create(null);$e.configurable=!1,$e.enumerable=!1,$e.get=function(){He.getter&&H("debug.getter:",L._.getters[et],"for",A(et),tt,"@",this.pointer,"+",we.offset,"sz",we.sizeof);let ot=new DataView(C().buffer,Number(this.pointer)+we.offset,we.sizeof)[L._.getters[et]](0,P);return He.getter&&H("debug.getter:",tt,"result =",ot),ot},we.readOnly?$e.set=u(se.prototype.structName,je):$e.set=function(ot){if(He.setter&&H("debug.setter:",L._.setters[et],"for",A(et),tt,"@",this.pointer,"+",we.offset,"sz",we.sizeof,ot),this.pointer||a("Cannot set struct property on disposed instance."),ot===null)ot=D;else for(;!ee(ot);){if(m(we.signature)&&ot instanceof ue){ot=ot.pointer||D,He.setter&&H("debug.setter:",tt,"resolved to",ot);break}a("Invalid value for pointer-type",tt+".")}new DataView(C().buffer,Number(this.pointer)+we.offset,we.sizeof)[L._.setters[et]](0,L._.sw[et](ot),P)},Object.defineProperty(se.prototype,je,$e)},Le=function L(se,pe){arguments.length===1?(pe=se,se=pe.name):pe.name||(pe.name=se),se||a("Struct name is required.");let we=!1;Object.keys(pe.members).forEach(He=>{const $e=pe.members[He];$e.sizeof?$e.sizeof===1?$e.signature==="c"||$e.signature==="C"||a("Unexpected sizeof==1 member",w(pe.name,He),"with signature",$e.signature):($e.sizeof%4!==0&&(console.warn("Invalid struct member description =",$e,"from",pe),a(se,"member",He,"sizeof is not aligned. sizeof="+$e.sizeof)),$e.offset%4!==0&&(console.warn("Invalid struct member description =",$e,"from",pe),a(se,"member",He,"offset is not aligned. offset="+$e.offset))):a(se,"member",He,"is missing sizeof."),(!we||we.offset<$e.offset)&&(we=$e)}),we?pe.sizeof<we.offset+we.sizeof&&a("Invalid struct config:",se,"max member offset ("+we.offset+") ","extends past end of struct (sizeof="+pe.sizeof+")."):a("No member property descriptions found.");const je=ie(h.__makeDebugFlags(L.debugFlags)),et=T(0),tt=function He($e){$e=T($e),this instanceof He?arguments.length?((Number.isNaN($e)||$e<=et)&&a("Invalid pointer value",arguments[0],"for",se,"constructor."),Ee(He,this,$e)):Ee(He,this):a("The",se,"constructor may only be called via 'new'.")};return Object.defineProperties(tt,{debugFlags:je,isA:ie(He=>He instanceof tt),memberKey:xe,memberKeys:G,methodInfoForKey:ie(function(He){}),structInfo:ie(pe),structName:ie(se)}),tt.prototype=new ue(se,pe,ie),Object.defineProperties(tt.prototype,{debugFlags:je,constructor:ie(tt)}),Object.keys(pe.members).forEach(He=>ke(tt,He,pe.members[He])),tt};return Le.StructType=ue,Le.config=p,Le.allocCString=X,Le.debugFlags||(Le.debugFlags=h.__makeDebugFlags(h.debugFlags)),Le},globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const p=(...S)=>{throw new Error(S.join(" "))},a=i.capi,o=i.wasm,h=i.util;globalThis.WhWasmUtilInstaller(o),delete globalThis.WhWasmUtilInstaller;const C={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(S,I)=>S[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:S=>S[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new o.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:S=>{let I;return(T,D,F,P)=>{try{const $=o.cArgvToJs(D,F);return I||(I=o.cArgvToJs(D,P)),S($,I)|0}catch($){return $.resultCode||a.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:S=>S[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new o.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(S,I)=>S[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:S=>S[0],callProxy:S=>(I,T,D,F,P)=>{S(I,T,o.cstrToJs(D),o.cstrToJs(F),P)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(o.exports.sqlite3_progress_handler&&C.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new o.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(S,I)=>S[0]}),"*"]]),o.exports.sqlite3_stmt_explain&&C.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),o.exports.sqlite3_set_authorizer&&C.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(S,I)=>S[0],callProxy:S=>(I,T,D,F,P,$)=>{try{return D=D&&o.cstrToJs(D),F=F&&o.cstrToJs(F),P=P&&o.cstrToJs(P),$=$&&o.cstrToJs($),S(I,T,D,F,P,$)|0}catch(m){return m.resultCode||a.SQLITE_ERROR}}}),"*"]]),o.exports.sqlite3_column_origin_name&&C.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),o.bigIntEnabled&&o.exports.sqlite3_declare_vtab&&C.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),o.bigIntEnabled&&o.exports.sqlite3_preupdate_hook&&C.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:S=>S[0],callProxy:S=>(I,T,D,F,P,$,m)=>{S(I,T,D,o.cstrToJs(F),o.cstrToJs(P),$,m)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),o.bigIntEnabled&&o.exports.sqlite3changegroup_add&&o.exports.sqlite3session_create&&o.exports.sqlite3_preupdate_hook){const S={signature:"i(ps)",callProxy:I=>(T,D)=>{try{return I(T,o.cstrToJs(D))|0}catch(F){return F.resultCode||a.SQLITE_ERROR}}};C.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new o.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new o.xWrap.FuncPtrAdapter({name:"xFilter",...S,contextKey:(I,T)=>I[0]}),"*"]])}i.StructBinder=globalThis.Jaccwabyt({heap:o.heap8u,alloc:o.alloc,dealloc:o.dealloc,bigIntEnabled:o.bigIntEnabled,pointerIR:o.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const S=o.xWrap.argAdapter("string");o.xWrap.argAdapter("string:flexible",F=>S(h.flexibleString(F))),o.xWrap.argAdapter("string:static",(function(F){return o.isPtr(F)?F:(F=""+F,this[F]||(this[F]=o.allocCString(F)))}).bind(Object.create(null)));const I=o.xWrap.argAdapter("*"),T=function(){};o.xWrap.argAdapter("sqlite3_filename",I)("sqlite3_context*",I)("sqlite3_value*",I)("void*",I)("sqlite3_changegroup*",I)("sqlite3_changeset_iter*",I)("sqlite3_session*",I)("sqlite3_stmt*",F=>{var P;return I(F instanceof(((P=i==null?void 0:i.oo1)==null?void 0:P.Stmt)||T)?F.pointer:F)})("sqlite3*",F=>{var P;return I(F instanceof(((P=i==null?void 0:i.oo1)==null?void 0:P.DB)||T)?F.pointer:F)})("sqlite3_vfs*",F=>typeof F=="string"?a.sqlite3_vfs_find(F)||i.SQLite3Error.toss(a.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",F):I(F instanceof(a.sqlite3_vfs||T)?F.pointer:F)),o.exports.sqlite3_declare_vtab&&o.xWrap.argAdapter("sqlite3_index_info*",F=>I(F instanceof(a.sqlite3_index_info||T)?F.pointer:F))("sqlite3_module*",F=>I(F instanceof(a.sqlite3_module||T)?F.pointer:F));const D=o.xWrap.resultAdapter("*");o.xWrap.resultAdapter("sqlite3*",D)("sqlite3_context*",D)("sqlite3_stmt*",D)("sqlite3_value*",D)("sqlite3_vfs*",D)("void*",D);for(const F of C.core)a[F[0]]=o.xWrap.apply(null,F);for(const F of C.wasmInternal)h[F[0]]=o.xWrap.apply(null,F);for(const F of C.int64)a[F[0]]=o.bigIntEnabled?o.xWrap.apply(null,F):()=>p(F[0]+"() is unavailable due to lack","of BigInt support in this build.");delete C.core,delete C.int64,delete C.wasmInternal,h.sqlite3__wasm_db_error=function(F,P,$){return F?(P instanceof i.WasmAllocError?(P=a.SQLITE_NOMEM,$=0):P instanceof Error&&($=$||""+P,P=P.resultCode||a.SQLITE_ERROR),a.sqlite3_set_errmsg(F,P,$)||P):a.SQLITE_MISUSE}}{const S=o.xCall("sqlite3__wasm_enum_json");S||p("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),o.ctype=JSON.parse(o.cstrToJs(S));const I=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];o.bigIntEnabled&&I.push("serialize","session","vtab");for(const F of I)for(const P of Object.entries(o.ctype[F]))a[P[0]]=P[1];o.functionEntry(a.SQLITE_WASM_DEALLOC)||p("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+a.SQLITE_WASM_DEALLOC+").");const T=Object.create(null);for(const F of["resultCodes"])for(const P of Object.entries(o.ctype[F]))T[P[1]]=P[0];a.sqlite3_js_rc_str=F=>T[F];const D=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!h.isUIThread(),sqlite3_index_info:!o.bigIntEnabled,sqlite3_index_constraint:!o.bigIntEnabled,sqlite3_index_orderby:!o.bigIntEnabled,sqlite3_index_constraint_usage:!o.bigIntEnabled});for(const F of o.ctype.structs)D[F.name]||(a[F.name]=i.StructBinder(F));if(a.sqlite3_index_info){for(const F of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])a.sqlite3_index_info[F]=a[F],delete a[F];a.sqlite3_vtab_config=o.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const M=(S,I,T)=>h.sqlite3__wasm_db_error(S,a.SQLITE_MISUSE,I+"() requires "+T+" argument"+(T===1?"":"s")+"."),ae=S=>h.sqlite3__wasm_db_error(S,a.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),H=S=>o.xWrap.argAdapter("sqlite3*")(S),N=S=>o.isPtr(S)?o.cstrToJs(S):S,z=(function(S,I){S=H(S);let T=this.dbMap.get(S);if(I)!T&&I>0&&this.dbMap.set(S,T=Object.create(null));else return this.dbMap.delete(S),T;return T}).bind(Object.assign(Object.create(null),{dbMap:new Map}));z.addCollation=function(S,I){const T=z(S,1);T.collation||(T.collation=new Set),T.collation.add(N(I).toLowerCase())},z._addUDF=function(S,I,T,D){I=N(I).toLowerCase();let F=D.get(I);F||D.set(I,F=new Set),F.add(T<0?-1:T)},z.addFunction=function(S,I,T){const D=z(S,1);D.udf||(D.udf=new Map),this._addUDF(S,I,T,D.udf)},o.exports.sqlite3_create_window_function&&(z.addWindowFunc=function(S,I,T){const D=z(S,1);D.wudf||(D.wudf=new Map),this._addUDF(S,I,T,D.wudf)}),z.cleanup=function(S){S=H(S);for(const D of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[F,P]=D;if(!o.exports[F])continue;const m=[S];m.length=P;try{a[F](...m)}catch(y){i.config.warn("close-time call of",F+"(",m,") threw:",y)}}const I=z(S,0);if(!I)return;if(I.collation){for(const D of I.collation)try{a.sqlite3_create_collation_v2(S,D,a.SQLITE_UTF8,0,0,0)}catch{}delete I.collation}let T;for(T=0;T<2;++T){const D=T?I.wudf:I.udf;if(!D)continue;const F=T?a.sqlite3_create_window_function:a.sqlite3_create_function_v2;for(const P of D){const $=P[0],m=P[1],y=[S,$,0,a.SQLITE_UTF8,0,0,0,0,0];T&&y.push(0);for(const A of m)try{y[2]=A,F.apply(null,y)}catch{}m.clear()}D.clear()}delete I.udf,delete I.wudf};{const S=o.xWrap("sqlite3_close_v2","int","sqlite3*");a.sqlite3_close_v2=function(I){if(arguments.length!==1)return M(I,"sqlite3_close_v2",1);if(I)try{z.cleanup(I)}catch{}return S(I)}}if(a.sqlite3session_create){const S=o.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);a.sqlite3session_delete=function(I){if(arguments.length!==1)return M(pDb,"sqlite3session_delete",1);I&&a.sqlite3session_table_filter(I,0,0),S(I)}}{const S=(T,D)=>"argv["+D+"]:"+T[0]+":"+o.cstrToJs(T[1]).toLowerCase(),I=o.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new o.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:S}),new o.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:S})]);a.sqlite3_create_collation_v2=function(T,D,F,P,$,m){if(arguments.length!==6)return M(T,"sqlite3_create_collation_v2",6);if(!(F&15))F|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(F&15))return ae(T);try{const y=I(T,D,F,P,$,m);return y===0&&$ instanceof Function&&z.addCollation(T,D),y}catch(y){return h.sqlite3__wasm_db_error(T,y)}},a.sqlite3_create_collation=(T,D,F,P,$)=>arguments.length===5?a.sqlite3_create_collation_v2(T,D,F,P,$,0):M(T,"sqlite3_create_collation",5)}{const S=function(F,P){return F[0]+":"+(F[2]<0?-1:F[2])+":"+P+":"+o.cstrToJs(F[1]).toLowerCase()},I=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:S,callProxy:F=>(P,$,m)=>{try{F(P,...a.sqlite3_values_to_js($,m))}catch(y){a.sqlite3_result_error_js(P,y)}}},xFinalAndValue:{signature:"v(p)",contextKey:S,callProxy:F=>P=>{try{a.sqlite3_result_js(P,F(P))}catch($){a.sqlite3_result_error_js(P,$)}}},xFunc:{signature:"v(pip)",contextKey:S,callProxy:F=>(P,$,m)=>{try{a.sqlite3_result_js(P,F(P,...a.sqlite3_values_to_js($,m)))}catch(y){a.sqlite3_result_error_js(P,y)}}},xDestroy:{signature:"v(p)",contextKey:S,callProxy:F=>P=>{try{F(P)}catch($){console.error("UDF xDestroy method threw:",$)}}}}),T=o.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new o.xWrap.FuncPtrAdapter({name:"xFunc",...I.xFunc}),new o.xWrap.FuncPtrAdapter({name:"xStep",...I.xInverseAndStep}),new o.xWrap.FuncPtrAdapter({name:"xFinal",...I.xFinalAndValue}),new o.xWrap.FuncPtrAdapter({name:"xDestroy",...I.xDestroy})]),D=o.exports.sqlite3_create_window_function?o.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new o.xWrap.FuncPtrAdapter({name:"xStep",...I.xInverseAndStep}),new o.xWrap.FuncPtrAdapter({name:"xFinal",...I.xFinalAndValue}),new o.xWrap.FuncPtrAdapter({name:"xValue",...I.xFinalAndValue}),new o.xWrap.FuncPtrAdapter({name:"xInverse",...I.xInverseAndStep}),new o.xWrap.FuncPtrAdapter({name:"xDestroy",...I.xDestroy})]):void 0;a.sqlite3_create_function_v2=function F(P,$,m,y,A,Z,ne,me,ge){if(F.length!==arguments.length)return M(P,"sqlite3_create_function_v2",F.length);if(!(y&15))y|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(y&15))return ae(P);try{const w=T(P,$,m,y,A,Z,ne,me,ge);return w===0&&(Z instanceof Function||ne instanceof Function||me instanceof Function||ge instanceof Function)&&z.addFunction(P,$,m),w}catch(w){return console.error("sqlite3_create_function_v2() setup threw:",w),h.sqlite3__wasm_db_error(P,w,"Creation of UDF threw: "+w)}},a.sqlite3_create_function=function F(P,$,m,y,A,Z,ne,me){return F.length===arguments.length?a.sqlite3_create_function_v2(P,$,m,y,A,Z,ne,me,0):M(P,"sqlite3_create_function",F.length)},D?a.sqlite3_create_window_function=function F(P,$,m,y,A,Z,ne,me,ge,w){if(F.length!==arguments.length)return M(P,"sqlite3_create_window_function",F.length);if(!(y&15))y|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(y&15))return ae(P);try{const u=D(P,$,m,y,A,Z,ne,me,ge,w);return u===0&&(Z instanceof Function||ne instanceof Function||me instanceof Function||ge instanceof Function||w instanceof Function)&&z.addWindowFunc(P,$,m),u}catch(u){return console.error("sqlite3_create_window_function() setup threw:",u),h.sqlite3__wasm_db_error(P,u,"Creation of UDF threw: "+u)}}:delete a.sqlite3_create_window_function,a.sqlite3_create_function_v2.udfSetResult=a.sqlite3_create_function.udfSetResult=a.sqlite3_result_js,a.sqlite3_create_window_function&&(a.sqlite3_create_window_function.udfSetResult=a.sqlite3_result_js),a.sqlite3_create_function_v2.udfConvertArgs=a.sqlite3_create_function.udfConvertArgs=a.sqlite3_values_to_js,a.sqlite3_create_window_function&&(a.sqlite3_create_window_function.udfConvertArgs=a.sqlite3_values_to_js),a.sqlite3_create_function_v2.udfSetError=a.sqlite3_create_function.udfSetError=a.sqlite3_result_error_js,a.sqlite3_create_window_function&&(a.sqlite3_create_window_function.udfSetError=a.sqlite3_result_error_js)}{const S=(T,D)=>(typeof T=="string"?D=-1:h.isSQLableTypedArray(T)?(D=T.byteLength,T=o.typedArrayToString(T instanceof ArrayBuffer?new Uint8Array(T):T)):Array.isArray(T)&&(T=T.join(""),D=-1),[T,D]),I={basic:o.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:o.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};a.sqlite3_prepare_v3=function T(D,F,P,$,m,y){if(T.length!==arguments.length)return M(D,"sqlite3_prepare_v3",T.length);const[A,Z]=S(F,Number(P));switch(typeof A){case"string":return I.basic(D,A,Z,$,m,null);case typeof o.ptr.null:return I.full(D,o.ptr.coerce(A),Z,$,m,y);default:return h.sqlite3__wasm_db_error(D,a.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof A)}},a.sqlite3_prepare_v2=function T(D,F,P,$,m){return T.length===arguments.length?a.sqlite3_prepare_v3(D,F,P,0,$,m):M(D,"sqlite3_prepare_v2",T.length)}}{const S=o.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),I=o.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);a.sqlite3_bind_text=function T(D,F,P,$,m){if(T.length!==arguments.length)return M(a.sqlite3_db_handle(D),"sqlite3_bind_text",T.length);if(o.isPtr(P)||P===null)return S(D,F,P,$,m);P instanceof ArrayBuffer?P=new Uint8Array(P):Array.isArray(pMem)&&(P=pMem.join(""));let y,A;try{if(h.isSQLableTypedArray(P))y=o.allocFromTypedArray(P),A=P.byteLength;else if(typeof P=="string")[y,A]=o.allocCString(P);else return h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return S(D,F,y,A,a.SQLITE_WASM_DEALLOC)}catch(Z){return o.dealloc(y),h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),Z)}},a.sqlite3_bind_blob=function T(D,F,P,$,m){if(T.length!==arguments.length)return M(a.sqlite3_db_handle(D),"sqlite3_bind_blob",T.length);if(o.isPtr(P)||P===null)return I(D,F,P,$,m);P instanceof ArrayBuffer?P=new Uint8Array(P):Array.isArray(P)&&(P=P.join(""));let y,A;try{if(h.isBindableTypedArray(P))y=o.allocFromTypedArray(P),A=$>=0?$:P.byteLength;else if(typeof P=="string")[y,A]=o.allocCString(P);else return h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return I(D,F,y,A,a.SQLITE_WASM_DEALLOC)}catch(Z){return o.dealloc(y),h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),Z)}}}a.sqlite3_config=function(S,...I){if(arguments.length<2)return a.SQLITE_MISUSE;switch(S){case a.SQLITE_CONFIG_COVERING_INDEX_SCAN:case a.SQLITE_CONFIG_MEMSTATUS:case a.SQLITE_CONFIG_SMALL_MALLOC:case a.SQLITE_CONFIG_SORTERREF_SIZE:case a.SQLITE_CONFIG_STMTJRNL_SPILL:case a.SQLITE_CONFIG_URI:return o.exports.sqlite3__wasm_config_i(S,I[0]);case a.SQLITE_CONFIG_LOOKASIDE:return o.exports.sqlite3__wasm_config_ii(S,I[0],I[1]);case a.SQLITE_CONFIG_MEMDB_MAXSIZE:return o.exports.sqlite3__wasm_config_j(S,I[0]);case a.SQLITE_CONFIG_GETMALLOC:case a.SQLITE_CONFIG_GETMUTEX:case a.SQLITE_CONFIG_GETPCACHE2:case a.SQLITE_CONFIG_GETPCACHE:case a.SQLITE_CONFIG_HEAP:case a.SQLITE_CONFIG_LOG:case a.SQLITE_CONFIG_MALLOC:case a.SQLITE_CONFIG_MMAP_SIZE:case a.SQLITE_CONFIG_MULTITHREAD:case a.SQLITE_CONFIG_MUTEX:case a.SQLITE_CONFIG_PAGECACHE:case a.SQLITE_CONFIG_PCACHE2:case a.SQLITE_CONFIG_PCACHE:case a.SQLITE_CONFIG_PCACHE_HDRSZ:case a.SQLITE_CONFIG_PMASZ:case a.SQLITE_CONFIG_SERIALIZED:case a.SQLITE_CONFIG_SINGLETHREAD:case a.SQLITE_CONFIG_SQLLOG:case a.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return a.SQLITE_NOTFOUND}};{const S=new Set;a.sqlite3_auto_extension=function(I){if(I instanceof Function)I=o.installFunction("i(ppp)",I);else if(arguments.length!==1||!o.isPtr(I))return a.SQLITE_MISUSE;const T=o.exports.sqlite3_auto_extension(I);return I!==arguments[0]&&(T===0?S.add(I):o.uninstallFunction(I)),T},a.sqlite3_cancel_auto_extension=function(I){return!I||arguments.length!==1||!o.isPtr(I)?0:o.exports.sqlite3_cancel_auto_extension(I)},a.sqlite3_reset_auto_extension=function(){o.exports.sqlite3_reset_auto_extension();for(const I of S)o.uninstallFunction(I);S.clear()}}const R=a.sqlite3_vfs_find("kvvfs");if(R)if(h.isUIThread()){const S=new a.sqlite3_kvvfs_methods(o.exports.sqlite3__wasm_kvvfs_methods());delete a.sqlite3_kvvfs_methods;const I=o.exports.sqlite3__wasm_kvvfsMakeKeyOnPstack,T=o.pstack,D=P=>o.peek(P)===115?sessionStorage:localStorage,F={xRead:(P,$,m,y)=>{const A=T.pointer,Z=o.scopedAllocPush();try{const ne=I(P,$);if(!ne)return-3;const me=o.cstrToJs(ne),ge=D(P).getItem(me);if(!ge)return-1;const w=ge.length;if(y<=0)return w;if(y===1)return o.poke(m,0),w;const u=o.scopedAllocCString(ge);return y>w+1&&(y=w+1),o.heap8u().copyWithin(Number(m),Number(u),o.ptr.addn(u,y,-1)),o.poke(o.ptr.add(m,y,-1),0),y-1}catch(ne){return i.config.error("kvstorageRead()",ne),-2}finally{T.restore(A),o.scopedAllocPop(Z)}},xWrite:(P,$,m)=>{const y=T.pointer;try{const A=I(P,$);if(!A)return 1;const Z=o.cstrToJs(A);return D(P).setItem(Z,o.cstrToJs(m)),0}catch(A){return i.config.error("kvstorageWrite()",A),a.SQLITE_IOERR}finally{T.restore(y)}},xDelete:(P,$)=>{const m=T.pointer;try{const y=I(P,$);return y?(D(P).removeItem(o.cstrToJs(y)),0):1}catch(y){return i.config.error("kvstorageDelete()",y),a.SQLITE_IOERR}finally{T.restore(m)}}};for(const P of Object.keys(F))S[S.memberKey(P)]=o.installFunction(S.memberSignature(P),F[P])}else a.sqlite3_vfs_unregister(R);o.xWrap.FuncPtrAdapter.warnOnUse=!0;const j=i.StructBinder,oe=function S(I,T,D,F=S.installMethodArgcCheck){if(I instanceof j.StructType?!(D instanceof Function)&&!o.isPtr(D)&&p("Usage error: expecting a Function or WASM pointer to one."):p("Usage error: target object is-not-a StructType."),arguments.length===1)return(y,A)=>S(I,y,A,F);S.argcProxy||(S.argcProxy=function(y,A,Z,ne){return function(...me){return Z.length!==arguments.length&&p("Argument mismatch for",y.structInfo.name+"::"+A+": Native signature is:",ne),Z.apply(this,me)}},S.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((y,A)=>{if(o.isPtr(y))try{o.uninstallFunction(y)}catch{}}),delete this.ondispose.__removeFuncList)});const P=I.memberSignature(T);P.length<2&&p("Member",T,"does not have a function pointer signature:",P);const $=I.memberKey(T),m=F&&!o.isPtr(D)?S.argcProxy(I,$,D,P):D;if(o.isPtr(m))m&&!o.functionEntry(m)&&p("Pointer",m,"is not a WASM function table entry."),I[$]=m;else{const y=o.installFunction(m,I.memberSignature(T));I[$]=y,(!I.ondispose||!I.ondispose.__removeFuncList)&&(I.addOnDispose("ondispose.__removeFuncList handler",S.removeFuncList),I.ondispose.__removeFuncList=[]),I.ondispose.__removeFuncList.push($,y)}return(y,A)=>S(I,y,A,F)};oe.installMethodArgcCheck=!1;const K=function(S,I,T=oe.installMethodArgcCheck){const D=new Map;for(const F of Object.keys(I)){const P=I[F],$=D.get(P);if($){const m=S.memberKey(F);S[m]=S[S.memberKey($)]}else oe(S,F,P,T),D.set(P,F)}return S};j.StructType.prototype.installMethod=function(I,T,D=oe.installMethodArgcCheck){return arguments.length<3&&I&&typeof I=="object"?K(this,...arguments):oe(this,...arguments)},j.StructType.prototype.installMethods=function(S,I=oe.installMethodArgcCheck){return K(this,S,I)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.version={libVersion:"3.51.0",libVersionNumber:3051e3,sourceId:"2025-11-04 19:38:17 fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",downloadVersion:351e4,scm:{"sha3-256":"fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",branch:"trunk",tags:"release major-release version-3.51.0",datetime:"2025-11-04T19:38:17.314Z"}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const p=(...w)=>{throw new i.SQLite3Error(...w)},a=i.capi,o=i.wasm,h=i.util,C=new WeakMap,M=new Set,ae=new WeakMap,H=(w,u,f)=>{const b=Object.getOwnPropertyDescriptor(w,u);return b?b.value:f},N=function(w,u){return u&&(w instanceof oe&&(w=w.pointer),p(u,"sqlite3 result code",u+":",w?a.sqlite3_errmsg(w):a.sqlite3_errstr(u))),arguments[0]},z=o.installFunction("i(ippp)",(function(w,u,f,b){a.SQLITE_TRACE_STMT===w&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+u+":",o.cstrToJs(b))}).bind({counter:0})),R=Object.create(null),j=function w(...u){if(!w._name2vfs){w._name2vfs=Object.create(null);const E=typeof importScripts=="function"?Q=>p("The VFS for",Q,"is only available in the main window thread."):!1;w._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:E||(()=>"local")},w._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:E||(()=>"session")}}const f=w.normalizeArgs(...u);let b;if(b=f["sqlite3*"])f["sqlite3*:takeOwnership"]||M.add(this),this.filename=a.sqlite3_db_filename(b,"main");else{let E=f.filename,Q=f.vfs,ee=f.flags;(typeof E!="string"&&!o.isPtr(E)||typeof ee!="string"||Q&&typeof Q!="string"&&!o.isPtr(Q))&&(i.config.error("Invalid DB ctor args",f,arguments),p("Invalid arguments for DB constructor:",arguments,"opts:",f));let he=o.isPtr(E)?o.cstrToJs(E):E;const ie=w._name2vfs[he];ie&&(Q=ie.vfs,E=he=ie.filename(he));let Ee=0;ee.indexOf("c")>=0&&(Ee|=a.SQLITE_OPEN_CREATE|a.SQLITE_OPEN_READWRITE),ee.indexOf("w")>=0&&(Ee|=a.SQLITE_OPEN_READWRITE),Ee===0&&(Ee|=a.SQLITE_OPEN_READONLY),Ee|=a.SQLITE_OPEN_EXRESCODE;const ye=o.pstack.pointer;try{const Pe=o.pstack.allocPtr();let xe=a.sqlite3_open_v2(E,Pe,Ee,Q||o.ptr.null);b=o.peekPtr(Pe),N(b,xe),a.sqlite3_extended_result_codes(b,1),ee.indexOf("t")>=0&&a.sqlite3_trace_v2(b,a.SQLITE_TRACE_STMT,z,b)}catch(Pe){throw b&&a.sqlite3_close_v2(b),Pe}finally{o.pstack.restore(ye)}this.filename=he}if(C.set(this,b),ae.set(this,Object.create(null)),!f["sqlite3*"])try{const E=a.sqlite3_js_db_vfs(b)||p("Internal error: cannot get VFS for new db handle."),Q=R[E];Q&&(Q instanceof Function?Q(this,i):N(b,a.sqlite3_exec(b,Q,0,0,0)))}catch(E){throw this.close(),E}};j.setVfsPostOpenCallback=function(w,u){u instanceof Function||p("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),R[w]=u},j.normalizeArgs=function(w=":memory:",u="c",f=null){const b={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(b,arguments[0]),b.flags===void 0&&(b.flags="c"),b.vfs===void 0&&(b.vfs=null),b.filename===void 0&&(b.filename=":memory:")):(b.filename=w,b.flags=u,b.vfs=f),b};const oe=function(...w){j.apply(this,w)};oe.dbCtorHelper=j;const K={null:1,number:2,string:3,boolean:4,blob:5};o.bigIntEnabled&&(K.bigint=K.number);const S=function(){K!==arguments[2]&&p(a.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],C.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&M.add(this)},I=function(w){return w.pointer||p("DB has been closed."),w},T=function(w,u){return(u!==(u|0)||u<0||u>=w.columnCount)&&p("Column index",u,"is out of range."),w},D=function(w,u){const f=Object.create(null);switch(f.opt=Object.create(null),u.length){case 1:typeof u[0]=="string"||h.isSQLableTypedArray(u[0])||Array.isArray(u[0])?f.sql=u[0]:u[0]&&typeof u[0]=="object"&&(f.opt=u[0],f.sql=f.opt.sql);break;case 2:f.sql=u[0],f.opt=u[1];break;default:p("Invalid argument count for exec().")}f.sql=h.flexibleString(f.sql),typeof f.sql!="string"&&p("Missing SQL argument or unsupported SQL value type.");const b=f.opt;switch(b.returnValue){case"resultRows":b.resultRows||(b.resultRows=[]),f.returnVal=()=>b.resultRows;break;case"saveSql":b.saveSql||(b.saveSql=[]),f.returnVal=()=>b.saveSql;break;case void 0:case"this":f.returnVal=()=>w;break;default:p("Invalid returnValue value:",b.returnValue)}if(!b.callback&&!b.returnValue&&b.rowMode!==void 0&&(b.resultRows||(b.resultRows=[]),f.returnVal=()=>b.resultRows),b.callback||b.resultRows)switch(b.rowMode===void 0?"array":b.rowMode){case"object":f.cbArg=(E,Q)=>{Q.columnNames||(Q.columnNames=E.getColumnNames([]));const ee=E.get([]),he=Object.create(null);for(const ie in Q.columnNames)he[Q.columnNames[ie]]=ee[ie];return he};break;case"array":f.cbArg=E=>E.get([]);break;case"stmt":Array.isArray(b.resultRows)&&p("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),f.cbArg=E=>E;break;default:if(h.isInt32(b.rowMode)){f.cbArg=E=>E.get(b.rowMode);break}else if(typeof b.rowMode=="string"&&b.rowMode.length>1&&b.rowMode[0]==="$"){const E=b.rowMode.substr(1);f.cbArg=Q=>{const ee=Q.get(Object.create(null))[E];return ee===void 0?p(a.SQLITE_NOTFOUND,"exec(): unknown result column:",E):ee};break}p("Invalid rowMode:",b.rowMode)}return f},F=(w,u,f,...b)=>{const E=w.prepare(u);try{const Q=E.bind(f).step()?E.get(...b):void 0;return E.reset(),Q}finally{E.finalize()}},P=(w,u,f,b)=>w.exec({sql:u,bind:f,rowMode:b,returnValue:"resultRows"});oe.checkRc=(w,u)=>N(w,u),oe.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return I(this)},close:function(){const w=this.pointer;if(w){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(ae.get(this)).forEach((u,f)=>{if(f&&f.pointer)try{f.finalize()}catch{}}),C.delete(this),ae.delete(this),M.delete(this)||a.sqlite3_close_v2(w),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(w=!1,u=!1){const f=I(this).pointer;return w?u?a.sqlite3_total_changes64(f):a.sqlite3_total_changes(f):u?a.sqlite3_changes64(f):a.sqlite3_changes(f)},dbFilename:function(w="main"){return a.sqlite3_db_filename(I(this).pointer,w)},dbName:function(w=0){return a.sqlite3_db_name(I(this).pointer,w)},dbVfsName:function(w=0){let u;const f=a.sqlite3_js_db_vfs(I(this).pointer,w);if(f){const b=new a.sqlite3_vfs(f);try{u=o.cstrToJs(b.$zName)}finally{b.dispose()}}return u},prepare:function(w){I(this);const u=o.pstack.pointer;let f,b;try{f=o.pstack.alloc(8),oe.checkRc(this,a.sqlite3_prepare_v2(this.pointer,w,-1,f,null)),b=o.peekPtr(f)}finally{o.pstack.restore(u)}b||p("Cannot prepare empty SQL.");const E=new S(this,b,K);return ae.get(this)[b]=E,E},exec:function(){I(this);const w=D(this,arguments);if(!w.sql)return p("exec() requires an SQL string.");const u=w.opt,f=u.callback,b=Array.isArray(u.resultRows)?u.resultRows:void 0;let E,Q=u.bind,ee=!!(w.cbArg||u.columnNames||b);const he=o.scopedAllocPush(),ie=Array.isArray(u.saveSql)?u.saveSql:void 0;try{const Ee=h.isSQLableTypedArray(w.sql);let ye=Ee?w.sql.byteLength:o.jstrlen(w.sql);const Pe=o.scopedAlloc(2*o.ptr.size+(ye+1)),xe=o.ptr.add(Pe,o.ptr.size);let ze=o.ptr.add(xe,o.ptr.size);const Xe=o.ptr.add(ze,ye);for(Ee?o.heap8().set(w.sql,ze):o.jstrcpy(w.sql,o.heap8(),ze,ye,!1),o.poke(o.ptr.add(ze,ye),0);ze&&o.peek(ze,"i8");){o.pokePtr([Pe,xe],0),oe.checkRc(this,a.sqlite3_prepare_v3(this.pointer,ze,ye,0,Pe,xe));const O=o.peekPtr(Pe);if(ze=o.peekPtr(xe),ye=Number(o.ptr.add(Xe,-ze)),!!O){if(ie&&ie.push(a.sqlite3_sql(O).trim()),E=new S(this,O,K),Q&&E.parameterCount&&(E.bind(Q),Q=null),ee&&E.columnCount){let G=Array.isArray(u.columnNames)?0:1;if(ee=!1,w.cbArg||b){const J=Object.create(null);for(;E.step();Z.delete(E)){G++===0&&E.getColumnNames(J.columnNames=u.columnNames||[]),Z.add(E);const fe=w.cbArg(E,J);if(b&&b.push(fe),f&&f.call(u,fe,E)===!1)break}Z.delete(E)}G===0&&E.getColumnNames(u.columnNames)}else E.step();E.reset().finalize(),E=null}}}finally{o.scopedAllocPop(he),E&&(Z.delete(E),E.finalize())}return w.returnVal()},createFunction:function(u,f,b){const E=J=>J instanceof Function;switch(arguments.length){case 1:b=u,u=b.name,f=b.xFunc||0;break;case 2:E(f)||(b=f,f=b.xFunc||0);break}b||(b={}),typeof u!="string"&&p("Invalid arguments: missing function name.");let Q=b.xStep||0,ee=b.xFinal||0;const he=b.xValue||0,ie=b.xInverse||0;let Ee;E(f)?(Ee=!1,(E(Q)||E(ee))&&p("Ambiguous arguments: scalar or aggregate?"),Q=ee=null):E(Q)?(E(ee)||p("Missing xFinal() callback for aggregate or window UDF."),f=null):E(ee)?p("Missing xStep() callback for aggregate or window UDF."):p("Missing function-type properties."),Ee===!1?(E(he)||E(ie))&&p("xValue and xInverse are not permitted for non-window UDFs."):E(he)?(E(ie)||p("xInverse must be provided if xValue is."),Ee=!0):E(ie)&&p("xValue must be provided if xInverse is.");const ye=b.pApp;ye!=null&&!o.isPtr(ye)&&p("Invalid value for pApp property. Must be a legal WASM pointer value.");const Pe=b.xDestroy||0;Pe&&!E(Pe)&&p("xDestroy property must be a function.");let xe=0;H(b,"deterministic")&&(xe|=a.SQLITE_DETERMINISTIC),H(b,"directOnly")&&(xe|=a.SQLITE_DIRECTONLY),H(b,"innocuous")&&(xe|=a.SQLITE_INNOCUOUS),u=u.toLowerCase();const ze=f||Q,Xe=H(b,"arity"),O=typeof Xe=="number"?Xe:ze.length?ze.length-1:0;let G;return Ee?G=a.sqlite3_create_window_function(this.pointer,u,O,a.SQLITE_UTF8|xe,ye||0,Q,ee,he,ie,Pe):G=a.sqlite3_create_function_v2(this.pointer,u,O,a.SQLITE_UTF8|xe,ye||0,f,Q,ee,Pe),oe.checkRc(this,G),this},selectValue:function(w,u,f){return F(this,w,u,0,f)},selectValues:function(w,u,f){const b=this.prepare(w),E=[];try{for(b.bind(u);b.step();)E.push(b.get(0,f));b.reset()}finally{b.finalize()}return E},selectArray:function(w,u){return F(this,w,u,[])},selectObject:function(w,u){return F(this,w,u,{})},selectArrays:function(w,u){return P(this,w,u,"array")},selectObjects:function(w,u){return P(this,w,u,"object")},openStatementCount:function(){return this.pointer?Object.keys(ae.get(this)).length:0},transaction:function(w){let u="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&p(a.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),u+=" "+arguments[0],w=arguments[1]),I(this).exec(u);try{const f=w(this);return this.exec("COMMIT"),f}catch(f){throw this.exec("ROLLBACK"),f}},savepoint:function(w){I(this).exec("SAVEPOINT oo1");try{const u=w(this);return this.exec("RELEASE oo1"),u}catch(u){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),u}},checkRc:function(w){return N(this,w)}},oe.wrapHandle=function(w,u=!1){if(!w||!o.isPtr(w))throw new i.SQLite3Error(a.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new oe({"sqlite3*":w,"sqlite3*:takeOwnership":!!u})};const $=function(w){return w.pointer||p("Stmt has been closed."),w},m=function(w){let u=K[w==null?"null":typeof w];switch(u){case K.boolean:case K.null:case K.number:case K.string:return u;case K.bigint:return o.bigIntEnabled?u:void 0;default:return h.isBindableTypedArray(w)?K.blob:void 0}},y=function(w){return m(w)||p("Unsupported bind() argument type:",typeof w)},A=function(w,u){const f=typeof u=="number"?u:a.sqlite3_bind_parameter_index(w.pointer,u);return f===0||!h.isInt32(f)?p("Invalid bind() parameter name: "+u):(f<1||f>w.parameterCount)&&p("Bind index",u,"is out of range."),f},Z=new Set,ne=new Set,me=function(w,u){return Z.has(w)&&p("Operation is illegal when statement is locked:",u),w},ge=function w(u,f,b,E){me($(u),"bind()"),w._||(w._tooBigInt=ee=>p("BigInt value is too big to store without precision loss:",ee),w._={string:function(ee,he,ie,Ee){const[ye,Pe]=o.allocCString(ie,!0);return(Ee?a.sqlite3_bind_blob:a.sqlite3_bind_text)(ee.pointer,he,ye,Pe,a.SQLITE_WASM_DEALLOC)}}),y(E),f=A(u,f);let Q=0;switch(E==null?K.null:b){case K.null:Q=a.sqlite3_bind_null(u.pointer,f);break;case K.string:Q=w._.string(u,f,E,!1);break;case K.number:{let ee;h.isInt32(E)?ee=a.sqlite3_bind_int:typeof E=="bigint"?h.bigIntFits64(E)?o.bigIntEnabled?ee=a.sqlite3_bind_int64:h.bigIntFitsDouble(E)?(E=Number(E),ee=a.sqlite3_bind_double):w._tooBigInt(E):w._tooBigInt(E):(E=Number(E),o.bigIntEnabled&&Number.isInteger(E)?ee=a.sqlite3_bind_int64:ee=a.sqlite3_bind_double),Q=ee(u.pointer,f,E);break}case K.boolean:Q=a.sqlite3_bind_int(u.pointer,f,E?1:0);break;case K.blob:{if(typeof E=="string"){Q=w._.string(u,f,E,!0);break}else E instanceof ArrayBuffer?E=new Uint8Array(E):h.isBindableTypedArray(E)||p("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const ee=o.alloc(E.byteLength||1);o.heap8().set(E.byteLength?E:[0],Number(ee)),Q=a.sqlite3_bind_blob(u.pointer,f,ee,E.byteLength,a.SQLITE_WASM_DEALLOC);break}default:i.config.warn("Unsupported bind() argument type:",E),p("Unsupported bind() argument type: "+typeof E)}return Q&&oe.checkRc(u.db.pointer,Q),u};S.prototype={finalize:function(){const w=this.pointer;if(w){me(this,"finalize()");const u=M.delete(this)?0:a.sqlite3_finalize(w);return delete ae.get(this.db)[w],C.delete(this),Z.delete(this),ne.delete(this),delete this.parameterCount,delete this.db,u}},clearBindings:function(){return me($(this),"clearBindings()"),a.sqlite3_clear_bindings(this.pointer),ne.delete(this),this},reset:function(w){me(this,"reset()"),w&&this.clearBindings();const u=a.sqlite3_reset($(this).pointer);return ne.delete(this),N(this.db,u),this},bind:function(){$(this);let w,u;switch(arguments.length){case 1:w=1,u=arguments[0];break;case 2:w=arguments[0],u=arguments[1];break;default:p("Invalid bind() arguments.")}return u===void 0?this:(this.parameterCount||p("This statement has no bindable parameters."),ne.delete(this),u===null?ge(this,w,K.null,u):Array.isArray(u)?(arguments.length!==1&&p("When binding an array, an index argument is not permitted."),u.forEach((f,b)=>ge(this,b+1,y(f),f)),this):(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),typeof u=="object"&&!h.isBindableTypedArray(u)?(arguments.length!==1&&p("When binding an object, an index argument is not permitted."),Object.keys(u).forEach(f=>ge(this,f,y(u[f]),u[f])),this):ge(this,w,y(u),u)))},bindAsBlob:function(w,u){$(this),arguments.length===1&&(u=w,w=1);const f=y(u);return K.string!==f&&K.blob!==f&&K.null!==f&&p("Invalid value type for bindAsBlob()"),ge(this,w,K.blob,u)},step:function(){me(this,"step()");const w=a.sqlite3_step($(this).pointer);switch(w){case a.SQLITE_DONE:return ne.delete(this),!1;case a.SQLITE_ROW:return ne.add(this),!0;default:ne.delete(this),i.config.warn("sqlite3_step() rc=",w,a.sqlite3_js_rc_str(w),"SQL =",a.sqlite3_sql(this.pointer)),oe.checkRc(this.db.pointer,w)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const w=this.step();return this.reset(),w}finally{try{this.finalize()}catch{}}},get:function(w,u){if(ne.has($(this))||p("Stmt.step() has not (recently) returned true."),Array.isArray(w)){let f=0;const b=this.columnCount;for(;f<b;)w[f]=this.get(f++);return w}else if(w&&typeof w=="object"){let f=0;const b=this.columnCount;for(;f<b;)w[a.sqlite3_column_name(this.pointer,f)]=this.get(f++);return w}switch(T(this,w),u===void 0?a.sqlite3_column_type(this.pointer,w):u){case a.SQLITE_NULL:return null;case a.SQLITE_INTEGER:if(o.bigIntEnabled){const f=a.sqlite3_column_int64(this.pointer,w);return f>=Number.MIN_SAFE_INTEGER&&f<=Number.MAX_SAFE_INTEGER?Number(f).valueOf():f}else{const f=a.sqlite3_column_double(this.pointer,w);return(f>Number.MAX_SAFE_INTEGER||f<Number.MIN_SAFE_INTEGER)&&p("Integer is out of range for JS integer range: "+f),h.isInt32(f)?f|0:f}case a.SQLITE_FLOAT:return a.sqlite3_column_double(this.pointer,w);case a.SQLITE_TEXT:return a.sqlite3_column_text(this.pointer,w);case a.SQLITE_BLOB:{const f=a.sqlite3_column_bytes(this.pointer,w),b=a.sqlite3_column_blob(this.pointer,w),E=new Uint8Array(f);return f&&(E.set(o.heap8u().slice(Number(b),Number(b)+f),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(E.buffer)),E}default:p("Don't know how to translate","type of result column #"+w+".")}p("Not reached.")},getInt:function(w){return this.get(w,a.SQLITE_INTEGER)},getFloat:function(w){return this.get(w,a.SQLITE_FLOAT)},getString:function(w){return this.get(w,a.SQLITE_TEXT)},getBlob:function(w){return this.get(w,a.SQLITE_BLOB)},getJSON:function(w){const u=this.get(w,a.SQLITE_STRING);return u===null?u:JSON.parse(u)},getColumnName:function(w){return a.sqlite3_column_name(T($(this),w).pointer,w)},getColumnNames:function(w=[]){T($(this),0);const u=this.columnCount;for(let f=0;f<u;++f)w.push(a.sqlite3_column_name(this.pointer,f));return w},getParamIndex:function(w){return $(this).parameterCount?a.sqlite3_bind_parameter_index(this.pointer,w):void 0},getParamName:function(w){return $(this).parameterCount?a.sqlite3_bind_parameter_name(this.pointer,w):void 0},isBusy:function(){return a.sqlite3_stmt_busy($(this))!==0},isReadOnly:function(){return a.sqlite3_stmt_readonly($(this))!==0}};{const w={enumerable:!0,get:function(){return C.get(this)},set:()=>p("The pointer property is read-only.")};Object.defineProperty(S.prototype,"pointer",w),Object.defineProperty(oe.prototype,"pointer",w)}if(Object.defineProperty(S.prototype,"columnCount",{enumerable:!1,get:function(){return a.sqlite3_column_count(this.pointer)},set:()=>p("The columnCount property is read-only.")}),Object.defineProperty(S.prototype,"parameterCount",{enumerable:!1,get:function(){return a.sqlite3_bind_parameter_count(this.pointer)},set:()=>p("The parameterCount property is read-only.")}),S.wrapHandle=function(w,u,f=!1){if(!(w instanceof oe)||!w.pointer)throw new i.SQLite3Error(i.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!u||!o.isPtr(u))throw new i.SQLite3Error(i.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new S(w,u,K,!!f)},i.oo1={DB:oe,Stmt:S},h.isUIThread()){i.oo1.JsStorageDb=function(u="session"){const f=j.normalizeArgs(...arguments);u=f.filename,u!=="session"&&u!=="local"&&p("JsStorageDb db name must be one of 'session' or 'local'."),f.vfs="kvvfs",j.call(this,f)};const w=i.oo1.JsStorageDb;w.prototype=Object.create(oe.prototype),w.clearStorage=a.sqlite3_js_kvvfs_clear,w.prototype.clearStorage=function(){return w.clearStorage(I(this).filename)},w.storageSize=a.sqlite3_js_kvvfs_size,w.prototype.storageSize=function(){return w.storageSize(I(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const p=i.util;i.initWorker1API=(function(){const a=(...R)=>{throw new Error(R.join(" "))};globalThis.WorkerGlobalScope instanceof Function||a("initWorker1API() must be run from a Worker thread.");const o=this.sqlite3||a("Missing this.sqlite3 object."),h=o.oo1.DB,C=function(R){let j=M.idMap.get(R);return j||(j="db#"+ ++M.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),M.idMap.set(R,j),j)},M={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(R){const j=new h(R);return this.dbs[C(j)]=j,this.dbList.indexOf(j)<0&&this.dbList.push(j),j},close:function(R,j){if(R){delete this.dbs[C(R)];const oe=R.filename,K=p.sqlite3__wasm_db_vfs(R.pointer,0);R.close();const S=this.dbList.indexOf(R);S>=0&&this.dbList.splice(S,1),j&&oe&&K&&p.sqlite3__wasm_vfs_unlink(K,oe)}},post:function(R,j){j&&j.length?(globalThis.postMessage(R,Array.from(j)),j.length=0):globalThis.postMessage(R)},dbs:Object.create(null),getDb:function(R,j=!0){return this.dbs[R]||(j?a("Unknown (or closed) DB ID:",R):void 0)}},ae=function(R=M.dbList[0]){return R&&R.pointer?R:a("DB is not opened.")},H=function(R,j=!0){const oe=M.getDb(R.dbId,!1)||M.dbList[0];return j?ae(oe):oe},N=function(){return M.dbList[0]&&C(M.dbList[0])},z={open:function(R){const j=Object.create(null),oe=R.args||Object.create(null);oe.simulateError&&a("Throwing because of simulateError flag.");const K=Object.create(null);j.vfs=oe.vfs,j.filename=oe.filename||"";const S=M.open(j);return K.filename=S.filename,K.persistent=!!o.capi.sqlite3_js_db_uses_vfs(S.pointer,"opfs"),K.dbId=C(S),K.vfs=S.dbVfsName(),K},close:function(R){const j=H(R,!1),oe={filename:j&&j.filename};if(j){const K=R.args&&typeof R.args=="object"?!!R.args.unlink:!1;M.close(j,K)}return oe},exec:function(R){const j=typeof R.args=="string"?{sql:R.args}:R.args||Object.create(null);j.rowMode==="stmt"?a("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):j.sql||a("'exec' requires input SQL.");const oe=H(R);(j.callback||Array.isArray(j.resultRows))&&(oe._blobXfer=M.xfer);const K=j.callback;let S=0;const I=!!j.columnNames;typeof K=="string"&&(I||(j.columnNames=[]),j.callback=function(T,D){M.post({type:K,columnNames:j.columnNames,rowNumber:++S,row:T},M.xfer)});try{const T=j.countChanges?oe.changes(!0,j.countChanges===64):void 0;oe.exec(j),T!==void 0&&(j.changeCount=oe.changes(!0,j.countChanges===64)-T);const D=j.lastInsertRowId?o.capi.sqlite3_last_insert_rowid(oe):void 0;D!==void 0&&(j.lastInsertRowId=D),j.callback instanceof Function&&(j.callback=K,M.post({type:K,columnNames:j.columnNames,rowNumber:null,row:void 0}))}finally{delete oe._blobXfer,j.callback&&(j.callback=K)}return j},"config-get":function(){const R=Object.create(null),j=o.config;return["bigIntEnabled"].forEach(function(oe){Object.getOwnPropertyDescriptor(j,oe)&&(R[oe]=j[oe])}),R.version=o.version,R.vfsList=o.capi.sqlite3_js_vfs_list(),R},export:function(R){const j=H(R),oe={byteArray:o.capi.sqlite3_js_db_export(j.pointer),filename:j.filename,mimetype:"application/x-sqlite3"};return M.xfer.push(oe.byteArray.buffer),oe},toss:function(R){a("Testing worker exception")}};globalThis.onmessage=async function(R){R=R.data;let j,oe=R.dbId,K=R.type;const S=performance.now();try{z.hasOwnProperty(K)&&z[K]instanceof Function?j=await z[K](R):a("Unknown db worker message type:",R.type)}catch(I){K="error",j={operation:R.type,message:I.message,errorClass:I.name,input:R},I.stack&&(j.stack=typeof I.stack=="string"?I.stack.split(/\n\s*/):I.stack)}oe||(oe=j.dbId||N()),M.post({type:K,dbId:oe,messageId:R.messageId,workerReceivedTime:S,workerRespondTime:performance.now(),departureTime:R.departureTime,result:j},M.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:i})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const p=i.wasm,a=i.capi,o=i.util.toss3,h=Object.create(null);i.vfs=h,a.sqlite3_vfs.prototype.registerVfs=function(C=!1){this instanceof i.capi.sqlite3_vfs||o("Expecting a sqlite3_vfs-type argument.");const M=a.sqlite3_vfs_register(this,C?1:0);return M&&o("sqlite3_vfs_register(",this,") failed with rc",M),this.pointer!==a.sqlite3_vfs_find(this.$zName)&&o("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},h.installVfs=function(C){let M=0;const ae=["io","vfs"];for(const H of ae){const N=C[H];N&&(++M,N.struct.installMethods(N.methods,!!N.applyArgcCheck),H==="vfs"&&(!N.struct.$zName&&typeof N.name=="string"&&N.struct.addOnDispose(N.struct.$zName=p.allocCString(N.name)),N.struct.registerVfs(!!N.asDefault)))}return M||o("Misuse: installVfs() options object requires at least","one of:",ae),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){if(!i.wasm.exports.sqlite3_declare_vtab)return;const p=i.wasm,a=i.capi,o=i.util.toss3,h=Object.create(null);i.vtab=h;const C=a.sqlite3_index_info;C.prototype.nthConstraint=function(H,N=!1){if(H<0||H>=this.$nConstraint)return!1;const z=p.ptr.add(this.$aConstraint,C.sqlite3_index_constraint.structInfo.sizeof*H);return N?z:new C.sqlite3_index_constraint(z)},C.prototype.nthConstraintUsage=function(H,N=!1){if(H<0||H>=this.$nConstraint)return!1;const z=p.ptr.add(this.$aConstraintUsage,C.sqlite3_index_constraint_usage.structInfo.sizeof*H);return N?z:new C.sqlite3_index_constraint_usage(z)},C.prototype.nthOrderBy=function(H,N=!1){if(H<0||H>=this.$nOrderBy)return!1;const z=p.ptr.add(this.$aOrderBy,C.sqlite3_index_orderby.structInfo.sizeof*H);return N?z:new C.sqlite3_index_orderby(z)};const M=function(H,N){return(function(z,R=!1){if(arguments.length===0&&(z=new N),z instanceof N)return this.set(z.pointer,z),z;p.isPtr(z)||i.SQLite3Error.toss("Invalid argument to",H+"()");let j=this.get(z);return R&&this.delete(z),j}).bind(new Map)},ae=function(H,N){const z=M(H,N);return Object.assign(Object.create(null),{StructType:N,create:R=>{const j=z();return p.pokePtr(R,j.pointer),j},get:R=>z(R),unget:R=>z(R,!0),dispose:R=>{const j=z(R,!0);j&&j.dispose()}})};h.xVtab=ae("xVtab",a.sqlite3_vtab),h.xCursor=ae("xCursor",a.sqlite3_vtab_cursor),h.xIndexInfo=H=>new a.sqlite3_index_info(H),h.xError=function H(N,z,R){if(H.errorReporter instanceof Function)try{H.errorReporter("sqlite3_module::"+N+"(): "+z.message)}catch{}let j;return z instanceof i.WasmAllocError?j=a.SQLITE_NOMEM:arguments.length>2?j=R:z instanceof i.SQLite3Error&&(j=z.resultCode),j||a.SQLITE_ERROR},h.xError.errorReporter=i.config.error.bind(i.config),h.xRowid=(H,N)=>p.poke(H,N,"i64"),h.setupModule=function(H){let N=!1;const z=this instanceof a.sqlite3_module?this:H.struct||(N=new a.sqlite3_module);try{const R=H.methods||o("Missing 'methods' object.");for(const j of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const oe=j[0],K=j[1];R[oe]===!0?R[oe]=R[K]:R[K]===!0&&(R[K]=R[oe])}if(H.catchExceptions){const j=function(S,I){return["xConnect","xCreate"].indexOf(S)>=0?function(T,D,F,P,$,m){try{return I(...arguments)||0}catch(y){return y instanceof i.WasmAllocError||(p.dealloc(p.peekPtr(m)),p.pokePtr(m,p.allocCString(y.message))),h.xError(S,y)}}:function(...T){try{return I(...T)||0}catch(D){return h.xError(S,D)}}},oe=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],K=Object.create(null);for(const S of oe){const I=R[S];if(I instanceof Function)S==="xConnect"&&R.xCreate===I?K[S]=R.xCreate:S==="xCreate"&&R.xConnect===I?K[S]=R.xConnect:K[S]=j(S,I);else continue}z.installMethods(K,!1)}else z.installMethods(R,!!H.applyArgcCheck);if(z.$iVersion===0){let j;typeof H.iVersion=="number"?j=H.iVersion:z.$xIntegrity?j=4:z.$xShadowName?j=3:z.$xSavePoint||z.$xRelease||z.$xRollbackTo?j=2:j=1,z.$iVersion=j}}catch(R){throw N&&N.dispose(),R}return z},a.sqlite3_module.prototype.setupModule=function(H){return h.setupModule.call(this,H)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const p=function a(o){var M;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((M=navigator==null?void 0:navigator.storage)!=null&&M.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!o||typeof o!="object")&&(o=Object.create(null));const h=new URL(globalThis.location.href).searchParams;return h.has("opfs-disable")?Promise.resolve(i):(o.verbose===void 0&&(o.verbose=h.has("opfs-verbose")?+h.get("opfs-verbose")||2:1),o.sanityChecks===void 0&&(o.sanityChecks=h.has("opfs-sanity-check")),o.proxyUri===void 0&&(o.proxyUri=a.defaultProxyUri),typeof o.proxyUri=="function"&&(o.proxyUri=o.proxyUri()),new Promise(function(ae,H){const N=[i.config.error,i.config.warn,i.config.log],z=(O,...G)=>{o.verbose>O&&N[O]("OPFS syncer:",...G)},R=(...O)=>z(2,...O),j=(...O)=>z(1,...O),oe=(...O)=>z(0,...O),K=i.util.toss,S=i.capi,I=i.util,T=i.wasm,D=S.sqlite3_vfs,F=S.sqlite3_file,P=S.sqlite3_io_methods,$=Object.create(null),m=()=>{var O;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((O=navigator==null?void 0:navigator.storage)==null?void 0:O.getDirectory)};$.metrics={dump:function(){let O,G=0,J=0,fe=0;for(O in f.opIds){const le=b[O];G+=le.count,J+=le.time,fe+=le.wait,le.avgTime=le.count&&le.time?le.time/le.count:0,le.avgWait=le.count&&le.wait?le.wait/le.count:0}i.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",b,`
Total of`,G,"op(s) for",J,"ms (incl. "+fe+" ms of waiting on the async side)"),i.config.log("Serialization metrics:",b.s11n),ge.postMessage({type:"opfs-async-metrics"})},reset:function(){let O;const G=fe=>fe.count=fe.time=fe.wait=0;for(O in f.opIds)G(b[O]=Object.create(null));let J=b.s11n=Object.create(null);J=J.serialize=Object.create(null),J.count=J.time=0,J=b.s11n.deserialize=Object.create(null),J.count=J.time=0}};const y=new P,A=new D().addOnDispose(()=>y.dispose());let Z;const ne=O=>(Z=!0,A.dispose(),H(O)),me=()=>(Z=!1,ae(i)),ge=new Worker(new URL(o.proxyUri,import.meta.url));setTimeout(()=>{Z===void 0&&ne(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),ge._originalOnError=ge.onerror,ge.onerror=function(O){oe("Error initializing OPFS asyncer:",O),ne(new Error("Loading OPFS async Worker failed for unknown reasons."))};const w=S.sqlite3_vfs_find(null),u=w?new D(w):null;y.$iVersion=1,A.$iVersion=2,A.$szOsFile=S.sqlite3_file.structInfo.sizeof,A.$mxPathname=1024,A.$zName=T.allocCString("opfs"),A.$xDlOpen=A.$xDlError=A.$xDlSym=A.$xDlClose=null,A.addOnDispose("$zName",A.$zName,"cleanup default VFS wrapper",()=>u?u.dispose():null);const f=Object.create(null);f.verbose=o.verbose,f.littleEndian=(()=>{const O=new ArrayBuffer(2);return new DataView(O).setInt16(0,256,!0),new Int16Array(O)[0]===256})(),f.asyncIdleWaitTime=150,f.asyncS11nExceptions=1,f.fileBufferSize=1024*64,f.sabS11nOffset=f.fileBufferSize,f.sabS11nSize=A.$mxPathname*2,f.sabIO=new SharedArrayBuffer(f.fileBufferSize+f.sabS11nSize),f.opIds=Object.create(null);const b=Object.create(null);{let O=0;f.opIds.whichOp=O++,f.opIds.rc=O++,f.opIds.xAccess=O++,f.opIds.xClose=O++,f.opIds.xDelete=O++,f.opIds.xDeleteNoWait=O++,f.opIds.xFileSize=O++,f.opIds.xLock=O++,f.opIds.xOpen=O++,f.opIds.xRead=O++,f.opIds.xSleep=O++,f.opIds.xSync=O++,f.opIds.xTruncate=O++,f.opIds.xUnlock=O++,f.opIds.xWrite=O++,f.opIds.mkdir=O++,f.opIds["opfs-async-metrics"]=O++,f.opIds["opfs-async-shutdown"]=O++,f.opIds.retry=O++,f.sabOP=new SharedArrayBuffer(O*4),$.metrics.reset()}f.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(O=>{(f.sq3Codes[O]=S[O])===void 0&&K("Maintenance required: not found:",O)}),f.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const E=(O,...G)=>{const J=f.opIds[O]||K("Invalid op ID:",O);f.s11n.serialize(...G),Atomics.store(f.sabOPView,f.opIds.rc,-1),Atomics.store(f.sabOPView,f.opIds.whichOp,J),Atomics.notify(f.sabOPView,f.opIds.whichOp);const fe=performance.now();for(;Atomics.wait(f.sabOPView,f.opIds.rc,-1)!=="not-equal";);const le=Atomics.load(f.sabOPView,f.opIds.rc);if(b[O].wait+=performance.now()-fe,le&&f.asyncS11nExceptions){const Se=f.s11n.deserialize();Se&&oe(O+"() async error:",...Se)}return le};$.debug={asyncShutdown:()=>{j("Shutting down OPFS async listener. The OPFS VFS will no longer work."),E("opfs-async-shutdown")},asyncRestart:()=>{j("Attempting to restart OPFS VFS async listener. Might work, might not."),ge.postMessage({type:"opfs-async-restart"})}};const Q=()=>{if(f.s11n)return f.s11n;const O=new TextDecoder,G=new TextEncoder("utf-8"),J=new Uint8Array(f.sabIO,f.sabS11nOffset,f.sabS11nSize),fe=new DataView(f.sabIO,f.sabS11nOffset,f.sabS11nSize);f.s11n=Object.create(null);const le=Object.create(null);le.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},le.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},le.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},le.string={id:4};const Se=B=>le[typeof B]||K("Maintenance required: this value type cannot be serialized.",B),ve=B=>{switch(B){case le.number.id:return le.number;case le.bigint.id:return le.bigint;case le.boolean.id:return le.boolean;case le.string.id:return le.string;default:K("Invalid type ID:",B)}};return f.s11n.deserialize=function(B=!1){++b.s11n.deserialize.count;const k=performance.now(),U=J[0],X=U?[]:null;if(U){const re=[];let ue=1,ke,Le,L;for(ke=0;ke<U;++ke,++ue)re.push(ve(J[ue]));for(ke=0;ke<U;++ke){const se=re[ke];se.getter?(L=fe[se.getter](ue,f.littleEndian),ue+=se.size):(Le=fe.getInt32(ue,f.littleEndian),ue+=4,L=O.decode(J.slice(ue,ue+Le)),ue+=Le),X.push(L)}}return B&&(J[0]=0),b.s11n.deserialize.time+=performance.now()-k,X},f.s11n.serialize=function(...B){const k=performance.now();if(++b.s11n.serialize.count,B.length){const U=[];let X=0,re=1;for(J[0]=B.length&255;X<B.length;++X,++re)U.push(Se(B[X])),J[re]=U[X].id;for(X=0;X<B.length;++X){const ue=U[X];if(ue.setter)fe[ue.setter](re,B[X],f.littleEndian),re+=ue.size;else{const ke=G.encode(B[X]);fe.setInt32(re,ke.byteLength,f.littleEndian),re+=4,J.set(ke,re),re+=ke.byteLength}}}else J[0]=0;b.s11n.serialize.time+=performance.now()-k},f.s11n},ee=function O(G=16){O._chars||(O._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",O._n=O._chars.length);const J=[];let fe=0;for(;fe<G;++fe){const le=Math.random()*(O._n*64)%O._n|0;J[fe]=O._chars[le]}return J.join("")},he=Object.create(null),ie=Object.create(null);ie.op=void 0,ie.start=void 0;const Ee=O=>{ie.start=performance.now(),ie.op=O,++b[O].count},ye=()=>b[ie.op].time+=performance.now()-ie.start,Pe={xCheckReservedLock:function(O,G){return T.poke(G,0,"i32"),0},xClose:function(O){Ee("xClose");let G=0;const J=he[O];return J&&(delete he[O],G=E("xClose",O),J.sq3File&&J.sq3File.dispose()),ye(),G},xDeviceCharacteristics:function(O){return S.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(O,G,J){return S.SQLITE_NOTFOUND},xFileSize:function(O,G){Ee("xFileSize");let J=E("xFileSize",O);if(J==0)try{const fe=f.s11n.deserialize()[0];T.poke(G,fe,"i64")}catch(fe){oe("Unexpected error reading xFileSize() result:",fe),J=f.sq3Codes.SQLITE_IOERR}return ye(),J},xLock:function(O,G){Ee("xLock");const J=he[O];let fe=0;return J.lockType?J.lockType=G:(fe=E("xLock",O,G),fe===0&&(J.lockType=G)),ye(),fe},xRead:function(O,G,J,fe){Ee("xRead");const le=he[O];let Se;try{Se=E("xRead",O,J,Number(fe)),(Se===0||S.SQLITE_IOERR_SHORT_READ===Se)&&T.heap8u().set(le.sabView.subarray(0,J),Number(G))}catch(ve){oe("xRead(",arguments,") failed:",ve,le),Se=S.SQLITE_IOERR_READ}return ye(),Se},xSync:function(O,G){Ee("xSync"),++b.xSync.count;const J=E("xSync",O,G);return ye(),J},xTruncate:function(O,G){Ee("xTruncate");const J=E("xTruncate",O,Number(G));return ye(),J},xUnlock:function(O,G){Ee("xUnlock");const J=he[O];let fe=0;return S.SQLITE_LOCK_NONE===G&&J.lockType&&(fe=E("xUnlock",O,G)),fe===0&&(J.lockType=G),ye(),fe},xWrite:function(O,G,J,fe){Ee("xWrite");const le=he[O];let Se;try{le.sabView.set(T.heap8u().subarray(Number(G),Number(G)+J)),Se=E("xWrite",O,J,Number(fe))}catch(ve){oe("xWrite(",arguments,") failed:",ve,le),Se=S.SQLITE_IOERR_WRITE}return ye(),Se}},xe={xAccess:function(O,G,J,fe){Ee("xAccess");const le=E("xAccess",T.cstrToJs(G));return T.poke(fe,le?0:1,"i32"),ye(),0},xCurrentTime:function(O,G){return T.poke(G,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(O,G){return T.poke(G,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(O,G,J){Ee("xDelete");const fe=E("xDelete",T.cstrToJs(G),J,!1);return ye(),fe},xFullPathname:function(O,G,J,fe){return T.cstrncpy(fe,G,J)<J?0:S.SQLITE_CANTOPEN},xGetLastError:function(O,G,J){return j("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(G,J,fe,le,Se){Ee("xOpen");let ve=0;J===0?J=ee():T.isPtr(J)&&(S.sqlite3_uri_boolean(J,"opfs-unlock-asap",0)&&(ve|=f.opfsFlags.OPFS_UNLOCK_ASAP),S.sqlite3_uri_boolean(J,"delete-before-open",0)&&(ve|=f.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),J=T.cstrToJs(J));const B=Object.create(null);B.fid=fe,B.filename=J,B.sab=new SharedArrayBuffer(f.fileBufferSize),B.flags=le,B.readOnly=!(i.SQLITE_OPEN_CREATE&le)&&!!(le&S.SQLITE_OPEN_READONLY);const k=E("xOpen",fe,J,le,ve);return k||(B.readOnly&&T.poke(Se,S.SQLITE_OPEN_READONLY,"i32"),he[fe]=B,B.sabView=f.sabFileBufView,B.sq3File=new F(fe),B.sq3File.$pMethods=y.pointer,B.lockType=S.SQLITE_LOCK_NONE),ye(),k}};u&&(A.$xRandomness=u.$xRandomness,A.$xSleep=u.$xSleep),A.$xRandomness||(xe.xRandomness=function(O,G,J){const fe=T.heap8u();let le=0;const Se=Number(J);for(;le<G;++le)fe[Se+le]=Math.random()*255e3&255;return le}),A.$xSleep||(xe.xSleep=function(O,G){return Atomics.wait(f.sabOPView,f.opIds.xSleep,0,G),0}),$.getResolvedPath=function(O,G){const J=new URL(O,"file://irrelevant").pathname;return G?J.split("/").filter(fe=>!!fe):J},$.getDirForFilename=async function(G,J=!1){const fe=$.getResolvedPath(G,!0),le=fe.pop();let Se=$.rootDirectory;for(const ve of fe)ve&&(Se=await Se.getDirectoryHandle(ve,{create:!!J}));return[Se,le]},$.mkdir=async function(O){try{return await $.getDirForFilename(O+"/filepart",!0),!0}catch{return!1}},$.entryExists=async function(O){try{const[G,J]=await $.getDirForFilename(O);return await G.getFileHandle(J),!0}catch{return!1}},$.randomFilename=ee,$.treeList=async function(){const O=async function J(fe,le){le.name=fe.name,le.dirs=[],le.files=[];for await(const Se of fe.values())if(Se.kind==="directory"){const ve=Object.create(null);le.dirs.push(ve),await J(Se,ve)}else le.files.push(Se.name)},G=Object.create(null);return await O($.rootDirectory,G),G},$.rmfr=async function(){const O=$.rootDirectory,G={recurse:!0};for await(const J of O.values())O.removeEntry(J.name,G)},$.unlink=async function(O,G=!1,J=!1){try{const[fe,le]=await $.getDirForFilename(O,!1);return await fe.removeEntry(le,{recursive:G}),!0}catch(fe){if(J)throw new Error("unlink(",arguments[0],") failed: "+fe.message,{cause:fe});return!1}},$.traverse=async function(O){const G={recursive:!0,directory:$.rootDirectory};typeof O=="function"&&(O={callback:O}),O=Object.assign(G,O||{}),async function fe(le,Se){for await(const ve of le.values()){if(O.callback(ve,le,Se)===!1)return!1;if(O.recursive&&ve.kind==="directory"&&await fe(ve,Se+1)===!1)break}}(O.directory,0)};const ze=async function(O,G){const[J,fe]=await $.getDirForFilename(O,!0);let Se=await(await J.getFileHandle(fe,{create:!0})).createSyncAccessHandle(),ve=0,B,k=!1;try{for(Se.truncate(0);(B=await G())!==void 0;)B instanceof ArrayBuffer&&(B=new Uint8Array(B)),!k&&ve===0&&B.byteLength>=15&&(I.affirmDbHeader(B),k=!0),Se.write(B,{at:ve}),ve+=B.byteLength;if((ve<512||ve%512!==0)&&K("Input size",ve,"is not correct for an SQLite database."),!k){const U=new Uint8Array(20);Se.read(U,{at:0}),I.affirmDbHeader(U)}return Se.write(new Uint8Array([1,1]),{at:18}),ve}catch(U){throw await Se.close(),Se=void 0,await J.removeEntry(fe).catch(()=>{}),U}finally{Se&&await Se.close()}};if($.importDb=async function(O,G){if(G instanceof Function)return ze(O,G);G instanceof ArrayBuffer&&(G=new Uint8Array(G)),I.affirmIsDb(G);const J=G.byteLength,[fe,le]=await $.getDirForFilename(O,!0);let Se,ve=0;try{return Se=await(await fe.getFileHandle(le,{create:!0})).createSyncAccessHandle(),Se.truncate(0),ve=Se.write(G,{at:0}),ve!=J&&K("Expected to write "+J+" bytes but wrote "+ve+"."),Se.write(new Uint8Array([1,1]),{at:18}),ve}catch(B){throw Se&&(await Se.close(),Se=void 0),await fe.removeEntry(le).catch(()=>{}),B}finally{Se&&await Se.close()}},i.oo1){const O=function(...G){const J=i.oo1.DB.dbCtorHelper.normalizeArgs(...G);J.vfs=A.$zName,i.oo1.DB.dbCtorHelper.call(this,J)};O.prototype=Object.create(i.oo1.DB.prototype),i.oo1.OpfsDb=O,O.importDb=$.importDb,i.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(A.pointer,function(G,J){J.capi.sqlite3_busy_timeout(G,1e4)})}const Xe=function(){const O=T.scopedAllocPush(),G=new F;try{const J=G.pointer,fe=S.SQLITE_OPEN_CREATE|S.SQLITE_OPEN_READWRITE|S.SQLITE_OPEN_MAIN_DB,le=T.scopedAlloc(8),Se="/sanity/check/file"+ee(8),ve=T.scopedAllocCString(Se);let B;if(f.s11n.serialize("This is  string."),B=f.s11n.deserialize(),R("deserialize() says:",B),B[0]!=="This is  string."&&K("String d13n error."),xe.xAccess(A.pointer,ve,0,le),B=T.peek(le,"i32"),R("xAccess(",Se,") exists ?=",B),B=xe.xOpen(A.pointer,ve,J,fe,le),R("open rc =",B,"state.sabOPView[xOpen] =",f.sabOPView[f.opIds.xOpen]),B!==0){oe("open failed with code",B);return}xe.xAccess(A.pointer,ve,0,le),B=T.peek(le,"i32"),B||K("xAccess() failed to detect file."),B=Pe.xSync(G.pointer,0),B&&K("sync failed w/ rc",B),B=Pe.xTruncate(G.pointer,1024),B&&K("truncate failed w/ rc",B),T.poke(le,0,"i64"),B=Pe.xFileSize(G.pointer,le),B&&K("xFileSize failed w/ rc",B),R("xFileSize says:",T.peek(le,"i64")),B=Pe.xWrite(G.pointer,ve,10,1),B&&K("xWrite() failed!");const k=T.scopedAlloc(16);B=Pe.xRead(G.pointer,k,6,2),T.poke(k+6,0);let U=T.cstrToJs(k);R("xRead() got:",U),U!=="sanity"&&K("Unexpected xRead() value."),xe.xSleep&&(R("xSleep()ing before close()ing..."),xe.xSleep(A.pointer,2e3),R("waking up from xSleep()")),B=Pe.xClose(J),R("xClose rc =",B,"sabOPView =",f.sabOPView),R("Deleting file:",Se),xe.xDelete(A.pointer,ve,4660),xe.xAccess(A.pointer,ve,0,le),B=T.peek(le,"i32"),B&&K("Expecting 0 from xAccess(",Se,") after xDelete()."),j("End of OPFS sanity checks.")}finally{G.dispose(),T.scopedAllocPop(O)}};ge.onmessage=function({data:O}){switch(O.type){case"opfs-unavailable":ne(new Error(O.payload.join(" ")));break;case"opfs-async-loaded":ge.postMessage({type:"opfs-async-init",args:f});break;case"opfs-async-inited":{if(Z===!0)break;try{i.vfs.installVfs({io:{struct:y,methods:Pe},vfs:{struct:A,methods:xe}}),f.sabOPView=new Int32Array(f.sabOP),f.sabFileBufView=new Uint8Array(f.sabIO,0,f.fileBufferSize),f.sabS11nView=new Uint8Array(f.sabIO,f.sabS11nOffset,f.sabS11nSize),Q(),o.sanityChecks&&(j("Running sanity checks because of opfs-sanity-check URL arg..."),Xe()),m()?navigator.storage.getDirectory().then(G=>{ge.onerror=ge._originalOnError,delete ge._originalOnError,i.opfs=$,$.rootDirectory=G,R("End of OPFS sqlite3_vfs setup.",A),me()}).catch(ne):me()}catch(G){oe(G),ne(G)}break}default:{const G="Unexpected message from the OPFS async worker: "+JSON.stringify(O);oe(G),ne(new Error(G));break}}}}))};p.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async a=>{try{let o=p.defaultProxyUri;return a.scriptInfo.sqlite3Dir&&(p.defaultProxyUri=a.scriptInfo.sqlite3Dir+o),p().catch(h=>{a.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",h.message)})}catch(o){return a.config.error("installOpfsVfs() exception:",o),Promise.reject(o)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){var ie,Ee,ye,Pe,xe,ze,Xe,O,G,J,fe,le,Gt,ve;const p=i.util.toss,a=i.util.toss3,o=Object.create(null),h=i.capi,C=i.util,M=i.wasm,ae=4096,H=512,N=4,z=8,R=H+N,j=H,oe=R,K=ae,S=h.SQLITE_OPEN_MAIN_DB|h.SQLITE_OPEN_MAIN_JOURNAL|h.SQLITE_OPEN_SUPER_JOURNAL|h.SQLITE_OPEN_WAL,I=h.SQLITE_OPEN_MEMORY,T=".opaque",D=()=>Math.random().toString(36).slice(2),F=new TextDecoder,P=new TextEncoder,$=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),m=[i.config.error,i.config.warn,i.config.log];i.config.log;const y=i.config.warn;i.config.error;const A=new Map,Z=B=>A.get(B),ne=(B,k)=>{k?A.set(B,k):A.delete(B)},me=new Map,ge=B=>me.get(B),w=(B,k)=>{k?me.set(B,k):me.delete(B)},u={xCheckReservedLock:function(B,k){const U=ge(B);return U.log("xCheckReservedLock"),U.storeErr(),M.poke32(k,1),0},xClose:function(B){const k=ge(B);k.storeErr();const U=k.getOFileForS3File(B);if(U)try{k.log(`xClose ${U.path}`),k.mapS3FileToOFile(B,!1),U.sah.flush(),U.flags&h.SQLITE_OPEN_DELETEONCLOSE&&k.deletePath(U.path)}catch(X){return k.storeErr(X,h.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(B){return h.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(B,k,U){return h.SQLITE_NOTFOUND},xFileSize:function(B,k){const U=ge(B);U.log("xFileSize");const re=U.getOFileForS3File(B).sah.getSize()-K;return M.poke64(k,BigInt(re)),0},xLock:function(B,k){const U=ge(B);U.log(`xLock ${k}`),U.storeErr();const X=U.getOFileForS3File(B);return X.lockType=k,0},xRead:function(B,k,U,X){const re=ge(B);re.storeErr();const ue=re.getOFileForS3File(B);re.log(`xRead ${ue.path} ${U} @ ${X}`);try{const ke=ue.sah.read(M.heap8u().subarray(Number(k),Number(k)+U),{at:K+Number(X)});return ke<U?(M.heap8u().fill(0,Number(k)+ke,Number(k)+U),h.SQLITE_IOERR_SHORT_READ):0}catch(ke){return re.storeErr(ke,h.SQLITE_IOERR)}},xSectorSize:function(B){return ae},xSync:function(B,k){const U=ge(B);U.log(`xSync ${k}`),U.storeErr();const X=U.getOFileForS3File(B);try{return X.sah.flush(),0}catch(re){return U.storeErr(re,h.SQLITE_IOERR)}},xTruncate:function(B,k){const U=ge(B);U.log(`xTruncate ${k}`),U.storeErr();const X=U.getOFileForS3File(B);try{return X.sah.truncate(K+Number(k)),0}catch(re){return U.storeErr(re,h.SQLITE_IOERR)}},xUnlock:function(B,k){const U=ge(B);U.log("xUnlock");const X=U.getOFileForS3File(B);return X.lockType=k,0},xWrite:function(B,k,U,X){const re=ge(B);re.storeErr();const ue=re.getOFileForS3File(B);re.log(`xWrite ${ue.path} ${U} ${X}`);try{const ke=ue.sah.write(M.heap8u().subarray(Number(k),Number(k)+U),{at:K+Number(X)});return U===ke?0:p("Unknown write() failure.")}catch(ke){return re.storeErr(ke,h.SQLITE_IOERR)}}},f=new h.sqlite3_io_methods;f.$iVersion=1,i.vfs.installVfs({io:{struct:f,methods:u}});const b={xAccess:function(B,k,U,X){const re=Z(B);re.storeErr();try{const ue=re.getPath(k);M.poke32(X,re.hasFilename(ue)?1:0)}catch{M.poke32(X,0)}return 0},xCurrentTime:function(B,k){return M.poke(k,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(B,k){return M.poke(k,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(B,k,U){const X=Z(B);X.log(`xDelete ${M.cstrToJs(k)}`),X.storeErr();try{return X.deletePath(X.getPath(k)),0}catch(re){return X.storeErr(re),h.SQLITE_IOERR_DELETE}},xFullPathname:function(B,k,U,X){return M.cstrncpy(X,k,U)<U?0:h.SQLITE_CANTOPEN},xGetLastError:function(B,k,U){const X=Z(B),re=X.popErr();if(X.log(`xGetLastError ${k} e =`,re),re){const ue=M.scopedAllocPush();try{const[ke,Le]=M.scopedAllocCString(re.message,!0);M.cstrncpy(U,ke,k),Le>k&&M.poke8(U+k-1,0)}catch{return h.SQLITE_NOMEM}finally{M.scopedAllocPop(ue)}}return re?re.sqlite3Rc||h.SQLITE_IOERR:0},xOpen:function(k,U,X,re,ue){const ke=Z(k);try{re&=~I,ke.log(`xOpen ${M.cstrToJs(U)} ${re}`);const Le=U&&M.peek8(U)?ke.getPath(U):D();let L=ke.getSAHForPath(Le);!L&&re&h.SQLITE_OPEN_CREATE&&(ke.getFileCount()<ke.getCapacity()?(L=ke.nextAvailableSAH(),ke.setAssociatedPath(L,Le,re)):p("SAH pool is full. Cannot create file",Le)),L||p("file not found:",Le);const se={path:Le,flags:re,sah:L};ke.mapS3FileToOFile(X,se),se.lockType=h.SQLITE_LOCK_NONE;const pe=new h.sqlite3_file(X);return pe.$pMethods=f.pointer,pe.dispose(),M.poke32(ue,re),0}catch(Le){return ke.storeErr(Le),h.SQLITE_CANTOPEN}}},E=function(B){i.capi.sqlite3_vfs_find(B)&&a("VFS name is already registered:",B);const k=new h.sqlite3_vfs,U=h.sqlite3_vfs_find(null),X=U?new h.sqlite3_vfs(U):null;return k.$iVersion=2,k.$szOsFile=h.sqlite3_file.structInfo.sizeof,k.$mxPathname=H,k.addOnDispose(k.$zName=M.allocCString(B),()=>ne(k.pointer,0)),X&&(k.$xRandomness=X.$xRandomness,k.$xSleep=X.$xSleep,X.dispose()),!k.$xRandomness&&!b.xRandomness&&(b.xRandomness=function(re,ue,ke){const Le=M.heap8u();let L=0;const se=Number(ke);for(;L<ue;++L)Le[se+L]=Math.random()*255e3&255;return L}),!k.$xSleep&&!b.xSleep&&(b.xSleep=(re,ue)=>0),i.vfs.installVfs({vfs:{struct:k,methods:b}}),k};class Q{constructor(k=Object.create(null)){lt(this,le);Je(this,"vfsDir");lt(this,ie);lt(this,Ee);lt(this,ye);lt(this,Pe,new Map);lt(this,xe,new Map);lt(this,ze,new Set);lt(this,Xe,new Map);lt(this,O,new Uint8Array(R));lt(this,G);lt(this,J);lt(this,fe);ft(this,fe,k.verbosity??$.verbosity),this.vfsName=k.name||$.name,ft(this,J,E(this.vfsName)),ne(_e(this,J).pointer,this),this.vfsDir=k.directory||"."+this.vfsName,ft(this,G,new DataView(_e(this,O).buffer,_e(this,O).byteOffset)),this.isReady=this.reset(!!(k.clearOnInit??$.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(k.initialCapacity||$.initialCapacity)})}log(...k){Bt(this,le,Gt).call(this,2,...k)}warn(...k){Bt(this,le,Gt).call(this,1,...k)}error(...k){Bt(this,le,Gt).call(this,0,...k)}getVfs(){return _e(this,J)}getCapacity(){return _e(this,Pe).size}getFileCount(){return _e(this,xe).size}getFileNames(){const k=[];for(const U of _e(this,xe).keys())k.push(U);return k}async addCapacity(k){for(let U=0;U<k;++U){const X=D(),ue=await(await _e(this,Ee).getFileHandle(X,{create:!0})).createSyncAccessHandle();_e(this,Pe).set(ue,X),this.setAssociatedPath(ue,"",0)}return this.getCapacity()}async reduceCapacity(k){let U=0;for(const X of Array.from(_e(this,ze))){if(U===k||this.getFileCount()===this.getCapacity())break;const re=_e(this,Pe).get(X);X.close(),await _e(this,Ee).removeEntry(re),_e(this,Pe).delete(X),_e(this,ze).delete(X),++U}return U}releaseAccessHandles(){for(const k of _e(this,Pe).keys())k.close();_e(this,Pe).clear(),_e(this,xe).clear(),_e(this,ze).clear()}async acquireAccessHandles(k=!1){const U=[];for await(const[X,re]of _e(this,Ee))re.kind==="file"&&U.push([X,re]);return Promise.all(U.map(async([X,re])=>{try{const ue=await re.createSyncAccessHandle();if(_e(this,Pe).set(ue,X),k)ue.truncate(K),this.setAssociatedPath(ue,"",0);else{const ke=this.getAssociatedPath(ue);ke?_e(this,xe).set(ke,ue):_e(this,ze).add(ue)}}catch(ue){throw this.storeErr(ue),this.releaseAccessHandles(),ue}}))}getAssociatedPath(k){k.read(_e(this,O),{at:0});const U=_e(this,G).getUint32(j);if(_e(this,O)[0]&&(U&h.SQLITE_OPEN_DELETEONCLOSE||!(U&S)))return y(`Removing file with unexpected flags ${U.toString(16)}`,_e(this,O)),this.setAssociatedPath(k,"",0),"";const X=new Uint32Array(z/4);k.read(X,{at:oe});const re=this.computeDigest(_e(this,O),U);if(X.every((ue,ke)=>ue===re[ke])){const ue=_e(this,O).findIndex(ke=>ke===0);return ue===0&&k.truncate(K),ue?F.decode(_e(this,O).subarray(0,ue)):""}else return y("Disassociating file with bad digest."),this.setAssociatedPath(k,"",0),""}setAssociatedPath(k,U,X){const re=P.encodeInto(U,_e(this,O));H<=re.written+1&&p("Path too long:",U),U&&X&&(X|=I),_e(this,O).fill(0,re.written,H),_e(this,G).setUint32(j,X);const ue=this.computeDigest(_e(this,O),X);k.write(_e(this,O),{at:0}),k.write(ue,{at:oe}),k.flush(),U?(_e(this,xe).set(U,k),_e(this,ze).delete(k)):(k.truncate(K),_e(this,ze).add(k))}computeDigest(k,U){if(U&I){let X=3735928559,re=1103547991;for(const ue of k)X=Math.imul(X^ue,2654435761),re=Math.imul(re^ue,104729);return new Uint32Array([X>>>0,re>>>0])}else return new Uint32Array([0,0])}async reset(k){await this.isReady;let U=await navigator.storage.getDirectory(),X;for(const re of this.vfsDir.split("/"))re&&(X=U,U=await U.getDirectoryHandle(re,{create:!0}));return ft(this,ie,U),ft(this,ye,X),ft(this,Ee,await _e(this,ie).getDirectoryHandle(T,{create:!0})),this.releaseAccessHandles(),this.acquireAccessHandles(k)}getPath(k){return M.isPtr(k)&&(k=M.cstrToJs(k)),(k instanceof URL?k:new URL(k,"file://localhost/")).pathname}deletePath(k){const U=_e(this,xe).get(k);return U&&(_e(this,xe).delete(k),this.setAssociatedPath(U,"",0)),!!U}storeErr(k,U){return k&&(k.sqlite3Rc=U||h.SQLITE_IOERR,this.error(k)),this.$error=k,U}popErr(){const k=this.$error;return this.$error=void 0,k}nextAvailableSAH(){const[k]=_e(this,ze).keys();return k}getOFileForS3File(k){return _e(this,Xe).get(k)}mapS3FileToOFile(k,U){U?(_e(this,Xe).set(k,U),w(k,this)):(_e(this,Xe).delete(k),w(k,!1))}hasFilename(k){return _e(this,xe).has(k)}getSAHForPath(k){return _e(this,xe).get(k)}async removeVfs(){if(!_e(this,J).pointer||!_e(this,Ee))return!1;h.sqlite3_vfs_unregister(_e(this,J).pointer),_e(this,J).dispose(),delete o[this.vfsName];try{this.releaseAccessHandles(),await _e(this,ie).removeEntry(T,{recursive:!0}),ft(this,Ee,void 0),await _e(this,ye).removeEntry(_e(this,ie).name,{recursive:!0}),ft(this,ie,ft(this,ye,void 0))}catch(k){i.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",k)}return!0}pauseVfs(){return _e(this,Xe).size>0&&i.SQLite3Error.toss(h.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),_e(this,Pe).size>0&&(h.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return _e(this,Pe).size===0}async unpauseVfs(){return _e(this,Pe).size===0?this.acquireAccessHandles(!1).then(()=>h.sqlite3_vfs_register(_e(this,J),0),this):this}exportFile(k){const U=_e(this,xe).get(k)||p("File not found:",k),X=U.getSize()-K,re=new Uint8Array(X>0?X:0);if(X>0){const ue=U.read(re,{at:K});ue!=X&&p("Expected to read "+X+" bytes but read "+ue+".")}return re}async importDbChunked(k,U){const X=_e(this,xe).get(k)||this.nextAvailableSAH()||p("No available handles to import to.");X.truncate(0);let re=0,ue,ke=!1;try{for(;(ue=await U())!==void 0;)ue instanceof ArrayBuffer&&(ue=new Uint8Array(ue)),!ke&&re===0&&ue.byteLength>=15&&(C.affirmDbHeader(ue),ke=!0),X.write(ue,{at:K+re}),re+=ue.byteLength;if((re<512||re%512!==0)&&p("Input size",re,"is not correct for an SQLite database."),!ke){const Le=new Uint8Array(20);X.read(Le,{at:0}),C.affirmDbHeader(Le)}X.write(new Uint8Array([1,1]),{at:K+18})}catch(Le){throw this.setAssociatedPath(X,"",0),Le}return this.setAssociatedPath(X,k,h.SQLITE_OPEN_MAIN_DB),re}importDb(k,U){if(U instanceof ArrayBuffer)U=new Uint8Array(U);else if(U instanceof Function)return this.importDbChunked(k,U);const X=_e(this,xe).get(k)||this.nextAvailableSAH()||p("No available handles to import to."),re=U.byteLength;(re<512||re%512!=0)&&p("Byte array size is invalid for an SQLite db.");const ue="SQLite format 3";for(let Le=0;Le<ue.length;++Le)ue.charCodeAt(Le)!==U[Le]&&p("Input does not contain an SQLite database header.");const ke=X.write(U,{at:K});return ke!=re?(this.setAssociatedPath(X,"",0),p("Expected to write "+re+" bytes but wrote "+ke+".")):(X.write(new Uint8Array([1,1]),{at:K+18}),this.setAssociatedPath(X,k,h.SQLITE_OPEN_MAIN_DB)),ke}}ie=new WeakMap,Ee=new WeakMap,ye=new WeakMap,Pe=new WeakMap,xe=new WeakMap,ze=new WeakMap,Xe=new WeakMap,O=new WeakMap,G=new WeakMap,J=new WeakMap,fe=new WeakMap,le=new WeakSet,Gt=function(k,...U){_e(this,fe)>k&&m[k](this.vfsName+":",...U)};class ee{constructor(k){lt(this,ve);ft(this,ve,k),this.vfsName=k.vfsName}async addCapacity(k){return _e(this,ve).addCapacity(k)}async reduceCapacity(k){return _e(this,ve).reduceCapacity(k)}getCapacity(){return _e(this,ve).getCapacity(_e(this,ve))}getFileCount(){return _e(this,ve).getFileCount()}getFileNames(){return _e(this,ve).getFileNames()}async reserveMinimumCapacity(k){const U=_e(this,ve).getCapacity();return U<k?_e(this,ve).addCapacity(k-U):U}exportFile(k){return _e(this,ve).exportFile(k)}importDb(k,U){return _e(this,ve).importDb(k,U)}async wipeFiles(){return _e(this,ve).reset(!0)}unlink(k){return _e(this,ve).deletePath(k)}async removeVfs(){return _e(this,ve).removeVfs()}pauseVfs(){return _e(this,ve).pauseVfs(),this}async unpauseVfs(){return _e(this,ve).unpauseVfs().then(()=>this)}isPaused(){return _e(this,ve).isPaused()}}ve=new WeakMap;const he=async()=>{const B=await navigator.storage.getDirectory(),k=".opfs-sahpool-sync-check-"+D(),re=(await(await B.getFileHandle(k,{create:!0})).createSyncAccessHandle()).close();return await re,await B.removeEntry(k),re!=null&&re.then&&p("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};i.installOpfsSAHPoolVfs=async function(B=Object.create(null)){var U;B=Object.assign(Object.create(null),$,B||{});const k=B.name;if(B.$testThrowPhase1)throw B.$testThrowPhase1;if(o[k])try{return await o[k]}catch(X){if(B.forceReinitIfPreviouslyFailed)delete o[k];else throw X}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((U=navigator==null?void 0:navigator.storage)!=null&&U.getDirectory)?o[k]=Promise.reject(new Error("Missing required OPFS APIs.")):o[k]=he().then(async function(){if(B.$testThrowPhase2)throw B.$testThrowPhase2;const X=new Q(B);return X.isReady.then(async()=>{const re=new ee(X);if(i.oo1){const ue=i.oo1,ke=X.getVfs(),Le=function(...L){const se=ue.DB.dbCtorHelper.normalizeArgs(...L);se.vfs=ke.$zName,ue.DB.dbCtorHelper.call(this,se)};Le.prototype=Object.create(ue.DB.prototype),re.OpfsSAHPoolDb=Le}return X.log("VFS initialized."),re}).catch(async re=>{throw await X.removeVfs().catch(()=>{}),re})}).catch(X=>o[k]=Promise.reject(X))}}),typeof s>"u")throw console.warn("This is not running in the context of Module.runSQLite3PostLoadInit()"),new Error("sqlite3-api-cleanup.js expects to be running in the context of its Emscripten module loader.");try{const i=Object.assign(Object.create(null),globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{},{memory:typeof it<"u"?it:s.wasmMemory,exports:typeof Tt<"u"?Tt:Object.prototype.hasOwnProperty.call(s,"wasmExports")?s.wasmExports:s.asm});i.wasmPtrIR=typeof i.exports.sqlite3_libversion()=="number"?"i32":"i64";const p=n;p.debugModule("Bootstrapping lib config",p);const a=globalThis.sqlite3ApiBootstrap(i);return delete globalThis.sqlite3ApiBootstrap,a}catch(i){throw console.error("sqlite3ApiBootstrap() error:",i),i}throw new Error("Maintenance required: this line should never be reached")},xn?t=r:t=new Promise((n,s)=>{Ze=n,rt=s}),t}const eu=function(){var l,_;const e=Tn;if(!e)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const t=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(l=globalThis==null?void 0:globalThis.document)==null?void 0:l.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(_=globalThis==null?void 0:globalThis.location)!=null&&_.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(t.debugModule=t.urlParams.has("sqlite3.debugModule")?(...g)=>console.warn("sqlite3.debugModule:",...g):()=>{},t.urlParams.has("sqlite3.dir"))t.sqlite3Dir=t.urlParams.get("sqlite3.dir")+"/";else if(t.moduleScript){const g=t.moduleScript.src.split("/");g.pop(),t.sqlite3Dir=g.join("/")+"/"}const r=globalThis.sqlite3InitModule=function g(...q){return e(...q).then(x=>{t.debugModule("sqlite3InitModule() sIMS =",t),t.debugModule("sqlite3InitModule() EmscriptenModule =",x);const W=x.runSQLite3PostLoadInit(t,x,!!g.__isUnderTest);return t.debugModule("sqlite3InitModule() sqlite3 =",W),W}).catch(x=>{throw console.error("Exception loading sqlite3 module:",x),x})};if(r.ready=e.ready,t.moduleScript){let g=t.moduleScript.src.split("/");g.pop(),t.scriptDir=g.join("/")+"/"}return t.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",t),r}();Tn=eu;var tu=Tn;globalThis.sqlite3Worker1Promiser=function e(t=e.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const Y=t;t=Object.assign(Object.create(null),e.defaultConfig),t.onready=Y}else t=Object.assign(Object.create(null),e.defaultConfig,t);const r=Object.create(null),l=function(){},_=t.onerror||l,g=t.debug||l,q=t.generateMessageId?void 0:Object.create(null),x=t.generateMessageId||function(Y){return Y.type+"#"+(q[Y.type]=(q[Y.type]||0)+1)},W=(...Y)=>{throw new Error(Y.join(" "))};t.worker||(t.worker=e.defaultConfig.worker),typeof t.worker=="function"&&(t.worker=t.worker());let te,ce;return t.worker.onmessage=function(Y){Y=Y.data,g("worker1.onmessage",Y);let de=r[Y.messageId];if(!de){if(Y&&Y.type==="sqlite3-api"&&Y.result==="worker1-ready"){t.onready&&t.onready(ce);return}if(de=r[Y.type],de&&de.onrow){de.onrow(Y);return}t.onunhandled?t.onunhandled(arguments[0]):_("sqlite3Worker1Promiser() unhandled worker message:",Y);return}switch(delete r[Y.messageId],Y.type){case"error":de.reject(Y);return;case"open":te||(te=Y.dbId);break;case"close":Y.dbId===te&&(te=void 0);break}try{de.resolve(Y)}catch(be){de.reject(be)}},ce=function(){let Y;arguments.length===1?Y=arguments[0]:arguments.length===2?(Y=Object.create(null),Y.type=arguments[0],Y.args=arguments[1],Y.dbId=Y.args.dbId):W("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!Y.dbId&&Y.type!=="open"&&(Y.dbId=te),Y.messageId=x(Y),Y.departureTime=performance.now();const de=Object.create(null);de.message=Y;let be;Y.type==="exec"&&Y.args&&(typeof Y.args.callback=="function"?(be=Y.messageId+":row",de.onrow=Y.args.callback,Y.args.callback=be,r[be]=de):typeof Y.args.callback=="string"&&W("exec callback may not be a string when using the Promise interface."));let Re=new Promise(function(Ze,rt){de.resolve=Ze,de.reject=rt,r[Y.messageId]=de,g("Posting",Y.type,"message to Worker dbId="+(te||"default")+":",Y),t.worker.postMessage(Y)});return be&&(Re=Re.finally(()=>delete r[be])),Re}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/assets/sqlite3-worker1-HKXiBUt9.js",import.meta.url))},onerror:(...e)=>console.error("worker1 promiser error",...e)};globalThis.sqlite3Worker1Promiser.v2=(function e(t=e.defaultConfig){let r;typeof t=="function"?(r=t,t={}):typeof(t==null?void 0:t.onready)=="function"&&(r=t.onready,delete t.onready);const l=Object.create(null);t=Object.assign(t||Object.create(null),{onready:async function(g){try{r&&await r(g),l.resolve(g)}catch(q){l.reject(q)}}});const _=new Promise(function(g,q){l.resolve=g,l.reject=q});try{this.original(t)}catch(g){l.reject(g)}return _}).bind({original:sqlite3Worker1Promiser});globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig;sqlite3Worker1Promiser.v2;const nu={fts:.35,vector:.4,entity:.15,graph:.1},ht={FTS_SEARCH:`
    SELECT
      m.gid,
      m.page_no,
      m.title,
      snippet(meta_fts, 3, '<mark>', '</mark>', '', 18) AS snippet,
      meta_fts.rank,
      (1.0 / (ABS(meta_fts.rank) + 1.0)) AS score
    FROM meta_fts
    JOIN meta_index m ON m.rowid = meta_fts.rowid
    WHERE meta_fts MATCH ?
    ORDER BY meta_fts.rank
    LIMIT ?
  `,FTS_SEARCH_WITH_ENTITIES:`
    SELECT
      m.gid,
      m.page_no,
      m.title,
      snippet(meta_fts, 3, '<mark>', '</mark>', '', 18) AS snippet,
      meta_fts.rank,
      (1.0 / (ABS(meta_fts.rank) + 1.0)) AS score
    FROM meta_fts
    JOIN meta_index m ON m.rowid = meta_fts.rowid
    WHERE meta_fts MATCH ?
      AND m.gid IN (
        SELECT DISTINCT gid
        FROM entities
        WHERE (entity_type = ? OR ? IS NULL)
          AND (normalized_value = ? OR ? IS NULL)
      )
    ORDER BY meta_fts.rank
    LIMIT ?
  `,LIST_ENTITY_FACETS:`
    SELECT
      entity_type,
      normalized_value,
      COUNT(*) AS count
    FROM entities
    WHERE entity_type = COALESCE(?, entity_type)
    GROUP BY entity_type, normalized_value
    ORDER BY count DESC, entity_type, normalized_value
    LIMIT ?
  `,LIST_ENTITY_TYPES:`
    SELECT DISTINCT entity_type, COUNT(*) AS count
    FROM entities
    GROUP BY entity_type
    ORDER BY count DESC
  `,GET_PAGE_LIST:`
    SELECT
      gid,
      doc_id,
      page_no,
      title,
      tags,
      updated_ts
    FROM meta_index
    ORDER BY page_no
    LIMIT ? OFFSET ?
  `,GET_PAGE_BLOB:`
    SELECT data, sz
    FROM sqlar
    WHERE name = ?
    LIMIT 1
  `,GET_VECTOR_META:`
    SELECT gid, model_id, dim
    FROM leann_meta
    WHERE gid = ? AND model_id = ?
    LIMIT 1
  `,GET_CACHED_VECTOR:`
    SELECT embedding
    FROM leann_vec
    WHERE gid = ? AND model_id = ?
    LIMIT 1
  `,GET_ALL_VECTORS:`
    SELECT
      lm.gid,
      lm.page_no,
      m.title,
      lv.embedding
    FROM leann_vec lv
    JOIN leann_meta lm ON lm.gid = lv.gid AND lm.model_id = lv.model_id
    JOIN meta_index m ON m.gid = lm.gid
    WHERE lv.model_id = ?
    ORDER BY lm.page_no
  `,GET_PAGE_ENTITIES:`
    SELECT
      entity_type,
      entity_text,
      normalized_value,
      confidence
    FROM entities
    WHERE gid = ?
    ORDER BY confidence DESC
  `,GET_CHECKPOINTS:`
    SELECT
      epoch,
      merkle_root,
      pages_count,
      anchors_json,
      created_ts
    FROM checkpoints
    ORDER BY epoch DESC
  `,VERIFY_PAGE:`
    SELECT
      gr.gid,
      gr.content_sha,
      gr.signer,
      gr.sig,
      gr.epoch,
      gr.merkle_root,
      m.full_text
    FROM glyph_receipts gr
    JOIN meta_index m ON m.gid = gr.gid
    WHERE gr.gid = ?
    LIMIT 1
  `,GET_GRAPH_NEIGHBORS:`
    SELECT
      n2.gid,
      n2.page_no,
      m.title,
      e.pred,
      e.weight
    FROM node_index n1
    JOIN edges e ON e.fromNode = n1.node_id
    JOIN node_index n2 ON n2.node_id = e.toNode
    JOIN meta_index m ON m.gid = n2.gid
    WHERE n1.gid = ?
    ORDER BY e.weight DESC
    LIMIT ?
  `};function ru(e,t){if(e.length!==t.length)throw new Error("Vectors must have same length");let r=0,l=0,_=0;for(let q=0;q<e.length;q++)r+=e[q]*t[q],l+=e[q]*e[q],_+=t[q]*t[q];const g=Math.sqrt(l)*Math.sqrt(_);return g===0?0:r/g}async function iu(e){const r=new TextEncoder().encode(e),l=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(l)).map(g=>g.toString(16).padStart(2,"0")).join("")}function su(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function Hr(e){return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}function bt(){return typeof navigator<"u"&&"storage"in navigator&&"getDirectory"in navigator.storage}async function ou(){if(!bt())throw new Error("OPFS not supported in this browser");return await navigator.storage.getDirectory()}async function On(){return await(await ou()).getDirectoryHandle("capsules",{create:!0})}async function au(e){if(!bt())throw new Error("OPFS not supported");const _=await(await(await(await On()).getFileHandle(e)).getFile()).arrayBuffer();return new Uint8Array(_)}async function lu(e){if(!bt())throw new Error("OPFS not supported");await(await On()).removeEntry(e),console.log(`[OPFS] Removed file: ${e}`)}async function cu(){if(!bt())return[];try{const e=await On(),t=[];for await(const[r,l]of e.entries())if(l.kind==="file"){const _=await l.getFile();t.push({path:r,size:_.size,lastModified:_.lastModified})}return t.sort((r,l)=>l.lastModified-r.lastModified)}catch(e){return console.error("[OPFS] Failed to list files:",e),[]}}function Vt(e,t){let r=0,l=0,_=0;for(let g=0;g<e.length;g++)r+=e[g]*t[g],l+=e[g]*e[g],_+=t[g]*t[g];return l===0||_===0?0:r/(Math.sqrt(l)*Math.sqrt(_))}class uu{constructor(t){Je(this,"centroid");Je(this,"entries");this.centroid=t,this.entries=[]}addEntry(t){this.entries.push(t)}updateCentroid(){if(this.entries.length===0)return;const t=this.centroid.length,r=new Float32Array(t);for(const l of this.entries)for(let _=0;_<t;_++)r[_]+=l.vector[_];for(let l=0;l<t;l++)r[l]/=this.entries.length;this.centroid=r}}class fu{constructor(t=100){Je(this,"clusters",[]);Je(this,"allEntries",[]);Je(this,"dimension",0);Je(this,"numClusters");this.numClusters=t}async build(t){if(t.length===0)return;if(this.allEntries=t,this.dimension=t[0].vector.length,t.length<100){console.log("[VectorIndex] Small dataset, using brute force");return}const r=performance.now(),l=Math.max(10,Math.min(this.numClusters,Math.ceil(Math.sqrt(t.length)))),_=new Set;for(;_.size<l;)_.add(Math.floor(Math.random()*t.length));this.clusters=Array.from(_).map(q=>new uu(Float32Array.from(t[q].vector)));for(let q=0;q<10;q++){for(const x of this.clusters)x.entries=[];for(const x of t){let W=this.clusters[0],te=-1;for(const ce of this.clusters){const Y=Vt(x.vector,ce.centroid);Y>te&&(te=Y,W=ce)}W.addEntry(x)}for(const x of this.clusters)x.updateCentroid()}const g=performance.now()-r;console.log(`[VectorIndex] Built index with ${this.clusters.length} clusters in ${g.toFixed(1)}ms`),console.log(`[VectorIndex] Average cluster size: ${(t.length/this.clusters.length).toFixed(1)}`)}search(t,r=20){if(this.allEntries.length===0)return[];const l=performance.now();if(this.clusters.length===0||this.allEntries.length<100){const ce=this.bruteForceSearch(t,r),Y=performance.now()-l;return console.log(`[VectorIndex] Brute force search: ${Y.toFixed(2)}ms`),ce}const _=Math.max(3,Math.ceil(this.clusters.length*.2)),g=this.clusters.map((ce,Y)=>({cluster:ce,similarity:Vt(t,ce.centroid),idx:Y}));g.sort((ce,Y)=>Y.similarity-ce.similarity);const q=[];let x=0;for(let ce=0;ce<_&&ce<g.length;ce++){const Y=g[ce].cluster;for(const de of Y.entries){const be=Vt(t,de.vector);q.push({gid:de.gid,similarity:be,metadata:de.metadata}),x++}}q.sort((ce,Y)=>Y.similarity-ce.similarity);const W=q.slice(0,r),te=performance.now()-l;return console.log(`[VectorIndex] ANN search: ${te.toFixed(2)}ms (scanned ${x}/${this.allEntries.length} entries)`),W}bruteForceSearch(t,r){const l=[];for(const _ of this.allEntries){const g=Vt(t,_.vector);l.push({gid:_.gid,similarity:g,metadata:_.metadata})}return l.sort((_,g)=>g.similarity-_.similarity),l.slice(0,r)}getStats(){return{totalEntries:this.allEntries.length,numClusters:this.clusters.length,dimension:this.dimension,avgClusterSize:this.clusters.length>0?(this.allEntries.length/this.clusters.length).toFixed(1):0}}clear(){this.clusters=[],this.allEntries=[],this.dimension=0}}const _u=["sqlar","meta_index","meta_fts","entities","node_index","edges","ledger_blocks","checkpoints","keys"],jt=1e4,du=1e3;let Ie=null,nt=null,dt=null,_t=null;async function pu(){nt||(console.log("[Worker] Initializing SQLite WASM..."),nt=await tu({print:console.log,printErr:console.error}),console.log("[Worker] SQLite WASM initialized:",nt.version.libVersion))}function Vr(){if(!Ie)return{valid:!1,missing:["no database open"]};const e=new Set,t=Ie.prepare('SELECT name FROM sqlite_master WHERE type="table"');try{for(;t.step();)e.add(t.get([])[0])}finally{t.finalize()}const r=_u.filter(l=>!e.has(l));return{valid:r.length===0,missing:r}}async function Gr(e,t,r){if(!Ie)throw new Error("No database open");let l="unknown",_=Ie.prepare("SELECT doc_id FROM meta_index LIMIT 1");try{_.step()&&(l=_.get([])[0])}finally{_.finalize()}_=Ie.prepare("SELECT COUNT(*) FROM meta_index");let g=0;try{_.step()&&(g=_.get([])[0])}finally{_.finalize()}_=Ie.prepare("SELECT COUNT(*) FROM entities");let q=0;try{_.step()&&(q=_.get([])[0])}finally{_.finalize()}_=Ie.prepare("SELECT COUNT(*) FROM edges");let x=0;try{_.step()&&(x=_.get([])[0])}finally{_.finalize()}let W=!1,te,ce;_=Ie.prepare(`
    SELECT name FROM sqlite_master
    WHERE type='table' AND name='leann_vec'
  `);try{if(_.step()){W=!0;const de=Ie.prepare("SELECT model_id, dim FROM leann_meta LIMIT 1");try{if(de.step()){const be=de.get([]);te=be[0],ce=be[1]}}finally{de.finalize()}}}finally{_.finalize()}const Y={fileName:e,fileSize:t,docId:l,pageCount:g,entityCount:q,edgeCount:x,hasVectors:W,vectorModel:te,vectorDim:ce,opfsPath:r};return W&&await hu(),Y}async function hu(){if(!(!Ie||!(dt!=null&&dt.hasVectors)))try{const e=performance.now();console.log("[Worker] Building vector index..."),_t&&_t.clear(),_t=new fu(100);const t=[],r=dt.vectorModel||"gte-small-384",l=Ie.prepare(`
      SELECT lv.gid, lv.embedding, m.page_no, m.title
      FROM leann_vec lv
      JOIN meta_index m ON m.gid = lv.gid
      WHERE lv.model_id = ?
      LIMIT 10000
    `);try{for(l.bind([r]);l.step();){const q=l.get([]),x=Hr(q[1]);t.push({gid:q[0],vector:x,metadata:{pageNo:q[2],title:q[3]}})}}finally{l.finalize()}await _t.build(t);const _=performance.now()-e,g=_t.getStats();console.log(`[Worker] Vector index built in ${_.toFixed(1)}ms:`,g)}catch(e){console.error("[Worker] Failed to build vector index:",e),_t=null}}async function Kr(e){try{const t=await e.arrayBuffer(),r=new Uint8Array(t);Ie&&(Ie.close(),Ie=null),Ie=new nt.oo1.DB(":memory:");const l=nt.capi.sqlite3_deserialize(Ie.pointer,"main",r,r.length,r.length,nt.capi.SQLITE_DESERIALIZE_FREEONCLOSE|nt.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(l!==nt.capi.SQLITE_OK)throw new Error(`Failed to deserialize database: ${l}`);const _=Vr();if(!_.valid)throw new Error(`Invalid schema. Missing tables: ${_.missing.join(", ")}`);const g=await Gr(e.name,e.size);return dt=g,console.log("[Worker] Capsule opened:",g),{ok:!0,data:g}}catch(t){return console.error("[Worker] Failed to open capsule:",t),{ok:!1,error:String(t)}}}async function mu(){try{const e=await fetch("/memglyph-demo.mgx.sqlite");if(!e.ok)throw new Error(`Failed to fetch demo capsule: ${e.statusText}`);const t=await e.arrayBuffer(),r=new Blob([t],{type:"application/x-sqlite3"}),l=new File([r],"memglyph-demo.mgx.sqlite",{type:"application/x-sqlite3"});return await Kr(l)}catch(e){return console.error("[Worker] Failed to open demo capsule:",e),{ok:!1,error:String(e)}}}async function gu(e){try{if(!bt())throw new Error("OPFS not supported in this browser");const t=await au(e);Ie&&(Ie.close(),Ie=null),Ie=new nt.oo1.DB(":memory:");const r=nt.capi.sqlite3_deserialize(Ie.pointer,"main",t,t.length,t.length,nt.capi.SQLITE_DESERIALIZE_FREEONCLOSE|nt.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(r!==nt.capi.SQLITE_OK)throw new Error(`Failed to deserialize database: ${r}`);const l=Vr();if(!l.valid)throw new Error(`Invalid schema. Missing tables: ${l.missing.join(", ")}`);const _=await Gr(e,t.length,e);return dt=_,console.log("[Worker] Capsule opened from OPFS:",_),Yt(_)}catch(t){return console.error("[Worker] Failed to open capsule from OPFS:",t),rn(t)}}async function bu(e){try{throw Ie?bt()?nt.capi.sqlite3_serialize(Ie.pointer,"main",0,0)?new Error("SAVE_TO_OPFS should be handled by main thread, not worker"):new Error("Failed to serialize database"):new Error("OPFS not supported in this browser"):new Error("No database open")}catch(t){return console.error("[Worker] Failed to save to OPFS:",t),rn(t)}}async function yu(e){try{if(!bt())throw new Error("OPFS not supported in this browser");return await lu(e),console.log(`[Worker] Removed file from OPFS: ${e}`),Yt(void 0)}catch(t){return console.error("[Worker] Failed to remove file from OPFS:",t),rn(t)}}async function vu(){try{if(!bt())return Yt([]);const e=await cu();return Yt(e)}catch(e){return console.error("[Worker] Failed to list OPFS files:",e),rn(e)}}function wu(){return Ie?(Ie.close(),Ie=null,dt=null,_t&&(_t.clear(),_t=null),{ok:!0,data:void 0}):{ok:!1,error:"No database open"}}function Jr(e,t,r,l){if(!Ie)return{ok:!1,error:"No database open"};const _=Math.min(t,du),g=[],q=r||l,x=q?ht.FTS_SEARCH_WITH_ENTITIES:ht.FTS_SEARCH,W=Ie.prepare(x);try{for(q?W.bind([e,r||null,r||null,l||null,l||null,_]):W.bind([e,_]);W.step();){const te=W.get([]);g.push({gid:te[0],pageNo:te[1],title:te[2],snippet:te[3],rank:te[4],score:te[5]})}return{ok:!0,data:g}}catch(te){return{ok:!1,error:String(te)}}finally{W.finalize()}}function qu(e,t){if(!Ie)return{ok:!1,error:"No database open"};if(!(dt!=null&&dt.hasVectors))return{ok:!1,error:"No vectors available in capsule"};const r=Math.min(t,jt),l=performance.now();if(_t){const W=_t.search(e,r).map(ce=>({gid:ce.gid,pageNo:ce.metadata.pageNo,title:ce.metadata.title,similarity:ce.similarity})),te=performance.now()-l;return console.log(`[Worker] Vector search (indexed): ${te.toFixed(2)}ms, ${W.length} results`),{ok:!0,data:W}}console.log("[Worker] Vector search (brute force fallback)");const _=[],g=dt.vectorModel||"gte-small-384",q=Ie.prepare(ht.GET_ALL_VECTORS);try{q.bind([g]);const x=[];for(;q.step();){const W=q.get([]),te=Hr(W[3]);x.push({gid:W[0],pageNo:W[1],title:W[2],vector:te})}for(const W of x){const te=ru(e,W.vector);_.push({gid:W.gid,pageNo:W.pageNo,title:W.title,similarity:te})}return _.sort((W,te)=>te.similarity-W.similarity),_.splice(r),{ok:!0,data:_}}catch(x){return{ok:!1,error:String(x)}}finally{q.finalize()}}function Eu(e,t,r){if(!Ie)return{ok:!1,error:"No database open"};const l=Math.min(t,jt),_={...nu,...r};try{const g=Jr(e,Math.min(l*3,50));if(!g.ok)return g;const q=g.data,x=new Map;for(const Y of q)x.set(Y.gid,{gid:Y.gid,pageNo:Y.pageNo,title:Y.title,snippet:Y.snippet,ftsScore:Y.score,vectorScore:0,entityScore:0,graphScore:0});const W=e.toLowerCase().split(/\s+/).filter(Y=>Y.length>2);if(W.length>0)for(const[Y,de]of x){const be=Ie.prepare(ht.GET_PAGE_ENTITIES);try{be.bind([Y]);let Re=0;for(;be.step();){const Ze=be.get([]),rt=String(Ze[1]).toLowerCase();for(const it of W)if(rt.includes(it)){Re++;break}}de.entityScore=Math.min(Re/3,1)}finally{be.finalize()}}const te=Array.from(x.keys()).slice(0,Math.min(10,l));for(const Y of te){const de=x.get(Y),be=Ie.prepare(ht.GET_GRAPH_NEIGHBORS);try{be.bind([Y,5]);let Re=0;for(;be.step();){const rt=be.get([])[0];x.has(rt)&&Re++}de.graphScore=Math.min(Re/3,1)}finally{be.finalize()}}const ce=[];for(const[Y,de]of x){const be=_.fts*de.ftsScore+_.vector*de.vectorScore+_.entity*de.entityScore+_.graph*de.graphScore;ce.push({gid:de.gid,pageNo:de.pageNo,title:de.title,snippet:de.snippet,scores:{fts:de.ftsScore,vector:de.vectorScore,entity:de.entityScore,graph:de.graphScore,final:be}})}return ce.sort((Y,de)=>de.scores.final-Y.scores.final),ce.splice(l),{ok:!0,data:ce}}catch(g){return{ok:!1,error:String(g)}}}function Su(e,t=100){if(!Ie)return{ok:!1,error:"No database open"};const r=Math.min(t,jt),l=[],_=Ie.prepare(ht.LIST_ENTITY_FACETS);try{for(_.bind([e||null,r]);_.step();){const g=_.get([]);l.push({entityType:g[0],normalizedValue:g[1],count:g[2]})}return{ok:!0,data:l}}catch(g){return{ok:!1,error:String(g)}}finally{_.finalize()}}function ku(e,t){if(!Ie)return{ok:!1,error:"No database open"};const r=Math.min(e,jt),l=[],_=Ie.prepare(ht.GET_PAGE_LIST);try{for(_.bind([r,t]);_.step();){const g=_.get([]);l.push({gid:g[0],docId:g[1],pageNo:g[2],title:g[3],tags:g[4],updatedTs:g[5]})}return{ok:!0,data:l}}catch(g){return{ok:!1,error:String(g)}}finally{_.finalize()}}function Au(e){if(!Ie)return{ok:!1,error:"No database open"};const t=Ie.prepare(ht.GET_PAGE_BLOB);try{return t.bind([e]),t.step()?{ok:!0,data:t.get([])[0]}:{ok:!1,error:`Blob not found: ${e}`}}catch(r){return{ok:!1,error:String(r)}}finally{t.finalize()}}async function Iu(e){if(!Ie)return{ok:!1,error:"No database open"};const t=Ie.prepare(ht.VERIFY_PAGE);try{if(t.bind([e]),t.step()){const r=t.get([]),l=r[1],_=r[6],g=await iu(_||"");return{ok:!0,data:{gid:r[0],contentSha:l,expectedSha:g,verified:l===g,signer:r[2],signature:r[3],epoch:r[4],merkleRoot:r[5]}}}return{ok:!1,error:`No receipt found for GID: ${e}`}}catch(r){return{ok:!1,error:String(r)}}finally{t.finalize()}}function Tu(){if(!Ie)return{ok:!1,error:"No database open"};const e=[],t=Ie.prepare(ht.GET_CHECKPOINTS);try{for(;t.step();){const r=t.get([]);e.push({epoch:r[0],merkleRoot:r[1],pagesCount:r[2],createdTs:r[4],anchors:su(r[3])})}return{ok:!0,data:e}}catch(r){return{ok:!1,error:String(r)}}finally{t.finalize()}}function Ou(e,t,r=3,l=50){if(!Ie)return{ok:!1,error:"No database open"};const _=Math.min(l,jt);try{const g=[],q=[],x={},W=new Set,te=[];for(te.push({gid:e,distance:0}),x[e]=0;te.length>0&&g.length<_;){const{gid:ce,distance:Y}=te.shift();if(W.has(ce)||Y>r)continue;W.add(ce);const de=Ie.prepare("SELECT gid, page_no, title FROM meta_index WHERE gid = ?");try{if(de.bind([ce]),de.step()){const be=de.get([]);g.push({gid:be[0],pageNo:be[1],title:be[2]})}}finally{de.finalize()}if(Y<r){const be=Ie.prepare(`
          SELECT
            n2.gid,
            e.pred,
            e.weight
          FROM node_index n1
          JOIN edges e ON e.fromNode = n1.node_id
          JOIN node_index n2 ON n2.node_id = e.toNode
          WHERE n1.gid = ?
          ${t?"AND e.pred = ?":""}
          ORDER BY e.weight DESC
        `);try{for(t?be.bind([ce,t]):be.bind([ce]);be.step();){const Re=be.get([]),Ze=Re[0],rt=Re[1],it=Re[2];q.push({fromGid:ce,toGid:Ze,predicate:rt,weight:it}),!W.has(Ze)&&!(Ze in x)&&(x[Ze]=Y+1,te.push({gid:Ze,distance:Y+1}))}}finally{be.finalize()}}}return{ok:!0,data:{nodes:g,edges:q,distances:x}}}catch(g){return{ok:!1,error:String(g)}}}function xu(e,t){if(!Ie)return{ok:!1,error:"No database open"};try{const r=Ie.prepare(e),l=[];try{for(r.bind(t);r.step();)l.push(r.get([]))}finally{r.finalize()}return{ok:!0,data:l}}catch(r){return{ok:!1,error:String(r)}}}function Fu(){if(!Ie)return{ok:!1,error:"No database open"};try{const e=nt.capi.sqlite3_js_db_export(Ie.pointer);return e?(console.log(`[Worker] Exported Core database: ${e.byteLength} bytes`),{ok:!0,data:e}):{ok:!1,error:"Failed to export database"}}catch(e){return{ok:!1,error:String(e)}}}async function Pu(e){try{switch(e.type){case"OPEN_FROM_FILE":return await Kr(e.file);case"OPEN_FROM_OPFS":return await gu(e.path);case"OPEN_DEMO":return await mu();case"SAVE_TO_OPFS":return await bu(e.path);case"REMOVE_FROM_OPFS":return await yu(e.path);case"LIST_OPFS_FILES":return await vu();case"CLOSE":return wu();case"FTS_SEARCH":return Jr(e.query,e.limit||20,e.entityType,e.entityValue);case"VECTOR_SEARCH":return qu(e.queryVector,e.limit||20);case"HYBRID_SEARCH":return Eu(e.query,e.limit||20,e.weights);case"LIST_ENTITIES":return Su(e.entityType,e.limit||100);case"GET_PAGE_LIST":return ku(e.limit||100,e.offset||0);case"GET_PAGE_BLOB":return Au(e.name);case"VERIFY_PAGE":return await Iu(e.gid);case"GET_CHECKPOINTS":return Tu();case"GRAPH_HOPS":return Ou(e.seedGid,e.predicate,e.maxHops||3,e.limit||50);case"EXPORT_DATABASE":return Fu();case"QUERY":return xu(e.sql,e.params||[]);default:return{ok:!1,error:`Unknown request type: ${e.type}`}}}catch(t){return{ok:!1,error:String(t)}}}self.onmessage=async e=>{const{id:t,request:r}=e.data;nt||await pu();const l=await Pu(r),_={id:t,response:l};self.postMessage(_)};self.postMessage({type:"READY"});console.log("[Worker] SQLite worker loaded and ready");
