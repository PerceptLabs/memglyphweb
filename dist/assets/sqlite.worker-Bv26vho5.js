var _s=Object.defineProperty;var Vn=e=>{throw TypeError(e)};var ds=(e,t,r)=>t in e?_s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ut=(e,t,r)=>ds(e,typeof t!="symbol"?t+"":t,r),un=(e,t,r)=>t.has(e)||Vn("Cannot "+r);var fe=(e,t,r)=>(un(e,t,"read from private field"),r?r.call(e):t.get(e)),st=(e,t,r)=>t.has(e)?Vn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ft=(e,t,r,l)=>(un(e,t,"write to private field"),l?l.call(e,r):t.set(e,r),r),$t=(e,t,r)=>(un(e,t,"access private method"),r);function H(e,t,r){function l(C,Y){var ae;Object.defineProperty(C,"_zod",{value:C._zod??{},enumerable:!1}),(ae=C._zod).traits??(ae.traits=new Set),C._zod.traits.add(e),t(C,Y);for(const pe in q.prototype)pe in C||Object.defineProperty(C,pe,{value:q.prototype[pe].bind(C)});C._zod.constr=q,C._zod.def=Y}const p=(r==null?void 0:r.Parent)??Object;class y extends p{}Object.defineProperty(y,"name",{value:e});function q(C){var Y;const ae=r!=null&&r.Parent?new y:this;l(ae,C),(Y=ae._zod).deferred??(Y.deferred=[]);for(const pe of ae._zod.deferred)pe();return ae}return Object.defineProperty(q,"init",{value:l}),Object.defineProperty(q,Symbol.hasInstance,{value:C=>{var Y,ae;return r!=null&&r.Parent&&C instanceof r.Parent?!0:(ae=(Y=C==null?void 0:C._zod)==null?void 0:Y.traits)==null?void 0:ae.has(e)}}),Object.defineProperty(q,"name",{value:e}),q}class Ot extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class hr extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const mr={};function wt(e){return mr}function ps(e){const t=Object.values(e).filter(l=>typeof l=="number");return Object.entries(e).filter(([l,p])=>t.indexOf(+l)===-1).map(([l,p])=>p)}function dn(e,t){return typeof t=="bigint"?t.toString():t}function Kt(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function gn(e){return e==null}function bn(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function hs(e,t){const r=(e.toString().split(".")[1]||"").length,l=t.toString();let p=(l.split(".")[1]||"").length;if(p===0&&/\d?e-\d?/.test(l)){const Y=l.match(/\d?e-(\d?)/);Y!=null&&Y[1]&&(p=Number.parseInt(Y[1]))}const y=r>p?r:p,q=Number.parseInt(e.toFixed(y).replace(".","")),C=Number.parseInt(t.toFixed(y).replace(".",""));return q%C/10**y}const Gn=Symbol("evaluating");function Me(e,t,r){let l;Object.defineProperty(e,t,{get(){if(l!==Gn)return l===void 0&&(l=Gn,l=r()),l},set(p){Object.defineProperty(e,t,{value:p})},configurable:!0})}function Et(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function St(...e){const t={};for(const r of e){const l=Object.getOwnPropertyDescriptors(r);Object.assign(t,l)}return Object.defineProperties({},t)}function Kn(e){return JSON.stringify(e)}const gr="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function zt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const ms=Kt(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Ct(e){if(zt(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(zt(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function br(e){return Ct(e)?{...e}:Array.isArray(e)?[...e]:e}const gs=new Set(["string","number","symbol"]);function xt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ht(e,t,r){const l=new e._zod.constr(t??e._zod.def);return(!t||r!=null&&r.parent)&&(l._zod.parent=e),l}function we(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function bs(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const ys={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function vs(e,t){const r=e._zod.def,l=St(e._zod.def,{get shape(){const p={};for(const y in t){if(!(y in r.shape))throw new Error(`Unrecognized key: "${y}"`);t[y]&&(p[y]=r.shape[y])}return Et(this,"shape",p),p},checks:[]});return ht(e,l)}function ws(e,t){const r=e._zod.def,l=St(e._zod.def,{get shape(){const p={...e._zod.def.shape};for(const y in t){if(!(y in r.shape))throw new Error(`Unrecognized key: "${y}"`);t[y]&&delete p[y]}return Et(this,"shape",p),p},checks:[]});return ht(e,l)}function qs(e,t){if(!Ct(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const p=St(e._zod.def,{get shape(){const y={...e._zod.def.shape,...t};return Et(this,"shape",y),y},checks:[]});return ht(e,p)}function Es(e,t){if(!Ct(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const l={...e._zod.def.shape,...t};return Et(this,"shape",l),l},checks:e._zod.def.checks};return ht(e,r)}function Ss(e,t){const r=St(e._zod.def,{get shape(){const l={...e._zod.def.shape,...t._zod.def.shape};return Et(this,"shape",l),l},get catchall(){return t._zod.def.catchall},checks:[]});return ht(e,r)}function ks(e,t,r){const l=St(t._zod.def,{get shape(){const p=t._zod.def.shape,y={...p};if(r)for(const q in r){if(!(q in p))throw new Error(`Unrecognized key: "${q}"`);r[q]&&(y[q]=e?new e({type:"optional",innerType:p[q]}):p[q])}else for(const q in p)y[q]=e?new e({type:"optional",innerType:p[q]}):p[q];return Et(this,"shape",y),y},checks:[]});return ht(t,l)}function As(e,t,r){const l=St(t._zod.def,{get shape(){const p=t._zod.def.shape,y={...p};if(r)for(const q in r){if(!(q in y))throw new Error(`Unrecognized key: "${q}"`);r[q]&&(y[q]=new e({type:"nonoptional",innerType:p[q]}))}else for(const q in p)y[q]=new e({type:"nonoptional",innerType:p[q]});return Et(this,"shape",y),y},checks:[]});return ht(t,l)}function Tt(e,t=0){var r;if(e.aborted===!0)return!0;for(let l=t;l<e.issues.length;l++)if(((r=e.issues[l])==null?void 0:r.continue)!==!0)return!0;return!1}function yr(e,t){return t.map(r=>{var l;return(l=r).path??(l.path=[]),r.path.unshift(e),r})}function Ut(e){return typeof e=="string"?e:e==null?void 0:e.message}function qt(e,t,r){var p,y,q,C,Y,ae;const l={...e,path:e.path??[]};if(!e.message){const pe=Ut((q=(y=(p=e.inst)==null?void 0:p._zod.def)==null?void 0:y.error)==null?void 0:q.call(y,e))??Ut((C=t==null?void 0:t.error)==null?void 0:C.call(t,e))??Ut((Y=r.customError)==null?void 0:Y.call(r,e))??Ut((ae=r.localeError)==null?void 0:ae.call(r,e))??"Invalid input";l.message=pe}return delete l.inst,delete l.continue,t!=null&&t.reportInput||delete l.input,l}function yn(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Rt(...e){const[t,r,l]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:l}:{...t}}const vr=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,dn,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},wr=H("$ZodError",vr),qr=H("$ZodError",vr,{Parent:Error});function Is(e,t=r=>r.message){const r={},l=[];for(const p of e.issues)p.path.length>0?(r[p.path[0]]=r[p.path[0]]||[],r[p.path[0]].push(t(p))):l.push(t(p));return{formErrors:l,fieldErrors:r}}function Ts(e,t=r=>r.message){const r={_errors:[]},l=p=>{for(const y of p.issues)if(y.code==="invalid_union"&&y.errors.length)y.errors.map(q=>l({issues:q}));else if(y.code==="invalid_key")l({issues:y.issues});else if(y.code==="invalid_element")l({issues:y.issues});else if(y.path.length===0)r._errors.push(t(y));else{let q=r,C=0;for(;C<y.path.length;){const Y=y.path[C];C===y.path.length-1?(q[Y]=q[Y]||{_errors:[]},q[Y]._errors.push(t(y))):q[Y]=q[Y]||{_errors:[]},q=q[Y],C++}}};return l(e),r}const vn=e=>(t,r,l,p)=>{const y=l?Object.assign(l,{async:!1}):{async:!1},q=t._zod.run({value:r,issues:[]},y);if(q instanceof Promise)throw new Ot;if(q.issues.length){const C=new((p==null?void 0:p.Err)??e)(q.issues.map(Y=>qt(Y,y,wt())));throw gr(C,p==null?void 0:p.callee),C}return q.value},wn=e=>async(t,r,l,p)=>{const y=l?Object.assign(l,{async:!0}):{async:!0};let q=t._zod.run({value:r,issues:[]},y);if(q instanceof Promise&&(q=await q),q.issues.length){const C=new((p==null?void 0:p.Err)??e)(q.issues.map(Y=>qt(Y,y,wt())));throw gr(C,p==null?void 0:p.callee),C}return q.value},Jt=e=>(t,r,l)=>{const p=l?{...l,async:!1}:{async:!1},y=t._zod.run({value:r,issues:[]},p);if(y instanceof Promise)throw new Ot;return y.issues.length?{success:!1,error:new(e??wr)(y.issues.map(q=>qt(q,p,wt())))}:{success:!0,data:y.value}},Os=Jt(qr),Yt=e=>async(t,r,l)=>{const p=l?Object.assign(l,{async:!0}):{async:!0};let y=t._zod.run({value:r,issues:[]},p);return y instanceof Promise&&(y=await y),y.issues.length?{success:!1,error:new e(y.issues.map(q=>qt(q,p,wt())))}:{success:!0,data:y.value}},xs=Yt(qr),Fs=e=>(t,r,l)=>{const p=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return vn(e)(t,r,p)},Ps=e=>(t,r,l)=>vn(e)(t,r,l),Ns=e=>async(t,r,l)=>{const p=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return wn(e)(t,r,p)},Ls=e=>async(t,r,l)=>wn(e)(t,r,l),zs=e=>(t,r,l)=>{const p=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return Jt(e)(t,r,p)},Cs=e=>(t,r,l)=>Jt(e)(t,r,l),Rs=e=>async(t,r,l)=>{const p=l?Object.assign(l,{direction:"backward"}):{direction:"backward"};return Yt(e)(t,r,p)},Ds=e=>async(t,r,l)=>Yt(e)(t,r,l),Ms=/^[cC][^\s-]{8,}$/,js=/^[0-9a-z]+$/,$s=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Us=/^[0-9a-vA-V]{20}$/,Bs=/^[A-Za-z0-9]{27}$/,Ws=/^[a-zA-Z0-9_-]{21}$/,Zs=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Qs=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Jn=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Hs=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Vs="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Gs(){return new RegExp(Vs,"u")}const Ks=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Js=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Ys=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Xs=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,eo=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Er=/^[A-Za-z0-9_-]*$/,to=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,no=/^\+(?:[0-9]){6,14}[0-9]$/,Sr="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ro=new RegExp(`^${Sr}$`);function kr(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function io(e){return new RegExp(`^${kr(e)}$`)}function so(e){const t=kr({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const l=`${t}(?:${r.join("|")})`;return new RegExp(`^${Sr}T(?:${l})$`)}const oo=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},ao=/^-?\d+$/,lo=/^-?\d+(?:\.\d+)?/,co=/^(?:true|false)$/i,uo=/^null$/i,fo=/^[^A-Z]*$/,_o=/^[^a-z]*$/,ot=H("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),Ar={number:"number",bigint:"bigint",object:"date"},Ir=H("$ZodCheckLessThan",(e,t)=>{ot.init(e,t);const r=Ar[typeof t.value];e._zod.onattach.push(l=>{const p=l._zod.bag,y=(t.inclusive?p.maximum:p.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<y&&(t.inclusive?p.maximum=t.value:p.exclusiveMaximum=t.value)}),e._zod.check=l=>{(t.inclusive?l.value<=t.value:l.value<t.value)||l.issues.push({origin:r,code:"too_big",maximum:t.value,input:l.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Tr=H("$ZodCheckGreaterThan",(e,t)=>{ot.init(e,t);const r=Ar[typeof t.value];e._zod.onattach.push(l=>{const p=l._zod.bag,y=(t.inclusive?p.minimum:p.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>y&&(t.inclusive?p.minimum=t.value:p.exclusiveMinimum=t.value)}),e._zod.check=l=>{(t.inclusive?l.value>=t.value:l.value>t.value)||l.issues.push({origin:r,code:"too_small",minimum:t.value,input:l.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),po=H("$ZodCheckMultipleOf",(e,t)=>{ot.init(e,t),e._zod.onattach.push(r=>{var l;(l=r._zod.bag).multipleOf??(l.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):hs(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),ho=H("$ZodCheckNumberFormat",(e,t)=>{var q;ot.init(e,t),t.format=t.format||"float64";const r=(q=t.format)==null?void 0:q.includes("int"),l=r?"int":"number",[p,y]=ys[t.format];e._zod.onattach.push(C=>{const Y=C._zod.bag;Y.format=t.format,Y.minimum=p,Y.maximum=y,r&&(Y.pattern=ao)}),e._zod.check=C=>{const Y=C.value;if(r){if(!Number.isInteger(Y)){C.issues.push({expected:l,format:t.format,code:"invalid_type",continue:!1,input:Y,inst:e});return}if(!Number.isSafeInteger(Y)){Y>0?C.issues.push({input:Y,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:l,continue:!t.abort}):C.issues.push({input:Y,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:l,continue:!t.abort});return}}Y<p&&C.issues.push({origin:"number",input:Y,code:"too_small",minimum:p,inclusive:!0,inst:e,continue:!t.abort}),Y>y&&C.issues.push({origin:"number",input:Y,code:"too_big",maximum:y,inst:e})}}),mo=H("$ZodCheckMaxLength",(e,t)=>{var r;ot.init(e,t),(r=e._zod.def).when??(r.when=l=>{const p=l.value;return!gn(p)&&p.length!==void 0}),e._zod.onattach.push(l=>{const p=l._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<p&&(l._zod.bag.maximum=t.maximum)}),e._zod.check=l=>{const p=l.value;if(p.length<=t.maximum)return;const q=yn(p);l.issues.push({origin:q,code:"too_big",maximum:t.maximum,inclusive:!0,input:p,inst:e,continue:!t.abort})}}),go=H("$ZodCheckMinLength",(e,t)=>{var r;ot.init(e,t),(r=e._zod.def).when??(r.when=l=>{const p=l.value;return!gn(p)&&p.length!==void 0}),e._zod.onattach.push(l=>{const p=l._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>p&&(l._zod.bag.minimum=t.minimum)}),e._zod.check=l=>{const p=l.value;if(p.length>=t.minimum)return;const q=yn(p);l.issues.push({origin:q,code:"too_small",minimum:t.minimum,inclusive:!0,input:p,inst:e,continue:!t.abort})}}),bo=H("$ZodCheckLengthEquals",(e,t)=>{var r;ot.init(e,t),(r=e._zod.def).when??(r.when=l=>{const p=l.value;return!gn(p)&&p.length!==void 0}),e._zod.onattach.push(l=>{const p=l._zod.bag;p.minimum=t.length,p.maximum=t.length,p.length=t.length}),e._zod.check=l=>{const p=l.value,y=p.length;if(y===t.length)return;const q=yn(p),C=y>t.length;l.issues.push({origin:q,...C?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:l.value,inst:e,continue:!t.abort})}}),Xt=H("$ZodCheckStringFormat",(e,t)=>{var r,l;ot.init(e,t),e._zod.onattach.push(p=>{const y=p._zod.bag;y.format=t.format,t.pattern&&(y.patterns??(y.patterns=new Set),y.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=p=>{t.pattern.lastIndex=0,!t.pattern.test(p.value)&&p.issues.push({origin:"string",code:"invalid_format",format:t.format,input:p.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(l=e._zod).check??(l.check=()=>{})}),yo=H("$ZodCheckRegex",(e,t)=>{Xt.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),vo=H("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=fo),Xt.init(e,t)}),wo=H("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=_o),Xt.init(e,t)}),qo=H("$ZodCheckIncludes",(e,t)=>{ot.init(e,t);const r=xt(t.includes),l=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=l,e._zod.onattach.push(p=>{const y=p._zod.bag;y.patterns??(y.patterns=new Set),y.patterns.add(l)}),e._zod.check=p=>{p.value.includes(t.includes,t.position)||p.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:p.value,inst:e,continue:!t.abort})}}),Eo=H("$ZodCheckStartsWith",(e,t)=>{ot.init(e,t);const r=new RegExp(`^${xt(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(l=>{const p=l._zod.bag;p.patterns??(p.patterns=new Set),p.patterns.add(r)}),e._zod.check=l=>{l.value.startsWith(t.prefix)||l.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:l.value,inst:e,continue:!t.abort})}}),So=H("$ZodCheckEndsWith",(e,t)=>{ot.init(e,t);const r=new RegExp(`.*${xt(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(l=>{const p=l._zod.bag;p.patterns??(p.patterns=new Set),p.patterns.add(r)}),e._zod.check=l=>{l.value.endsWith(t.suffix)||l.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:l.value,inst:e,continue:!t.abort})}}),ko=H("$ZodCheckOverwrite",(e,t)=>{ot.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class Ao{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const l=t.split(`
`).filter(q=>q),p=Math.min(...l.map(q=>q.length-q.trimStart().length)),y=l.map(q=>q.slice(p)).map(q=>" ".repeat(this.indent*2)+q);for(const q of y)this.content.push(q)}compile(){const t=Function,r=this==null?void 0:this.args,p=[...((this==null?void 0:this.content)??[""]).map(y=>`  ${y}`)];return new t(...r,p.join(`
`))}}const Io={major:4,minor:1,patch:12},Be=H("$ZodType",(e,t)=>{var p;var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Io;const l=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&l.unshift(e);for(const y of l)for(const q of y._zod.onattach)q(e);if(l.length===0)(r=e._zod).deferred??(r.deferred=[]),(p=e._zod.deferred)==null||p.push(()=>{e._zod.run=e._zod.parse});else{const y=(C,Y,ae)=>{let pe=Tt(C),ee;for(const he of Y){if(he._zod.def.when){if(!he._zod.def.when(C))continue}else if(pe)continue;const Ie=C.issues.length,Re=he._zod.check(C);if(Re instanceof Promise&&(ae==null?void 0:ae.async)===!1)throw new Ot;if(ee||Re instanceof Promise)ee=(ee??Promise.resolve()).then(async()=>{await Re,C.issues.length!==Ie&&(pe||(pe=Tt(C,Ie)))});else{if(C.issues.length===Ie)continue;pe||(pe=Tt(C,Ie))}}return ee?ee.then(()=>C):C},q=(C,Y,ae)=>{if(Tt(C))return C.aborted=!0,C;const pe=y(Y,l,ae);if(pe instanceof Promise){if(ae.async===!1)throw new Ot;return pe.then(ee=>e._zod.parse(ee,ae))}return e._zod.parse(pe,ae)};e._zod.run=(C,Y)=>{if(Y.skipChecks)return e._zod.parse(C,Y);if(Y.direction==="backward"){const pe=e._zod.parse({value:C.value,issues:[]},{...Y,skipChecks:!0});return pe instanceof Promise?pe.then(ee=>q(ee,C,Y)):q(pe,C,Y)}const ae=e._zod.parse(C,Y);if(ae instanceof Promise){if(Y.async===!1)throw new Ot;return ae.then(pe=>y(pe,l,Y))}return y(ae,l,Y)}}e["~standard"]={validate:y=>{var q;try{const C=Os(e,y);return C.success?{value:C.data}:{issues:(q=C.error)==null?void 0:q.issues}}catch{return xs(e,y).then(Y=>{var ae;return Y.success?{value:Y.data}:{issues:(ae=Y.error)==null?void 0:ae.issues}})}},vendor:"zod",version:1}}),qn=H("$ZodString",(e,t)=>{var r;Be.init(e,t),e._zod.pattern=[...((r=e==null?void 0:e._zod.bag)==null?void 0:r.patterns)??[]].pop()??oo(e._zod.bag),e._zod.parse=(l,p)=>{if(t.coerce)try{l.value=String(l.value)}catch{}return typeof l.value=="string"||l.issues.push({expected:"string",code:"invalid_type",input:l.value,inst:e}),l}}),Ue=H("$ZodStringFormat",(e,t)=>{Xt.init(e,t),qn.init(e,t)}),To=H("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Qs),Ue.init(e,t)}),Oo=H("$ZodUUID",(e,t)=>{if(t.version){const l={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(l===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Jn(l))}else t.pattern??(t.pattern=Jn());Ue.init(e,t)}),xo=H("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Hs),Ue.init(e,t)}),Fo=H("$ZodURL",(e,t)=>{Ue.init(e,t),e._zod.check=r=>{try{const l=r.value.trim(),p=new URL(l);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(p.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:to.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(p.protocol.endsWith(":")?p.protocol.slice(0,-1):p.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=p.href:r.value=l;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),Po=H("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Gs()),Ue.init(e,t)}),No=H("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Ws),Ue.init(e,t)}),Lo=H("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Ms),Ue.init(e,t)}),zo=H("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=js),Ue.init(e,t)}),Co=H("$ZodULID",(e,t)=>{t.pattern??(t.pattern=$s),Ue.init(e,t)}),Ro=H("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Us),Ue.init(e,t)}),Do=H("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Bs),Ue.init(e,t)}),Mo=H("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=so(t)),Ue.init(e,t)}),jo=H("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=ro),Ue.init(e,t)}),$o=H("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=io(t)),Ue.init(e,t)}),Uo=H("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Zs),Ue.init(e,t)}),Bo=H("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Ks),Ue.init(e,t),e._zod.onattach.push(r=>{const l=r._zod.bag;l.format="ipv4"})}),Wo=H("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Js),Ue.init(e,t),e._zod.onattach.push(r=>{const l=r._zod.bag;l.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),Zo=H("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Ys),Ue.init(e,t)}),Qo=H("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Xs),Ue.init(e,t),e._zod.check=r=>{const l=r.value.split("/");try{if(l.length!==2)throw new Error;const[p,y]=l;if(!y)throw new Error;const q=Number(y);if(`${q}`!==y)throw new Error;if(q<0||q>128)throw new Error;new URL(`http://[${p}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function Or(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Ho=H("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=eo),Ue.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{Or(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Vo(e){if(!Er.test(e))return!1;const t=e.replace(/[-_]/g,l=>l==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Or(r)}const Go=H("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Er),Ue.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{Vo(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Ko=H("$ZodE164",(e,t)=>{t.pattern??(t.pattern=no),Ue.init(e,t)});function Jo(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[l]=r;if(!l)return!1;const p=JSON.parse(atob(l));return!("typ"in p&&(p==null?void 0:p.typ)!=="JWT"||!p.alg||t&&(!("alg"in p)||p.alg!==t))}catch{return!1}}const Yo=H("$ZodJWT",(e,t)=>{Ue.init(e,t),e._zod.check=r=>{Jo(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),xr=H("$ZodNumber",(e,t)=>{Be.init(e,t),e._zod.pattern=e._zod.bag.pattern??lo,e._zod.parse=(r,l)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const p=r.value;if(typeof p=="number"&&!Number.isNaN(p)&&Number.isFinite(p))return r;const y=typeof p=="number"?Number.isNaN(p)?"NaN":Number.isFinite(p)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:p,inst:e,...y?{received:y}:{}}),r}}),Xo=H("$ZodNumber",(e,t)=>{ho.init(e,t),xr.init(e,t)}),ea=H("$ZodBoolean",(e,t)=>{Be.init(e,t),e._zod.pattern=co,e._zod.parse=(r,l)=>{if(t.coerce)try{r.value=!!r.value}catch{}const p=r.value;return typeof p=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:p,inst:e}),r}}),ta=H("$ZodNull",(e,t)=>{Be.init(e,t),e._zod.pattern=uo,e._zod.values=new Set([null]),e._zod.parse=(r,l)=>{const p=r.value;return p===null||r.issues.push({expected:"null",code:"invalid_type",input:p,inst:e}),r}}),na=H("$ZodUnknown",(e,t)=>{Be.init(e,t),e._zod.parse=r=>r}),ra=H("$ZodNever",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function Yn(e,t,r){e.issues.length&&t.issues.push(...yr(r,e.issues)),t.value[r]=e.value}const ia=H("$ZodArray",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>{const p=r.value;if(!Array.isArray(p))return r.issues.push({expected:"array",code:"invalid_type",input:p,inst:e}),r;r.value=Array(p.length);const y=[];for(let q=0;q<p.length;q++){const C=p[q],Y=t.element._zod.run({value:C,issues:[]},l);Y instanceof Promise?y.push(Y.then(ae=>Yn(ae,r,q))):Yn(Y,r,q)}return y.length?Promise.all(y).then(()=>r):r}});function Ht(e,t,r,l){e.issues.length&&t.issues.push(...yr(r,e.issues)),e.value===void 0?r in l&&(t.value[r]=void 0):t.value[r]=e.value}function Fr(e){var l,p,y,q;const t=Object.keys(e.shape);for(const C of t)if(!((q=(y=(p=(l=e.shape)==null?void 0:l[C])==null?void 0:p._zod)==null?void 0:y.traits)!=null&&q.has("$ZodType")))throw new Error(`Invalid element at key "${C}": expected a Zod schema`);const r=bs(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function Pr(e,t,r,l,p,y){const q=[],C=p.keySet,Y=p.catchall._zod,ae=Y.def.type;for(const pe of Object.keys(t)){if(C.has(pe))continue;if(ae==="never"){q.push(pe);continue}const ee=Y.run({value:t[pe],issues:[]},l);ee instanceof Promise?e.push(ee.then(he=>Ht(he,r,pe,t))):Ht(ee,r,pe,t)}return q.length&&r.issues.push({code:"unrecognized_keys",keys:q,input:t,inst:y}),e.length?Promise.all(e).then(()=>r):r}const sa=H("$ZodObject",(e,t)=>{Be.init(e,t);const r=Object.getOwnPropertyDescriptor(t,"shape");if(!(r!=null&&r.get)){const C=t.shape;Object.defineProperty(t,"shape",{get:()=>{const Y={...C};return Object.defineProperty(t,"shape",{value:Y}),Y}})}const l=Kt(()=>Fr(t));Me(e._zod,"propValues",()=>{const C=t.shape,Y={};for(const ae in C){const pe=C[ae]._zod;if(pe.values){Y[ae]??(Y[ae]=new Set);for(const ee of pe.values)Y[ae].add(ee)}}return Y});const p=zt,y=t.catchall;let q;e._zod.parse=(C,Y)=>{q??(q=l.value);const ae=C.value;if(!p(ae))return C.issues.push({expected:"object",code:"invalid_type",input:ae,inst:e}),C;C.value={};const pe=[],ee=q.shape;for(const he of q.keys){const Re=ee[he]._zod.run({value:ae[he],issues:[]},Y);Re instanceof Promise?pe.push(Re.then(He=>Ht(He,C,he,ae))):Ht(Re,C,he,ae)}return y?Pr(pe,ae,C,Y,l.value,e):pe.length?Promise.all(pe).then(()=>C):C}}),oa=H("$ZodObjectJIT",(e,t)=>{sa.init(e,t);const r=e._zod.parse,l=Kt(()=>Fr(t)),p=he=>{const Ie=new Ao(["shape","payload","ctx"]),Re=l.value,He=Ge=>{const Je=Kn(Ge);return`shape[${Je}]._zod.run({ value: input[${Je}], issues: [] }, ctx)`};Ie.write("const input = payload.value;");const at=Object.create(null);let ct=0;for(const Ge of Re.keys)at[Ge]=`key_${ct++}`;Ie.write("const newResult = {};");for(const Ge of Re.keys){const Je=at[Ge],Te=Kn(Ge);Ie.write(`const ${Je} = ${He(Ge)};`),Ie.write(`
        if (${Je}.issues.length) {
          payload.issues = payload.issues.concat(${Je}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Te}, ...iss.path] : [${Te}]
          })));
        }
        
        
        if (${Je}.value === undefined) {
          if (${Te} in input) {
            newResult[${Te}] = undefined;
          }
        } else {
          newResult[${Te}] = ${Je}.value;
        }
        
      `)}Ie.write("payload.value = newResult;"),Ie.write("return payload;");const it=Ie.compile();return(Ge,Je)=>it(he,Ge,Je)};let y;const q=zt,C=!mr.jitless,ae=C&&ms.value,pe=t.catchall;let ee;e._zod.parse=(he,Ie)=>{ee??(ee=l.value);const Re=he.value;return q(Re)?C&&ae&&(Ie==null?void 0:Ie.async)===!1&&Ie.jitless!==!0?(y||(y=p(t.shape)),he=y(he,Ie),pe?Pr([],Re,he,Ie,ee,e):he):r(he,Ie):(he.issues.push({expected:"object",code:"invalid_type",input:Re,inst:e}),he)}});function Xn(e,t,r,l){for(const y of e)if(y.issues.length===0)return t.value=y.value,t;const p=e.filter(y=>!Tt(y));return p.length===1?(t.value=p[0].value,p[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(y=>y.issues.map(q=>qt(q,l,wt())))}),t)}const Nr=H("$ZodUnion",(e,t)=>{Be.init(e,t),Me(e._zod,"optin",()=>t.options.some(p=>p._zod.optin==="optional")?"optional":void 0),Me(e._zod,"optout",()=>t.options.some(p=>p._zod.optout==="optional")?"optional":void 0),Me(e._zod,"values",()=>{if(t.options.every(p=>p._zod.values))return new Set(t.options.flatMap(p=>Array.from(p._zod.values)))}),Me(e._zod,"pattern",()=>{if(t.options.every(p=>p._zod.pattern)){const p=t.options.map(y=>y._zod.pattern);return new RegExp(`^(${p.map(y=>bn(y.source)).join("|")})$`)}});const r=t.options.length===1,l=t.options[0]._zod.run;e._zod.parse=(p,y)=>{if(r)return l(p,y);let q=!1;const C=[];for(const Y of t.options){const ae=Y._zod.run({value:p.value,issues:[]},y);if(ae instanceof Promise)C.push(ae),q=!0;else{if(ae.issues.length===0)return ae;C.push(ae)}}return q?Promise.all(C).then(Y=>Xn(Y,p,e,y)):Xn(C,p,e,y)}}),aa=H("$ZodDiscriminatedUnion",(e,t)=>{Nr.init(e,t);const r=e._zod.parse;Me(e._zod,"propValues",()=>{const p={};for(const y of t.options){const q=y._zod.propValues;if(!q||Object.keys(q).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(y)}"`);for(const[C,Y]of Object.entries(q)){p[C]||(p[C]=new Set);for(const ae of Y)p[C].add(ae)}}return p});const l=Kt(()=>{var q;const p=t.options,y=new Map;for(const C of p){const Y=(q=C._zod.propValues)==null?void 0:q[t.discriminator];if(!Y||Y.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(C)}"`);for(const ae of Y){if(y.has(ae))throw new Error(`Duplicate discriminator value "${String(ae)}"`);y.set(ae,C)}}return y});e._zod.parse=(p,y)=>{const q=p.value;if(!zt(q))return p.issues.push({code:"invalid_type",expected:"object",input:q,inst:e}),p;const C=l.value.get(q==null?void 0:q[t.discriminator]);return C?C._zod.run(p,y):t.unionFallback?r(p,y):(p.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:q,path:[t.discriminator],inst:e}),p)}}),la=H("$ZodIntersection",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>{const p=r.value,y=t.left._zod.run({value:p,issues:[]},l),q=t.right._zod.run({value:p,issues:[]},l);return y instanceof Promise||q instanceof Promise?Promise.all([y,q]).then(([Y,ae])=>er(r,Y,ae)):er(r,y,q)}});function pn(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Ct(e)&&Ct(t)){const r=Object.keys(t),l=Object.keys(e).filter(y=>r.indexOf(y)!==-1),p={...e,...t};for(const y of l){const q=pn(e[y],t[y]);if(!q.valid)return{valid:!1,mergeErrorPath:[y,...q.mergeErrorPath]};p[y]=q.data}return{valid:!0,data:p}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let l=0;l<e.length;l++){const p=e[l],y=t[l],q=pn(p,y);if(!q.valid)return{valid:!1,mergeErrorPath:[l,...q.mergeErrorPath]};r.push(q.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function er(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),Tt(e))return e;const l=pn(t.value,r.value);if(!l.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(l.mergeErrorPath)}`);return e.value=l.data,e}const ca=H("$ZodEnum",(e,t)=>{Be.init(e,t);const r=ps(t.entries),l=new Set(r);e._zod.values=l,e._zod.pattern=new RegExp(`^(${r.filter(p=>gs.has(typeof p)).map(p=>typeof p=="string"?xt(p):p.toString()).join("|")})$`),e._zod.parse=(p,y)=>{const q=p.value;return l.has(q)||p.issues.push({code:"invalid_value",values:r,input:q,inst:e}),p}}),ua=H("$ZodLiteral",(e,t)=>{if(Be.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?xt(r):r?xt(r.toString()):String(r)).join("|")})$`),e._zod.parse=(r,l)=>{const p=r.value;return e._zod.values.has(p)||r.issues.push({code:"invalid_value",values:t.values,input:p,inst:e}),r}}),fa=H("$ZodTransform",(e,t)=>{Be.init(e,t),e._zod.parse=(r,l)=>{if(l.direction==="backward")throw new hr(e.constructor.name);const p=t.transform(r.value,r);if(l.async)return(p instanceof Promise?p:Promise.resolve(p)).then(q=>(r.value=q,r));if(p instanceof Promise)throw new Ot;return r.value=p,r}});function tr(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const _a=H("$ZodOptional",(e,t)=>{Be.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Me(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),Me(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${bn(r.source)})?$`):void 0}),e._zod.parse=(r,l)=>{if(t.innerType._zod.optin==="optional"){const p=t.innerType._zod.run(r,l);return p instanceof Promise?p.then(y=>tr(y,r.value)):tr(p,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,l)}}),da=H("$ZodNullable",(e,t)=>{Be.init(e,t),Me(e._zod,"optin",()=>t.innerType._zod.optin),Me(e._zod,"optout",()=>t.innerType._zod.optout),Me(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${bn(r.source)}|null)$`):void 0}),Me(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,l)=>r.value===null?r:t.innerType._zod.run(r,l)}),pa=H("$ZodDefault",(e,t)=>{Be.init(e,t),e._zod.optin="optional",Me(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,l)=>{if(l.direction==="backward")return t.innerType._zod.run(r,l);if(r.value===void 0)return r.value=t.defaultValue,r;const p=t.innerType._zod.run(r,l);return p instanceof Promise?p.then(y=>nr(y,t)):nr(p,t)}});function nr(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const ha=H("$ZodPrefault",(e,t)=>{Be.init(e,t),e._zod.optin="optional",Me(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,l)=>(l.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,l))}),ma=H("$ZodNonOptional",(e,t)=>{Be.init(e,t),Me(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(l=>l!==void 0)):void 0}),e._zod.parse=(r,l)=>{const p=t.innerType._zod.run(r,l);return p instanceof Promise?p.then(y=>rr(y,e)):rr(p,e)}});function rr(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const ga=H("$ZodCatch",(e,t)=>{Be.init(e,t),Me(e._zod,"optin",()=>t.innerType._zod.optin),Me(e._zod,"optout",()=>t.innerType._zod.optout),Me(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,l)=>{if(l.direction==="backward")return t.innerType._zod.run(r,l);const p=t.innerType._zod.run(r,l);return p instanceof Promise?p.then(y=>(r.value=y.value,y.issues.length&&(r.value=t.catchValue({...r,error:{issues:y.issues.map(q=>qt(q,l,wt()))},input:r.value}),r.issues=[]),r)):(r.value=p.value,p.issues.length&&(r.value=t.catchValue({...r,error:{issues:p.issues.map(y=>qt(y,l,wt()))},input:r.value}),r.issues=[]),r)}}),ba=H("$ZodPipe",(e,t)=>{Be.init(e,t),Me(e._zod,"values",()=>t.in._zod.values),Me(e._zod,"optin",()=>t.in._zod.optin),Me(e._zod,"optout",()=>t.out._zod.optout),Me(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,l)=>{if(l.direction==="backward"){const y=t.out._zod.run(r,l);return y instanceof Promise?y.then(q=>Bt(q,t.in,l)):Bt(y,t.in,l)}const p=t.in._zod.run(r,l);return p instanceof Promise?p.then(y=>Bt(y,t.out,l)):Bt(p,t.out,l)}});function Bt(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const ya=H("$ZodReadonly",(e,t)=>{Be.init(e,t),Me(e._zod,"propValues",()=>t.innerType._zod.propValues),Me(e._zod,"values",()=>t.innerType._zod.values),Me(e._zod,"optin",()=>t.innerType._zod.optin),Me(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,l)=>{if(l.direction==="backward")return t.innerType._zod.run(r,l);const p=t.innerType._zod.run(r,l);return p instanceof Promise?p.then(ir):ir(p)}});function ir(e){return e.value=Object.freeze(e.value),e}const va=H("$ZodCustom",(e,t)=>{ot.init(e,t),Be.init(e,t),e._zod.parse=(r,l)=>r,e._zod.check=r=>{const l=r.value,p=t.fn(l);if(p instanceof Promise)return p.then(y=>sr(y,r,l,e));sr(p,r,l,e)}});function sr(e,t,r,l){if(!e){const p={code:"custom",input:r,inst:l,path:[...l._zod.def.path??[]],continue:!l._zod.def.abort};l._zod.def.params&&(p.params=l._zod.def.params),t.issues.push(Rt(p))}}class wa{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const l=r[0];if(this._map.set(t,l),l&&typeof l=="object"&&"id"in l){if(this._idmap.has(l.id))throw new Error(`ID ${l.id} already exists in the registry`);this._idmap.set(l.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const l={...this.get(r)??{}};delete l.id;const p={...l,...this._map.get(t)};return Object.keys(p).length?p:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function qa(){return new wa}const Wt=qa();function Ea(e,t){return new e({type:"string",...we(t)})}function Sa(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...we(t)})}function or(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...we(t)})}function ka(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...we(t)})}function Aa(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...we(t)})}function Ia(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...we(t)})}function Ta(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...we(t)})}function Oa(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...we(t)})}function xa(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...we(t)})}function Fa(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...we(t)})}function Pa(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...we(t)})}function Na(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...we(t)})}function La(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...we(t)})}function za(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...we(t)})}function Ca(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...we(t)})}function Ra(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...we(t)})}function Da(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...we(t)})}function Ma(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...we(t)})}function ja(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...we(t)})}function $a(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...we(t)})}function Ua(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...we(t)})}function Ba(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...we(t)})}function Wa(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...we(t)})}function Za(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...we(t)})}function Qa(e,t){return new e({type:"string",format:"date",check:"string_format",...we(t)})}function Ha(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...we(t)})}function Va(e,t){return new e({type:"string",format:"duration",check:"string_format",...we(t)})}function Ga(e,t){return new e({type:"number",checks:[],...we(t)})}function Ka(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...we(t)})}function Ja(e,t){return new e({type:"boolean",...we(t)})}function Ya(e,t){return new e({type:"null",...we(t)})}function Xa(e){return new e({type:"unknown"})}function el(e,t){return new e({type:"never",...we(t)})}function ar(e,t){return new Ir({check:"less_than",...we(t),value:e,inclusive:!1})}function fn(e,t){return new Ir({check:"less_than",...we(t),value:e,inclusive:!0})}function lr(e,t){return new Tr({check:"greater_than",...we(t),value:e,inclusive:!1})}function _n(e,t){return new Tr({check:"greater_than",...we(t),value:e,inclusive:!0})}function cr(e,t){return new po({check:"multiple_of",...we(t),value:e})}function Lr(e,t){return new mo({check:"max_length",...we(t),maximum:e})}function Vt(e,t){return new go({check:"min_length",...we(t),minimum:e})}function zr(e,t){return new bo({check:"length_equals",...we(t),length:e})}function tl(e,t){return new yo({check:"string_format",format:"regex",...we(t),pattern:e})}function nl(e){return new vo({check:"string_format",format:"lowercase",...we(e)})}function rl(e){return new wo({check:"string_format",format:"uppercase",...we(e)})}function il(e,t){return new qo({check:"string_format",format:"includes",...we(t),includes:e})}function sl(e,t){return new Eo({check:"string_format",format:"starts_with",...we(t),prefix:e})}function ol(e,t){return new So({check:"string_format",format:"ends_with",...we(t),suffix:e})}function Dt(e){return new ko({check:"overwrite",tx:e})}function al(e){return Dt(t=>t.normalize(e))}function ll(){return Dt(e=>e.trim())}function cl(){return Dt(e=>e.toLowerCase())}function ul(){return Dt(e=>e.toUpperCase())}function fl(e,t,r){return new e({type:"array",element:t,...we(r)})}function _l(e,t,r){return new e({type:"custom",check:"custom",fn:t,...we(r)})}function dl(e){const t=pl(r=>(r.addIssue=l=>{if(typeof l=="string")r.issues.push(Rt(l,r.value,t._zod.def));else{const p=l;p.fatal&&(p.continue=!1),p.code??(p.code="custom"),p.input??(p.input=r.value),p.inst??(p.inst=t),p.continue??(p.continue=!t._zod.def.abort),r.issues.push(Rt(p))}},e(r.value,r)));return t}function pl(e,t){const r=new ot({check:"custom",...we(t)});return r._zod.check=e,r}const hl=H("ZodISODateTime",(e,t)=>{Mo.init(e,t),We.init(e,t)});function ml(e){return Za(hl,e)}const gl=H("ZodISODate",(e,t)=>{jo.init(e,t),We.init(e,t)});function bl(e){return Qa(gl,e)}const yl=H("ZodISOTime",(e,t)=>{$o.init(e,t),We.init(e,t)});function vl(e){return Ha(yl,e)}const wl=H("ZodISODuration",(e,t)=>{Uo.init(e,t),We.init(e,t)});function ql(e){return Va(wl,e)}const El=(e,t)=>{wr.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>Ts(e,r)},flatten:{value:r=>Is(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,dn,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,dn,2)}},isEmpty:{get(){return e.issues.length===0}}})},lt=H("ZodError",El,{Parent:Error}),Sl=vn(lt),kl=wn(lt),Al=Jt(lt),Il=Yt(lt),Tl=Fs(lt),Ol=Ps(lt),xl=Ns(lt),Fl=Ls(lt),Pl=zs(lt),Nl=Cs(lt),Ll=Rs(lt),zl=Ds(lt),Ze=H("ZodType",(e,t)=>(Be.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(St(t,{checks:[...t.checks??[],...r.map(l=>typeof l=="function"?{_zod:{check:l,def:{check:"custom"},onattach:[]}}:l)]})),e.clone=(r,l)=>ht(e,r,l),e.brand=()=>e,e.register=(r,l)=>(r.add(e,l),e),e.parse=(r,l)=>Sl(e,r,l,{callee:e.parse}),e.safeParse=(r,l)=>Al(e,r,l),e.parseAsync=async(r,l)=>kl(e,r,l,{callee:e.parseAsync}),e.safeParseAsync=async(r,l)=>Il(e,r,l),e.spa=e.safeParseAsync,e.encode=(r,l)=>Tl(e,r,l),e.decode=(r,l)=>Ol(e,r,l),e.encodeAsync=async(r,l)=>xl(e,r,l),e.decodeAsync=async(r,l)=>Fl(e,r,l),e.safeEncode=(r,l)=>Pl(e,r,l),e.safeDecode=(r,l)=>Nl(e,r,l),e.safeEncodeAsync=async(r,l)=>Ll(e,r,l),e.safeDecodeAsync=async(r,l)=>zl(e,r,l),e.refine=(r,l)=>e.check(Tc(r,l)),e.superRefine=r=>e.check(Oc(r)),e.overwrite=r=>e.check(Dt(r)),e.optional=()=>_r(e),e.nullable=()=>dr(e),e.nullish=()=>_r(dr(e)),e.nonoptional=r=>qc(e,r),e.array=()=>En(e),e.or=r=>Sn([e,r]),e.and=r=>_c(e,r),e.transform=r=>pr(e,mc(r)),e.default=r=>yc(e,r),e.prefault=r=>wc(e,r),e.catch=r=>Sc(e,r),e.pipe=r=>pr(e,r),e.readonly=()=>Ic(e),e.describe=r=>{const l=e.clone();return Wt.add(l,{description:r}),l},Object.defineProperty(e,"description",{get(){var r;return(r=Wt.get(e))==null?void 0:r.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Wt.get(e);const l=e.clone();return Wt.add(l,r[0]),l},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Cr=H("_ZodString",(e,t)=>{qn.init(e,t),Ze.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...l)=>e.check(tl(...l)),e.includes=(...l)=>e.check(il(...l)),e.startsWith=(...l)=>e.check(sl(...l)),e.endsWith=(...l)=>e.check(ol(...l)),e.min=(...l)=>e.check(Vt(...l)),e.max=(...l)=>e.check(Lr(...l)),e.length=(...l)=>e.check(zr(...l)),e.nonempty=(...l)=>e.check(Vt(1,...l)),e.lowercase=l=>e.check(nl(l)),e.uppercase=l=>e.check(rl(l)),e.trim=()=>e.check(ll()),e.normalize=(...l)=>e.check(al(...l)),e.toLowerCase=()=>e.check(cl()),e.toUpperCase=()=>e.check(ul())}),Cl=H("ZodString",(e,t)=>{qn.init(e,t),Cr.init(e,t),e.email=r=>e.check(Sa(Rl,r)),e.url=r=>e.check(Oa(Dl,r)),e.jwt=r=>e.check(Wa(Xl,r)),e.emoji=r=>e.check(xa(Ml,r)),e.guid=r=>e.check(or(ur,r)),e.uuid=r=>e.check(ka(Zt,r)),e.uuidv4=r=>e.check(Aa(Zt,r)),e.uuidv6=r=>e.check(Ia(Zt,r)),e.uuidv7=r=>e.check(Ta(Zt,r)),e.nanoid=r=>e.check(Fa(jl,r)),e.guid=r=>e.check(or(ur,r)),e.cuid=r=>e.check(Pa($l,r)),e.cuid2=r=>e.check(Na(Ul,r)),e.ulid=r=>e.check(La(Bl,r)),e.base64=r=>e.check($a(Kl,r)),e.base64url=r=>e.check(Ua(Jl,r)),e.xid=r=>e.check(za(Wl,r)),e.ksuid=r=>e.check(Ca(Zl,r)),e.ipv4=r=>e.check(Ra(Ql,r)),e.ipv6=r=>e.check(Da(Hl,r)),e.cidrv4=r=>e.check(Ma(Vl,r)),e.cidrv6=r=>e.check(ja(Gl,r)),e.e164=r=>e.check(Ba(Yl,r)),e.datetime=r=>e.check(ml(r)),e.date=r=>e.check(bl(r)),e.time=r=>e.check(vl(r)),e.duration=r=>e.check(ql(r))});function ke(e){return Ea(Cl,e)}const We=H("ZodStringFormat",(e,t)=>{Ue.init(e,t),Cr.init(e,t)}),Rl=H("ZodEmail",(e,t)=>{xo.init(e,t),We.init(e,t)}),ur=H("ZodGUID",(e,t)=>{To.init(e,t),We.init(e,t)}),Zt=H("ZodUUID",(e,t)=>{Oo.init(e,t),We.init(e,t)}),Dl=H("ZodURL",(e,t)=>{Fo.init(e,t),We.init(e,t)}),Ml=H("ZodEmoji",(e,t)=>{Po.init(e,t),We.init(e,t)}),jl=H("ZodNanoID",(e,t)=>{No.init(e,t),We.init(e,t)}),$l=H("ZodCUID",(e,t)=>{Lo.init(e,t),We.init(e,t)}),Ul=H("ZodCUID2",(e,t)=>{zo.init(e,t),We.init(e,t)}),Bl=H("ZodULID",(e,t)=>{Co.init(e,t),We.init(e,t)}),Wl=H("ZodXID",(e,t)=>{Ro.init(e,t),We.init(e,t)}),Zl=H("ZodKSUID",(e,t)=>{Do.init(e,t),We.init(e,t)}),Ql=H("ZodIPv4",(e,t)=>{Bo.init(e,t),We.init(e,t)}),Hl=H("ZodIPv6",(e,t)=>{Wo.init(e,t),We.init(e,t)}),Vl=H("ZodCIDRv4",(e,t)=>{Zo.init(e,t),We.init(e,t)}),Gl=H("ZodCIDRv6",(e,t)=>{Qo.init(e,t),We.init(e,t)}),Kl=H("ZodBase64",(e,t)=>{Ho.init(e,t),We.init(e,t)}),Jl=H("ZodBase64URL",(e,t)=>{Go.init(e,t),We.init(e,t)}),Yl=H("ZodE164",(e,t)=>{Ko.init(e,t),We.init(e,t)}),Xl=H("ZodJWT",(e,t)=>{Yo.init(e,t),We.init(e,t)}),Rr=H("ZodNumber",(e,t)=>{xr.init(e,t),Ze.init(e,t),e.gt=(l,p)=>e.check(lr(l,p)),e.gte=(l,p)=>e.check(_n(l,p)),e.min=(l,p)=>e.check(_n(l,p)),e.lt=(l,p)=>e.check(ar(l,p)),e.lte=(l,p)=>e.check(fn(l,p)),e.max=(l,p)=>e.check(fn(l,p)),e.int=l=>e.check(fr(l)),e.safe=l=>e.check(fr(l)),e.positive=l=>e.check(lr(0,l)),e.nonnegative=l=>e.check(_n(0,l)),e.negative=l=>e.check(ar(0,l)),e.nonpositive=l=>e.check(fn(0,l)),e.multipleOf=(l,p)=>e.check(cr(l,p)),e.step=(l,p)=>e.check(cr(l,p)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function Ne(e){return Ga(Rr,e)}const ec=H("ZodNumberFormat",(e,t)=>{Xo.init(e,t),Rr.init(e,t)});function fr(e){return Ka(ec,e)}const tc=H("ZodBoolean",(e,t)=>{ea.init(e,t),Ze.init(e,t)});function Dr(e){return Ja(tc,e)}const nc=H("ZodNull",(e,t)=>{ta.init(e,t),Ze.init(e,t)});function rc(e){return Ya(nc,e)}const ic=H("ZodUnknown",(e,t)=>{na.init(e,t),Ze.init(e,t)});function hn(){return Xa(ic)}const sc=H("ZodNever",(e,t)=>{ra.init(e,t),Ze.init(e,t)});function oc(e){return el(sc,e)}const ac=H("ZodArray",(e,t)=>{ia.init(e,t),Ze.init(e,t),e.element=t.element,e.min=(r,l)=>e.check(Vt(r,l)),e.nonempty=r=>e.check(Vt(1,r)),e.max=(r,l)=>e.check(Lr(r,l)),e.length=(r,l)=>e.check(zr(r,l)),e.unwrap=()=>e.element});function En(e,t){return fl(ac,e,t)}const lc=H("ZodObject",(e,t)=>{oa.init(e,t),Ze.init(e,t),Me(e,"shape",()=>t.shape),e.keyof=()=>dc(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:hn()}),e.loose=()=>e.clone({...e._zod.def,catchall:hn()}),e.strict=()=>e.clone({...e._zod.def,catchall:oc()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>qs(e,r),e.safeExtend=r=>Es(e,r),e.merge=r=>Ss(e,r),e.pick=r=>vs(e,r),e.omit=r=>ws(e,r),e.partial=(...r)=>ks(jr,e,r[0]),e.required=(...r)=>As($r,e,r[0])});function ze(e,t){const r={type:"object",shape:e??{},...we(t)};return new lc(r)}const Mr=H("ZodUnion",(e,t)=>{Nr.init(e,t),Ze.init(e,t),e.options=t.options});function Sn(e,t){return new Mr({type:"union",options:e,...we(t)})}const cc=H("ZodDiscriminatedUnion",(e,t)=>{Mr.init(e,t),aa.init(e,t)});function uc(e,t,r){return new cc({type:"union",options:t,discriminator:e,...we(r)})}const fc=H("ZodIntersection",(e,t)=>{la.init(e,t),Ze.init(e,t)});function _c(e,t){return new fc({type:"intersection",left:e,right:t})}const mn=H("ZodEnum",(e,t)=>{ca.init(e,t),Ze.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(l,p)=>{const y={};for(const q of l)if(r.has(q))y[q]=t.entries[q];else throw new Error(`Key ${q} not found in enum`);return new mn({...t,checks:[],...we(p),entries:y})},e.exclude=(l,p)=>{const y={...t.entries};for(const q of l)if(r.has(q))delete y[q];else throw new Error(`Key ${q} not found in enum`);return new mn({...t,checks:[],...we(p),entries:y})}});function dc(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(l=>[l,l])):e;return new mn({type:"enum",entries:r,...we(t)})}const pc=H("ZodLiteral",(e,t)=>{ua.init(e,t),Ze.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function Ve(e,t){return new pc({type:"literal",values:Array.isArray(e)?e:[e],...we(t)})}const hc=H("ZodTransform",(e,t)=>{fa.init(e,t),Ze.init(e,t),e._zod.parse=(r,l)=>{if(l.direction==="backward")throw new hr(e.constructor.name);r.addIssue=y=>{if(typeof y=="string")r.issues.push(Rt(y,r.value,t));else{const q=y;q.fatal&&(q.continue=!1),q.code??(q.code="custom"),q.input??(q.input=r.value),q.inst??(q.inst=e),r.issues.push(Rt(q))}};const p=t.transform(r.value,r);return p instanceof Promise?p.then(y=>(r.value=y,r)):(r.value=p,r)}});function mc(e){return new hc({type:"transform",transform:e})}const jr=H("ZodOptional",(e,t)=>{_a.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType});function _r(e){return new jr({type:"optional",innerType:e})}const gc=H("ZodNullable",(e,t)=>{da.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType});function dr(e){return new gc({type:"nullable",innerType:e})}const bc=H("ZodDefault",(e,t)=>{pa.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function yc(e,t){return new bc({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():br(t)}})}const vc=H("ZodPrefault",(e,t)=>{ha.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType});function wc(e,t){return new vc({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():br(t)}})}const $r=H("ZodNonOptional",(e,t)=>{ma.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType});function qc(e,t){return new $r({type:"nonoptional",innerType:e,...we(t)})}const Ec=H("ZodCatch",(e,t)=>{ga.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Sc(e,t){return new Ec({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const kc=H("ZodPipe",(e,t)=>{ba.init(e,t),Ze.init(e,t),e.in=t.in,e.out=t.out});function pr(e,t){return new kc({type:"pipe",in:e,out:t})}const Ac=H("ZodReadonly",(e,t)=>{ya.init(e,t),Ze.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ic(e){return new Ac({type:"readonly",innerType:e})}const Ur=H("ZodCustom",(e,t)=>{va.init(e,t),Ze.init(e,t)});function Tc(e,t={}){return _l(Ur,e,t)}function Oc(e){return dl(e)}function Br(e,t={error:`Input not instance of ${e.name}`}){const r=new Ur({type:"custom",check:"custom",fn:l=>l instanceof e,abort:!0,...we(t)});return r._zod.bag.Class=e,r}const xc=ze({type:Ve("OPEN_FROM_FILE"),file:Br(File)}),Fc=ze({type:Ve("OPEN_FROM_OPFS"),path:ke()}),Pc=ze({type:Ve("OPEN_DEMO")}),Nc=ze({type:Ve("SAVE_TO_OPFS"),path:ke()}),Lc=ze({type:Ve("REMOVE_FROM_OPFS"),path:ke()}),zc=ze({type:Ve("LIST_OPFS_FILES")}),Cc=ze({type:Ve("CLOSE")}),Rc=ze({type:Ve("FTS_SEARCH"),query:ke(),limit:Ne().int().positive().max(200).optional().default(20)}),Dc=ze({type:Ve("VECTOR_SEARCH"),queryVector:Br(Float32Array),limit:Ne().int().positive().max(200).optional().default(20)}),Mc=ze({fts:Ne().min(0).max(1),vector:Ne().min(0).max(1),entity:Ne().min(0).max(1),graph:Ne().min(0).max(1)}).partial(),jc=ze({type:Ve("HYBRID_SEARCH"),query:ke(),limit:Ne().int().positive().max(200).optional().default(20),weights:Mc.optional()}),$c=ze({type:Ve("LIST_ENTITIES"),entityType:ke().optional(),limit:Ne().int().positive().max(500).optional().default(100)}),Uc=ze({type:Ve("GRAPH_HOPS"),seedGid:ke(),predicate:ke().optional(),maxHops:Ne().int().positive().max(5).optional().default(3),limit:Ne().int().positive().max(200).optional().default(50)}),Bc=ze({type:Ve("GET_PAGE_BLOB"),name:ke()}),Wc=ze({type:Ve("GET_PAGE_LIST"),limit:Ne().int().positive().max(500).optional().default(100),offset:Ne().int().nonnegative().optional().default(0)}),Zc=ze({type:Ve("VERIFY_PAGE"),gid:ke()}),Qc=ze({type:Ve("GET_CHECKPOINTS")}),Hc=ze({type:Ve("QUERY"),sql:ke(),params:En(Sn([ke(),Ne(),rc()])).optional().default([])}),Vc=uc("type",[xc,Fc,Pc,Nc,Lc,zc,Cc,Rc,Dc,jc,$c,Uc,Bc,Wc,Zc,Qc,Hc]);ze({fileName:ke(),fileSize:Ne(),docId:ke(),pageCount:Ne(),entityCount:Ne(),edgeCount:Ne(),hasVectors:Dr(),vectorModel:ke().optional(),vectorDim:Ne().optional(),opfsPath:ke().optional()});ze({gid:ke(),pageNo:Ne(),title:ke().nullable(),snippet:ke(),rank:Ne(),score:Ne()});ze({gid:ke(),pageNo:Ne(),title:ke().nullable(),similarity:Ne()});ze({gid:ke(),pageNo:Ne(),title:ke().nullable(),snippet:ke().nullable(),scores:ze({fts:Ne(),vector:Ne(),entity:Ne(),graph:Ne(),final:Ne()})});ze({entityType:ke(),normalizedValue:ke().nullable(),count:Ne()});ze({gid:ke(),pageNo:Ne(),title:ke().nullable()});ze({fromGid:ke(),toGid:ke(),predicate:ke(),weight:Ne()});ze({gid:ke(),docId:ke(),pageNo:Ne(),title:ke().nullable(),tags:ke().nullable(),updatedTs:ke()});ze({epoch:ke(),merkleRoot:ke(),pagesCount:Ne(),createdTs:ke(),anchors:En(ke()).nullable()});ze({gid:ke(),contentSha:ke(),expectedSha:ke().nullable(),verified:Dr(),signer:ke().nullable(),signature:ke().nullable(),epoch:ke().nullable(),merkleRoot:ke().nullable()});ze({path:ke(),size:Ne(),lastModified:Ne()});ze({id:Ne(),request:Vc});ze({id:Ne(),response:Sn([ze({ok:Ve(!0),data:hn()}),ze({ok:Ve(!1),error:ke()})])});function Gt(e){return{ok:!0,data:e}}function en(e){return{ok:!1,error:e instanceof Error?e.message:e}}async function kn(e={}){var Qn;var t,r=e,l=typeof window=="object",p=typeof WorkerGlobalScope<"u";typeof process=="object"&&((Qn=process.versions)!=null&&Qn.node)&&process.type!="renderer",function(n){const s=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{console.warn("globalThis.sqlite3InitModuleState is missing")}});delete globalThis.sqlite3InitModuleState,s.debugModule("pre-js.js sqlite3InitModuleState =",s),n.locateFile=(function(c,i){return new URL(c,import.meta.url).href}).bind(s),n.instantiateWasm=(function(i,d){const a=this,o=n.locateFile(a.wasmFilename,typeof C>"u"?"":C);a.debugModule("instantiateWasm() uri =",o,"sIMS =",this);const h=()=>fetch(o,{credentials:"same-origin"}),L=oe=>{oe.imports=i,a.instantiateWasm=oe,d(oe.instance,oe.module)};return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(h(),i).then(L):async()=>h().then(oe=>oe.arrayBuffer()).then(oe=>WebAssembly.instantiate(oe,i)).then(L))()}).bind(s)}(r);var y="./this.program",q=import.meta.url,C="";function Y(n){return r.locateFile?r.locateFile(n,C):C+n}var ae,pe;if(l||p){try{C=new URL(".",q).href}catch{}p&&(pe=n=>{var s=new XMLHttpRequest;return s.open("GET",n,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),ae=async n=>{var s=await fetch(n,{credentials:"same-origin"});if(s.ok)return s.arrayBuffer();throw new Error(s.status+" : "+s.url)}}var ee=console.log.bind(console),he=console.error.bind(console),Ie,Re=!1,He,at,ct,it,Ge,Je,Te,Ke,tt,In=!1;function Tn(){var n=ct.buffer;it=new Int8Array(n),Je=new Int16Array(n),Ge=new Uint8Array(n),Te=new Int32Array(n),Ke=new Uint32Array(n),tt=new BigInt64Array(n),new BigUint64Array(n)}function Vr(){if(r.wasmMemory)ct=r.wasmMemory;else{var n=r.INITIAL_MEMORY||8388608;ct=new WebAssembly.Memory({initial:n/65536,maximum:32768})}Tn()}function Gr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)ai(r.preRun.shift());xn(Pn)}function Kr(){In=!0,!r.noFSInit&&!_.initialized&&_.init(),It.__wasm_call_ctors(),_.ignorePermissions=!1}function Jr(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)oi(r.postRun.shift());xn(Fn)}var gt=0,Ft=null;function On(n){var s;gt++,(s=r.monitorRunDependencies)==null||s.call(r,gt)}function tn(n){var c;if(gt--,(c=r.monitorRunDependencies)==null||c.call(r,gt),gt==0&&Ft){var s=Ft;Ft=null,s()}}function Yr(n){var c;(c=r.onAbort)==null||c.call(r,n),n="Aborted("+n+")",he(n),Re=!0,n+=". Build with -sASSERTIONS for more info.";var s=new WebAssembly.RuntimeError(n);throw at==null||at(s),s}var nn;function Xr(){return r.locateFile?Y("sqlite3.wasm"):new URL("/assets/sqlite3-1f8bVu-G.wasm",import.meta.url).href}function ei(n){if(n==nn&&Ie)return new Uint8Array(Ie);if(pe)return pe(n);throw"both async and sync fetching of the wasm failed"}async function ti(n){if(!Ie)try{var s=await ae(n);return new Uint8Array(s)}catch{}return ei(n)}async function ni(n,s){try{var c=await ti(n),i=await WebAssembly.instantiate(c,s);return i}catch(d){he(`failed to asynchronously prepare wasm: ${d}`),Yr(d)}}async function ri(n,s,c){if(!n)try{var i=fetch(s,{credentials:"same-origin"}),d=await WebAssembly.instantiateStreaming(i,c);return d}catch(a){he(`wasm streaming compile failed: ${a}`),he("falling back to ArrayBuffer instantiation")}return ni(s,c)}function ii(){return{env:Zn,wasi_snapshot_preview1:Zn}}async function si(){function n(a,o){return It=a.exports,as(It),tn(),It}On();function s(a){return n(a.instance)}var c=ii();if(r.instantiateWasm)return new Promise((a,o)=>{r.instantiateWasm(c,(h,L)=>{a(n(h))})});nn??(nn=Xr());var i=await ri(Ie,nn,c),d=s(i);return d}var xn=n=>{for(;n.length>0;)n.shift()(r)},Fn=[],oi=n=>Fn.push(n),Pn=[],ai=n=>Pn.push(n),De={isAbs:n=>n.charAt(0)==="/",splitPath:n=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return s.exec(n).slice(1)},normalizeArray:(n,s)=>{for(var c=0,i=n.length-1;i>=0;i--){var d=n[i];d==="."?n.splice(i,1):d===".."?(n.splice(i,1),c++):c&&(n.splice(i,1),c--)}if(s)for(;c;c--)n.unshift("..");return n},normalize:n=>{var s=De.isAbs(n),c=n.slice(-1)==="/";return n=De.normalizeArray(n.split("/").filter(i=>!!i),!s).join("/"),!n&&!s&&(n="."),n&&c&&(n+="/"),(s?"/":"")+n},dirname:n=>{var s=De.splitPath(n),c=s[0],i=s[1];return!c&&!i?".":(i&&(i=i.slice(0,-1)),c+i)},basename:n=>n&&n.match(/([^\/]+|\/)\/*$/)[1],join:(...n)=>De.normalize(n.join("/")),join2:(n,s)=>De.normalize(n+"/"+s)},li=()=>n=>crypto.getRandomValues(n),Nn=n=>{(Nn=li())(n)},kt={resolve:(...n)=>{for(var s="",c=!1,i=n.length-1;i>=-1&&!c;i--){var d=i>=0?n[i]:_.cwd();if(typeof d!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!d)return"";s=d+"/"+s,c=De.isAbs(d)}return s=De.normalizeArray(s.split("/").filter(a=>!!a),!c).join("/"),(c?"/":"")+s||"."},relative:(n,s)=>{n=kt.resolve(n).slice(1),s=kt.resolve(s).slice(1);function c(M){for(var oe=0;oe<M.length&&M[oe]==="";oe++);for(var Q=M.length-1;Q>=0&&M[Q]==="";Q--);return oe>Q?[]:M.slice(oe,Q-oe+1)}for(var i=c(n.split("/")),d=c(s.split("/")),a=Math.min(i.length,d.length),o=a,h=0;h<a;h++)if(i[h]!==d[h]){o=h;break}for(var L=[],h=o;h<i.length;h++)L.push("..");return L=L.concat(d.slice(o)),L.join("/")}},Ln=new TextDecoder,zn=(n,s,c,i)=>{for(var d=s+c;n[s]&&!(s>=d);)++s;return s},Pt=(n,s=0,c,i)=>{var d=zn(n,s,c);return Ln.decode(n.buffer?n.subarray(s,d):new Uint8Array(n.slice(s,d)))},rn=[],Mt=n=>{for(var s=0,c=0;c<n.length;++c){var i=n.charCodeAt(c);i<=127?s++:i<=2047?s+=2:i>=55296&&i<=57343?(s+=4,++c):s+=3}return s},Cn=(n,s,c,i)=>{if(!(i>0))return 0;for(var d=c,a=c+i-1,o=0;o<n.length;++o){var h=n.codePointAt(o);if(h<=127){if(c>=a)break;s[c++]=h}else if(h<=2047){if(c+1>=a)break;s[c++]=192|h>>6,s[c++]=128|h&63}else if(h<=65535){if(c+2>=a)break;s[c++]=224|h>>12,s[c++]=128|h>>6&63,s[c++]=128|h&63}else{if(c+3>=a)break;s[c++]=240|h>>18,s[c++]=128|h>>12&63,s[c++]=128|h>>6&63,s[c++]=128|h&63,o++}}return s[c]=0,c-d},sn=(n,s,c)=>{var i=Mt(n)+1,d=new Array(i),a=Cn(n,d,0,d.length);return d.length=a,d},ci=()=>{if(!rn.length){var n=null;if(typeof window<"u"&&typeof window.prompt=="function"&&(n=window.prompt("Input: "),n!==null&&(n+=`
`)),!n)return null;rn=sn(n)}return rn.shift()},bt={ttys:[],init(){},shutdown(){},register(n,s){bt.ttys[n]={input:[],output:[],ops:s},_.registerDevice(n,bt.stream_ops)},stream_ops:{open(n){var s=bt.ttys[n.node.rdev];if(!s)throw new _.ErrnoError(43);n.tty=s,n.seekable=!1},close(n){n.tty.ops.fsync(n.tty)},fsync(n){n.tty.ops.fsync(n.tty)},read(n,s,c,i,d){if(!n.tty||!n.tty.ops.get_char)throw new _.ErrnoError(60);for(var a=0,o=0;o<i;o++){var h;try{h=n.tty.ops.get_char(n.tty)}catch{throw new _.ErrnoError(29)}if(h===void 0&&a===0)throw new _.ErrnoError(6);if(h==null)break;a++,s[c+o]=h}return a&&(n.node.atime=Date.now()),a},write(n,s,c,i,d){if(!n.tty||!n.tty.ops.put_char)throw new _.ErrnoError(60);try{for(var a=0;a<i;a++)n.tty.ops.put_char(n.tty,s[c+a])}catch{throw new _.ErrnoError(29)}return i&&(n.node.mtime=n.node.ctime=Date.now()),a}},default_tty_ops:{get_char(n){return ci()},put_char(n,s){s===null||s===10?(ee(Pt(n.output)),n.output=[]):s!=0&&n.output.push(s)},fsync(n){var s;((s=n.output)==null?void 0:s.length)>0&&(ee(Pt(n.output)),n.output=[])},ioctl_tcgets(n){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(n,s,c){return 0},ioctl_tiocgwinsz(n){return[24,80]}},default_tty1_ops:{put_char(n,s){s===null||s===10?(he(Pt(n.output)),n.output=[]):s!=0&&n.output.push(s)},fsync(n){var s;((s=n.output)==null?void 0:s.length)>0&&(he(Pt(n.output)),n.output=[])}}},ui=(n,s)=>Ge.fill(0,n,n+s),Rn=(n,s)=>Math.ceil(n/s)*s,Dn=n=>{n=Rn(n,65536);var s=Wn(65536,n);return s&&ui(s,n),s},Ae={ops_table:null,mount(n){return Ae.createNode(null,"/",16895,0)},createNode(n,s,c,i){if(_.isBlkdev(c)||_.isFIFO(c))throw new _.ErrnoError(63);Ae.ops_table||(Ae.ops_table={dir:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr,lookup:Ae.node_ops.lookup,mknod:Ae.node_ops.mknod,rename:Ae.node_ops.rename,unlink:Ae.node_ops.unlink,rmdir:Ae.node_ops.rmdir,readdir:Ae.node_ops.readdir,symlink:Ae.node_ops.symlink},stream:{llseek:Ae.stream_ops.llseek}},file:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr},stream:{llseek:Ae.stream_ops.llseek,read:Ae.stream_ops.read,write:Ae.stream_ops.write,mmap:Ae.stream_ops.mmap,msync:Ae.stream_ops.msync}},link:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr,readlink:Ae.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr},stream:_.chrdev_stream_ops}});var d=_.createNode(n,s,c,i);return _.isDir(d.mode)?(d.node_ops=Ae.ops_table.dir.node,d.stream_ops=Ae.ops_table.dir.stream,d.contents={}):_.isFile(d.mode)?(d.node_ops=Ae.ops_table.file.node,d.stream_ops=Ae.ops_table.file.stream,d.usedBytes=0,d.contents=null):_.isLink(d.mode)?(d.node_ops=Ae.ops_table.link.node,d.stream_ops=Ae.ops_table.link.stream):_.isChrdev(d.mode)&&(d.node_ops=Ae.ops_table.chrdev.node,d.stream_ops=Ae.ops_table.chrdev.stream),d.atime=d.mtime=d.ctime=Date.now(),n&&(n.contents[s]=d,n.atime=n.mtime=n.ctime=d.atime),d},getFileDataAsTypedArray(n){return n.contents?n.contents.subarray?n.contents.subarray(0,n.usedBytes):new Uint8Array(n.contents):new Uint8Array(0)},expandFileStorage(n,s){var c=n.contents?n.contents.length:0;if(!(c>=s)){var i=1024*1024;s=Math.max(s,c*(c<i?2:1.125)>>>0),c!=0&&(s=Math.max(s,256));var d=n.contents;n.contents=new Uint8Array(s),n.usedBytes>0&&n.contents.set(d.subarray(0,n.usedBytes),0)}},resizeFileStorage(n,s){if(n.usedBytes!=s)if(s==0)n.contents=null,n.usedBytes=0;else{var c=n.contents;n.contents=new Uint8Array(s),c&&n.contents.set(c.subarray(0,Math.min(s,n.usedBytes))),n.usedBytes=s}},node_ops:{getattr(n){var s={};return s.dev=_.isChrdev(n.mode)?n.id:1,s.ino=n.id,s.mode=n.mode,s.nlink=1,s.uid=0,s.gid=0,s.rdev=n.rdev,_.isDir(n.mode)?s.size=4096:_.isFile(n.mode)?s.size=n.usedBytes:_.isLink(n.mode)?s.size=n.link.length:s.size=0,s.atime=new Date(n.atime),s.mtime=new Date(n.mtime),s.ctime=new Date(n.ctime),s.blksize=4096,s.blocks=Math.ceil(s.size/s.blksize),s},setattr(n,s){for(const c of["mode","atime","mtime","ctime"])s[c]!=null&&(n[c]=s[c]);s.size!==void 0&&Ae.resizeFileStorage(n,s.size)},lookup(n,s){throw Ae.doesNotExistError||(Ae.doesNotExistError=new _.ErrnoError(44),Ae.doesNotExistError.stack="<generic error, no stack>"),Ae.doesNotExistError},mknod(n,s,c,i){return Ae.createNode(n,s,c,i)},rename(n,s,c){var i;try{i=_.lookupNode(s,c)}catch{}if(i){if(_.isDir(n.mode))for(var d in i.contents)throw new _.ErrnoError(55);_.hashRemoveNode(i)}delete n.parent.contents[n.name],s.contents[c]=n,n.name=c,s.ctime=s.mtime=n.parent.ctime=n.parent.mtime=Date.now()},unlink(n,s){delete n.contents[s],n.ctime=n.mtime=Date.now()},rmdir(n,s){var c=_.lookupNode(n,s);for(var i in c.contents)throw new _.ErrnoError(55);delete n.contents[s],n.ctime=n.mtime=Date.now()},readdir(n){return[".","..",...Object.keys(n.contents)]},symlink(n,s,c){var i=Ae.createNode(n,s,41471,0);return i.link=c,i},readlink(n){if(!_.isLink(n.mode))throw new _.ErrnoError(28);return n.link}},stream_ops:{read(n,s,c,i,d){var a=n.node.contents;if(d>=n.node.usedBytes)return 0;var o=Math.min(n.node.usedBytes-d,i);if(o>8&&a.subarray)s.set(a.subarray(d,d+o),c);else for(var h=0;h<o;h++)s[c+h]=a[d+h];return o},write(n,s,c,i,d,a){if(s.buffer===it.buffer&&(a=!1),!i)return 0;var o=n.node;if(o.mtime=o.ctime=Date.now(),s.subarray&&(!o.contents||o.contents.subarray)){if(a)return o.contents=s.subarray(c,c+i),o.usedBytes=i,i;if(o.usedBytes===0&&d===0)return o.contents=s.slice(c,c+i),o.usedBytes=i,i;if(d+i<=o.usedBytes)return o.contents.set(s.subarray(c,c+i),d),i}if(Ae.expandFileStorage(o,d+i),o.contents.subarray&&s.subarray)o.contents.set(s.subarray(c,c+i),d);else for(var h=0;h<i;h++)o.contents[d+h]=s[c+h];return o.usedBytes=Math.max(o.usedBytes,d+i),i},llseek(n,s,c){var i=s;if(c===1?i+=n.position:c===2&&_.isFile(n.node.mode)&&(i+=n.node.usedBytes),i<0)throw new _.ErrnoError(28);return i},mmap(n,s,c,i,d){if(!_.isFile(n.node.mode))throw new _.ErrnoError(43);var a,o,h=n.node.contents;if(!(d&2)&&h&&h.buffer===it.buffer)o=!1,a=h.byteOffset;else{if(o=!0,a=Dn(s),!a)throw new _.ErrnoError(48);h&&((c>0||c+s<h.length)&&(h.subarray?h=h.subarray(c,c+s):h=Array.prototype.slice.call(h,c,c+s)),it.set(h,a))}return{ptr:a,allocated:o}},msync(n,s,c,i,d){return Ae.stream_ops.write(n,s,0,i,c,!1),0}}},fi=async n=>{var s=await ae(n);return new Uint8Array(s)},_i=(...n)=>_.createDataFile(...n),Mn=[],di=(n,s,c,i)=>{typeof Browser<"u"&&Browser.init();var d=!1;return Mn.forEach(a=>{d||a.canHandle(s)&&(a.handle(n,s,c,i),d=!0)}),d},pi=(n,s,c,i,d,a,o,h,L,M)=>{var oe=s?kt.resolve(De.join2(n,s)):n;function Q(P){function R(z){M==null||M(),h||_i(n,s,z,i,d,L),a==null||a(),tn()}di(P,oe,R,()=>{o==null||o(),tn()})||R(P)}On(),typeof c=="string"?fi(c).then(Q,o):Q(c)},hi=n=>{var s={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},c=s[n];if(typeof c>"u")throw new Error(`Unknown file open mode: ${n}`);return c},on=(n,s)=>{var c=0;return n&&(c|=365),s&&(c|=146),c},_={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(n){ut(this,"name","ErrnoError");this.errno=n}},FSStream:class{constructor(){ut(this,"shared",{})}get object(){return this.node}set object(n){this.node=n}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(n){this.shared.flags=n}get position(){return this.shared.position}set position(n){this.shared.position=n}},FSNode:class{constructor(n,s,c,i){ut(this,"node_ops",{});ut(this,"stream_ops",{});ut(this,"readMode",365);ut(this,"writeMode",146);ut(this,"mounted",null);n||(n=this),this.parent=n,this.mount=n.mount,this.id=_.nextInode++,this.name=s,this.mode=c,this.rdev=i,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(n){n?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(n){n?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return _.isDir(this.mode)}get isDevice(){return _.isChrdev(this.mode)}},lookupPath(n,s={}){if(!n)throw new _.ErrnoError(44);s.follow_mount??(s.follow_mount=!0),De.isAbs(n)||(n=_.cwd()+"/"+n);e:for(var c=0;c<40;c++){for(var i=n.split("/").filter(M=>!!M),d=_.root,a="/",o=0;o<i.length;o++){var h=o===i.length-1;if(h&&s.parent)break;if(i[o]!=="."){if(i[o]===".."){if(a=De.dirname(a),_.isRoot(d)){n=a+"/"+i.slice(o+1).join("/"),c--;continue e}else d=d.parent;continue}a=De.join2(a,i[o]);try{d=_.lookupNode(d,i[o])}catch(M){if((M==null?void 0:M.errno)===44&&h&&s.noent_okay)return{path:a};throw M}if(_.isMountpoint(d)&&(!h||s.follow_mount)&&(d=d.mounted.root),_.isLink(d.mode)&&(!h||s.follow)){if(!d.node_ops.readlink)throw new _.ErrnoError(52);var L=d.node_ops.readlink(d);De.isAbs(L)||(L=De.dirname(a)+"/"+L),n=L+"/"+i.slice(o+1).join("/");continue e}}}return{path:a,node:d}}throw new _.ErrnoError(32)},getPath(n){for(var s;;){if(_.isRoot(n)){var c=n.mount.mountpoint;return s?c[c.length-1]!=="/"?`${c}/${s}`:c+s:c}s=s?`${n.name}/${s}`:n.name,n=n.parent}},hashName(n,s){for(var c=0,i=0;i<s.length;i++)c=(c<<5)-c+s.charCodeAt(i)|0;return(n+c>>>0)%_.nameTable.length},hashAddNode(n){var s=_.hashName(n.parent.id,n.name);n.name_next=_.nameTable[s],_.nameTable[s]=n},hashRemoveNode(n){var s=_.hashName(n.parent.id,n.name);if(_.nameTable[s]===n)_.nameTable[s]=n.name_next;else for(var c=_.nameTable[s];c;){if(c.name_next===n){c.name_next=n.name_next;break}c=c.name_next}},lookupNode(n,s){var c=_.mayLookup(n);if(c)throw new _.ErrnoError(c);for(var i=_.hashName(n.id,s),d=_.nameTable[i];d;d=d.name_next){var a=d.name;if(d.parent.id===n.id&&a===s)return d}return _.lookup(n,s)},createNode(n,s,c,i){var d=new _.FSNode(n,s,c,i);return _.hashAddNode(d),d},destroyNode(n){_.hashRemoveNode(n)},isRoot(n){return n===n.parent},isMountpoint(n){return!!n.mounted},isFile(n){return(n&61440)===32768},isDir(n){return(n&61440)===16384},isLink(n){return(n&61440)===40960},isChrdev(n){return(n&61440)===8192},isBlkdev(n){return(n&61440)===24576},isFIFO(n){return(n&61440)===4096},isSocket(n){return(n&49152)===49152},flagsToPermissionString(n){var s=["r","w","rw"][n&3];return n&512&&(s+="w"),s},nodePermissions(n,s){return _.ignorePermissions?0:s.includes("r")&&!(n.mode&292)||s.includes("w")&&!(n.mode&146)||s.includes("x")&&!(n.mode&73)?2:0},mayLookup(n){if(!_.isDir(n.mode))return 54;var s=_.nodePermissions(n,"x");return s||(n.node_ops.lookup?0:2)},mayCreate(n,s){if(!_.isDir(n.mode))return 54;try{var c=_.lookupNode(n,s);return 20}catch{}return _.nodePermissions(n,"wx")},mayDelete(n,s,c){var i;try{i=_.lookupNode(n,s)}catch(a){return a.errno}var d=_.nodePermissions(n,"wx");if(d)return d;if(c){if(!_.isDir(i.mode))return 54;if(_.isRoot(i)||_.getPath(i)===_.cwd())return 10}else if(_.isDir(i.mode))return 31;return 0},mayOpen(n,s){return n?_.isLink(n.mode)?32:_.isDir(n.mode)&&(_.flagsToPermissionString(s)!=="r"||s&576)?31:_.nodePermissions(n,_.flagsToPermissionString(s)):44},checkOpExists(n,s){if(!n)throw new _.ErrnoError(s);return n},MAX_OPEN_FDS:4096,nextfd(){for(var n=0;n<=_.MAX_OPEN_FDS;n++)if(!_.streams[n])return n;throw new _.ErrnoError(33)},getStreamChecked(n){var s=_.getStream(n);if(!s)throw new _.ErrnoError(8);return s},getStream:n=>_.streams[n],createStream(n,s=-1){return n=Object.assign(new _.FSStream,n),s==-1&&(s=_.nextfd()),n.fd=s,_.streams[s]=n,n},closeStream(n){_.streams[n]=null},dupStream(n,s=-1){var i,d;var c=_.createStream(n,s);return(d=(i=c.stream_ops)==null?void 0:i.dup)==null||d.call(i,c),c},doSetAttr(n,s,c){var i=n==null?void 0:n.stream_ops.setattr,d=i?n:s;i??(i=s.node_ops.setattr),_.checkOpExists(i,63),i(d,c)},chrdev_stream_ops:{open(n){var c,i;var s=_.getDevice(n.node.rdev);n.stream_ops=s.stream_ops,(i=(c=n.stream_ops).open)==null||i.call(c,n)},llseek(){throw new _.ErrnoError(70)}},major:n=>n>>8,minor:n=>n&255,makedev:(n,s)=>n<<8|s,registerDevice(n,s){_.devices[n]={stream_ops:s}},getDevice:n=>_.devices[n],getMounts(n){for(var s=[],c=[n];c.length;){var i=c.pop();s.push(i),c.push(...i.mounts)}return s},syncfs(n,s){typeof n=="function"&&(s=n,n=!1),_.syncFSRequests++,_.syncFSRequests>1&&he(`warning: ${_.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var c=_.getMounts(_.root.mount),i=0;function d(o){return _.syncFSRequests--,s(o)}function a(o){if(o)return a.errored?void 0:(a.errored=!0,d(o));++i>=c.length&&d(null)}c.forEach(o=>{if(!o.type.syncfs)return a(null);o.type.syncfs(o,n,a)})},mount(n,s,c){var i=c==="/",d=!c,a;if(i&&_.root)throw new _.ErrnoError(10);if(!i&&!d){var o=_.lookupPath(c,{follow_mount:!1});if(c=o.path,a=o.node,_.isMountpoint(a))throw new _.ErrnoError(10);if(!_.isDir(a.mode))throw new _.ErrnoError(54)}var h={type:n,opts:s,mountpoint:c,mounts:[]},L=n.mount(h);return L.mount=h,h.root=L,i?_.root=L:a&&(a.mounted=h,a.mount&&a.mount.mounts.push(h)),L},unmount(n){var s=_.lookupPath(n,{follow_mount:!1});if(!_.isMountpoint(s.node))throw new _.ErrnoError(28);var c=s.node,i=c.mounted,d=_.getMounts(i);Object.keys(_.nameTable).forEach(o=>{for(var h=_.nameTable[o];h;){var L=h.name_next;d.includes(h.mount)&&_.destroyNode(h),h=L}}),c.mounted=null;var a=c.mount.mounts.indexOf(i);c.mount.mounts.splice(a,1)},lookup(n,s){return n.node_ops.lookup(n,s)},mknod(n,s,c){var i=_.lookupPath(n,{parent:!0}),d=i.node,a=De.basename(n);if(!a)throw new _.ErrnoError(28);if(a==="."||a==="..")throw new _.ErrnoError(20);var o=_.mayCreate(d,a);if(o)throw new _.ErrnoError(o);if(!d.node_ops.mknod)throw new _.ErrnoError(63);return d.node_ops.mknod(d,a,s,c)},statfs(n){return _.statfsNode(_.lookupPath(n,{follow:!0}).node)},statfsStream(n){return _.statfsNode(n.node)},statfsNode(n){var s={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:_.nextInode,ffree:_.nextInode-1,fsid:42,flags:2,namelen:255};return n.node_ops.statfs&&Object.assign(s,n.node_ops.statfs(n.mount.opts.root)),s},create(n,s=438){return s&=4095,s|=32768,_.mknod(n,s,0)},mkdir(n,s=511){return s&=1023,s|=16384,_.mknod(n,s,0)},mkdirTree(n,s){var c=n.split("/"),i="";for(var d of c)if(d){(i||De.isAbs(n))&&(i+="/"),i+=d;try{_.mkdir(i,s)}catch(a){if(a.errno!=20)throw a}}},mkdev(n,s,c){return typeof c>"u"&&(c=s,s=438),s|=8192,_.mknod(n,s,c)},symlink(n,s){if(!kt.resolve(n))throw new _.ErrnoError(44);var c=_.lookupPath(s,{parent:!0}),i=c.node;if(!i)throw new _.ErrnoError(44);var d=De.basename(s),a=_.mayCreate(i,d);if(a)throw new _.ErrnoError(a);if(!i.node_ops.symlink)throw new _.ErrnoError(63);return i.node_ops.symlink(i,d,n)},rename(n,s){var c=De.dirname(n),i=De.dirname(s),d=De.basename(n),a=De.basename(s),o,h,L;if(o=_.lookupPath(n,{parent:!0}),h=o.node,o=_.lookupPath(s,{parent:!0}),L=o.node,!h||!L)throw new _.ErrnoError(44);if(h.mount!==L.mount)throw new _.ErrnoError(75);var M=_.lookupNode(h,d),oe=kt.relative(n,i);if(oe.charAt(0)!==".")throw new _.ErrnoError(28);if(oe=kt.relative(s,c),oe.charAt(0)!==".")throw new _.ErrnoError(55);var Q;try{Q=_.lookupNode(L,a)}catch{}if(M!==Q){var P=_.isDir(M.mode),R=_.mayDelete(h,d,P);if(R)throw new _.ErrnoError(R);if(R=Q?_.mayDelete(L,a,P):_.mayCreate(L,a),R)throw new _.ErrnoError(R);if(!h.node_ops.rename)throw new _.ErrnoError(63);if(_.isMountpoint(M)||Q&&_.isMountpoint(Q))throw new _.ErrnoError(10);if(L!==h&&(R=_.nodePermissions(h,"w"),R))throw new _.ErrnoError(R);_.hashRemoveNode(M);try{h.node_ops.rename(M,L,a),M.parent=L}catch(z){throw z}finally{_.hashAddNode(M)}}},rmdir(n){var s=_.lookupPath(n,{parent:!0}),c=s.node,i=De.basename(n),d=_.lookupNode(c,i),a=_.mayDelete(c,i,!0);if(a)throw new _.ErrnoError(a);if(!c.node_ops.rmdir)throw new _.ErrnoError(63);if(_.isMountpoint(d))throw new _.ErrnoError(10);c.node_ops.rmdir(c,i),_.destroyNode(d)},readdir(n){var s=_.lookupPath(n,{follow:!0}),c=s.node,i=_.checkOpExists(c.node_ops.readdir,54);return i(c)},unlink(n){var s=_.lookupPath(n,{parent:!0}),c=s.node;if(!c)throw new _.ErrnoError(44);var i=De.basename(n),d=_.lookupNode(c,i),a=_.mayDelete(c,i,!1);if(a)throw new _.ErrnoError(a);if(!c.node_ops.unlink)throw new _.ErrnoError(63);if(_.isMountpoint(d))throw new _.ErrnoError(10);c.node_ops.unlink(c,i),_.destroyNode(d)},readlink(n){var s=_.lookupPath(n),c=s.node;if(!c)throw new _.ErrnoError(44);if(!c.node_ops.readlink)throw new _.ErrnoError(28);return c.node_ops.readlink(c)},stat(n,s){var c=_.lookupPath(n,{follow:!s}),i=c.node,d=_.checkOpExists(i.node_ops.getattr,63);return d(i)},fstat(n){var s=_.getStreamChecked(n),c=s.node,i=s.stream_ops.getattr,d=i?s:c;return i??(i=c.node_ops.getattr),_.checkOpExists(i,63),i(d)},lstat(n){return _.stat(n,!0)},doChmod(n,s,c,i){_.doSetAttr(n,s,{mode:c&4095|s.mode&-4096,ctime:Date.now(),dontFollow:i})},chmod(n,s,c){var i;if(typeof n=="string"){var d=_.lookupPath(n,{follow:!c});i=d.node}else i=n;_.doChmod(null,i,s,c)},lchmod(n,s){_.chmod(n,s,!0)},fchmod(n,s){var c=_.getStreamChecked(n);_.doChmod(c,c.node,s,!1)},doChown(n,s,c){_.doSetAttr(n,s,{timestamp:Date.now(),dontFollow:c})},chown(n,s,c,i){var d;if(typeof n=="string"){var a=_.lookupPath(n,{follow:!i});d=a.node}else d=n;_.doChown(null,d,i)},lchown(n,s,c){_.chown(n,s,c,!0)},fchown(n,s,c){var i=_.getStreamChecked(n);_.doChown(i,i.node,!1)},doTruncate(n,s,c){if(_.isDir(s.mode))throw new _.ErrnoError(31);if(!_.isFile(s.mode))throw new _.ErrnoError(28);var i=_.nodePermissions(s,"w");if(i)throw new _.ErrnoError(i);_.doSetAttr(n,s,{size:c,timestamp:Date.now()})},truncate(n,s){if(s<0)throw new _.ErrnoError(28);var c;if(typeof n=="string"){var i=_.lookupPath(n,{follow:!0});c=i.node}else c=n;_.doTruncate(null,c,s)},ftruncate(n,s){var c=_.getStreamChecked(n);if(s<0||!(c.flags&2097155))throw new _.ErrnoError(28);_.doTruncate(c,c.node,s)},utime(n,s,c){var i=_.lookupPath(n,{follow:!0}),d=i.node,a=_.checkOpExists(d.node_ops.setattr,63);a(d,{atime:s,mtime:c})},open(n,s,c=438){if(n==="")throw new _.ErrnoError(44);s=typeof s=="string"?hi(s):s,s&64?c=c&4095|32768:c=0;var i,d;if(typeof n=="object")i=n;else{d=n.endsWith("/");var a=_.lookupPath(n,{follow:!(s&131072),noent_okay:!0});i=a.node,n=a.path}var o=!1;if(s&64)if(i){if(s&128)throw new _.ErrnoError(20)}else{if(d)throw new _.ErrnoError(31);i=_.mknod(n,c|511,0),o=!0}if(!i)throw new _.ErrnoError(44);if(_.isChrdev(i.mode)&&(s&=-513),s&65536&&!_.isDir(i.mode))throw new _.ErrnoError(54);if(!o){var h=_.mayOpen(i,s);if(h)throw new _.ErrnoError(h)}s&512&&!o&&_.truncate(i,0),s&=-131713;var L=_.createStream({node:i,path:_.getPath(i),flags:s,seekable:!0,position:0,stream_ops:i.stream_ops,ungotten:[],error:!1});return L.stream_ops.open&&L.stream_ops.open(L),o&&_.chmod(i,c&511),r.logReadFiles&&!(s&1)&&(n in _.readFiles||(_.readFiles[n]=1)),L},close(n){if(_.isClosed(n))throw new _.ErrnoError(8);n.getdents&&(n.getdents=null);try{n.stream_ops.close&&n.stream_ops.close(n)}catch(s){throw s}finally{_.closeStream(n.fd)}n.fd=null},isClosed(n){return n.fd===null},llseek(n,s,c){if(_.isClosed(n))throw new _.ErrnoError(8);if(!n.seekable||!n.stream_ops.llseek)throw new _.ErrnoError(70);if(c!=0&&c!=1&&c!=2)throw new _.ErrnoError(28);return n.position=n.stream_ops.llseek(n,s,c),n.ungotten=[],n.position},read(n,s,c,i,d){if(i<0||d<0)throw new _.ErrnoError(28);if(_.isClosed(n))throw new _.ErrnoError(8);if((n.flags&2097155)===1)throw new _.ErrnoError(8);if(_.isDir(n.node.mode))throw new _.ErrnoError(31);if(!n.stream_ops.read)throw new _.ErrnoError(28);var a=typeof d<"u";if(!a)d=n.position;else if(!n.seekable)throw new _.ErrnoError(70);var o=n.stream_ops.read(n,s,c,i,d);return a||(n.position+=o),o},write(n,s,c,i,d,a){if(i<0||d<0)throw new _.ErrnoError(28);if(_.isClosed(n))throw new _.ErrnoError(8);if(!(n.flags&2097155))throw new _.ErrnoError(8);if(_.isDir(n.node.mode))throw new _.ErrnoError(31);if(!n.stream_ops.write)throw new _.ErrnoError(28);n.seekable&&n.flags&1024&&_.llseek(n,0,2);var o=typeof d<"u";if(!o)d=n.position;else if(!n.seekable)throw new _.ErrnoError(70);var h=n.stream_ops.write(n,s,c,i,d,a);return o||(n.position+=h),h},mmap(n,s,c,i,d){if(i&2&&!(d&2)&&(n.flags&2097155)!==2)throw new _.ErrnoError(2);if((n.flags&2097155)===1)throw new _.ErrnoError(2);if(!n.stream_ops.mmap)throw new _.ErrnoError(43);if(!s)throw new _.ErrnoError(28);return n.stream_ops.mmap(n,s,c,i,d)},msync(n,s,c,i,d){return n.stream_ops.msync?n.stream_ops.msync(n,s,c,i,d):0},ioctl(n,s,c){if(!n.stream_ops.ioctl)throw new _.ErrnoError(59);return n.stream_ops.ioctl(n,s,c)},readFile(n,s={}){if(s.flags=s.flags||0,s.encoding=s.encoding||"binary",s.encoding!=="utf8"&&s.encoding!=="binary")throw new Error(`Invalid encoding type "${s.encoding}"`);var c=_.open(n,s.flags),i=_.stat(n),d=i.size,a=new Uint8Array(d);return _.read(c,a,0,d,0),s.encoding==="utf8"&&(a=Pt(a)),_.close(c),a},writeFile(n,s,c={}){c.flags=c.flags||577;var i=_.open(n,c.flags,c.mode);if(typeof s=="string"&&(s=new Uint8Array(sn(s))),ArrayBuffer.isView(s))_.write(i,s,0,s.byteLength,void 0,c.canOwn);else throw new Error("Unsupported data type");_.close(i)},cwd:()=>_.currentPath,chdir(n){var s=_.lookupPath(n,{follow:!0});if(s.node===null)throw new _.ErrnoError(44);if(!_.isDir(s.node.mode))throw new _.ErrnoError(54);var c=_.nodePermissions(s.node,"x");if(c)throw new _.ErrnoError(c);_.currentPath=s.path},createDefaultDirectories(){_.mkdir("/tmp"),_.mkdir("/home"),_.mkdir("/home/web_user")},createDefaultDevices(){_.mkdir("/dev"),_.registerDevice(_.makedev(1,3),{read:()=>0,write:(i,d,a,o,h)=>o,llseek:()=>0}),_.mkdev("/dev/null",_.makedev(1,3)),bt.register(_.makedev(5,0),bt.default_tty_ops),bt.register(_.makedev(6,0),bt.default_tty1_ops),_.mkdev("/dev/tty",_.makedev(5,0)),_.mkdev("/dev/tty1",_.makedev(6,0));var n=new Uint8Array(1024),s=0,c=()=>(s===0&&(Nn(n),s=n.byteLength),n[--s]);_.createDevice("/dev","random",c),_.createDevice("/dev","urandom",c),_.mkdir("/dev/shm"),_.mkdir("/dev/shm/tmp")},createSpecialDirectories(){_.mkdir("/proc");var n=_.mkdir("/proc/self");_.mkdir("/proc/self/fd"),_.mount({mount(){var s=_.createNode(n,"fd",16895,73);return s.stream_ops={llseek:Ae.stream_ops.llseek},s.node_ops={lookup(c,i){var d=+i,a=_.getStreamChecked(d),o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>a.path},id:d+1};return o.parent=o,o},readdir(){return Array.from(_.streams.entries()).filter(([c,i])=>i).map(([c,i])=>c.toString())}},s}},{},"/proc/self/fd")},createStandardStreams(n,s,c){n?_.createDevice("/dev","stdin",n):_.symlink("/dev/tty","/dev/stdin"),s?_.createDevice("/dev","stdout",null,s):_.symlink("/dev/tty","/dev/stdout"),c?_.createDevice("/dev","stderr",null,c):_.symlink("/dev/tty1","/dev/stderr"),_.open("/dev/stdin",0),_.open("/dev/stdout",1),_.open("/dev/stderr",1)},staticInit(){_.nameTable=new Array(4096),_.mount(Ae,{},"/"),_.createDefaultDirectories(),_.createDefaultDevices(),_.createSpecialDirectories(),_.filesystems={MEMFS:Ae}},init(n,s,c){_.initialized=!0,n??(n=r.stdin),s??(s=r.stdout),c??(c=r.stderr),_.createStandardStreams(n,s,c)},quit(){_.initialized=!1;for(var n of _.streams)n&&_.close(n)},findObject(n,s){var c=_.analyzePath(n,s);return c.exists?c.object:null},analyzePath(n,s){try{var c=_.lookupPath(n,{follow:!s});n=c.path}catch{}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var c=_.lookupPath(n,{parent:!0});i.parentExists=!0,i.parentPath=c.path,i.parentObject=c.node,i.name=De.basename(n),c=_.lookupPath(n,{follow:!s}),i.exists=!0,i.path=c.path,i.object=c.node,i.name=c.node.name,i.isRoot=c.path==="/"}catch(d){i.error=d.errno}return i},createPath(n,s,c,i){n=typeof n=="string"?n:_.getPath(n);for(var d=s.split("/").reverse();d.length;){var a=d.pop();if(a){var o=De.join2(n,a);try{_.mkdir(o)}catch(h){if(h.errno!=20)throw h}n=o}}return o},createFile(n,s,c,i,d){var a=De.join2(typeof n=="string"?n:_.getPath(n),s),o=on(i,d);return _.create(a,o)},createDataFile(n,s,c,i,d,a){var o=s;n&&(n=typeof n=="string"?n:_.getPath(n),o=s?De.join2(n,s):n);var h=on(i,d),L=_.create(o,h);if(c){if(typeof c=="string"){for(var M=new Array(c.length),oe=0,Q=c.length;oe<Q;++oe)M[oe]=c.charCodeAt(oe);c=M}_.chmod(L,h|146);var P=_.open(L,577);_.write(P,c,0,c.length,0,a),_.close(P),_.chmod(L,h)}},createDevice(n,s,c,i){var h;var d=De.join2(typeof n=="string"?n:_.getPath(n),s),a=on(!!c,!!i);(h=_.createDevice).major??(h.major=64);var o=_.makedev(_.createDevice.major++,0);return _.registerDevice(o,{open(L){L.seekable=!1},close(L){var M;(M=i==null?void 0:i.buffer)!=null&&M.length&&i(10)},read(L,M,oe,Q,P){for(var R=0,z=0;z<Q;z++){var j;try{j=c()}catch{throw new _.ErrnoError(29)}if(j===void 0&&R===0)throw new _.ErrnoError(6);if(j==null)break;R++,M[oe+z]=j}return R&&(L.node.atime=Date.now()),R},write(L,M,oe,Q,P){for(var R=0;R<Q;R++)try{i(M[oe+R])}catch{throw new _.ErrnoError(29)}return Q&&(L.node.mtime=L.node.ctime=Date.now()),R}}),_.mkdev(d,a,o)},forceLoadFile(n){if(n.isDevice||n.isFolder||n.link||n.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{n.contents=pe(n.url),n.usedBytes=n.contents.length}catch{throw new _.ErrnoError(29)}},createLazyFile(n,s,c,i,d){class a{constructor(){ut(this,"lengthKnown",!1);ut(this,"chunks",[])}get(R){if(!(R>this.length-1||R<0)){var z=R%this.chunkSize,j=R/this.chunkSize|0;return this.getter(j)[z]}}setDataGetter(R){this.getter=R}cacheLength(){var R=new XMLHttpRequest;if(R.open("HEAD",c,!1),R.send(null),!(R.status>=200&&R.status<300||R.status===304))throw new Error("Couldn't load "+c+". Status: "+R.status);var z=Number(R.getResponseHeader("Content-length")),j,se=(j=R.getResponseHeader("Accept-Ranges"))&&j==="bytes",G=(j=R.getResponseHeader("Content-Encoding"))&&j==="gzip",S=1024*1024;se||(S=z);var I=(D,x)=>{if(D>x)throw new Error("invalid range ("+D+", "+x+") or no bytes requested!");if(x>z-1)throw new Error("only "+z+" bytes available! programmer error!");var F=new XMLHttpRequest;if(F.open("GET",c,!1),z!==S&&F.setRequestHeader("Range","bytes="+D+"-"+x),F.responseType="arraybuffer",F.overrideMimeType&&F.overrideMimeType("text/plain; charset=x-user-defined"),F.send(null),!(F.status>=200&&F.status<300||F.status===304))throw new Error("Couldn't load "+c+". Status: "+F.status);return F.response!==void 0?new Uint8Array(F.response||[]):sn(F.responseText||"")},T=this;T.setDataGetter(D=>{var x=D*S,F=(D+1)*S-1;if(F=Math.min(F,z-1),typeof T.chunks[D]>"u"&&(T.chunks[D]=I(x,F)),typeof T.chunks[D]>"u")throw new Error("doXHR failed!");return T.chunks[D]}),(G||!z)&&(S=z=1,z=this.getter(0).length,S=z,ee("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=z,this._chunkSize=S,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!p)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var o=new a,h={isDevice:!1,contents:o}}else var h={isDevice:!1,url:c};var L=_.createFile(n,s,h,i,d);h.contents?L.contents=h.contents:h.url&&(L.contents=null,L.url=h.url),Object.defineProperties(L,{usedBytes:{get:function(){return this.contents.length}}});var M={},oe=Object.keys(L.stream_ops);oe.forEach(P=>{var R=L.stream_ops[P];M[P]=(...z)=>(_.forceLoadFile(L),R(...z))});function Q(P,R,z,j,se){var G=P.node.contents;if(se>=G.length)return 0;var S=Math.min(G.length-se,j);if(G.slice)for(var I=0;I<S;I++)R[z+I]=G[se+I];else for(var I=0;I<S;I++)R[z+I]=G.get(se+I);return S}return M.read=(P,R,z,j,se)=>(_.forceLoadFile(L),Q(P,R,z,j,se)),M.mmap=(P,R,z,j,se)=>{_.forceLoadFile(L);var G=Dn(R);if(!G)throw new _.ErrnoError(48);return Q(P,it,G,R,z),{ptr:G,allocated:!0}},L.stream_ops=M,L}},mi=(n,s,c)=>{if(!n)return"";var i=zn(Ge,n,s);return Ln.decode(Ge.subarray(n,i))},Fe={DEFAULT_POLLMASK:5,calculateAt(n,s,c){if(De.isAbs(s))return s;var i;if(n===-100)i=_.cwd();else{var d=Fe.getStreamFromFD(n);i=d.path}if(s.length==0){if(!c)throw new _.ErrnoError(44);return i}return i+"/"+s},writeStat(n,s){Te[n>>2]=s.dev,Te[n+4>>2]=s.mode,Ke[n+8>>2]=s.nlink,Te[n+12>>2]=s.uid,Te[n+16>>2]=s.gid,Te[n+20>>2]=s.rdev,tt[n+24>>3]=BigInt(s.size),Te[n+32>>2]=4096,Te[n+36>>2]=s.blocks;var c=s.atime.getTime(),i=s.mtime.getTime(),d=s.ctime.getTime();return tt[n+40>>3]=BigInt(Math.floor(c/1e3)),Ke[n+48>>2]=c%1e3*1e3*1e3,tt[n+56>>3]=BigInt(Math.floor(i/1e3)),Ke[n+64>>2]=i%1e3*1e3*1e3,tt[n+72>>3]=BigInt(Math.floor(d/1e3)),Ke[n+80>>2]=d%1e3*1e3*1e3,tt[n+88>>3]=BigInt(s.ino),0},writeStatFs(n,s){Te[n+4>>2]=s.bsize,Te[n+60>>2]=s.bsize,tt[n+8>>3]=BigInt(s.blocks),tt[n+16>>3]=BigInt(s.bfree),tt[n+24>>3]=BigInt(s.bavail),tt[n+32>>3]=BigInt(s.files),tt[n+40>>3]=BigInt(s.ffree),Te[n+48>>2]=s.fsid,Te[n+64>>2]=s.flags,Te[n+56>>2]=s.namelen},doMsync(n,s,c,i,d){if(!_.isFile(s.node.mode))throw new _.ErrnoError(43);if(i&2)return 0;var a=Ge.slice(n,n+c);_.msync(s,a,d,c,i)},getStreamFromFD(n){var s=_.getStreamChecked(n);return s},varargs:void 0,getStr(n){var s=mi(n);return s}};function gi(n,s){try{return n=Fe.getStr(n),_.chmod(n,s),0}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function bi(n,s,c,i){try{if(s=Fe.getStr(s),s=Fe.calculateAt(n,s),c&-8)return-28;var d=_.lookupPath(s,{follow:!0}),a=d.node;if(!a)return-44;var o="";return c&4&&(o+="r"),c&2&&(o+="w"),c&1&&(o+="x"),o&&_.nodePermissions(a,o)?-2:0}catch(h){if(typeof _>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}function yi(n,s){try{return _.fchmod(n,s),0}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function vi(n,s,c){try{return _.fchown(n,s,c),0}catch(i){if(typeof _>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}var jt=()=>{var n=Te[+Fe.varargs>>2];return Fe.varargs+=4,n},At=jt;function wi(n,s,c){Fe.varargs=c;try{var i=Fe.getStreamFromFD(n);switch(s){case 0:{var d=jt();if(d<0)return-28;for(;_.streams[d];)d++;var a;return a=_.dupStream(i,d),a.fd}case 1:case 2:return 0;case 3:return i.flags;case 4:{var d=jt();return i.flags|=d,0}case 12:{var d=At(),o=0;return Je[d+o>>1]=2,0}case 13:case 14:return 0}return-28}catch(h){if(typeof _>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}function qi(n,s){try{return Fe.writeStat(s,_.fstat(n))}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var Ei=9007199254740992,Si=-9007199254740992,Nt=n=>n<Si||n>Ei?NaN:Number(n);function ki(n,s){s=Nt(s);try{return isNaN(s)?-61:(_.ftruncate(n,s),0)}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var yt=(n,s,c)=>Cn(n,Ge,s,c);function Ai(n,s){try{if(s===0)return-28;var c=_.cwd(),i=Mt(c)+1;return s<i?-68:(yt(c,n,s),i)}catch(d){if(typeof _>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function Ii(n,s,c){Fe.varargs=c;try{var i=Fe.getStreamFromFD(n);switch(s){case 21509:return i.tty?0:-59;case 21505:{if(!i.tty)return-59;if(i.tty.ops.ioctl_tcgets){var d=i.tty.ops.ioctl_tcgets(i),a=At();Te[a>>2]=d.c_iflag||0,Te[a+4>>2]=d.c_oflag||0,Te[a+8>>2]=d.c_cflag||0,Te[a+12>>2]=d.c_lflag||0;for(var o=0;o<32;o++)it[a+o+17]=d.c_cc[o]||0;return 0}return 0}case 21510:case 21511:case 21512:return i.tty?0:-59;case 21506:case 21507:case 21508:{if(!i.tty)return-59;if(i.tty.ops.ioctl_tcsets){for(var a=At(),h=Te[a>>2],L=Te[a+4>>2],M=Te[a+8>>2],oe=Te[a+12>>2],Q=[],o=0;o<32;o++)Q.push(it[a+o+17]);return i.tty.ops.ioctl_tcsets(i.tty,s,{c_iflag:h,c_oflag:L,c_cflag:M,c_lflag:oe,c_cc:Q})}return 0}case 21519:{if(!i.tty)return-59;var a=At();return Te[a>>2]=0,0}case 21520:return i.tty?-28:-59;case 21537:case 21531:{var a=At();return _.ioctl(i,s,a)}case 21523:{if(!i.tty)return-59;if(i.tty.ops.ioctl_tiocgwinsz){var P=i.tty.ops.ioctl_tiocgwinsz(i.tty),a=At();Je[a>>1]=P[0],Je[a+2>>1]=P[1]}return 0}case 21524:return i.tty?0:-59;case 21515:return i.tty?0:-59;default:return-28}}catch(R){if(typeof _>"u"||R.name!=="ErrnoError")throw R;return-R.errno}}function Ti(n,s){try{return n=Fe.getStr(n),Fe.writeStat(s,_.lstat(n))}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Oi(n,s,c){try{return s=Fe.getStr(s),s=Fe.calculateAt(n,s),_.mkdir(s,c,0),0}catch(i){if(typeof _>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function xi(n,s,c,i){try{s=Fe.getStr(s);var d=i&256,a=i&4096;return i=i&-6401,s=Fe.calculateAt(n,s,a),Fe.writeStat(c,d?_.lstat(s):_.stat(s))}catch(o){if(typeof _>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Fi(n,s,c,i){Fe.varargs=i;try{s=Fe.getStr(s),s=Fe.calculateAt(n,s);var d=i?jt():0;return _.open(s,c,d).fd}catch(a){if(typeof _>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}function Pi(n,s,c,i){try{if(s=Fe.getStr(s),s=Fe.calculateAt(n,s),i<=0)return-28;var d=_.readlink(s),a=Math.min(i,Mt(d)),o=it[c+a];return yt(d,c,i+1),it[c+a]=o,a}catch(h){if(typeof _>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}function Ni(n){try{return n=Fe.getStr(n),_.rmdir(n),0}catch(s){if(typeof _>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Li(n,s){try{return n=Fe.getStr(n),Fe.writeStat(s,_.stat(n))}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function zi(n,s,c){try{if(s=Fe.getStr(s),s=Fe.calculateAt(n,s),!c)_.unlink(s);else if(c===512)_.rmdir(s);else return-28;return 0}catch(i){if(typeof _>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}var jn=n=>Ke[n>>2]+Te[n+4>>2]*4294967296;function Ci(n,s,c,i){try{s=Fe.getStr(s),s=Fe.calculateAt(n,s,!0);var d=Date.now(),a,o;if(!c)a=d,o=d;else{var h=jn(c),L=Te[c+8>>2];L==1073741823?a=d:L==1073741822?a=null:a=h*1e3+L/(1e3*1e3),c+=16,h=jn(c),L=Te[c+8>>2],L==1073741823?o=d:L==1073741822?o=null:o=h*1e3+L/(1e3*1e3)}return(o??a)!==null&&_.utime(s,a,o),0}catch(M){if(typeof _>"u"||M.name!=="ErrnoError")throw M;return-M.errno}}var Ri=n=>n%4===0&&(n%100!==0||n%400===0),Di=[0,31,60,91,121,152,182,213,244,274,305,335],Mi=[0,31,59,90,120,151,181,212,243,273,304,334],ji=n=>{var s=Ri(n.getFullYear()),c=s?Di:Mi,i=c[n.getMonth()]+n.getDate()-1;return i};function $i(n,s){n=Nt(n);var c=new Date(n*1e3);Te[s>>2]=c.getSeconds(),Te[s+4>>2]=c.getMinutes(),Te[s+8>>2]=c.getHours(),Te[s+12>>2]=c.getDate(),Te[s+16>>2]=c.getMonth(),Te[s+20>>2]=c.getFullYear()-1900,Te[s+24>>2]=c.getDay();var i=ji(c)|0;Te[s+28>>2]=i,Te[s+36>>2]=-(c.getTimezoneOffset()*60);var d=new Date(c.getFullYear(),0,1),a=new Date(c.getFullYear(),6,1).getTimezoneOffset(),o=d.getTimezoneOffset(),h=(a!=o&&c.getTimezoneOffset()==Math.min(o,a))|0;Te[s+32>>2]=h}function Ui(n,s,c,i,d,a,o){d=Nt(d);try{var h=Fe.getStreamFromFD(i),L=_.mmap(h,n,d,s,c),M=L.ptr;return Te[a>>2]=L.allocated,Ke[o>>2]=M,0}catch(oe){if(typeof _>"u"||oe.name!=="ErrnoError")throw oe;return-oe.errno}}function Bi(n,s,c,i,d,a){a=Nt(a);try{var o=Fe.getStreamFromFD(d);c&2&&Fe.doMsync(n,o,s,i,a)}catch(h){if(typeof _>"u"||h.name!=="ErrnoError")throw h;return-h.errno}}var Wi=(n,s,c,i)=>{var d=new Date().getFullYear(),a=new Date(d,0,1),o=new Date(d,6,1),h=a.getTimezoneOffset(),L=o.getTimezoneOffset(),M=Math.max(h,L);Ke[n>>2]=M*60,Te[s>>2]=+(h!=L);var oe=R=>{var z=R>=0?"-":"+",j=Math.abs(R),se=String(Math.floor(j/60)).padStart(2,"0"),G=String(j%60).padStart(2,"0");return`UTC${z}${se}${G}`},Q=oe(h),P=oe(L);L<h?(yt(Q,c,17),yt(P,i,17)):(yt(Q,i,17),yt(P,c,17))},$n=()=>performance.now(),Un=()=>Date.now(),Zi=n=>n>=0&&n<=3;function Qi(n,s,c){if(!Zi(n))return 28;var i;n===0?i=Un():i=$n();var d=Math.round(i*1e3*1e3);return tt[c>>3]=BigInt(d),0}var Bn=()=>2147483648,Hi=()=>Bn(),Vi=n=>{var s=ct.buffer.byteLength,c=(n-s+65535)/65536|0;try{return ct.grow(c),Tn(),1}catch{}},Gi=n=>{var s=Ge.length;n>>>=0;var c=Bn();if(n>c)return!1;for(var i=1;i<=4;i*=2){var d=s*(1+.2/i);d=Math.min(d,n+100663296);var a=Math.min(c,Rn(Math.max(n,d),65536)),o=Vi(a);if(o)return!0}return!1},an={},Ki=()=>y||"./this.program",Lt=()=>{if(!Lt.strings){var n=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:n,_:Ki()};for(var c in an)an[c]===void 0?delete s[c]:s[c]=an[c];var i=[];for(var c in s)i.push(`${c}=${s[c]}`);Lt.strings=i}return Lt.strings},Ji=(n,s)=>{var c=0,i=0;for(var d of Lt()){var a=s+c;Ke[n+i>>2]=a,c+=yt(d,a,1/0)+1,i+=4}return 0},Yi=(n,s)=>{var c=Lt();Ke[n>>2]=c.length;var i=0;for(var d of c)i+=Mt(d)+1;return Ke[s>>2]=i,0};function Xi(n){try{var s=Fe.getStreamFromFD(n);return _.close(s),0}catch(c){if(typeof _>"u"||c.name!=="ErrnoError")throw c;return c.errno}}function es(n,s){try{var c=0,i=0,d=0,a=Fe.getStreamFromFD(n),o=a.tty?2:_.isDir(a.mode)?3:_.isLink(a.mode)?7:4;return it[s]=o,Je[s+2>>1]=d,tt[s+8>>3]=BigInt(c),tt[s+16>>3]=BigInt(i),0}catch(h){if(typeof _>"u"||h.name!=="ErrnoError")throw h;return h.errno}}var ts=(n,s,c,i)=>{for(var d=0,a=0;a<c;a++){var o=Ke[s>>2],h=Ke[s+4>>2];s+=8;var L=_.read(n,it,o,h,i);if(L<0)return-1;if(d+=L,L<h)break}return d};function ns(n,s,c,i){try{var d=Fe.getStreamFromFD(n),a=ts(d,s,c);return Ke[i>>2]=a,0}catch(o){if(typeof _>"u"||o.name!=="ErrnoError")throw o;return o.errno}}function rs(n,s,c,i){s=Nt(s);try{if(isNaN(s))return 61;var d=Fe.getStreamFromFD(n);return _.llseek(d,s,c),tt[i>>3]=BigInt(d.position),d.getdents&&s===0&&c===0&&(d.getdents=null),0}catch(a){if(typeof _>"u"||a.name!=="ErrnoError")throw a;return a.errno}}function is(n){var c;try{var s=Fe.getStreamFromFD(n);return(c=s.stream_ops)!=null&&c.fsync?s.stream_ops.fsync(s):0}catch(i){if(typeof _>"u"||i.name!=="ErrnoError")throw i;return i.errno}}var ss=(n,s,c,i)=>{for(var d=0,a=0;a<c;a++){var o=Ke[s>>2],h=Ke[s+4>>2];s+=8;var L=_.write(n,it,o,h,i);if(L<0)return-1;if(d+=L,L<h)break}return d};function os(n,s,c,i){try{var d=Fe.getStreamFromFD(n),a=ss(d,s,c);return Ke[i>>2]=a,0}catch(o){if(typeof _>"u"||o.name!=="ErrnoError")throw o;return o.errno}}_.createPreloadedFile=pi,_.staticInit(),Vr(),r.noExitRuntime&&r.noExitRuntime,r.preloadPlugins&&(Mn=r.preloadPlugins),r.print&&(ee=r.print),r.printErr&&(he=r.printErr),r.wasmBinary&&(Ie=r.wasmBinary),r.arguments&&r.arguments,r.thisProgram&&(y=r.thisProgram),r.wasmMemory=ct;var Wn;function as(n){r._sqlite3_status64=n.sqlite3_status64,r._sqlite3_status=n.sqlite3_status,r._sqlite3_db_status64=n.sqlite3_db_status64,r._sqlite3_msize=n.sqlite3_msize,r._sqlite3_db_status=n.sqlite3_db_status,r._sqlite3_vfs_find=n.sqlite3_vfs_find,r._sqlite3_initialize=n.sqlite3_initialize,r._sqlite3_malloc=n.sqlite3_malloc,r._sqlite3_free=n.sqlite3_free,r._sqlite3_vfs_register=n.sqlite3_vfs_register,r._sqlite3_vfs_unregister=n.sqlite3_vfs_unregister,r._sqlite3_malloc64=n.sqlite3_malloc64,r._sqlite3_realloc=n.sqlite3_realloc,r._sqlite3_realloc64=n.sqlite3_realloc64,r._sqlite3_value_text=n.sqlite3_value_text,r._sqlite3_randomness=n.sqlite3_randomness,r._sqlite3_stricmp=n.sqlite3_stricmp,r._sqlite3_strnicmp=n.sqlite3_strnicmp,r._sqlite3_uri_parameter=n.sqlite3_uri_parameter,r._sqlite3_uri_boolean=n.sqlite3_uri_boolean,r._sqlite3_serialize=n.sqlite3_serialize,r._sqlite3_prepare_v2=n.sqlite3_prepare_v2,r._sqlite3_step=n.sqlite3_step,r._sqlite3_column_int64=n.sqlite3_column_int64,r._sqlite3_reset=n.sqlite3_reset,r._sqlite3_exec=n.sqlite3_exec,r._sqlite3_column_int=n.sqlite3_column_int,r._sqlite3_finalize=n.sqlite3_finalize,r._sqlite3_file_control=n.sqlite3_file_control,r._sqlite3_column_name=n.sqlite3_column_name,r._sqlite3_column_text=n.sqlite3_column_text,r._sqlite3_column_type=n.sqlite3_column_type,r._sqlite3_errmsg=n.sqlite3_errmsg,r._sqlite3_deserialize=n.sqlite3_deserialize,r._sqlite3_clear_bindings=n.sqlite3_clear_bindings,r._sqlite3_value_blob=n.sqlite3_value_blob,r._sqlite3_value_bytes=n.sqlite3_value_bytes,r._sqlite3_value_double=n.sqlite3_value_double,r._sqlite3_value_int=n.sqlite3_value_int,r._sqlite3_value_int64=n.sqlite3_value_int64,r._sqlite3_value_subtype=n.sqlite3_value_subtype,r._sqlite3_value_pointer=n.sqlite3_value_pointer,r._sqlite3_value_type=n.sqlite3_value_type,r._sqlite3_value_nochange=n.sqlite3_value_nochange,r._sqlite3_value_frombind=n.sqlite3_value_frombind,r._sqlite3_value_dup=n.sqlite3_value_dup,r._sqlite3_value_free=n.sqlite3_value_free,r._sqlite3_result_blob=n.sqlite3_result_blob,r._sqlite3_result_error_toobig=n.sqlite3_result_error_toobig,r._sqlite3_result_error_nomem=n.sqlite3_result_error_nomem,r._sqlite3_result_double=n.sqlite3_result_double,r._sqlite3_result_error=n.sqlite3_result_error,r._sqlite3_result_int=n.sqlite3_result_int,r._sqlite3_result_int64=n.sqlite3_result_int64,r._sqlite3_result_null=n.sqlite3_result_null,r._sqlite3_result_pointer=n.sqlite3_result_pointer,r._sqlite3_result_subtype=n.sqlite3_result_subtype,r._sqlite3_result_text=n.sqlite3_result_text,r._sqlite3_result_zeroblob=n.sqlite3_result_zeroblob,r._sqlite3_result_zeroblob64=n.sqlite3_result_zeroblob64,r._sqlite3_result_error_code=n.sqlite3_result_error_code,r._sqlite3_user_data=n.sqlite3_user_data,r._sqlite3_context_db_handle=n.sqlite3_context_db_handle,r._sqlite3_vtab_nochange=n.sqlite3_vtab_nochange,r._sqlite3_vtab_in_first=n.sqlite3_vtab_in_first,r._sqlite3_vtab_in_next=n.sqlite3_vtab_in_next,r._sqlite3_aggregate_context=n.sqlite3_aggregate_context,r._sqlite3_get_auxdata=n.sqlite3_get_auxdata,r._sqlite3_set_auxdata=n.sqlite3_set_auxdata,r._sqlite3_column_count=n.sqlite3_column_count,r._sqlite3_data_count=n.sqlite3_data_count,r._sqlite3_column_blob=n.sqlite3_column_blob,r._sqlite3_column_bytes=n.sqlite3_column_bytes,r._sqlite3_column_double=n.sqlite3_column_double,r._sqlite3_column_value=n.sqlite3_column_value,r._sqlite3_column_decltype=n.sqlite3_column_decltype,r._sqlite3_column_database_name=n.sqlite3_column_database_name,r._sqlite3_column_table_name=n.sqlite3_column_table_name,r._sqlite3_column_origin_name=n.sqlite3_column_origin_name,r._sqlite3_bind_blob=n.sqlite3_bind_blob,r._sqlite3_bind_double=n.sqlite3_bind_double,r._sqlite3_bind_int=n.sqlite3_bind_int,r._sqlite3_bind_int64=n.sqlite3_bind_int64,r._sqlite3_bind_null=n.sqlite3_bind_null,r._sqlite3_bind_pointer=n.sqlite3_bind_pointer,r._sqlite3_bind_text=n.sqlite3_bind_text,r._sqlite3_bind_parameter_count=n.sqlite3_bind_parameter_count,r._sqlite3_bind_parameter_name=n.sqlite3_bind_parameter_name,r._sqlite3_bind_parameter_index=n.sqlite3_bind_parameter_index,r._sqlite3_db_handle=n.sqlite3_db_handle,r._sqlite3_stmt_readonly=n.sqlite3_stmt_readonly,r._sqlite3_stmt_isexplain=n.sqlite3_stmt_isexplain,r._sqlite3_stmt_explain=n.sqlite3_stmt_explain,r._sqlite3_stmt_busy=n.sqlite3_stmt_busy,r._sqlite3_stmt_status=n.sqlite3_stmt_status,r._sqlite3_sql=n.sqlite3_sql,r._sqlite3_expanded_sql=n.sqlite3_expanded_sql,r._sqlite3_preupdate_old=n.sqlite3_preupdate_old,r._sqlite3_preupdate_count=n.sqlite3_preupdate_count,r._sqlite3_preupdate_depth=n.sqlite3_preupdate_depth,r._sqlite3_preupdate_blobwrite=n.sqlite3_preupdate_blobwrite,r._sqlite3_preupdate_new=n.sqlite3_preupdate_new,r._sqlite3_value_numeric_type=n.sqlite3_value_numeric_type,r._sqlite3_set_authorizer=n.sqlite3_set_authorizer,r._sqlite3_strglob=n.sqlite3_strglob,r._sqlite3_strlike=n.sqlite3_strlike,r._sqlite3_auto_extension=n.sqlite3_auto_extension,r._sqlite3_cancel_auto_extension=n.sqlite3_cancel_auto_extension,r._sqlite3_reset_auto_extension=n.sqlite3_reset_auto_extension,r._sqlite3_prepare_v3=n.sqlite3_prepare_v3,r._sqlite3_create_module=n.sqlite3_create_module,r._sqlite3_create_module_v2=n.sqlite3_create_module_v2,r._sqlite3_drop_modules=n.sqlite3_drop_modules,r._sqlite3_declare_vtab=n.sqlite3_declare_vtab,r._sqlite3_vtab_on_conflict=n.sqlite3_vtab_on_conflict,r._sqlite3_vtab_collation=n.sqlite3_vtab_collation,r._sqlite3_vtab_in=n.sqlite3_vtab_in,r._sqlite3_vtab_rhs_value=n.sqlite3_vtab_rhs_value,r._sqlite3_vtab_distinct=n.sqlite3_vtab_distinct,r._sqlite3_keyword_name=n.sqlite3_keyword_name,r._sqlite3_keyword_count=n.sqlite3_keyword_count,r._sqlite3_keyword_check=n.sqlite3_keyword_check,r._sqlite3_complete=n.sqlite3_complete,r._sqlite3_libversion=n.sqlite3_libversion,r._sqlite3_libversion_number=n.sqlite3_libversion_number,r._sqlite3_shutdown=n.sqlite3_shutdown,r._sqlite3_last_insert_rowid=n.sqlite3_last_insert_rowid,r._sqlite3_set_last_insert_rowid=n.sqlite3_set_last_insert_rowid,r._sqlite3_changes64=n.sqlite3_changes64,r._sqlite3_changes=n.sqlite3_changes,r._sqlite3_total_changes64=n.sqlite3_total_changes64,r._sqlite3_total_changes=n.sqlite3_total_changes,r._sqlite3_txn_state=n.sqlite3_txn_state,r._sqlite3_close_v2=n.sqlite3_close_v2,r._sqlite3_busy_handler=n.sqlite3_busy_handler,r._sqlite3_progress_handler=n.sqlite3_progress_handler,r._sqlite3_busy_timeout=n.sqlite3_busy_timeout,r._sqlite3_interrupt=n.sqlite3_interrupt,r._sqlite3_is_interrupted=n.sqlite3_is_interrupted,r._sqlite3_create_function=n.sqlite3_create_function,r._sqlite3_create_function_v2=n.sqlite3_create_function_v2,r._sqlite3_create_window_function=n.sqlite3_create_window_function,r._sqlite3_overload_function=n.sqlite3_overload_function,r._sqlite3_trace_v2=n.sqlite3_trace_v2,r._sqlite3_commit_hook=n.sqlite3_commit_hook,r._sqlite3_update_hook=n.sqlite3_update_hook,r._sqlite3_rollback_hook=n.sqlite3_rollback_hook,r._sqlite3_preupdate_hook=n.sqlite3_preupdate_hook,r._sqlite3_set_errmsg=n.sqlite3_set_errmsg,r._sqlite3_error_offset=n.sqlite3_error_offset,r._sqlite3_errcode=n.sqlite3_errcode,r._sqlite3_extended_errcode=n.sqlite3_extended_errcode,r._sqlite3_errstr=n.sqlite3_errstr,r._sqlite3_limit=n.sqlite3_limit,r._sqlite3_open=n.sqlite3_open,r._sqlite3_open_v2=n.sqlite3_open_v2,r._sqlite3_create_collation=n.sqlite3_create_collation,r._sqlite3_create_collation_v2=n.sqlite3_create_collation_v2,r._sqlite3_collation_needed=n.sqlite3_collation_needed,r._sqlite3_get_autocommit=n.sqlite3_get_autocommit,r._sqlite3_table_column_metadata=n.sqlite3_table_column_metadata,r._sqlite3_extended_result_codes=n.sqlite3_extended_result_codes,r._sqlite3_uri_key=n.sqlite3_uri_key,r._sqlite3_uri_int64=n.sqlite3_uri_int64,r._sqlite3_db_name=n.sqlite3_db_name,r._sqlite3_db_filename=n.sqlite3_db_filename,r._sqlite3_db_readonly=n.sqlite3_db_readonly,r._sqlite3_compileoption_used=n.sqlite3_compileoption_used,r._sqlite3_compileoption_get=n.sqlite3_compileoption_get,r._sqlite3session_diff=n.sqlite3session_diff,r._sqlite3session_attach=n.sqlite3session_attach,r._sqlite3session_create=n.sqlite3session_create,r._sqlite3session_delete=n.sqlite3session_delete,r._sqlite3session_table_filter=n.sqlite3session_table_filter,r._sqlite3session_changeset=n.sqlite3session_changeset,r._sqlite3session_changeset_strm=n.sqlite3session_changeset_strm,r._sqlite3session_patchset_strm=n.sqlite3session_patchset_strm,r._sqlite3session_patchset=n.sqlite3session_patchset,r._sqlite3session_enable=n.sqlite3session_enable,r._sqlite3session_indirect=n.sqlite3session_indirect,r._sqlite3session_isempty=n.sqlite3session_isempty,r._sqlite3session_memory_used=n.sqlite3session_memory_used,r._sqlite3session_object_config=n.sqlite3session_object_config,r._sqlite3session_changeset_size=n.sqlite3session_changeset_size,r._sqlite3changeset_start=n.sqlite3changeset_start,r._sqlite3changeset_start_v2=n.sqlite3changeset_start_v2,r._sqlite3changeset_start_strm=n.sqlite3changeset_start_strm,r._sqlite3changeset_start_v2_strm=n.sqlite3changeset_start_v2_strm,r._sqlite3changeset_next=n.sqlite3changeset_next,r._sqlite3changeset_op=n.sqlite3changeset_op,r._sqlite3changeset_pk=n.sqlite3changeset_pk,r._sqlite3changeset_old=n.sqlite3changeset_old,r._sqlite3changeset_new=n.sqlite3changeset_new,r._sqlite3changeset_conflict=n.sqlite3changeset_conflict,r._sqlite3changeset_fk_conflicts=n.sqlite3changeset_fk_conflicts,r._sqlite3changeset_finalize=n.sqlite3changeset_finalize,r._sqlite3changeset_invert=n.sqlite3changeset_invert,r._sqlite3changeset_invert_strm=n.sqlite3changeset_invert_strm,r._sqlite3changeset_apply_v2=n.sqlite3changeset_apply_v2,r._sqlite3changeset_apply_v3=n.sqlite3changeset_apply_v3,r._sqlite3changeset_apply=n.sqlite3changeset_apply,r._sqlite3changeset_apply_v3_strm=n.sqlite3changeset_apply_v3_strm,r._sqlite3changeset_apply_v2_strm=n.sqlite3changeset_apply_v2_strm,r._sqlite3changeset_apply_strm=n.sqlite3changeset_apply_strm,r._sqlite3changegroup_new=n.sqlite3changegroup_new,r._sqlite3changegroup_add=n.sqlite3changegroup_add,r._sqlite3changegroup_output=n.sqlite3changegroup_output,r._sqlite3changegroup_add_strm=n.sqlite3changegroup_add_strm,r._sqlite3changegroup_output_strm=n.sqlite3changegroup_output_strm,r._sqlite3changegroup_delete=n.sqlite3changegroup_delete,r._sqlite3changeset_concat=n.sqlite3changeset_concat,r._sqlite3changeset_concat_strm=n.sqlite3changeset_concat_strm,r._sqlite3session_config=n.sqlite3session_config,r._sqlite3_sourceid=n.sqlite3_sourceid,r._sqlite3__wasm_pstack_ptr=n.sqlite3__wasm_pstack_ptr,r._sqlite3__wasm_pstack_restore=n.sqlite3__wasm_pstack_restore,r._sqlite3__wasm_pstack_alloc=n.sqlite3__wasm_pstack_alloc,r._sqlite3__wasm_pstack_remaining=n.sqlite3__wasm_pstack_remaining,r._sqlite3__wasm_pstack_quota=n.sqlite3__wasm_pstack_quota,r._sqlite3__wasm_test_struct=n.sqlite3__wasm_test_struct,r._sqlite3__wasm_enum_json=n.sqlite3__wasm_enum_json,r._sqlite3__wasm_vfs_unlink=n.sqlite3__wasm_vfs_unlink,r._sqlite3__wasm_db_vfs=n.sqlite3__wasm_db_vfs,r._sqlite3__wasm_db_reset=n.sqlite3__wasm_db_reset,r._sqlite3__wasm_db_export_chunked=n.sqlite3__wasm_db_export_chunked,r._sqlite3__wasm_db_serialize=n.sqlite3__wasm_db_serialize,r._sqlite3__wasm_vfs_create_file=n.sqlite3__wasm_vfs_create_file,r._sqlite3__wasm_posix_create_file=n.sqlite3__wasm_posix_create_file,r._sqlite3__wasm_kvvfsMakeKeyOnPstack=n.sqlite3__wasm_kvvfsMakeKeyOnPstack,r._sqlite3__wasm_kvvfs_methods=n.sqlite3__wasm_kvvfs_methods,r._sqlite3__wasm_vtab_config=n.sqlite3__wasm_vtab_config,r._sqlite3__wasm_db_config_ip=n.sqlite3__wasm_db_config_ip,r._sqlite3__wasm_db_config_pii=n.sqlite3__wasm_db_config_pii,r._sqlite3__wasm_db_config_s=n.sqlite3__wasm_db_config_s,r._sqlite3__wasm_config_i=n.sqlite3__wasm_config_i,r._sqlite3__wasm_config_ii=n.sqlite3__wasm_config_ii,r._sqlite3__wasm_config_j=n.sqlite3__wasm_config_j,r._sqlite3__wasm_qfmt_token=n.sqlite3__wasm_qfmt_token,r._sqlite3__wasm_init_wasmfs=n.sqlite3__wasm_init_wasmfs,r._sqlite3__wasm_test_intptr=n.sqlite3__wasm_test_intptr,r._sqlite3__wasm_test_voidptr=n.sqlite3__wasm_test_voidptr,r._sqlite3__wasm_test_int64_max=n.sqlite3__wasm_test_int64_max,r._sqlite3__wasm_test_int64_min=n.sqlite3__wasm_test_int64_min,r._sqlite3__wasm_test_int64_times2=n.sqlite3__wasm_test_int64_times2,r._sqlite3__wasm_test_int64_minmax=n.sqlite3__wasm_test_int64_minmax,r._sqlite3__wasm_test_int64ptr=n.sqlite3__wasm_test_int64ptr,r._sqlite3__wasm_test_stack_overflow=n.sqlite3__wasm_test_stack_overflow,r._sqlite3__wasm_test_str_hello=n.sqlite3__wasm_test_str_hello,r._sqlite3__wasm_SQLTester_strglob=n.sqlite3__wasm_SQLTester_strglob,r._malloc=n.malloc,r._free=n.free,r._realloc=n.realloc,Wn=n.emscripten_builtin_memalign,n._emscripten_stack_restore,n._emscripten_stack_alloc,n.emscripten_stack_get_current}var Zn={__syscall_chmod:gi,__syscall_faccessat:bi,__syscall_fchmod:yi,__syscall_fchown32:vi,__syscall_fcntl64:wi,__syscall_fstat64:qi,__syscall_ftruncate64:ki,__syscall_getcwd:Ai,__syscall_ioctl:Ii,__syscall_lstat64:Ti,__syscall_mkdirat:Oi,__syscall_newfstatat:xi,__syscall_openat:Fi,__syscall_readlinkat:Pi,__syscall_rmdir:Ni,__syscall_stat64:Li,__syscall_unlinkat:zi,__syscall_utimensat:Ci,_localtime_js:$i,_mmap_js:Ui,_munmap_js:Bi,_tzset_js:Wi,clock_time_get:Qi,emscripten_date_now:Un,emscripten_get_heap_max:Hi,emscripten_get_now:$n,emscripten_resize_heap:Gi,environ_get:Ji,environ_sizes_get:Yi,fd_close:Xi,fd_fdstat_get:es,fd_read:ns,fd_seek:rs,fd_sync:is,fd_write:os,memory:ct},It=await si();function ln(){if(gt>0){Ft=ln;return}if(Gr(),gt>0){Ft=ln;return}function n(){var s;r.calledRun=!0,!Re&&(Kr(),He==null||He(r),(s=r.onRuntimeInitialized)==null||s.call(r),Jr())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),n()},1)):n()}function ls(){if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()()}return ls(),ln(),r.runSQLite3PostLoadInit=function(n,s,c){if(delete s.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function i(d=globalThis.sqlite3ApiConfig||i.defaultConfig){if(i.sqlite3)return(i.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),i.sqlite3;const a=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},d||{});Object.assign(a,{allocExportName:a.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:a.useStdAlloc?"free":"sqlite3_free",reallocExportName:a.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(m=>{typeof a[m]=="function"&&(a[m]=a[m]())}),delete globalThis.sqlite3ApiConfig,delete i.defaultConfig;const o=Object.create(null),h=Object.create(null),L=m=>o.sqlite3_js_rc_str&&o.sqlite3_js_rc_str(m)||"Unknown result code #"+m,M=m=>typeof m=="number"&&m===(m|0)&&m<=2147483647&&m>=-2147483648;class oe extends Error{constructor(...b){let A;if(b.length)if(M(b[0]))if(A=b[0],b.length===1)super(L(b[0]));else{const W=L(A);typeof b[1]=="object"?super(W,b[1]):(b[0]=W+":",super(b.join(" ")))}else b.length===2&&typeof b[1]=="object"?super(...b):super(b.join(" "));this.resultCode=A||o.SQLITE_ERROR,this.name="SQLite3Error"}}oe.toss=(...m)=>{throw new oe(...m)};const Q=oe.toss;a.wasmfsOpfsDir&&!/^\/[^/]+$/.test(a.wasmfsOpfsDir)&&Q("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const P=function m(b){return m._max||(m._max=BigInt("0x7fffffffffffffff"),m._min=~m._max),b>=m._min&&b<=m._max},R=m=>m>=-0x7fffffffn-1n&&m<=0x7fffffffn,z=function m(b){return m._min||(m._min=Number.MIN_SAFE_INTEGER,m._max=Number.MAX_SAFE_INTEGER),b>=m._min&&b<=m._max},j=m=>m&&m.constructor&&M(m.constructor.BYTES_PER_ELEMENT)?m:!1,se=m=>m&&(m instanceof Uint8Array||m instanceof Int8Array||m instanceof ArrayBuffer),G=m=>m&&(m instanceof Uint8Array||m instanceof Int8Array||m instanceof ArrayBuffer),S=m=>se(m)||Q("Value is not of a supported TypedArray type."),I=function(m){return G(m)?h.typedArrayToString(m instanceof ArrayBuffer?new Uint8Array(m):m,0,m.length):Array.isArray(m)?m.join(""):(h.isPtr(m)&&(m=h.cstrToJs(m)),m)};class T extends Error{constructor(...b){b.length===2&&typeof b[1]=="object"?super(...b):b.length?super(b.join(" ")):super("Allocation failed."),this.resultCode=o.SQLITE_NOMEM,this.name="WasmAllocError"}}T.toss=(...m)=>{throw new T(...m)},Object.assign(o,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(m,b,A,W,te,me,ge,w,u)=>{},sqlite3_create_function:(m,b,A,W,te,me,ge,w)=>{},sqlite3_create_window_function:(m,b,A,W,te,me,ge,w,u,f)=>{},sqlite3_prepare_v3:(m,b,A,W,te,me)=>{},sqlite3_prepare_v2:(m,b,A,W,te)=>{},sqlite3_exec:(m,b,A,W,te)=>{},sqlite3_randomness:(m,b)=>{}});const D={affirmBindableTypedArray:S,flexibleString:I,bigIntFits32:R,bigIntFits64:P,bigIntFitsDouble:z,isBindableTypedArray:se,isInt32:M,isSQLableTypedArray:G,isTypedArray:j,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...m){throw new Error(m.join(" "))},toss3:Q,typedArrayPart:h.typedArrayPart,affirmDbHeader:function(m){m instanceof ArrayBuffer&&(m=new Uint8Array(m));const b="SQLite format 3";b.length>m.byteLength&&Q("Input does not contain an SQLite3 database header.");for(let A=0;A<b.length;++A)b.charCodeAt(A)!==m[A]&&Q("Input does not contain an SQLite3 database header.")},affirmIsDb:function(m){m instanceof ArrayBuffer&&(m=new Uint8Array(m));const b=m.byteLength;(b<512||b%512!==0)&&Q("Byte array size",b,"is invalid for an SQLite3 db."),D.affirmDbHeader(m)}};Object.assign(h,{pointerIR:a.wasmPtrIR,bigIntEnabled:!!a.bigIntEnabled,exports:a.exports||Q("Missing API config.exports (WASM module exports)."),memory:a.memory||a.exports.memory||Q("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),functionTable:a.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),h.allocFromTypedArray=function(m){m instanceof ArrayBuffer&&(m=new Uint8Array(m)),S(m);const b=h.heapForSize(m.constructor),A=h.alloc(m.byteLength||1);return b.set(m.byteLength?m:[0],Number(A)),A};{const m=a.allocExportName,b=a.deallocExportName,A=a.reallocExportName;for(const W of[m,b,A])h.exports[W]instanceof Function||Q("Missing required exports[",W,"] function.");h.alloc=function W(te){return W.impl(te)||T.toss("Failed to allocate",te," bytes.")},h.alloc.impl=h.exports[m],h.realloc=function W(te,me){const ge=W.impl(h.ptr.coerce(te),me);return me?ge||T.toss("Failed to reallocate",me," bytes."):h.ptr.null},h.realloc.impl=h.exports[A],h.dealloc=function W(te){W.impl(h.ptr.coerce(te))},h.dealloc.impl=h.exports[b]}h.compileOptionUsed=function m(b){if(arguments.length){if(Array.isArray(b)){const A=Object.create(null);return b.forEach(W=>{A[W]=o.sqlite3_compileoption_used(W)}),A}else if(typeof b=="object")return Object.keys(b).forEach(A=>{b[A]=o.sqlite3_compileoption_used(A)}),b}else{if(m._result)return m._result;m._opt||(m._rx=/^([^=]+)=(.+)/,m._rxInt=/^-?\d+$/,m._opt=function(ge,w){const u=m._rx.exec(ge);w[0]=u?u[1]:ge,w[1]=u?m._rxInt.test(u[2])?+u[2]:u[2]:!0});const A=Object.create(null),W=[0,0];let te=0,me;for(;me=o.sqlite3_compileoption_get(te++);)m._opt(me,W),A[W[0]]=W[1];return m._result=A}return typeof b=="string"?!!o.sqlite3_compileoption_used(b):!1},h.pstack=Object.assign(Object.create(null),{restore:h.exports.sqlite3__wasm_pstack_restore,alloc:function(m){return typeof m=="string"&&!(m=h.sizeofIR(m))&&T.toss("Invalid value for pstack.alloc(",arguments[0],")"),h.exports.sqlite3__wasm_pstack_alloc(m)||T.toss("Could not allocate",m,"bytes from the pstack.")},allocChunks:function(m,b){typeof b=="string"&&!(b=h.sizeofIR(b))&&T.toss("Invalid size value for allocChunks(",arguments[1],")");const A=h.pstack.alloc(m*b),W=[A];let te=1,me=b;for(;te<m;++te,me+=b)W.push(h.ptr.add(A,me));return W},allocPtr:(m=1,b=!0)=>m===1?h.pstack.alloc(b?8:h.ptr.size):h.pstack.allocChunks(m,b?8:h.ptr.size),call:function(m){const b=h.pstack.pointer;try{return m($)}finally{h.pstack.restore(b)}}}),Object.defineProperties(h.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:h.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:h.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:h.exports.sqlite3__wasm_pstack_remaining}}),o.sqlite3_randomness=(...m)=>{if(m.length===1&&D.isTypedArray(m[0])&&m[0].BYTES_PER_ELEMENT===1){const b=m[0];if(b.byteLength===0)return h.exports.sqlite3_randomness(0,h.ptr.null),b;const A=h.pstack.pointer;try{let W=b.byteLength,te=0;const me=h.exports.sqlite3_randomness,ge=h.heap8u(),w=W<512?W:512,u=h.pstack.alloc(w);do{const f=W>w?w:W;me(f,u),b.set(h.typedArrayPart(ge,u,h.ptr.add(u,f)),te),W-=f,te+=f}while(W>0)}catch(W){a.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",W)}finally{h.pstack.restore(A)}return b}h.exports.sqlite3_randomness(...m)};let x;if(o.sqlite3_wasmfs_opfs_dir=function(){if(x!==void 0)return x;const m=a.wasmfsOpfsDir;if(!m||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!h.exports.sqlite3__wasm_init_wasmfs)return x="";try{return m&&h.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],m)===0?x=m:x=""}catch{return x=""}},o.sqlite3_wasmfs_filename_is_persistent=function(m){const b=o.sqlite3_wasmfs_opfs_dir();return b&&m?m.startsWith(b+"/"):!1},o.sqlite3_js_db_uses_vfs=function(m,b,A=0){try{const W=o.sqlite3_vfs_find(b);return W?m?W===o.sqlite3_js_db_vfs(m,A)?W:!1:W===o.sqlite3_vfs_find(0)?W:!1:!1}catch{return!1}},o.sqlite3_js_vfs_list=function(){const m=[];let b=o.sqlite3_vfs_find(h.ptr.coerce(0));for(;b;){const A=new o.sqlite3_vfs(b);m.push(h.cstrToJs(A.$zName)),b=A.$pNext,A.dispose()}return m},o.sqlite3_js_db_export=function(m,b=0){m=h.xWrap.testConvertArg("sqlite3*",m),m||Q("Invalid sqlite3* argument."),h.bigIntEnabled||Q("BigInt support is not enabled.");const A=h.scopedAllocPush();let W;try{const te=h.scopedAlloc(8+h.ptr.size),me=h.ptr.add(te,8),ge=b?h.isPtr(b)?b:h.scopedAllocCString(""+b):h.ptr.null;let w=h.exports.sqlite3__wasm_db_serialize(m,ge,me,te,0);w&&Q("Database serialization failed with code",$.capi.sqlite3_js_rc_str(w)),W=h.peekPtr(me);const u=h.peek(te,"i64");return w=u?h.heap8u().slice(Number(W),Number(W)+Number(u)):new Uint8Array,w}finally{W&&h.exports.sqlite3_free(W),h.scopedAllocPop(A)}},o.sqlite3_js_db_vfs=(m,b=0)=>D.sqlite3__wasm_db_vfs(m,b),o.sqlite3_js_aggregate_context=(m,b)=>o.sqlite3_aggregate_context(m,b)||(b?T.toss("Cannot allocate",b,"bytes for sqlite3_aggregate_context()"):0),o.sqlite3_js_posix_create_file=function(m,b,A){let W;b&&h.isPtr(b)?W=b:b instanceof ArrayBuffer||b instanceof Uint8Array?(W=h.allocFromTypedArray(b),(arguments.length<3||!D.isInt32(A)||A<0)&&(A=b.byteLength)):oe.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!D.isInt32(A)||A<0)&&oe.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const te=D.sqlite3__wasm_posix_create_file(m,W,A);te&&oe.toss("Creation of file failed with sqlite3 result code",o.sqlite3_js_rc_str(te))}finally{W&&W!==b&&h.dealloc(W)}},o.sqlite3_js_vfs_create_file=function(m,b,A,W){a.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let te;A?h.isPtr(A)?te=A:(A instanceof ArrayBuffer&&(A=new Uint8Array(A)),A instanceof Uint8Array?(te=h.allocFromTypedArray(A),(arguments.length<4||!D.isInt32(W)||W<0)&&(W=A.byteLength)):oe.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):te=0,(!D.isInt32(W)||W<0)&&(te&&te!==A&&h.dealloc(te),oe.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const me=D.sqlite3__wasm_vfs_create_file(m,b,te,W);me&&oe.toss("Creation of file failed with sqlite3 result code",o.sqlite3_js_rc_str(me))}finally{te&&te!==A&&h.dealloc(te)}},o.sqlite3_js_sql_to_string=m=>{if(typeof m=="string")return m;const b=I(v);return b===v?void 0:b},D.isUIThread()){const m=function(b){const A=Object.create(null);return A.prefix="kvvfs-"+b,A.stores=[],(b==="session"||b==="")&&A.stores.push(globalThis.sessionStorage),(b==="local"||b==="")&&A.stores.push(globalThis.localStorage),A};o.sqlite3_js_kvvfs_clear=function(b=""){let A=0;const W=m(b);return W.stores.forEach(te=>{const me=[];let ge;for(ge=0;ge<te.length;++ge){const w=te.key(ge);w.startsWith(W.prefix)&&me.push(w)}me.forEach(w=>te.removeItem(w)),A+=me.length}),A},o.sqlite3_js_kvvfs_size=function(b=""){let A=0;const W=m(b);return W.stores.forEach(te=>{let me;for(me=0;me<te.length;++me){const ge=te.key(me);ge.startsWith(W.prefix)&&(A+=ge.length,A+=te.getItem(ge).length)}}),A*2}}o.sqlite3_db_config=(function(m,b,...A){switch(b){case o.SQLITE_DBCONFIG_ENABLE_FKEY:case o.SQLITE_DBCONFIG_ENABLE_TRIGGER:case o.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case o.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case o.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case o.SQLITE_DBCONFIG_ENABLE_QPSG:case o.SQLITE_DBCONFIG_TRIGGER_EQP:case o.SQLITE_DBCONFIG_RESET_DATABASE:case o.SQLITE_DBCONFIG_DEFENSIVE:case o.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case o.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case o.SQLITE_DBCONFIG_DQS_DML:case o.SQLITE_DBCONFIG_DQS_DDL:case o.SQLITE_DBCONFIG_ENABLE_VIEW:case o.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case o.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case o.SQLITE_DBCONFIG_STMT_SCANSTATUS:case o.SQLITE_DBCONFIG_REVERSE_SCANORDER:case o.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case o.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case o.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=h.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(m,b,A[0],A[1]||0);case o.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=h.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(m,b,A[0],A[1],A[2]);case o.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=h.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(m,b,A[0]);default:return o.SQLITE_MISUSE}}).bind(Object.create(null)),o.sqlite3_value_to_js=function(m,b=!0){let A;const W=o.sqlite3_value_type(m);switch(W){case o.SQLITE_INTEGER:h.bigIntEnabled?(A=o.sqlite3_value_int64(m),D.bigIntFitsDouble(A)&&(A=Number(A))):A=o.sqlite3_value_double(m);break;case o.SQLITE_FLOAT:A=o.sqlite3_value_double(m);break;case o.SQLITE_TEXT:A=o.sqlite3_value_text(m);break;case o.SQLITE_BLOB:{const te=o.sqlite3_value_bytes(m),me=o.sqlite3_value_blob(m);te&&!me&&$.WasmAllocError.toss("Cannot allocate memory for blob argument of",te,"byte(s)"),A=te?h.heap8u().slice(Number(me),Number(me)+Number(te)):null;break}case o.SQLITE_NULL:A=null;break;default:b&&Q(o.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",W),A=void 0}return A},o.sqlite3_values_to_js=function(m,b,A=!0){let W;const te=[];for(W=0;W<m;++W)te.push(o.sqlite3_value_to_js(h.peekPtr(h.ptr.add(b,h.ptr.size*W)),A));return te},o.sqlite3_result_error_js=function(m,b){b instanceof T?o.sqlite3_result_error_nomem(m):o.sqlite3_result_error(m,""+b,-1)},o.sqlite3_result_js=function(m,b){if(b instanceof Error){o.sqlite3_result_error_js(m,b);return}try{switch(typeof b){case"undefined":break;case"boolean":o.sqlite3_result_int(m,b?1:0);break;case"bigint":D.bigIntFits32(b)?o.sqlite3_result_int(m,Number(b)):D.bigIntFitsDouble(b)?o.sqlite3_result_double(m,Number(b)):h.bigIntEnabled?D.bigIntFits64(b)?o.sqlite3_result_int64(m,b):Q("BigInt value",b.toString(),"is too BigInt for int64."):Q("BigInt value",b.toString(),"is too BigInt.");break;case"number":{let A;D.isInt32(b)?A=o.sqlite3_result_int:h.bigIntEnabled&&Number.isInteger(b)&&D.bigIntFits64(BigInt(b))?A=o.sqlite3_result_int64:A=o.sqlite3_result_double,A(m,b);break}case"string":{const[A,W]=h.allocCString(b,!0);o.sqlite3_result_text(m,A,W,o.SQLITE_WASM_DEALLOC);break}case"object":if(b===null){o.sqlite3_result_null(m);break}else if(D.isBindableTypedArray(b)){const A=h.allocFromTypedArray(b);o.sqlite3_result_blob(m,A,b.byteLength,o.SQLITE_WASM_DEALLOC);break}default:Q("Don't not how to handle this UDF result value:",typeof b,b)}}catch(A){o.sqlite3_result_error_js(m,A)}},o.sqlite3_column_js=function(m,b,A=!0){const W=o.sqlite3_column_value(m,b);return W===0?void 0:o.sqlite3_value_to_js(W,A)};const F=(function(m,b,A){A=o[A],this.ptr?h.pokePtr(this.ptr,0):this.ptr=h.allocPtr();const W=A(m,b,this.ptr);if(W)return oe.toss(W,arguments[2]+"() failed with code "+W);const te=h.peekPtr(this.ptr);return te?o.sqlite3_value_to_js(te,!0):void 0}).bind(Object.create(null));o.sqlite3_preupdate_new_js=(m,b)=>F(m,b,"sqlite3_preupdate_new"),o.sqlite3_preupdate_old_js=(m,b)=>F(m,b,"sqlite3_preupdate_old"),o.sqlite3changeset_new_js=(m,b)=>F(m,b,"sqlite3changeset_new"),o.sqlite3changeset_old_js=(m,b)=>F(m,b,"sqlite3changeset_old");const $={WasmAllocError:T,SQLite3Error:oe,capi:o,util:D,wasm:h,config:a,version:Object.create(null),client:void 0,asyncPostInit:async function m(){if(m.isReady instanceof Promise)return m.isReady;let b=i.initializersAsync;delete i.initializersAsync;const A=async()=>($.__isUnderTest||(delete $.util,delete $.StructBinder),$),W=me=>{throw a.error("an async sqlite3 initializer failed:",me),me};if(!b||!b.length)return m.isReady=A().catch(W);b=b.map(me=>me instanceof Function?async ge=>me($):me),b.push(A);let te=Promise.resolve($);for(;b.length;)te=te.then(b.shift());return m.isReady=te.catch(W)},scriptInfo:void 0};try{i.initializers.forEach(m=>{m($)})}catch(m){throw console.error("sqlite3 bootstrap initializer threw:",m),m}if(delete i.initializers,i.sqlite3=$,delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig,n.debugModule("sqlite3ApiBootstrap() complete",$),$.scriptInfo=n,$.__isUnderTest=c){$.config.emscripten=s;const m=n.instantiateWasm;m&&($.wasm.module=m.module,$.wasm.instance=m.instance,$.wasm.imports=m.imports)}return $.asyncPostInit().then(m=>(n.debugModule("sqlite3.asyncPostInit() complete",$),delete m.asyncPostInit,delete m.scriptInfo,delete m.emscripten,m))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(i){i.bigIntEnabled===void 0&&(i.bigIntEnabled=!!globalThis.BigInt64Array);const d=(...u)=>{throw new Error(u.join(" "))};i.pointerSize&&!i.pointerIR&&(i.pointerIR=i.pointerSize===4?"i32":"i64");const a=i.pointerIR??(i.pointerIR="i32"),o=i.pointerSize??(i.pointerSize=a==="i32"?4:a==="i64"?8:0);delete i.pointerSize,delete i.pointerIR,a!=="i32"&&a!=="i64"?d("Invalid pointerIR:",a):o!==8&&o!==4&&d("Invalid pointerSize:",o);const h=i.bigIntEnabled?u=>BigInt(u||0):u=>d("BigInt support is disabled in this build."),M=o===4?u=>Number(u||0):h,oe=M(0),Q=function(...u){let f=M(0);for(const g of u)f+=M(g);return f};{const u=Object.create(null);Object.defineProperty(i,"ptr",{enumerable:!0,get:()=>u,set:()=>d("The ptr property is read-only.")}),function f(g,E){return Object.defineProperty(u,g,{enumerable:!0,get:()=>E,set:()=>d("ptr["+g+"] is read-only.")}),f}("null",oe)("size",o)("ir",a)("coerce",M)("add",Q)("addn",a===4?Q:(...f)=>Number(Q(...f)))}i.exports||Object.defineProperty(i,"exports",{enumerable:!0,configurable:!0,get:()=>{var u;return(u=i.instance)==null?void 0:u.exports}});const P=Object.create(null);P.heapSize=0,P.memory=null,P.freeFuncIndexes=[],P.scopedAlloc=[],P.scopedAlloc.pushPtr=u=>(P.scopedAlloc[P.scopedAlloc.length-1].push(u),u),P.utf8Decoder=new TextDecoder,P.utf8Encoder=new TextEncoder("utf-8"),i.sizeofIR=u=>{switch(u){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return o;default:return(""+u).endsWith("*")?o:void 0}};const R=function(){if(!P.memory)P.memory=i.memory instanceof WebAssembly.Memory?i.memory:i.exports.memory;else if(P.heapSize===P.memory.buffer.byteLength)return P;const u=P.memory.buffer;return P.HEAP8=new Int8Array(u),P.HEAP8U=new Uint8Array(u),P.HEAP16=new Int16Array(u),P.HEAP16U=new Uint16Array(u),P.HEAP32=new Int32Array(u),P.HEAP32U=new Uint32Array(u),P.HEAP32F=new Float32Array(u),P.HEAP64F=new Float64Array(u),i.bigIntEnabled&&(typeof BigInt64Array<"u"?(P.HEAP64=new BigInt64Array(u),P.HEAP64U=new BigUint64Array(u)):d("BigInt support is enabled, but the BigInt64Array type is missing.")),P.heapSize=u.byteLength,P};i.heap8=()=>R().HEAP8,i.heap8u=()=>R().HEAP8U,i.heap16=()=>R().HEAP16,i.heap16u=()=>R().HEAP16U,i.heap32=()=>R().HEAP32,i.heap32u=()=>R().HEAP32U,i.heapForSize=function(u,f=!0){const g=P.memory&&P.heapSize===P.memory.buffer.byteLength?P:R();switch(u){case Int8Array:return g.HEAP8;case Uint8Array:return g.HEAP8U;case Int16Array:return g.HEAP16;case Uint16Array:return g.HEAP16U;case Int32Array:return g.HEAP32;case Uint32Array:return g.HEAP32U;case 8:return f?g.HEAP8U:g.HEAP8;case 16:return f?g.HEAP16U:g.HEAP16;case 32:return f?g.HEAP32U:g.HEAP32;case 64:if(g.HEAP64)return f?g.HEAP64U:g.HEAP64;break;default:if(i.bigIntEnabled){if(u===globalThis.BigUint64Array)return g.HEAP64U;if(u===globalThis.BigInt64Array)return g.HEAP64;break}}d("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const z=i.functionTable;delete i.functionTable,i.functionTable=z?()=>z:()=>i.exports.__indirect_function_table,i.functionEntry=function(u){const f=i.functionTable();return u<f.length?f.get(M(u)):void 0},i.jsFuncToWasm=function u(f,g){if(u._||(u._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:a,P:a,s:a,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(de,re,qe)=>{qe<128?de[re](qe):de[re](qe%128|128,qe>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:de=>{const re=u._.rxJSig.exec(de);return re?re[2]:de.substr(1)},letterType:de=>u._.sigTypes[de]||d("Invalid signature letter:",de),pushSigType:(de,re)=>de.push(u._.typeCodes[u._.letterType(re)])}),typeof f=="string"){const de=g;g=f,f=de}const E=u._,Z=E.sigParams(g),X=[1,96];E.uleb128Encode(X,"push",Z.length);for(const de of Z)E.pushSigType(X,de);return g[0]==="v"?X.push(0):(X.push(1),E.pushSigType(X,g[0])),E.uleb128Encode(X,"unshift",X.length),X.unshift(0,97,115,109,1,0,0,0,1),X.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(X)),{e:{f}}).exports.f};const j=function(f,g,E){if(E&&!P.scopedAlloc.length&&d("No scopedAllocPush() scope is active."),typeof f=="string"){const re=g;g=f,f=re}(typeof g!="string"||!(f instanceof Function))&&d("Invalid arguments: expecting (function,signature) or (signature,function).");const Z=i.functionTable(),X=M(Z.length);let de;for(;P.freeFuncIndexes.length&&(de=P.freeFuncIndexes.pop(),Z.get(de));){de=null;continue}de||(de=M(X),Z.grow(M(1)));try{return Z.set(de,f),E&&P.scopedAlloc.pushPtr(de),de}catch(re){if(!(re instanceof TypeError))throw de===X&&P.freeFuncIndexes.push(X),re}try{const re=i.jsFuncToWasm(f,g);Z.set(de,re),E&&P.scopedAlloc.pushPtr(de)}catch(re){throw de===X&&P.freeFuncIndexes.push(X),re}return de};i.installFunction=(u,f)=>j(u,f,!1),i.scopedInstallFunction=(u,f)=>j(u,f,!0),i.uninstallFunction=function(u){if(!u&&u!==0)return;const f=P.freeFuncIndexes,g=i.functionTable();f.push(u);const E=g.get(u);return g.set(u,null),E},i.peek=function(f,g="i8"){g.endsWith("*")&&(g=a);const E=P.memory&&P.heapSize===P.memory.buffer.byteLength?P:R(),Z=Array.isArray(f)?[]:void 0;let X;do{switch(Z&&(f=arguments[0].shift()),g){case"i1":case"i8":X=E.HEAP8[Number(f)>>0];break;case"i16":X=E.HEAP16[Number(f)>>1];break;case"i32":X=E.HEAP32[Number(f)>>2];break;case"float":case"f32":X=E.HEAP32F[Number(f)>>2];break;case"double":case"f64":X=Number(E.HEAP64F[Number(f)>>3]);break;case"i64":if(E.HEAP64){X=h(E.HEAP64[Number(f)>>3]);break}default:d("Invalid type for peek():",g)}Z&&Z.push(X)}while(Z&&arguments[0].length);return Z||X},i.poke=function(u,f,g="i8"){g.endsWith("*")&&(g=a);const E=P.memory&&P.heapSize===P.memory.buffer.byteLength?P:R();for(const Z of Array.isArray(u)?u:[u])switch(g){case"i1":case"i8":E.HEAP8[Number(Z)>>0]=f;continue;case"i16":E.HEAP16[Number(Z)>>1]=f;continue;case"i32":E.HEAP32[Number(Z)>>2]=f;continue;case"float":case"f32":E.HEAP32F[Number(Z)>>2]=f;continue;case"double":case"f64":E.HEAP64F[Number(Z)>>3]=f;continue;case"i64":if(E.HEAP64){E.HEAP64[Number(Z)>>3]=h(f);continue}default:d("Invalid type for poke(): "+g)}return this},i.peekPtr=(...u)=>i.peek(u.length===1?u[0]:u,a),i.pokePtr=(u,f=0)=>i.poke(u,f,a),i.peek8=(...u)=>i.peek(u.length===1?u[0]:u,"i8"),i.poke8=(u,f)=>i.poke(u,f,"i8"),i.peek16=(...u)=>i.peek(u.length===1?u[0]:u,"i16"),i.poke16=(u,f)=>i.poke(u,f,"i16"),i.peek32=(...u)=>i.peek(u.length===1?u[0]:u,"i32"),i.poke32=(u,f)=>i.poke(u,f,"i32"),i.peek64=(...u)=>i.peek(u.length===1?u[0]:u,"i64"),i.poke64=(u,f)=>i.poke(u,f,"i64"),i.peek32f=(...u)=>i.peek(u.length===1?u[0]:u,"f32"),i.poke32f=(u,f)=>i.poke(u,f,"f32"),i.peek64f=(...u)=>i.peek(u.length===1?u[0]:u,"f64"),i.poke64f=(u,f)=>i.poke(u,f,"f64"),i.getMemValue=i.peek,i.getPtrValue=i.peekPtr,i.setMemValue=i.poke,i.setPtrValue=i.pokePtr,i.isPtr32=u=>typeof u=="number"&&u>=0&&u===(u|0),i.isPtr64=u=>typeof u=="bigint"?u>=0:i.isPtr32(u),i.isPtr=o===4?i.isPtr32:i.isPtr64,i.cstrlen=function(u){if(!u||!i.isPtr(u))return null;u=Number(u);const f=R().HEAP8U;let g=u;for(;f[g]!==0;++g);return Number(g-u)};const se=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,G=u=>u.buffer instanceof se;i.isSharedTypedArray=G;const S=(u,f,g)=>(o===8&&(typeof f=="bigint"&&(f=Number(f)),typeof g=="bigint"&&(g=Number(g))),G(u)?u.slice(f,g):u.subarray(f,g));i.typedArrayPart=S;const I=(u,f,g)=>P.utf8Decoder.decode(S(u,f,g));i.typedArrayToString=I,i.cstrToJs=function(u){const f=i.cstrlen(u);return f?I(R().HEAP8U,Number(u),Number(u)+f):f===null?f:""},i.jstrlen=function(u){if(typeof u!="string")return null;const f=u.length;let g=0;for(let E=0;E<f;++E){let Z=u.charCodeAt(E);Z>=55296&&Z<=57343&&(Z=65536+((Z&1023)<<10)|u.charCodeAt(++E)&1023),Z<=127?++g:Z<=2047?g+=2:Z<=65535?g+=3:g+=4}return g},i.jstrcpy=function(u,f,g=0,E=-1,Z=!0){if((!f||!(f instanceof Int8Array)&&!(f instanceof Uint8Array))&&d("jstrcpy() target must be an Int8Array or Uint8Array."),E=Number(E),g=Number(g),E<0&&(E=f.length-g),!(E>0)||!(g>=0))return 0;let X=0,de=u.length;const re=g,qe=g+E-(Z?1:0);for(;X<de&&g<qe;++X){let be=u.charCodeAt(X);if(be>=55296&&be<=57343&&(be=65536+((be&1023)<<10)|u.charCodeAt(++X)&1023),be<=127){if(g>=qe)break;f[g++]=be}else if(be<=2047){if(g+1>=qe)break;f[g++]=192|be>>6,f[g++]=128|be&63}else if(be<=65535){if(g+2>=qe)break;f[g++]=224|be>>12,f[g++]=128|be>>6&63,f[g++]=128|be&63}else{if(g+3>=qe)break;f[g++]=240|be>>18,f[g++]=128|be>>12&63,f[g++]=128|be>>6&63,f[g++]=128|be&63}}return Z&&(f[g++]=0),g-re},i.cstrncpy=function(u,f,g){if((!u||!f)&&d("cstrncpy() does not accept NULL strings."),g<0)g=i.cstrlen(strPtr)+1;else if(!(g>0))return 0;const E=i.heap8u();let Z=0,X;const de=Number(u),re=Number(f);for(;Z<g&&(X=E[re+Z]);++Z)E[de+Z]=X;return Z<g&&(E[de+Z++]=0),Z},i.jstrToUintArray=(u,f=!1)=>P.utf8Encoder.encode(f?u+"\0":u);const T=(u,f)=>{(!(u.alloc instanceof Function)||!(u.dealloc instanceof Function))&&d("Object is missing alloc() and/or dealloc() function(s)","required by",f+"().")},D=function(u,f,g,E){if(T(i,E),typeof u!="string")return null;const Z=P.utf8Encoder.encode(u),X=g(Z.length+1);let de=X;try{const re=R().HEAP8U;return re.set(Z,Number(X)),re[Q(X,Z.length)]=0,de=oe,f?[X,Z.length]:X}finally{de&&i.dealloc(de)}};i.allocCString=(u,f=!1)=>D(u,f,i.alloc,"allocCString()"),i.scopedAllocPush=function(){T(i,"scopedAllocPush");const u=[];return P.scopedAlloc.push(u),u},i.scopedAllocPop=function(u){T(i,"scopedAllocPop");const f=arguments.length?P.scopedAlloc.indexOf(u):P.scopedAlloc.length-1;f<0&&d("Invalid state object for scopedAllocPop()."),arguments.length===0&&(u=P.scopedAlloc[f]),P.scopedAlloc.splice(f,1);for(let g;g=u.pop();)i.functionEntry(g)?i.uninstallFunction(g):i.dealloc(g)},i.scopedAlloc=function(u){P.scopedAlloc.length||d("No scopedAllocPush() scope is active.");const f=M(i.alloc(u));return P.scopedAlloc.pushPtr(f)},Object.defineProperty(i.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>P.scopedAlloc.length,set:()=>d("The 'active' property is read-only.")}),i.scopedAllocCString=(u,f=!1)=>D(u,f,i.scopedAlloc,"scopedAllocCString()");const x=function(u,f){const g=i[u?"scopedAlloc":"alloc"]((f.length+1)*i.ptr.size);let E=0;return f.forEach(Z=>{i.pokePtr(Q(g,i.ptr.size*E++),i[u?"scopedAllocCString":"allocCString"](""+Z))}),i.pokePtr(Q(g,i.ptr.size*E),0),g};i.scopedAllocMainArgv=u=>x(!0,u),i.allocMainArgv=u=>x(!1,u),i.cArgvToJs=(u,f)=>{const g=[];for(let E=0;E<u;++E){const Z=i.peekPtr(Q(f,i.ptr.size*E));g.push(Z?i.cstrToJs(Z):null)}return g},i.scopedAllocCall=function(u){i.scopedAllocPush();try{return u()}finally{i.scopedAllocPop()}};const F=function(u,f,g){T(i,g);const E=f?"i64":a;let Z=i[g](u*(f?8:o));if(i.poke(Z,0,E),u===1)return Z;const X=[Z];for(let de=1;de<u;++de)Z=Q(Z,f?8:o),X[de]=Z,i.poke(Z,0,E);return X};i.allocPtr=(u=1,f=!0)=>F(u,f,"alloc"),i.scopedAllocPtr=(u=1,f=!0)=>F(u,f,"scopedAlloc"),i.xGet=function(u){return i.exports[u]||d("Cannot find exported symbol:",u)};const $=(u,f)=>d(u+"() requires",f,"argument(s).");i.xCall=function(u,...f){const g=u instanceof Function?u:i.xGet(u);return g instanceof Function||d("Exported symbol",u,"is not a function."),g.length!==f.length&&$(g===u?g.name:u,g.length),arguments.length===2&&Array.isArray(arguments[1])?g.apply(null,arguments[1]):g.apply(null,f)},P.xWrap=Object.create(null),P.xWrap.convert=Object.create(null),P.xWrap.convert.arg=new Map,P.xWrap.convert.result=new Map;const m=P.xWrap.convert.arg,b=P.xWrap.convert.result,A=M;m.set("i64",h).set("i32",u=>u|0).set("i16",u=>(u|0)&65535).set("i8",u=>(u|0)&255).set("f32",u=>Number(u).valueOf()).set("float",m.get("f32")).set("f64",m.get("f32")).set("double",m.get("f64")).set("int",m.get("i32")).set("null",u=>u).set(null,m.get("null")).set("**",A).set("*",A),b.set("*",A).set("pointer",A).set("number",u=>Number(u)).set("void",u=>{}).set(void 0,b.get("void")).set("null",u=>u).set(null,b.get("null"));for(const u of["i8","i16","i32","i64","int","f32","float","f64","double"])m.set(u+"*",A),b.set(u+"*",A),b.set(u,m.get(u)||d("Maintenance required: missing arg converter for",u));const W=u=>typeof u=="string"?i.scopedAllocCString(u):M(u);m.set("string",W).set("utf8",W),b.set("string",u=>i.cstrToJs(u)).set("utf8",b.get("string")).set("string:dealloc",u=>{try{return u?i.cstrToJs(u):null}finally{i.dealloc(u)}}).set("utf8:dealloc",b.get("string:dealloc")).set("json",u=>JSON.parse(i.cstrToJs(u))).set("json:dealloc",u=>{try{return u?JSON.parse(i.cstrToJs(u)):null}finally{i.dealloc(u)}});const te=class{constructor(u){this.name=u.name||"unnamed adapter"}convertArg(u,f,g){d("AbstractArgAdapter must be subclassed.")}};m.FuncPtrAdapter=class dt extends te{constructor(f){super(f),m.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",f),this.name=f.name||"unnamed",this.signature=f.signature,f.contextKey instanceof Function&&(this.contextKey=f.contextKey,f.bindScope||(f.bindScope="context")),this.bindScope=f.bindScope||d("FuncPtrAdapter options requires a bindScope (explicit or implied)."),dt.bindScopes.indexOf(f.bindScope)<0&&d("Invalid options.bindScope ("+f.bindMod+") for FuncPtrAdapter. Expecting one of: ("+dt.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=f.callProxy instanceof Function?f.callProxy:void 0}contextKey(f,g){return this}contextMap(f){const g=this.__cmap||(this.__cmap=new Map);let E=g.get(f);return E===void 0&&g.set(f,E=[]),E}convertArg(f,g,E){let Z=this.singleton;if(!Z&&this.isContext&&(Z=this.contextMap(this.contextKey(g,E))),Z&&Z.length===2&&Z[0]===f)return Z[1];if(f instanceof Function){this.callProxy&&(f=this.callProxy(f));const X=j(f,this.signature,this.isTransient);if(dt.debugFuncInstall&&dt.debugOut("FuncPtrAdapter installed",this,this.contextKey(g,E),"@"+X,f),Z){if(Z[1]){dt.debugFuncInstall&&dt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(g,E),"@"+Z[1],f);try{P.scopedAlloc.pushPtr(Z[1])}catch{}}Z[0]=arguments[0]||oe,Z[1]=X}return X}else if(i.isPtr(f)||f===null||f===void 0){if(Z&&Z[1]&&Z[1]!==f){dt.debugFuncInstall&&dt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(g,E),"@"+Z[1],f);try{P.scopedAlloc.pushPtr(Z[1])}catch{}Z[0]=Z[1]=f||oe}return f||oe}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},m.FuncPtrAdapter.warnOnUse=!1,m.FuncPtrAdapter.debugFuncInstall=!1,m.FuncPtrAdapter.debugOut=console.debug.bind(console),m.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const me=u=>m.get(u)||d("Argument adapter not found:",u),ge=u=>b.get(u)||d("Result adapter not found:",u);P.xWrap.convertArg=(u,...f)=>me(u)(...f),P.xWrap.convertArgNoCheck=(u,...f)=>m.get(u)(...f),P.xWrap.convertResult=(u,f)=>u===null?f:u?ge(u)(f):void 0,P.xWrap.convertResultNoCheck=(u,f)=>u===null?f:u?b.get(u)(f):void 0,i.xWrap=function u(f,g,...E){arguments.length===3&&Array.isArray(arguments[2])&&(E=arguments[2]),i.isPtr(f)&&(f=i.functionEntry(f)||d("Function pointer not found in WASM function table."));const Z=f instanceof Function,X=Z?f:i.xGet(f);if(Z&&(f=X.name||"unnamed function"),E.length!==X.length&&$(f,X.length),X.length===0&&(g===null||g==="null"))return X;ge(g);for(const re of E)re instanceof te?m.set(re,(...qe)=>re.convertArg(...qe)):me(re);const de=P.xWrap;return X.length===0?(...re)=>re.length?$(f,X.length):de.convertResult(g,X.call(null)):function(...re){re.length!==X.length&&$(f,X.length);const qe=i.scopedAllocPush();try{let be=0;for(u.debug&&console.debug("xWrap() preparing: resultType ",g,"xf",X,"argTypes",E,"args",re);be<re.length;++be)re[be]=de.convertArgNoCheck(E[be],re[be],re,be);return u.debug&&console.debug("xWrap() calling: resultType ",g,"xf",X,"argTypes",E,"args",re),de.convertResultNoCheck(g,X.apply(null,re))}finally{i.scopedAllocPop(qe)}}};const w=function(u,f,g,E,Z,X){if(typeof g=="string"){if(f===1)return X.get(g);if(f===2){if(E)E instanceof Function||d(Z,"requires a function argument.");else return X.delete(g),u;return X.set(g,E),u}}d("Invalid arguments to",Z)};return i.xWrap.resultAdapter=function u(f,g){return w(u,arguments.length,f,g,"resultAdapter()",b)},i.xWrap.argAdapter=function u(f,g){return w(u,arguments.length,f,g,"argAdapter()",m)},i.xWrap.FuncPtrAdapter=m.FuncPtrAdapter,i.xCallWrapped=function(u,f,g,...E){return Array.isArray(arguments[3])&&(E=arguments[3]),i.xWrap(u,f,g||[]).apply(null,E||[])},i.xWrap.testConvertArg=P.xWrap.convertArg,i.xWrap.testConvertResult=P.xWrap.convertResult,i},globalThis.WhWasmUtilInstaller.yawl=(function(i){const d=()=>fetch(i.uri,{credentials:"same-origin"}),a=this,o=function(L){var M,oe;if(i.wasmUtilTarget){const Q=(...R)=>{throw new Error(R.join(" "))},P=i.wasmUtilTarget;if(P.module=L.module,P.instance=L.instance,P.instance.exports.memory||(P.memory=((oe=(M=i==null?void 0:i.imports)==null?void 0:M.env)==null?void 0:oe.memory)||Q("Missing 'memory' object!")),!P.alloc&&L.instance.exports.malloc){const R=L.instance.exports;P.alloc=function(z){return R.malloc(z)||Q("Allocation of",z,"bytes failed.")},P.dealloc=function(z){R.free(z)}}a(P)}return L.config=i,i.onload&&i.onload(L),L};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(d(),i.imports||{}).then(o):()=>d().then(L=>L.arrayBuffer()).then(L=>WebAssembly.instantiate(L,i.imports||{})).then(o)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function i(d){const a=(...N)=>{throw new Error(N.join(" "))};!(d.heap instanceof WebAssembly.Memory)&&!(d.heap instanceof Function)&&a("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(N){d[N]instanceof Function||a("Config option '"+N+"' must be a function.")});const o=d.heap,h=i,L=o||(()=>new Uint8Array(o.buffer)),M=d.alloc,oe=d.dealloc,Q=d.log||console.debug.bind(console),P=d.memberPrefix||"",R=d.memberSuffix||"",z=globalThis.BigInt,j=globalThis.BigInt64Array,se=d.bigIntEnabled??!!j,G=d.pointerIR||d.ptrIR||"i32",S=d.ptrSize||(G==="i32"?4:8);G!=="i32"&&G!=="i64"&&a("Invalid pointer representation:",G),S!==4&&S!==8&&a("Invalid pointer size:",S);const I=se&&z?N=>z(N||0):N=>a("BigInt support is disabled in this build."),T=G=="i32"?Number:I,D=T(0),x=function(...N){let ie=D;for(let _e=0;_e<N.length;++_e)ie+=T(N[_e]);return ie};h.debugFlags||(h.__makeDebugFlags=function(N=null){N&&N.__flags&&(N=N.__flags);const ie=function _e(ve){return arguments.length===0?_e.__flags:(ve<0?(delete _e.__flags.getter,delete _e.__flags.setter,delete _e.__flags.alloc,delete _e.__flags.dealloc):(_e.__flags.getter=(1&ve)!==0,_e.__flags.setter=(2&ve)!==0,_e.__flags.alloc=(4&ve)!==0,_e.__flags.dealloc=(8&ve)!==0),_e._flags)};return Object.defineProperty(ie,"__flags",{iterable:!1,writable:!1,value:Object.create(N)}),N||ie(0),ie},h.debugFlags=h.__makeDebugFlags());const F=function(){const N=new ArrayBuffer(2);return new DataView(N).setInt16(0,256,!0),new Int16Array(N)[0]===256}(),$=N=>N[1]==="(",m=N=>N==="P",b=N=>$(N)?"p":N[0],A=function(N){switch(b(N)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return G;case"j":return"i64";case"f":return"float";case"d":return"double"}a("Unhandled signature IR:",N)},W=j?()=>!0:()=>a("BigInt64Array is not available."),te=function(N){switch(b(N)){case"p":case"P":case"s":{switch(S){case 4:return"getInt32";case 8:return W()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return W()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}a("Unhandled DataView getter for signature:",N)},me=function(N){switch(b(N)){case"p":case"P":case"s":{switch(S){case 4:return"setInt32";case 8:return W()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return W()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}a("Unhandled DataView setter for signature:",N)},ge=function(N){switch(b(N)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return I;case"p":case"P":case"s":switch(S){case 4:return Number;case 8:return I}break}a("Unhandled DataView set wrapper for signature:",N)},w=(N,ie)=>N+"::"+ie,u=function(N,ie){return()=>a(w(N,ie),"is read-only.")},f=new WeakMap,g="(pointer-is-external)",E=N=>typeof N=="number"&&N===(N|0)&&N>=0,X=S===4?E:N=>typeof N=="bigint"&&N>=0||E(N),de=function(N,ie,_e){if(_e||(_e=f.get(ie)),_e){if(f.delete(ie),Array.isArray(ie.ondispose)){let ve;for(;ve=ie.ondispose.shift();)try{ve instanceof Function?ve.call(ie):ve instanceof ce?ve.dispose():X(ve)&&oe(ve)}catch(je){console.warn("ondispose() for",N.structName,"@",_e,"threw. NOT propagating it.",je)}}else if(ie.ondispose instanceof Function)try{ie.ondispose()}catch(ve){console.warn("ondispose() for",N.structName,"@",_e,"threw. NOT propagating it.",ve)}delete ie.ondispose,N.debugFlags.__flags.dealloc&&Q("debug.dealloc:",ie[g]?"EXTERNAL":"",N.structName,"instance:",N.structInfo.sizeof,"bytes @"+_e),ie[g]||oe(_e)}},re=N=>({configurable:!1,writable:!1,iterable:!1,value:N}),qe=function(N,ie,_e){let ve=!_e;_e?Object.defineProperty(ie,g,re(_e)):(_e=M(N.structInfo.sizeof),_e||a("Allocation of",N.structName,"structure failed."));try{N.debugFlags.__flags.alloc&&Q("debug.alloc:",ve?"":"EXTERNAL",N.structName,"instance:",N.structInfo.sizeof,"bytes @"+_e),ve&&L().fill(0,Number(_e),Number(_e)+N.structInfo.sizeof),f.set(ie,_e)}catch(je){throw de(N,ie,_e),je}},be=function(){const N=this.pointer;return N?new Uint8Array(L().slice(Number(N),Number(N)+this.structInfo.sizeof)):null},Oe=re(N=>P+N+R),Ce=function(N,ie,_e=!0){let ve=N.members[ie];if(!ve&&(P||R)){for(const je of Object.values(N.members))if(je.key===ie){ve=je;break}!ve&&_e&&a(w(N.name,ie),"is not a mapped struct member.")}return ve},Ye=function N(ie,_e,ve=!1){N._||(N._=Xe=>Xe.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const je=Ce(ie.structInfo,_e,!0);return ve?N._(je.signature):je.signature},O={configurable:!1,enumerable:!1,get:function(){return f.get(this)},set:()=>a("Cannot assign the 'pointer' property of a struct.")},V=re(function(){const N=[];for(const ie of Object.keys(this.structInfo.members))N.push(this.memberKey(ie));return N}),K=new TextDecoder("utf-8"),ue=new TextEncoder,le=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,Ee=function(N,ie,_e){return S===8&&(ie=Number(ie),_e=Number(_e)),K.decode(N.buffer instanceof le?N.slice(ie,_e):N.subarray(ie,_e))},ye=function(N,ie,_e=!1){const ve=Ce(N.structInfo,ie,_e);return ve&&ve.signature.length===1&&ve.signature[0]==="s"?ve:!1},B=function(N){N.signature!=="s"&&a("Invalid member type signature for C-string value:",JSON.stringify(N))},k=function(ie,_e){const ve=Ce(ie.structInfo,_e,!0);B(ve);const je=ie[ve.key];if(!je)return null;let Xe=je;const et=L();for(;et[Xe]!==0;++Xe);return je===Xe?"":Ee(et,je,Xe)},U=function(N,...ie){N.ondispose?Array.isArray(N.ondispose)||(N.ondispose=[N.ondispose]):N.ondispose=[],N.ondispose.push(...ie)},J=function(N){const ie=ue.encode(N),_e=M(ie.length+1);_e||a("Allocation error while duplicating string:",N);const ve=L();return ve.set(ie,Number(_e)),ve[x(_e,ie.length)]=0,_e},ne=function(N,ie,_e){const ve=Ce(N.structInfo,ie,!0);B(ve);const je=J(_e);return N[ve.key]=je,U(N,je),N},ce=function(ie,_e){arguments[2]!==re&&a("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:re(ie),structInfo:re(_e)})};ce.prototype=Object.create(null,{dispose:re(function(){de(this.constructor,this)}),lookupMember:re(function(N,ie=!0){return Ce(this.structInfo,N,ie)}),memberToJsString:re(function(N){return k(this,N)}),memberIsString:re(function(N,ie=!0){return ye(this,N,ie)}),memberKey:Oe,memberKeys:V,memberSignature:re(function(N,ie=!1){return Ye(this,N,ie)}),memoryDump:re(be),pointer:O,setMemberCString:re(function(N,ie){return ne(this,N,ie)})}),Object.assign(ce.prototype,{addOnDispose:function(...N){return U(this,...N),this}}),Object.defineProperties(ce,{allocCString:re(J),isA:re(N=>N instanceof ce),hasExternalPointer:re(N=>N instanceof ce&&!!N[g]),memberKey:Oe});const Se=function N(ie,_e,ve){if(!N._){N._={getters:{},setters:{},sw:{}};const nt=["i","c","C","p","P","s","f","d","v()"];se&&nt.push("j"),nt.forEach(function(_t){N._.getters[_t]=te(_t),N._.setters[_t]=me(_t),N._.sw[_t]=ge(_t)});const cs=/^[ipPsjfdcC]$/,us=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;N.sigCheck=function(_t,fs,Hn,cn){Object.prototype.hasOwnProperty.call(_t,Hn)&&a(_t.structName,"already has a property named",Hn+"."),cs.test(cn)||us.test(cn)||a("Malformed signature for",w(_t.structName,fs)+":",cn)}}const je=ie.memberKey(_e);N.sigCheck(ie.prototype,_e,je,ve.signature),ve.key=je,ve.name=_e;const Xe=b(ve.signature),et=w(ie.prototype.structName,je),Qe=ie.prototype.debugFlags.__flags,$e=Object.create(null);$e.configurable=!1,$e.enumerable=!1,$e.get=function(){Qe.getter&&Q("debug.getter:",N._.getters[Xe],"for",A(Xe),et,"@",this.pointer,"+",ve.offset,"sz",ve.sizeof);let nt=new DataView(L().buffer,Number(this.pointer)+ve.offset,ve.sizeof)[N._.getters[Xe]](0,F);return Qe.getter&&Q("debug.getter:",et,"result =",nt),nt},ve.readOnly?$e.set=u(ie.prototype.structName,je):$e.set=function(nt){if(Qe.setter&&Q("debug.setter:",N._.setters[Xe],"for",A(Xe),et,"@",this.pointer,"+",ve.offset,"sz",ve.sizeof,nt),this.pointer||a("Cannot set struct property on disposed instance."),nt===null)nt=D;else for(;!X(nt);){if(m(ve.signature)&&nt instanceof ce){nt=nt.pointer||D,Qe.setter&&Q("debug.setter:",et,"resolved to",nt);break}a("Invalid value for pointer-type",et+".")}new DataView(L().buffer,Number(this.pointer)+ve.offset,ve.sizeof)[N._.setters[Xe]](0,N._.sw[Xe](nt),F)},Object.defineProperty(ie.prototype,je,$e)},Le=function N(ie,_e){arguments.length===1?(_e=ie,ie=_e.name):_e.name||(_e.name=ie),ie||a("Struct name is required.");let ve=!1;Object.keys(_e.members).forEach(Qe=>{const $e=_e.members[Qe];$e.sizeof?$e.sizeof===1?$e.signature==="c"||$e.signature==="C"||a("Unexpected sizeof==1 member",w(_e.name,Qe),"with signature",$e.signature):($e.sizeof%4!==0&&(console.warn("Invalid struct member description =",$e,"from",_e),a(ie,"member",Qe,"sizeof is not aligned. sizeof="+$e.sizeof)),$e.offset%4!==0&&(console.warn("Invalid struct member description =",$e,"from",_e),a(ie,"member",Qe,"offset is not aligned. offset="+$e.offset))):a(ie,"member",Qe,"is missing sizeof."),(!ve||ve.offset<$e.offset)&&(ve=$e)}),ve?_e.sizeof<ve.offset+ve.sizeof&&a("Invalid struct config:",ie,"max member offset ("+ve.offset+") ","extends past end of struct (sizeof="+_e.sizeof+")."):a("No member property descriptions found.");const je=re(h.__makeDebugFlags(N.debugFlags)),Xe=T(0),et=function Qe($e){$e=T($e),this instanceof Qe?arguments.length?((Number.isNaN($e)||$e<=Xe)&&a("Invalid pointer value",arguments[0],"for",ie,"constructor."),qe(Qe,this,$e)):qe(Qe,this):a("The",ie,"constructor may only be called via 'new'.")};return Object.defineProperties(et,{debugFlags:je,isA:re(Qe=>Qe instanceof et),memberKey:Oe,memberKeys:V,methodInfoForKey:re(function(Qe){}),structInfo:re(_e),structName:re(ie)}),et.prototype=new ce(ie,_e,re),Object.defineProperties(et.prototype,{debugFlags:je,constructor:re(et)}),Object.keys(_e.members).forEach(Qe=>Se(et,Qe,_e.members[Qe])),et};return Le.StructType=ce,Le.config=d,Le.allocCString=J,Le.debugFlags||(Le.debugFlags=h.__makeDebugFlags(h.debugFlags)),Le},globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const d=(...S)=>{throw new Error(S.join(" "))},a=i.capi,o=i.wasm,h=i.util;globalThis.WhWasmUtilInstaller(o),delete globalThis.WhWasmUtilInstaller;const L={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(S,I)=>S[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:S=>S[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new o.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:S=>{let I;return(T,D,x,F)=>{try{const $=o.cArgvToJs(D,x);return I||(I=o.cArgvToJs(D,F)),S($,I)|0}catch($){return $.resultCode||a.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:S=>S[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new o.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(S,I)=>S[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:S=>S[0],callProxy:S=>(I,T,D,x,F)=>{S(I,T,o.cstrToJs(D),o.cstrToJs(x),F)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(o.exports.sqlite3_progress_handler&&L.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new o.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(S,I)=>S[0]}),"*"]]),o.exports.sqlite3_stmt_explain&&L.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),o.exports.sqlite3_set_authorizer&&L.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(S,I)=>S[0],callProxy:S=>(I,T,D,x,F,$)=>{try{return D=D&&o.cstrToJs(D),x=x&&o.cstrToJs(x),F=F&&o.cstrToJs(F),$=$&&o.cstrToJs($),S(I,T,D,x,F,$)|0}catch(m){return m.resultCode||a.SQLITE_ERROR}}}),"*"]]),o.exports.sqlite3_column_origin_name&&L.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),o.bigIntEnabled&&o.exports.sqlite3_declare_vtab&&L.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),o.bigIntEnabled&&o.exports.sqlite3_preupdate_hook&&L.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:S=>S[0],callProxy:S=>(I,T,D,x,F,$,m)=>{S(I,T,D,o.cstrToJs(x),o.cstrToJs(F),$,m)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),o.bigIntEnabled&&o.exports.sqlite3changegroup_add&&o.exports.sqlite3session_create&&o.exports.sqlite3_preupdate_hook){const S={signature:"i(ps)",callProxy:I=>(T,D)=>{try{return I(T,o.cstrToJs(D))|0}catch(x){return x.resultCode||a.SQLITE_ERROR}}};L.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...S}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new o.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new o.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new o.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new o.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new o.xWrap.FuncPtrAdapter({name:"xFilter",...S,contextKey:(I,T)=>I[0]}),"*"]])}i.StructBinder=globalThis.Jaccwabyt({heap:o.heap8u,alloc:o.alloc,dealloc:o.dealloc,bigIntEnabled:o.bigIntEnabled,pointerIR:o.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const S=o.xWrap.argAdapter("string");o.xWrap.argAdapter("string:flexible",x=>S(h.flexibleString(x))),o.xWrap.argAdapter("string:static",(function(x){return o.isPtr(x)?x:(x=""+x,this[x]||(this[x]=o.allocCString(x)))}).bind(Object.create(null)));const I=o.xWrap.argAdapter("*"),T=function(){};o.xWrap.argAdapter("sqlite3_filename",I)("sqlite3_context*",I)("sqlite3_value*",I)("void*",I)("sqlite3_changegroup*",I)("sqlite3_changeset_iter*",I)("sqlite3_session*",I)("sqlite3_stmt*",x=>{var F;return I(x instanceof(((F=i==null?void 0:i.oo1)==null?void 0:F.Stmt)||T)?x.pointer:x)})("sqlite3*",x=>{var F;return I(x instanceof(((F=i==null?void 0:i.oo1)==null?void 0:F.DB)||T)?x.pointer:x)})("sqlite3_vfs*",x=>typeof x=="string"?a.sqlite3_vfs_find(x)||i.SQLite3Error.toss(a.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",x):I(x instanceof(a.sqlite3_vfs||T)?x.pointer:x)),o.exports.sqlite3_declare_vtab&&o.xWrap.argAdapter("sqlite3_index_info*",x=>I(x instanceof(a.sqlite3_index_info||T)?x.pointer:x))("sqlite3_module*",x=>I(x instanceof(a.sqlite3_module||T)?x.pointer:x));const D=o.xWrap.resultAdapter("*");o.xWrap.resultAdapter("sqlite3*",D)("sqlite3_context*",D)("sqlite3_stmt*",D)("sqlite3_value*",D)("sqlite3_vfs*",D)("void*",D);for(const x of L.core)a[x[0]]=o.xWrap.apply(null,x);for(const x of L.wasmInternal)h[x[0]]=o.xWrap.apply(null,x);for(const x of L.int64)a[x[0]]=o.bigIntEnabled?o.xWrap.apply(null,x):()=>d(x[0]+"() is unavailable due to lack","of BigInt support in this build.");delete L.core,delete L.int64,delete L.wasmInternal,h.sqlite3__wasm_db_error=function(x,F,$){return x?(F instanceof i.WasmAllocError?(F=a.SQLITE_NOMEM,$=0):F instanceof Error&&($=$||""+F,F=F.resultCode||a.SQLITE_ERROR),a.sqlite3_set_errmsg(x,F,$)||F):a.SQLITE_MISUSE}}{const S=o.xCall("sqlite3__wasm_enum_json");S||d("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),o.ctype=JSON.parse(o.cstrToJs(S));const I=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];o.bigIntEnabled&&I.push("serialize","session","vtab");for(const x of I)for(const F of Object.entries(o.ctype[x]))a[F[0]]=F[1];o.functionEntry(a.SQLITE_WASM_DEALLOC)||d("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+a.SQLITE_WASM_DEALLOC+").");const T=Object.create(null);for(const x of["resultCodes"])for(const F of Object.entries(o.ctype[x]))T[F[1]]=F[0];a.sqlite3_js_rc_str=x=>T[x];const D=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!h.isUIThread(),sqlite3_index_info:!o.bigIntEnabled,sqlite3_index_constraint:!o.bigIntEnabled,sqlite3_index_orderby:!o.bigIntEnabled,sqlite3_index_constraint_usage:!o.bigIntEnabled});for(const x of o.ctype.structs)D[x.name]||(a[x.name]=i.StructBinder(x));if(a.sqlite3_index_info){for(const x of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])a.sqlite3_index_info[x]=a[x],delete a[x];a.sqlite3_vtab_config=o.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const M=(S,I,T)=>h.sqlite3__wasm_db_error(S,a.SQLITE_MISUSE,I+"() requires "+T+" argument"+(T===1?"":"s")+"."),oe=S=>h.sqlite3__wasm_db_error(S,a.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),Q=S=>o.xWrap.argAdapter("sqlite3*")(S),P=S=>o.isPtr(S)?o.cstrToJs(S):S,R=(function(S,I){S=Q(S);let T=this.dbMap.get(S);if(I)!T&&I>0&&this.dbMap.set(S,T=Object.create(null));else return this.dbMap.delete(S),T;return T}).bind(Object.assign(Object.create(null),{dbMap:new Map}));R.addCollation=function(S,I){const T=R(S,1);T.collation||(T.collation=new Set),T.collation.add(P(I).toLowerCase())},R._addUDF=function(S,I,T,D){I=P(I).toLowerCase();let x=D.get(I);x||D.set(I,x=new Set),x.add(T<0?-1:T)},R.addFunction=function(S,I,T){const D=R(S,1);D.udf||(D.udf=new Map),this._addUDF(S,I,T,D.udf)},o.exports.sqlite3_create_window_function&&(R.addWindowFunc=function(S,I,T){const D=R(S,1);D.wudf||(D.wudf=new Map),this._addUDF(S,I,T,D.wudf)}),R.cleanup=function(S){S=Q(S);for(const D of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[x,F]=D;if(!o.exports[x])continue;const m=[S];m.length=F;try{a[x](...m)}catch(b){i.config.warn("close-time call of",x+"(",m,") threw:",b)}}const I=R(S,0);if(!I)return;if(I.collation){for(const D of I.collation)try{a.sqlite3_create_collation_v2(S,D,a.SQLITE_UTF8,0,0,0)}catch{}delete I.collation}let T;for(T=0;T<2;++T){const D=T?I.wudf:I.udf;if(!D)continue;const x=T?a.sqlite3_create_window_function:a.sqlite3_create_function_v2;for(const F of D){const $=F[0],m=F[1],b=[S,$,0,a.SQLITE_UTF8,0,0,0,0,0];T&&b.push(0);for(const A of m)try{b[2]=A,x.apply(null,b)}catch{}m.clear()}D.clear()}delete I.udf,delete I.wudf};{const S=o.xWrap("sqlite3_close_v2","int","sqlite3*");a.sqlite3_close_v2=function(I){if(arguments.length!==1)return M(I,"sqlite3_close_v2",1);if(I)try{R.cleanup(I)}catch{}return S(I)}}if(a.sqlite3session_create){const S=o.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);a.sqlite3session_delete=function(I){if(arguments.length!==1)return M(pDb,"sqlite3session_delete",1);I&&a.sqlite3session_table_filter(I,0,0),S(I)}}{const S=(T,D)=>"argv["+D+"]:"+T[0]+":"+o.cstrToJs(T[1]).toLowerCase(),I=o.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new o.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:S}),new o.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:S})]);a.sqlite3_create_collation_v2=function(T,D,x,F,$,m){if(arguments.length!==6)return M(T,"sqlite3_create_collation_v2",6);if(!(x&15))x|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(x&15))return oe(T);try{const b=I(T,D,x,F,$,m);return b===0&&$ instanceof Function&&R.addCollation(T,D),b}catch(b){return h.sqlite3__wasm_db_error(T,b)}},a.sqlite3_create_collation=(T,D,x,F,$)=>arguments.length===5?a.sqlite3_create_collation_v2(T,D,x,F,$,0):M(T,"sqlite3_create_collation",5)}{const S=function(x,F){return x[0]+":"+(x[2]<0?-1:x[2])+":"+F+":"+o.cstrToJs(x[1]).toLowerCase()},I=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:S,callProxy:x=>(F,$,m)=>{try{x(F,...a.sqlite3_values_to_js($,m))}catch(b){a.sqlite3_result_error_js(F,b)}}},xFinalAndValue:{signature:"v(p)",contextKey:S,callProxy:x=>F=>{try{a.sqlite3_result_js(F,x(F))}catch($){a.sqlite3_result_error_js(F,$)}}},xFunc:{signature:"v(pip)",contextKey:S,callProxy:x=>(F,$,m)=>{try{a.sqlite3_result_js(F,x(F,...a.sqlite3_values_to_js($,m)))}catch(b){a.sqlite3_result_error_js(F,b)}}},xDestroy:{signature:"v(p)",contextKey:S,callProxy:x=>F=>{try{x(F)}catch($){console.error("UDF xDestroy method threw:",$)}}}}),T=o.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new o.xWrap.FuncPtrAdapter({name:"xFunc",...I.xFunc}),new o.xWrap.FuncPtrAdapter({name:"xStep",...I.xInverseAndStep}),new o.xWrap.FuncPtrAdapter({name:"xFinal",...I.xFinalAndValue}),new o.xWrap.FuncPtrAdapter({name:"xDestroy",...I.xDestroy})]),D=o.exports.sqlite3_create_window_function?o.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new o.xWrap.FuncPtrAdapter({name:"xStep",...I.xInverseAndStep}),new o.xWrap.FuncPtrAdapter({name:"xFinal",...I.xFinalAndValue}),new o.xWrap.FuncPtrAdapter({name:"xValue",...I.xFinalAndValue}),new o.xWrap.FuncPtrAdapter({name:"xInverse",...I.xInverseAndStep}),new o.xWrap.FuncPtrAdapter({name:"xDestroy",...I.xDestroy})]):void 0;a.sqlite3_create_function_v2=function x(F,$,m,b,A,W,te,me,ge){if(x.length!==arguments.length)return M(F,"sqlite3_create_function_v2",x.length);if(!(b&15))b|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(b&15))return oe(F);try{const w=T(F,$,m,b,A,W,te,me,ge);return w===0&&(W instanceof Function||te instanceof Function||me instanceof Function||ge instanceof Function)&&R.addFunction(F,$,m),w}catch(w){return console.error("sqlite3_create_function_v2() setup threw:",w),h.sqlite3__wasm_db_error(F,w,"Creation of UDF threw: "+w)}},a.sqlite3_create_function=function x(F,$,m,b,A,W,te,me){return x.length===arguments.length?a.sqlite3_create_function_v2(F,$,m,b,A,W,te,me,0):M(F,"sqlite3_create_function",x.length)},D?a.sqlite3_create_window_function=function x(F,$,m,b,A,W,te,me,ge,w){if(x.length!==arguments.length)return M(F,"sqlite3_create_window_function",x.length);if(!(b&15))b|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(b&15))return oe(F);try{const u=D(F,$,m,b,A,W,te,me,ge,w);return u===0&&(W instanceof Function||te instanceof Function||me instanceof Function||ge instanceof Function||w instanceof Function)&&R.addWindowFunc(F,$,m),u}catch(u){return console.error("sqlite3_create_window_function() setup threw:",u),h.sqlite3__wasm_db_error(F,u,"Creation of UDF threw: "+u)}}:delete a.sqlite3_create_window_function,a.sqlite3_create_function_v2.udfSetResult=a.sqlite3_create_function.udfSetResult=a.sqlite3_result_js,a.sqlite3_create_window_function&&(a.sqlite3_create_window_function.udfSetResult=a.sqlite3_result_js),a.sqlite3_create_function_v2.udfConvertArgs=a.sqlite3_create_function.udfConvertArgs=a.sqlite3_values_to_js,a.sqlite3_create_window_function&&(a.sqlite3_create_window_function.udfConvertArgs=a.sqlite3_values_to_js),a.sqlite3_create_function_v2.udfSetError=a.sqlite3_create_function.udfSetError=a.sqlite3_result_error_js,a.sqlite3_create_window_function&&(a.sqlite3_create_window_function.udfSetError=a.sqlite3_result_error_js)}{const S=(T,D)=>(typeof T=="string"?D=-1:h.isSQLableTypedArray(T)?(D=T.byteLength,T=o.typedArrayToString(T instanceof ArrayBuffer?new Uint8Array(T):T)):Array.isArray(T)&&(T=T.join(""),D=-1),[T,D]),I={basic:o.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:o.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};a.sqlite3_prepare_v3=function T(D,x,F,$,m,b){if(T.length!==arguments.length)return M(D,"sqlite3_prepare_v3",T.length);const[A,W]=S(x,Number(F));switch(typeof A){case"string":return I.basic(D,A,W,$,m,null);case typeof o.ptr.null:return I.full(D,o.ptr.coerce(A),W,$,m,b);default:return h.sqlite3__wasm_db_error(D,a.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof A)}},a.sqlite3_prepare_v2=function T(D,x,F,$,m){return T.length===arguments.length?a.sqlite3_prepare_v3(D,x,F,0,$,m):M(D,"sqlite3_prepare_v2",T.length)}}{const S=o.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),I=o.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);a.sqlite3_bind_text=function T(D,x,F,$,m){if(T.length!==arguments.length)return M(a.sqlite3_db_handle(D),"sqlite3_bind_text",T.length);if(o.isPtr(F)||F===null)return S(D,x,F,$,m);F instanceof ArrayBuffer?F=new Uint8Array(F):Array.isArray(pMem)&&(F=pMem.join(""));let b,A;try{if(h.isSQLableTypedArray(F))b=o.allocFromTypedArray(F),A=F.byteLength;else if(typeof F=="string")[b,A]=o.allocCString(F);else return h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return S(D,x,b,A,a.SQLITE_WASM_DEALLOC)}catch(W){return o.dealloc(b),h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),W)}},a.sqlite3_bind_blob=function T(D,x,F,$,m){if(T.length!==arguments.length)return M(a.sqlite3_db_handle(D),"sqlite3_bind_blob",T.length);if(o.isPtr(F)||F===null)return I(D,x,F,$,m);F instanceof ArrayBuffer?F=new Uint8Array(F):Array.isArray(F)&&(F=F.join(""));let b,A;try{if(h.isBindableTypedArray(F))b=o.allocFromTypedArray(F),A=$>=0?$:F.byteLength;else if(typeof F=="string")[b,A]=o.allocCString(F);else return h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return I(D,x,b,A,a.SQLITE_WASM_DEALLOC)}catch(W){return o.dealloc(b),h.sqlite3__wasm_db_error(a.sqlite3_db_handle(D),W)}}}a.sqlite3_config=function(S,...I){if(arguments.length<2)return a.SQLITE_MISUSE;switch(S){case a.SQLITE_CONFIG_COVERING_INDEX_SCAN:case a.SQLITE_CONFIG_MEMSTATUS:case a.SQLITE_CONFIG_SMALL_MALLOC:case a.SQLITE_CONFIG_SORTERREF_SIZE:case a.SQLITE_CONFIG_STMTJRNL_SPILL:case a.SQLITE_CONFIG_URI:return o.exports.sqlite3__wasm_config_i(S,I[0]);case a.SQLITE_CONFIG_LOOKASIDE:return o.exports.sqlite3__wasm_config_ii(S,I[0],I[1]);case a.SQLITE_CONFIG_MEMDB_MAXSIZE:return o.exports.sqlite3__wasm_config_j(S,I[0]);case a.SQLITE_CONFIG_GETMALLOC:case a.SQLITE_CONFIG_GETMUTEX:case a.SQLITE_CONFIG_GETPCACHE2:case a.SQLITE_CONFIG_GETPCACHE:case a.SQLITE_CONFIG_HEAP:case a.SQLITE_CONFIG_LOG:case a.SQLITE_CONFIG_MALLOC:case a.SQLITE_CONFIG_MMAP_SIZE:case a.SQLITE_CONFIG_MULTITHREAD:case a.SQLITE_CONFIG_MUTEX:case a.SQLITE_CONFIG_PAGECACHE:case a.SQLITE_CONFIG_PCACHE2:case a.SQLITE_CONFIG_PCACHE:case a.SQLITE_CONFIG_PCACHE_HDRSZ:case a.SQLITE_CONFIG_PMASZ:case a.SQLITE_CONFIG_SERIALIZED:case a.SQLITE_CONFIG_SINGLETHREAD:case a.SQLITE_CONFIG_SQLLOG:case a.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return a.SQLITE_NOTFOUND}};{const S=new Set;a.sqlite3_auto_extension=function(I){if(I instanceof Function)I=o.installFunction("i(ppp)",I);else if(arguments.length!==1||!o.isPtr(I))return a.SQLITE_MISUSE;const T=o.exports.sqlite3_auto_extension(I);return I!==arguments[0]&&(T===0?S.add(I):o.uninstallFunction(I)),T},a.sqlite3_cancel_auto_extension=function(I){return!I||arguments.length!==1||!o.isPtr(I)?0:o.exports.sqlite3_cancel_auto_extension(I)},a.sqlite3_reset_auto_extension=function(){o.exports.sqlite3_reset_auto_extension();for(const I of S)o.uninstallFunction(I);S.clear()}}const z=a.sqlite3_vfs_find("kvvfs");if(z)if(h.isUIThread()){const S=new a.sqlite3_kvvfs_methods(o.exports.sqlite3__wasm_kvvfs_methods());delete a.sqlite3_kvvfs_methods;const I=o.exports.sqlite3__wasm_kvvfsMakeKeyOnPstack,T=o.pstack,D=F=>o.peek(F)===115?sessionStorage:localStorage,x={xRead:(F,$,m,b)=>{const A=T.pointer,W=o.scopedAllocPush();try{const te=I(F,$);if(!te)return-3;const me=o.cstrToJs(te),ge=D(F).getItem(me);if(!ge)return-1;const w=ge.length;if(b<=0)return w;if(b===1)return o.poke(m,0),w;const u=o.scopedAllocCString(ge);return b>w+1&&(b=w+1),o.heap8u().copyWithin(Number(m),Number(u),o.ptr.addn(u,b,-1)),o.poke(o.ptr.add(m,b,-1),0),b-1}catch(te){return i.config.error("kvstorageRead()",te),-2}finally{T.restore(A),o.scopedAllocPop(W)}},xWrite:(F,$,m)=>{const b=T.pointer;try{const A=I(F,$);if(!A)return 1;const W=o.cstrToJs(A);return D(F).setItem(W,o.cstrToJs(m)),0}catch(A){return i.config.error("kvstorageWrite()",A),a.SQLITE_IOERR}finally{T.restore(b)}},xDelete:(F,$)=>{const m=T.pointer;try{const b=I(F,$);return b?(D(F).removeItem(o.cstrToJs(b)),0):1}catch(b){return i.config.error("kvstorageDelete()",b),a.SQLITE_IOERR}finally{T.restore(m)}}};for(const F of Object.keys(x))S[S.memberKey(F)]=o.installFunction(S.memberSignature(F),x[F])}else a.sqlite3_vfs_unregister(z);o.xWrap.FuncPtrAdapter.warnOnUse=!0;const j=i.StructBinder,se=function S(I,T,D,x=S.installMethodArgcCheck){if(I instanceof j.StructType?!(D instanceof Function)&&!o.isPtr(D)&&d("Usage error: expecting a Function or WASM pointer to one."):d("Usage error: target object is-not-a StructType."),arguments.length===1)return(b,A)=>S(I,b,A,x);S.argcProxy||(S.argcProxy=function(b,A,W,te){return function(...me){return W.length!==arguments.length&&d("Argument mismatch for",b.structInfo.name+"::"+A+": Native signature is:",te),W.apply(this,me)}},S.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((b,A)=>{if(o.isPtr(b))try{o.uninstallFunction(b)}catch{}}),delete this.ondispose.__removeFuncList)});const F=I.memberSignature(T);F.length<2&&d("Member",T,"does not have a function pointer signature:",F);const $=I.memberKey(T),m=x&&!o.isPtr(D)?S.argcProxy(I,$,D,F):D;if(o.isPtr(m))m&&!o.functionEntry(m)&&d("Pointer",m,"is not a WASM function table entry."),I[$]=m;else{const b=o.installFunction(m,I.memberSignature(T));I[$]=b,(!I.ondispose||!I.ondispose.__removeFuncList)&&(I.addOnDispose("ondispose.__removeFuncList handler",S.removeFuncList),I.ondispose.__removeFuncList=[]),I.ondispose.__removeFuncList.push($,b)}return(b,A)=>S(I,b,A,x)};se.installMethodArgcCheck=!1;const G=function(S,I,T=se.installMethodArgcCheck){const D=new Map;for(const x of Object.keys(I)){const F=I[x],$=D.get(F);if($){const m=S.memberKey(x);S[m]=S[S.memberKey($)]}else se(S,x,F,T),D.set(F,x)}return S};j.StructType.prototype.installMethod=function(I,T,D=se.installMethodArgcCheck){return arguments.length<3&&I&&typeof I=="object"?G(this,...arguments):se(this,...arguments)},j.StructType.prototype.installMethods=function(S,I=se.installMethodArgcCheck){return G(this,S,I)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.version={libVersion:"3.51.0",libVersionNumber:3051e3,sourceId:"2025-11-04 19:38:17 fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",downloadVersion:351e4,scm:{"sha3-256":"fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",branch:"trunk",tags:"release major-release version-3.51.0",datetime:"2025-11-04T19:38:17.314Z"}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const d=(...w)=>{throw new i.SQLite3Error(...w)},a=i.capi,o=i.wasm,h=i.util,L=new WeakMap,M=new Set,oe=new WeakMap,Q=(w,u,f)=>{const g=Object.getOwnPropertyDescriptor(w,u);return g?g.value:f},P=function(w,u){return u&&(w instanceof se&&(w=w.pointer),d(u,"sqlite3 result code",u+":",w?a.sqlite3_errmsg(w):a.sqlite3_errstr(u))),arguments[0]},R=o.installFunction("i(ippp)",(function(w,u,f,g){a.SQLITE_TRACE_STMT===w&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+u+":",o.cstrToJs(g))}).bind({counter:0})),z=Object.create(null),j=function w(...u){if(!w._name2vfs){w._name2vfs=Object.create(null);const E=typeof importScripts=="function"?Z=>d("The VFS for",Z,"is only available in the main window thread."):!1;w._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:E||(()=>"local")},w._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:E||(()=>"session")}}const f=w.normalizeArgs(...u);let g;if(g=f["sqlite3*"])f["sqlite3*:takeOwnership"]||M.add(this),this.filename=a.sqlite3_db_filename(g,"main");else{let E=f.filename,Z=f.vfs,X=f.flags;(typeof E!="string"&&!o.isPtr(E)||typeof X!="string"||Z&&typeof Z!="string"&&!o.isPtr(Z))&&(i.config.error("Invalid DB ctor args",f,arguments),d("Invalid arguments for DB constructor:",arguments,"opts:",f));let de=o.isPtr(E)?o.cstrToJs(E):E;const re=w._name2vfs[de];re&&(Z=re.vfs,E=de=re.filename(de));let qe=0;X.indexOf("c")>=0&&(qe|=a.SQLITE_OPEN_CREATE|a.SQLITE_OPEN_READWRITE),X.indexOf("w")>=0&&(qe|=a.SQLITE_OPEN_READWRITE),qe===0&&(qe|=a.SQLITE_OPEN_READONLY),qe|=a.SQLITE_OPEN_EXRESCODE;const be=o.pstack.pointer;try{const Pe=o.pstack.allocPtr();let Oe=a.sqlite3_open_v2(E,Pe,qe,Z||o.ptr.null);g=o.peekPtr(Pe),P(g,Oe),a.sqlite3_extended_result_codes(g,1),X.indexOf("t")>=0&&a.sqlite3_trace_v2(g,a.SQLITE_TRACE_STMT,R,g)}catch(Pe){throw g&&a.sqlite3_close_v2(g),Pe}finally{o.pstack.restore(be)}this.filename=de}if(L.set(this,g),oe.set(this,Object.create(null)),!f["sqlite3*"])try{const E=a.sqlite3_js_db_vfs(g)||d("Internal error: cannot get VFS for new db handle."),Z=z[E];Z&&(Z instanceof Function?Z(this,i):P(g,a.sqlite3_exec(g,Z,0,0,0)))}catch(E){throw this.close(),E}};j.setVfsPostOpenCallback=function(w,u){u instanceof Function||d("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),z[w]=u},j.normalizeArgs=function(w=":memory:",u="c",f=null){const g={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(g,arguments[0]),g.flags===void 0&&(g.flags="c"),g.vfs===void 0&&(g.vfs=null),g.filename===void 0&&(g.filename=":memory:")):(g.filename=w,g.flags=u,g.vfs=f),g};const se=function(...w){j.apply(this,w)};se.dbCtorHelper=j;const G={null:1,number:2,string:3,boolean:4,blob:5};o.bigIntEnabled&&(G.bigint=G.number);const S=function(){G!==arguments[2]&&d(a.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],L.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&M.add(this)},I=function(w){return w.pointer||d("DB has been closed."),w},T=function(w,u){return(u!==(u|0)||u<0||u>=w.columnCount)&&d("Column index",u,"is out of range."),w},D=function(w,u){const f=Object.create(null);switch(f.opt=Object.create(null),u.length){case 1:typeof u[0]=="string"||h.isSQLableTypedArray(u[0])||Array.isArray(u[0])?f.sql=u[0]:u[0]&&typeof u[0]=="object"&&(f.opt=u[0],f.sql=f.opt.sql);break;case 2:f.sql=u[0],f.opt=u[1];break;default:d("Invalid argument count for exec().")}f.sql=h.flexibleString(f.sql),typeof f.sql!="string"&&d("Missing SQL argument or unsupported SQL value type.");const g=f.opt;switch(g.returnValue){case"resultRows":g.resultRows||(g.resultRows=[]),f.returnVal=()=>g.resultRows;break;case"saveSql":g.saveSql||(g.saveSql=[]),f.returnVal=()=>g.saveSql;break;case void 0:case"this":f.returnVal=()=>w;break;default:d("Invalid returnValue value:",g.returnValue)}if(!g.callback&&!g.returnValue&&g.rowMode!==void 0&&(g.resultRows||(g.resultRows=[]),f.returnVal=()=>g.resultRows),g.callback||g.resultRows)switch(g.rowMode===void 0?"array":g.rowMode){case"object":f.cbArg=(E,Z)=>{Z.columnNames||(Z.columnNames=E.getColumnNames([]));const X=E.get([]),de=Object.create(null);for(const re in Z.columnNames)de[Z.columnNames[re]]=X[re];return de};break;case"array":f.cbArg=E=>E.get([]);break;case"stmt":Array.isArray(g.resultRows)&&d("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),f.cbArg=E=>E;break;default:if(h.isInt32(g.rowMode)){f.cbArg=E=>E.get(g.rowMode);break}else if(typeof g.rowMode=="string"&&g.rowMode.length>1&&g.rowMode[0]==="$"){const E=g.rowMode.substr(1);f.cbArg=Z=>{const X=Z.get(Object.create(null))[E];return X===void 0?d(a.SQLITE_NOTFOUND,"exec(): unknown result column:",E):X};break}d("Invalid rowMode:",g.rowMode)}return f},x=(w,u,f,...g)=>{const E=w.prepare(u);try{const Z=E.bind(f).step()?E.get(...g):void 0;return E.reset(),Z}finally{E.finalize()}},F=(w,u,f,g)=>w.exec({sql:u,bind:f,rowMode:g,returnValue:"resultRows"});se.checkRc=(w,u)=>P(w,u),se.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return I(this)},close:function(){const w=this.pointer;if(w){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(oe.get(this)).forEach((u,f)=>{if(f&&f.pointer)try{f.finalize()}catch{}}),L.delete(this),oe.delete(this),M.delete(this)||a.sqlite3_close_v2(w),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(w=!1,u=!1){const f=I(this).pointer;return w?u?a.sqlite3_total_changes64(f):a.sqlite3_total_changes(f):u?a.sqlite3_changes64(f):a.sqlite3_changes(f)},dbFilename:function(w="main"){return a.sqlite3_db_filename(I(this).pointer,w)},dbName:function(w=0){return a.sqlite3_db_name(I(this).pointer,w)},dbVfsName:function(w=0){let u;const f=a.sqlite3_js_db_vfs(I(this).pointer,w);if(f){const g=new a.sqlite3_vfs(f);try{u=o.cstrToJs(g.$zName)}finally{g.dispose()}}return u},prepare:function(w){I(this);const u=o.pstack.pointer;let f,g;try{f=o.pstack.alloc(8),se.checkRc(this,a.sqlite3_prepare_v2(this.pointer,w,-1,f,null)),g=o.peekPtr(f)}finally{o.pstack.restore(u)}g||d("Cannot prepare empty SQL.");const E=new S(this,g,G);return oe.get(this)[g]=E,E},exec:function(){I(this);const w=D(this,arguments);if(!w.sql)return d("exec() requires an SQL string.");const u=w.opt,f=u.callback,g=Array.isArray(u.resultRows)?u.resultRows:void 0;let E,Z=u.bind,X=!!(w.cbArg||u.columnNames||g);const de=o.scopedAllocPush(),re=Array.isArray(u.saveSql)?u.saveSql:void 0;try{const qe=h.isSQLableTypedArray(w.sql);let be=qe?w.sql.byteLength:o.jstrlen(w.sql);const Pe=o.scopedAlloc(2*o.ptr.size+(be+1)),Oe=o.ptr.add(Pe,o.ptr.size);let Ce=o.ptr.add(Oe,o.ptr.size);const Ye=o.ptr.add(Ce,be);for(qe?o.heap8().set(w.sql,Ce):o.jstrcpy(w.sql,o.heap8(),Ce,be,!1),o.poke(o.ptr.add(Ce,be),0);Ce&&o.peek(Ce,"i8");){o.pokePtr([Pe,Oe],0),se.checkRc(this,a.sqlite3_prepare_v3(this.pointer,Ce,be,0,Pe,Oe));const O=o.peekPtr(Pe);if(Ce=o.peekPtr(Oe),be=Number(o.ptr.add(Ye,-Ce)),!!O){if(re&&re.push(a.sqlite3_sql(O).trim()),E=new S(this,O,G),Z&&E.parameterCount&&(E.bind(Z),Z=null),X&&E.columnCount){let V=Array.isArray(u.columnNames)?0:1;if(X=!1,w.cbArg||g){const K=Object.create(null);for(;E.step();W.delete(E)){V++===0&&E.getColumnNames(K.columnNames=u.columnNames||[]),W.add(E);const ue=w.cbArg(E,K);if(g&&g.push(ue),f&&f.call(u,ue,E)===!1)break}W.delete(E)}V===0&&E.getColumnNames(u.columnNames)}else E.step();E.reset().finalize(),E=null}}}finally{o.scopedAllocPop(de),E&&(W.delete(E),E.finalize())}return w.returnVal()},createFunction:function(u,f,g){const E=K=>K instanceof Function;switch(arguments.length){case 1:g=u,u=g.name,f=g.xFunc||0;break;case 2:E(f)||(g=f,f=g.xFunc||0);break}g||(g={}),typeof u!="string"&&d("Invalid arguments: missing function name.");let Z=g.xStep||0,X=g.xFinal||0;const de=g.xValue||0,re=g.xInverse||0;let qe;E(f)?(qe=!1,(E(Z)||E(X))&&d("Ambiguous arguments: scalar or aggregate?"),Z=X=null):E(Z)?(E(X)||d("Missing xFinal() callback for aggregate or window UDF."),f=null):E(X)?d("Missing xStep() callback for aggregate or window UDF."):d("Missing function-type properties."),qe===!1?(E(de)||E(re))&&d("xValue and xInverse are not permitted for non-window UDFs."):E(de)?(E(re)||d("xInverse must be provided if xValue is."),qe=!0):E(re)&&d("xValue must be provided if xInverse is.");const be=g.pApp;be!=null&&!o.isPtr(be)&&d("Invalid value for pApp property. Must be a legal WASM pointer value.");const Pe=g.xDestroy||0;Pe&&!E(Pe)&&d("xDestroy property must be a function.");let Oe=0;Q(g,"deterministic")&&(Oe|=a.SQLITE_DETERMINISTIC),Q(g,"directOnly")&&(Oe|=a.SQLITE_DIRECTONLY),Q(g,"innocuous")&&(Oe|=a.SQLITE_INNOCUOUS),u=u.toLowerCase();const Ce=f||Z,Ye=Q(g,"arity"),O=typeof Ye=="number"?Ye:Ce.length?Ce.length-1:0;let V;return qe?V=a.sqlite3_create_window_function(this.pointer,u,O,a.SQLITE_UTF8|Oe,be||0,Z,X,de,re,Pe):V=a.sqlite3_create_function_v2(this.pointer,u,O,a.SQLITE_UTF8|Oe,be||0,f,Z,X,Pe),se.checkRc(this,V),this},selectValue:function(w,u,f){return x(this,w,u,0,f)},selectValues:function(w,u,f){const g=this.prepare(w),E=[];try{for(g.bind(u);g.step();)E.push(g.get(0,f));g.reset()}finally{g.finalize()}return E},selectArray:function(w,u){return x(this,w,u,[])},selectObject:function(w,u){return x(this,w,u,{})},selectArrays:function(w,u){return F(this,w,u,"array")},selectObjects:function(w,u){return F(this,w,u,"object")},openStatementCount:function(){return this.pointer?Object.keys(oe.get(this)).length:0},transaction:function(w){let u="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&d(a.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),u+=" "+arguments[0],w=arguments[1]),I(this).exec(u);try{const f=w(this);return this.exec("COMMIT"),f}catch(f){throw this.exec("ROLLBACK"),f}},savepoint:function(w){I(this).exec("SAVEPOINT oo1");try{const u=w(this);return this.exec("RELEASE oo1"),u}catch(u){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),u}},checkRc:function(w){return P(this,w)}},se.wrapHandle=function(w,u=!1){if(!w||!o.isPtr(w))throw new i.SQLite3Error(a.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new se({"sqlite3*":w,"sqlite3*:takeOwnership":!!u})};const $=function(w){return w.pointer||d("Stmt has been closed."),w},m=function(w){let u=G[w==null?"null":typeof w];switch(u){case G.boolean:case G.null:case G.number:case G.string:return u;case G.bigint:return o.bigIntEnabled?u:void 0;default:return h.isBindableTypedArray(w)?G.blob:void 0}},b=function(w){return m(w)||d("Unsupported bind() argument type:",typeof w)},A=function(w,u){const f=typeof u=="number"?u:a.sqlite3_bind_parameter_index(w.pointer,u);return f===0||!h.isInt32(f)?d("Invalid bind() parameter name: "+u):(f<1||f>w.parameterCount)&&d("Bind index",u,"is out of range."),f},W=new Set,te=new Set,me=function(w,u){return W.has(w)&&d("Operation is illegal when statement is locked:",u),w},ge=function w(u,f,g,E){me($(u),"bind()"),w._||(w._tooBigInt=X=>d("BigInt value is too big to store without precision loss:",X),w._={string:function(X,de,re,qe){const[be,Pe]=o.allocCString(re,!0);return(qe?a.sqlite3_bind_blob:a.sqlite3_bind_text)(X.pointer,de,be,Pe,a.SQLITE_WASM_DEALLOC)}}),b(E),f=A(u,f);let Z=0;switch(E==null?G.null:g){case G.null:Z=a.sqlite3_bind_null(u.pointer,f);break;case G.string:Z=w._.string(u,f,E,!1);break;case G.number:{let X;h.isInt32(E)?X=a.sqlite3_bind_int:typeof E=="bigint"?h.bigIntFits64(E)?o.bigIntEnabled?X=a.sqlite3_bind_int64:h.bigIntFitsDouble(E)?(E=Number(E),X=a.sqlite3_bind_double):w._tooBigInt(E):w._tooBigInt(E):(E=Number(E),o.bigIntEnabled&&Number.isInteger(E)?X=a.sqlite3_bind_int64:X=a.sqlite3_bind_double),Z=X(u.pointer,f,E);break}case G.boolean:Z=a.sqlite3_bind_int(u.pointer,f,E?1:0);break;case G.blob:{if(typeof E=="string"){Z=w._.string(u,f,E,!0);break}else E instanceof ArrayBuffer?E=new Uint8Array(E):h.isBindableTypedArray(E)||d("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const X=o.alloc(E.byteLength||1);o.heap8().set(E.byteLength?E:[0],Number(X)),Z=a.sqlite3_bind_blob(u.pointer,f,X,E.byteLength,a.SQLITE_WASM_DEALLOC);break}default:i.config.warn("Unsupported bind() argument type:",E),d("Unsupported bind() argument type: "+typeof E)}return Z&&se.checkRc(u.db.pointer,Z),u};S.prototype={finalize:function(){const w=this.pointer;if(w){me(this,"finalize()");const u=M.delete(this)?0:a.sqlite3_finalize(w);return delete oe.get(this.db)[w],L.delete(this),W.delete(this),te.delete(this),delete this.parameterCount,delete this.db,u}},clearBindings:function(){return me($(this),"clearBindings()"),a.sqlite3_clear_bindings(this.pointer),te.delete(this),this},reset:function(w){me(this,"reset()"),w&&this.clearBindings();const u=a.sqlite3_reset($(this).pointer);return te.delete(this),P(this.db,u),this},bind:function(){$(this);let w,u;switch(arguments.length){case 1:w=1,u=arguments[0];break;case 2:w=arguments[0],u=arguments[1];break;default:d("Invalid bind() arguments.")}return u===void 0?this:(this.parameterCount||d("This statement has no bindable parameters."),te.delete(this),u===null?ge(this,w,G.null,u):Array.isArray(u)?(arguments.length!==1&&d("When binding an array, an index argument is not permitted."),u.forEach((f,g)=>ge(this,g+1,b(f),f)),this):(u instanceof ArrayBuffer&&(u=new Uint8Array(u)),typeof u=="object"&&!h.isBindableTypedArray(u)?(arguments.length!==1&&d("When binding an object, an index argument is not permitted."),Object.keys(u).forEach(f=>ge(this,f,b(u[f]),u[f])),this):ge(this,w,b(u),u)))},bindAsBlob:function(w,u){$(this),arguments.length===1&&(u=w,w=1);const f=b(u);return G.string!==f&&G.blob!==f&&G.null!==f&&d("Invalid value type for bindAsBlob()"),ge(this,w,G.blob,u)},step:function(){me(this,"step()");const w=a.sqlite3_step($(this).pointer);switch(w){case a.SQLITE_DONE:return te.delete(this),!1;case a.SQLITE_ROW:return te.add(this),!0;default:te.delete(this),i.config.warn("sqlite3_step() rc=",w,a.sqlite3_js_rc_str(w),"SQL =",a.sqlite3_sql(this.pointer)),se.checkRc(this.db.pointer,w)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const w=this.step();return this.reset(),w}finally{try{this.finalize()}catch{}}},get:function(w,u){if(te.has($(this))||d("Stmt.step() has not (recently) returned true."),Array.isArray(w)){let f=0;const g=this.columnCount;for(;f<g;)w[f]=this.get(f++);return w}else if(w&&typeof w=="object"){let f=0;const g=this.columnCount;for(;f<g;)w[a.sqlite3_column_name(this.pointer,f)]=this.get(f++);return w}switch(T(this,w),u===void 0?a.sqlite3_column_type(this.pointer,w):u){case a.SQLITE_NULL:return null;case a.SQLITE_INTEGER:if(o.bigIntEnabled){const f=a.sqlite3_column_int64(this.pointer,w);return f>=Number.MIN_SAFE_INTEGER&&f<=Number.MAX_SAFE_INTEGER?Number(f).valueOf():f}else{const f=a.sqlite3_column_double(this.pointer,w);return(f>Number.MAX_SAFE_INTEGER||f<Number.MIN_SAFE_INTEGER)&&d("Integer is out of range for JS integer range: "+f),h.isInt32(f)?f|0:f}case a.SQLITE_FLOAT:return a.sqlite3_column_double(this.pointer,w);case a.SQLITE_TEXT:return a.sqlite3_column_text(this.pointer,w);case a.SQLITE_BLOB:{const f=a.sqlite3_column_bytes(this.pointer,w),g=a.sqlite3_column_blob(this.pointer,w),E=new Uint8Array(f);return f&&(E.set(o.heap8u().slice(Number(g),Number(g)+f),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(E.buffer)),E}default:d("Don't know how to translate","type of result column #"+w+".")}d("Not reached.")},getInt:function(w){return this.get(w,a.SQLITE_INTEGER)},getFloat:function(w){return this.get(w,a.SQLITE_FLOAT)},getString:function(w){return this.get(w,a.SQLITE_TEXT)},getBlob:function(w){return this.get(w,a.SQLITE_BLOB)},getJSON:function(w){const u=this.get(w,a.SQLITE_STRING);return u===null?u:JSON.parse(u)},getColumnName:function(w){return a.sqlite3_column_name(T($(this),w).pointer,w)},getColumnNames:function(w=[]){T($(this),0);const u=this.columnCount;for(let f=0;f<u;++f)w.push(a.sqlite3_column_name(this.pointer,f));return w},getParamIndex:function(w){return $(this).parameterCount?a.sqlite3_bind_parameter_index(this.pointer,w):void 0},getParamName:function(w){return $(this).parameterCount?a.sqlite3_bind_parameter_name(this.pointer,w):void 0},isBusy:function(){return a.sqlite3_stmt_busy($(this))!==0},isReadOnly:function(){return a.sqlite3_stmt_readonly($(this))!==0}};{const w={enumerable:!0,get:function(){return L.get(this)},set:()=>d("The pointer property is read-only.")};Object.defineProperty(S.prototype,"pointer",w),Object.defineProperty(se.prototype,"pointer",w)}if(Object.defineProperty(S.prototype,"columnCount",{enumerable:!1,get:function(){return a.sqlite3_column_count(this.pointer)},set:()=>d("The columnCount property is read-only.")}),Object.defineProperty(S.prototype,"parameterCount",{enumerable:!1,get:function(){return a.sqlite3_bind_parameter_count(this.pointer)},set:()=>d("The parameterCount property is read-only.")}),S.wrapHandle=function(w,u,f=!1){if(!(w instanceof se)||!w.pointer)throw new i.SQLite3Error(i.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!u||!o.isPtr(u))throw new i.SQLite3Error(i.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new S(w,u,G,!!f)},i.oo1={DB:se,Stmt:S},h.isUIThread()){i.oo1.JsStorageDb=function(u="session"){const f=j.normalizeArgs(...arguments);u=f.filename,u!=="session"&&u!=="local"&&d("JsStorageDb db name must be one of 'session' or 'local'."),f.vfs="kvvfs",j.call(this,f)};const w=i.oo1.JsStorageDb;w.prototype=Object.create(se.prototype),w.clearStorage=a.sqlite3_js_kvvfs_clear,w.prototype.clearStorage=function(){return w.clearStorage(I(this).filename)},w.storageSize=a.sqlite3_js_kvvfs_size,w.prototype.storageSize=function(){return w.storageSize(I(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const d=i.util;i.initWorker1API=(function(){const a=(...z)=>{throw new Error(z.join(" "))};globalThis.WorkerGlobalScope instanceof Function||a("initWorker1API() must be run from a Worker thread.");const o=this.sqlite3||a("Missing this.sqlite3 object."),h=o.oo1.DB,L=function(z){let j=M.idMap.get(z);return j||(j="db#"+ ++M.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),M.idMap.set(z,j),j)},M={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(z){const j=new h(z);return this.dbs[L(j)]=j,this.dbList.indexOf(j)<0&&this.dbList.push(j),j},close:function(z,j){if(z){delete this.dbs[L(z)];const se=z.filename,G=d.sqlite3__wasm_db_vfs(z.pointer,0);z.close();const S=this.dbList.indexOf(z);S>=0&&this.dbList.splice(S,1),j&&se&&G&&d.sqlite3__wasm_vfs_unlink(G,se)}},post:function(z,j){j&&j.length?(globalThis.postMessage(z,Array.from(j)),j.length=0):globalThis.postMessage(z)},dbs:Object.create(null),getDb:function(z,j=!0){return this.dbs[z]||(j?a("Unknown (or closed) DB ID:",z):void 0)}},oe=function(z=M.dbList[0]){return z&&z.pointer?z:a("DB is not opened.")},Q=function(z,j=!0){const se=M.getDb(z.dbId,!1)||M.dbList[0];return j?oe(se):se},P=function(){return M.dbList[0]&&L(M.dbList[0])},R={open:function(z){const j=Object.create(null),se=z.args||Object.create(null);se.simulateError&&a("Throwing because of simulateError flag.");const G=Object.create(null);j.vfs=se.vfs,j.filename=se.filename||"";const S=M.open(j);return G.filename=S.filename,G.persistent=!!o.capi.sqlite3_js_db_uses_vfs(S.pointer,"opfs"),G.dbId=L(S),G.vfs=S.dbVfsName(),G},close:function(z){const j=Q(z,!1),se={filename:j&&j.filename};if(j){const G=z.args&&typeof z.args=="object"?!!z.args.unlink:!1;M.close(j,G)}return se},exec:function(z){const j=typeof z.args=="string"?{sql:z.args}:z.args||Object.create(null);j.rowMode==="stmt"?a("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):j.sql||a("'exec' requires input SQL.");const se=Q(z);(j.callback||Array.isArray(j.resultRows))&&(se._blobXfer=M.xfer);const G=j.callback;let S=0;const I=!!j.columnNames;typeof G=="string"&&(I||(j.columnNames=[]),j.callback=function(T,D){M.post({type:G,columnNames:j.columnNames,rowNumber:++S,row:T},M.xfer)});try{const T=j.countChanges?se.changes(!0,j.countChanges===64):void 0;se.exec(j),T!==void 0&&(j.changeCount=se.changes(!0,j.countChanges===64)-T);const D=j.lastInsertRowId?o.capi.sqlite3_last_insert_rowid(se):void 0;D!==void 0&&(j.lastInsertRowId=D),j.callback instanceof Function&&(j.callback=G,M.post({type:G,columnNames:j.columnNames,rowNumber:null,row:void 0}))}finally{delete se._blobXfer,j.callback&&(j.callback=G)}return j},"config-get":function(){const z=Object.create(null),j=o.config;return["bigIntEnabled"].forEach(function(se){Object.getOwnPropertyDescriptor(j,se)&&(z[se]=j[se])}),z.version=o.version,z.vfsList=o.capi.sqlite3_js_vfs_list(),z},export:function(z){const j=Q(z),se={byteArray:o.capi.sqlite3_js_db_export(j.pointer),filename:j.filename,mimetype:"application/x-sqlite3"};return M.xfer.push(se.byteArray.buffer),se},toss:function(z){a("Testing worker exception")}};globalThis.onmessage=async function(z){z=z.data;let j,se=z.dbId,G=z.type;const S=performance.now();try{R.hasOwnProperty(G)&&R[G]instanceof Function?j=await R[G](z):a("Unknown db worker message type:",z.type)}catch(I){G="error",j={operation:z.type,message:I.message,errorClass:I.name,input:z},I.stack&&(j.stack=typeof I.stack=="string"?I.stack.split(/\n\s*/):I.stack)}se||(se=j.dbId||P()),M.post({type:G,dbId:se,messageId:z.messageId,workerReceivedTime:S,workerRespondTime:performance.now(),departureTime:z.departureTime,result:j},M.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:i})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const d=i.wasm,a=i.capi,o=i.util.toss3,h=Object.create(null);i.vfs=h,a.sqlite3_vfs.prototype.registerVfs=function(L=!1){this instanceof i.capi.sqlite3_vfs||o("Expecting a sqlite3_vfs-type argument.");const M=a.sqlite3_vfs_register(this,L?1:0);return M&&o("sqlite3_vfs_register(",this,") failed with rc",M),this.pointer!==a.sqlite3_vfs_find(this.$zName)&&o("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},h.installVfs=function(L){let M=0;const oe=["io","vfs"];for(const Q of oe){const P=L[Q];P&&(++M,P.struct.installMethods(P.methods,!!P.applyArgcCheck),Q==="vfs"&&(!P.struct.$zName&&typeof P.name=="string"&&P.struct.addOnDispose(P.struct.$zName=d.allocCString(P.name)),P.struct.registerVfs(!!P.asDefault)))}return M||o("Misuse: installVfs() options object requires at least","one of:",oe),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){if(!i.wasm.exports.sqlite3_declare_vtab)return;const d=i.wasm,a=i.capi,o=i.util.toss3,h=Object.create(null);i.vtab=h;const L=a.sqlite3_index_info;L.prototype.nthConstraint=function(Q,P=!1){if(Q<0||Q>=this.$nConstraint)return!1;const R=d.ptr.add(this.$aConstraint,L.sqlite3_index_constraint.structInfo.sizeof*Q);return P?R:new L.sqlite3_index_constraint(R)},L.prototype.nthConstraintUsage=function(Q,P=!1){if(Q<0||Q>=this.$nConstraint)return!1;const R=d.ptr.add(this.$aConstraintUsage,L.sqlite3_index_constraint_usage.structInfo.sizeof*Q);return P?R:new L.sqlite3_index_constraint_usage(R)},L.prototype.nthOrderBy=function(Q,P=!1){if(Q<0||Q>=this.$nOrderBy)return!1;const R=d.ptr.add(this.$aOrderBy,L.sqlite3_index_orderby.structInfo.sizeof*Q);return P?R:new L.sqlite3_index_orderby(R)};const M=function(Q,P){return(function(R,z=!1){if(arguments.length===0&&(R=new P),R instanceof P)return this.set(R.pointer,R),R;d.isPtr(R)||i.SQLite3Error.toss("Invalid argument to",Q+"()");let j=this.get(R);return z&&this.delete(R),j}).bind(new Map)},oe=function(Q,P){const R=M(Q,P);return Object.assign(Object.create(null),{StructType:P,create:z=>{const j=R();return d.pokePtr(z,j.pointer),j},get:z=>R(z),unget:z=>R(z,!0),dispose:z=>{const j=R(z,!0);j&&j.dispose()}})};h.xVtab=oe("xVtab",a.sqlite3_vtab),h.xCursor=oe("xCursor",a.sqlite3_vtab_cursor),h.xIndexInfo=Q=>new a.sqlite3_index_info(Q),h.xError=function Q(P,R,z){if(Q.errorReporter instanceof Function)try{Q.errorReporter("sqlite3_module::"+P+"(): "+R.message)}catch{}let j;return R instanceof i.WasmAllocError?j=a.SQLITE_NOMEM:arguments.length>2?j=z:R instanceof i.SQLite3Error&&(j=R.resultCode),j||a.SQLITE_ERROR},h.xError.errorReporter=i.config.error.bind(i.config),h.xRowid=(Q,P)=>d.poke(Q,P,"i64"),h.setupModule=function(Q){let P=!1;const R=this instanceof a.sqlite3_module?this:Q.struct||(P=new a.sqlite3_module);try{const z=Q.methods||o("Missing 'methods' object.");for(const j of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const se=j[0],G=j[1];z[se]===!0?z[se]=z[G]:z[G]===!0&&(z[G]=z[se])}if(Q.catchExceptions){const j=function(S,I){return["xConnect","xCreate"].indexOf(S)>=0?function(T,D,x,F,$,m){try{return I(...arguments)||0}catch(b){return b instanceof i.WasmAllocError||(d.dealloc(d.peekPtr(m)),d.pokePtr(m,d.allocCString(b.message))),h.xError(S,b)}}:function(...T){try{return I(...T)||0}catch(D){return h.xError(S,D)}}},se=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],G=Object.create(null);for(const S of se){const I=z[S];if(I instanceof Function)S==="xConnect"&&z.xCreate===I?G[S]=z.xCreate:S==="xCreate"&&z.xConnect===I?G[S]=z.xConnect:G[S]=j(S,I);else continue}R.installMethods(G,!1)}else R.installMethods(z,!!Q.applyArgcCheck);if(R.$iVersion===0){let j;typeof Q.iVersion=="number"?j=Q.iVersion:R.$xIntegrity?j=4:R.$xShadowName?j=3:R.$xSavePoint||R.$xRelease||R.$xRollbackTo?j=2:j=1,R.$iVersion=j}}catch(z){throw P&&P.dispose(),z}return R},a.sqlite3_module.prototype.setupModule=function(Q){return h.setupModule.call(this,Q)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const d=function a(o){var M;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((M=navigator==null?void 0:navigator.storage)!=null&&M.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!o||typeof o!="object")&&(o=Object.create(null));const h=new URL(globalThis.location.href).searchParams;return h.has("opfs-disable")?Promise.resolve(i):(o.verbose===void 0&&(o.verbose=h.has("opfs-verbose")?+h.get("opfs-verbose")||2:1),o.sanityChecks===void 0&&(o.sanityChecks=h.has("opfs-sanity-check")),o.proxyUri===void 0&&(o.proxyUri=a.defaultProxyUri),typeof o.proxyUri=="function"&&(o.proxyUri=o.proxyUri()),new Promise(function(oe,Q){const P=[i.config.error,i.config.warn,i.config.log],R=(O,...V)=>{o.verbose>O&&P[O]("OPFS syncer:",...V)},z=(...O)=>R(2,...O),j=(...O)=>R(1,...O),se=(...O)=>R(0,...O),G=i.util.toss,S=i.capi,I=i.util,T=i.wasm,D=S.sqlite3_vfs,x=S.sqlite3_file,F=S.sqlite3_io_methods,$=Object.create(null),m=()=>{var O;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((O=navigator==null?void 0:navigator.storage)==null?void 0:O.getDirectory)};$.metrics={dump:function(){let O,V=0,K=0,ue=0;for(O in f.opIds){const le=g[O];V+=le.count,K+=le.time,ue+=le.wait,le.avgTime=le.count&&le.time?le.time/le.count:0,le.avgWait=le.count&&le.wait?le.wait/le.count:0}i.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",g,`
Total of`,V,"op(s) for",K,"ms (incl. "+ue+" ms of waiting on the async side)"),i.config.log("Serialization metrics:",g.s11n),ge.postMessage({type:"opfs-async-metrics"})},reset:function(){let O;const V=ue=>ue.count=ue.time=ue.wait=0;for(O in f.opIds)V(g[O]=Object.create(null));let K=g.s11n=Object.create(null);K=K.serialize=Object.create(null),K.count=K.time=0,K=g.s11n.deserialize=Object.create(null),K.count=K.time=0}};const b=new F,A=new D().addOnDispose(()=>b.dispose());let W;const te=O=>(W=!0,A.dispose(),Q(O)),me=()=>(W=!1,oe(i)),ge=new Worker(new URL(o.proxyUri,import.meta.url));setTimeout(()=>{W===void 0&&te(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),ge._originalOnError=ge.onerror,ge.onerror=function(O){se("Error initializing OPFS asyncer:",O),te(new Error("Loading OPFS async Worker failed for unknown reasons."))};const w=S.sqlite3_vfs_find(null),u=w?new D(w):null;b.$iVersion=1,A.$iVersion=2,A.$szOsFile=S.sqlite3_file.structInfo.sizeof,A.$mxPathname=1024,A.$zName=T.allocCString("opfs"),A.$xDlOpen=A.$xDlError=A.$xDlSym=A.$xDlClose=null,A.addOnDispose("$zName",A.$zName,"cleanup default VFS wrapper",()=>u?u.dispose():null);const f=Object.create(null);f.verbose=o.verbose,f.littleEndian=(()=>{const O=new ArrayBuffer(2);return new DataView(O).setInt16(0,256,!0),new Int16Array(O)[0]===256})(),f.asyncIdleWaitTime=150,f.asyncS11nExceptions=1,f.fileBufferSize=1024*64,f.sabS11nOffset=f.fileBufferSize,f.sabS11nSize=A.$mxPathname*2,f.sabIO=new SharedArrayBuffer(f.fileBufferSize+f.sabS11nSize),f.opIds=Object.create(null);const g=Object.create(null);{let O=0;f.opIds.whichOp=O++,f.opIds.rc=O++,f.opIds.xAccess=O++,f.opIds.xClose=O++,f.opIds.xDelete=O++,f.opIds.xDeleteNoWait=O++,f.opIds.xFileSize=O++,f.opIds.xLock=O++,f.opIds.xOpen=O++,f.opIds.xRead=O++,f.opIds.xSleep=O++,f.opIds.xSync=O++,f.opIds.xTruncate=O++,f.opIds.xUnlock=O++,f.opIds.xWrite=O++,f.opIds.mkdir=O++,f.opIds["opfs-async-metrics"]=O++,f.opIds["opfs-async-shutdown"]=O++,f.opIds.retry=O++,f.sabOP=new SharedArrayBuffer(O*4),$.metrics.reset()}f.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(O=>{(f.sq3Codes[O]=S[O])===void 0&&G("Maintenance required: not found:",O)}),f.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const E=(O,...V)=>{const K=f.opIds[O]||G("Invalid op ID:",O);f.s11n.serialize(...V),Atomics.store(f.sabOPView,f.opIds.rc,-1),Atomics.store(f.sabOPView,f.opIds.whichOp,K),Atomics.notify(f.sabOPView,f.opIds.whichOp);const ue=performance.now();for(;Atomics.wait(f.sabOPView,f.opIds.rc,-1)!=="not-equal";);const le=Atomics.load(f.sabOPView,f.opIds.rc);if(g[O].wait+=performance.now()-ue,le&&f.asyncS11nExceptions){const Ee=f.s11n.deserialize();Ee&&se(O+"() async error:",...Ee)}return le};$.debug={asyncShutdown:()=>{j("Shutting down OPFS async listener. The OPFS VFS will no longer work."),E("opfs-async-shutdown")},asyncRestart:()=>{j("Attempting to restart OPFS VFS async listener. Might work, might not."),ge.postMessage({type:"opfs-async-restart"})}};const Z=()=>{if(f.s11n)return f.s11n;const O=new TextDecoder,V=new TextEncoder("utf-8"),K=new Uint8Array(f.sabIO,f.sabS11nOffset,f.sabS11nSize),ue=new DataView(f.sabIO,f.sabS11nOffset,f.sabS11nSize);f.s11n=Object.create(null);const le=Object.create(null);le.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},le.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},le.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},le.string={id:4};const Ee=B=>le[typeof B]||G("Maintenance required: this value type cannot be serialized.",B),ye=B=>{switch(B){case le.number.id:return le.number;case le.bigint.id:return le.bigint;case le.boolean.id:return le.boolean;case le.string.id:return le.string;default:G("Invalid type ID:",B)}};return f.s11n.deserialize=function(B=!1){++g.s11n.deserialize.count;const k=performance.now(),U=K[0],J=U?[]:null;if(U){const ne=[];let ce=1,Se,Le,N;for(Se=0;Se<U;++Se,++ce)ne.push(ye(K[ce]));for(Se=0;Se<U;++Se){const ie=ne[Se];ie.getter?(N=ue[ie.getter](ce,f.littleEndian),ce+=ie.size):(Le=ue.getInt32(ce,f.littleEndian),ce+=4,N=O.decode(K.slice(ce,ce+Le)),ce+=Le),J.push(N)}}return B&&(K[0]=0),g.s11n.deserialize.time+=performance.now()-k,J},f.s11n.serialize=function(...B){const k=performance.now();if(++g.s11n.serialize.count,B.length){const U=[];let J=0,ne=1;for(K[0]=B.length&255;J<B.length;++J,++ne)U.push(Ee(B[J])),K[ne]=U[J].id;for(J=0;J<B.length;++J){const ce=U[J];if(ce.setter)ue[ce.setter](ne,B[J],f.littleEndian),ne+=ce.size;else{const Se=V.encode(B[J]);ue.setInt32(ne,Se.byteLength,f.littleEndian),ne+=4,K.set(Se,ne),ne+=Se.byteLength}}}else K[0]=0;g.s11n.serialize.time+=performance.now()-k},f.s11n},X=function O(V=16){O._chars||(O._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",O._n=O._chars.length);const K=[];let ue=0;for(;ue<V;++ue){const le=Math.random()*(O._n*64)%O._n|0;K[ue]=O._chars[le]}return K.join("")},de=Object.create(null),re=Object.create(null);re.op=void 0,re.start=void 0;const qe=O=>{re.start=performance.now(),re.op=O,++g[O].count},be=()=>g[re.op].time+=performance.now()-re.start,Pe={xCheckReservedLock:function(O,V){return T.poke(V,0,"i32"),0},xClose:function(O){qe("xClose");let V=0;const K=de[O];return K&&(delete de[O],V=E("xClose",O),K.sq3File&&K.sq3File.dispose()),be(),V},xDeviceCharacteristics:function(O){return S.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(O,V,K){return S.SQLITE_NOTFOUND},xFileSize:function(O,V){qe("xFileSize");let K=E("xFileSize",O);if(K==0)try{const ue=f.s11n.deserialize()[0];T.poke(V,ue,"i64")}catch(ue){se("Unexpected error reading xFileSize() result:",ue),K=f.sq3Codes.SQLITE_IOERR}return be(),K},xLock:function(O,V){qe("xLock");const K=de[O];let ue=0;return K.lockType?K.lockType=V:(ue=E("xLock",O,V),ue===0&&(K.lockType=V)),be(),ue},xRead:function(O,V,K,ue){qe("xRead");const le=de[O];let Ee;try{Ee=E("xRead",O,K,Number(ue)),(Ee===0||S.SQLITE_IOERR_SHORT_READ===Ee)&&T.heap8u().set(le.sabView.subarray(0,K),Number(V))}catch(ye){se("xRead(",arguments,") failed:",ye,le),Ee=S.SQLITE_IOERR_READ}return be(),Ee},xSync:function(O,V){qe("xSync"),++g.xSync.count;const K=E("xSync",O,V);return be(),K},xTruncate:function(O,V){qe("xTruncate");const K=E("xTruncate",O,Number(V));return be(),K},xUnlock:function(O,V){qe("xUnlock");const K=de[O];let ue=0;return S.SQLITE_LOCK_NONE===V&&K.lockType&&(ue=E("xUnlock",O,V)),ue===0&&(K.lockType=V),be(),ue},xWrite:function(O,V,K,ue){qe("xWrite");const le=de[O];let Ee;try{le.sabView.set(T.heap8u().subarray(Number(V),Number(V)+K)),Ee=E("xWrite",O,K,Number(ue))}catch(ye){se("xWrite(",arguments,") failed:",ye,le),Ee=S.SQLITE_IOERR_WRITE}return be(),Ee}},Oe={xAccess:function(O,V,K,ue){qe("xAccess");const le=E("xAccess",T.cstrToJs(V));return T.poke(ue,le?0:1,"i32"),be(),0},xCurrentTime:function(O,V){return T.poke(V,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(O,V){return T.poke(V,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(O,V,K){qe("xDelete");const ue=E("xDelete",T.cstrToJs(V),K,!1);return be(),ue},xFullPathname:function(O,V,K,ue){return T.cstrncpy(ue,V,K)<K?0:S.SQLITE_CANTOPEN},xGetLastError:function(O,V,K){return j("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(V,K,ue,le,Ee){qe("xOpen");let ye=0;K===0?K=X():T.isPtr(K)&&(S.sqlite3_uri_boolean(K,"opfs-unlock-asap",0)&&(ye|=f.opfsFlags.OPFS_UNLOCK_ASAP),S.sqlite3_uri_boolean(K,"delete-before-open",0)&&(ye|=f.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),K=T.cstrToJs(K));const B=Object.create(null);B.fid=ue,B.filename=K,B.sab=new SharedArrayBuffer(f.fileBufferSize),B.flags=le,B.readOnly=!(i.SQLITE_OPEN_CREATE&le)&&!!(le&S.SQLITE_OPEN_READONLY);const k=E("xOpen",ue,K,le,ye);return k||(B.readOnly&&T.poke(Ee,S.SQLITE_OPEN_READONLY,"i32"),de[ue]=B,B.sabView=f.sabFileBufView,B.sq3File=new x(ue),B.sq3File.$pMethods=b.pointer,B.lockType=S.SQLITE_LOCK_NONE),be(),k}};u&&(A.$xRandomness=u.$xRandomness,A.$xSleep=u.$xSleep),A.$xRandomness||(Oe.xRandomness=function(O,V,K){const ue=T.heap8u();let le=0;const Ee=Number(K);for(;le<V;++le)ue[Ee+le]=Math.random()*255e3&255;return le}),A.$xSleep||(Oe.xSleep=function(O,V){return Atomics.wait(f.sabOPView,f.opIds.xSleep,0,V),0}),$.getResolvedPath=function(O,V){const K=new URL(O,"file://irrelevant").pathname;return V?K.split("/").filter(ue=>!!ue):K},$.getDirForFilename=async function(V,K=!1){const ue=$.getResolvedPath(V,!0),le=ue.pop();let Ee=$.rootDirectory;for(const ye of ue)ye&&(Ee=await Ee.getDirectoryHandle(ye,{create:!!K}));return[Ee,le]},$.mkdir=async function(O){try{return await $.getDirForFilename(O+"/filepart",!0),!0}catch{return!1}},$.entryExists=async function(O){try{const[V,K]=await $.getDirForFilename(O);return await V.getFileHandle(K),!0}catch{return!1}},$.randomFilename=X,$.treeList=async function(){const O=async function K(ue,le){le.name=ue.name,le.dirs=[],le.files=[];for await(const Ee of ue.values())if(Ee.kind==="directory"){const ye=Object.create(null);le.dirs.push(ye),await K(Ee,ye)}else le.files.push(Ee.name)},V=Object.create(null);return await O($.rootDirectory,V),V},$.rmfr=async function(){const O=$.rootDirectory,V={recurse:!0};for await(const K of O.values())O.removeEntry(K.name,V)},$.unlink=async function(O,V=!1,K=!1){try{const[ue,le]=await $.getDirForFilename(O,!1);return await ue.removeEntry(le,{recursive:V}),!0}catch(ue){if(K)throw new Error("unlink(",arguments[0],") failed: "+ue.message,{cause:ue});return!1}},$.traverse=async function(O){const V={recursive:!0,directory:$.rootDirectory};typeof O=="function"&&(O={callback:O}),O=Object.assign(V,O||{}),async function ue(le,Ee){for await(const ye of le.values()){if(O.callback(ye,le,Ee)===!1)return!1;if(O.recursive&&ye.kind==="directory"&&await ue(ye,Ee+1)===!1)break}}(O.directory,0)};const Ce=async function(O,V){const[K,ue]=await $.getDirForFilename(O,!0);let Ee=await(await K.getFileHandle(ue,{create:!0})).createSyncAccessHandle(),ye=0,B,k=!1;try{for(Ee.truncate(0);(B=await V())!==void 0;)B instanceof ArrayBuffer&&(B=new Uint8Array(B)),!k&&ye===0&&B.byteLength>=15&&(I.affirmDbHeader(B),k=!0),Ee.write(B,{at:ye}),ye+=B.byteLength;if((ye<512||ye%512!==0)&&G("Input size",ye,"is not correct for an SQLite database."),!k){const U=new Uint8Array(20);Ee.read(U,{at:0}),I.affirmDbHeader(U)}return Ee.write(new Uint8Array([1,1]),{at:18}),ye}catch(U){throw await Ee.close(),Ee=void 0,await K.removeEntry(ue).catch(()=>{}),U}finally{Ee&&await Ee.close()}};if($.importDb=async function(O,V){if(V instanceof Function)return Ce(O,V);V instanceof ArrayBuffer&&(V=new Uint8Array(V)),I.affirmIsDb(V);const K=V.byteLength,[ue,le]=await $.getDirForFilename(O,!0);let Ee,ye=0;try{return Ee=await(await ue.getFileHandle(le,{create:!0})).createSyncAccessHandle(),Ee.truncate(0),ye=Ee.write(V,{at:0}),ye!=K&&G("Expected to write "+K+" bytes but wrote "+ye+"."),Ee.write(new Uint8Array([1,1]),{at:18}),ye}catch(B){throw Ee&&(await Ee.close(),Ee=void 0),await ue.removeEntry(le).catch(()=>{}),B}finally{Ee&&await Ee.close()}},i.oo1){const O=function(...V){const K=i.oo1.DB.dbCtorHelper.normalizeArgs(...V);K.vfs=A.$zName,i.oo1.DB.dbCtorHelper.call(this,K)};O.prototype=Object.create(i.oo1.DB.prototype),i.oo1.OpfsDb=O,O.importDb=$.importDb,i.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(A.pointer,function(V,K){K.capi.sqlite3_busy_timeout(V,1e4)})}const Ye=function(){const O=T.scopedAllocPush(),V=new x;try{const K=V.pointer,ue=S.SQLITE_OPEN_CREATE|S.SQLITE_OPEN_READWRITE|S.SQLITE_OPEN_MAIN_DB,le=T.scopedAlloc(8),Ee="/sanity/check/file"+X(8),ye=T.scopedAllocCString(Ee);let B;if(f.s11n.serialize("This is  string."),B=f.s11n.deserialize(),z("deserialize() says:",B),B[0]!=="This is  string."&&G("String d13n error."),Oe.xAccess(A.pointer,ye,0,le),B=T.peek(le,"i32"),z("xAccess(",Ee,") exists ?=",B),B=Oe.xOpen(A.pointer,ye,K,ue,le),z("open rc =",B,"state.sabOPView[xOpen] =",f.sabOPView[f.opIds.xOpen]),B!==0){se("open failed with code",B);return}Oe.xAccess(A.pointer,ye,0,le),B=T.peek(le,"i32"),B||G("xAccess() failed to detect file."),B=Pe.xSync(V.pointer,0),B&&G("sync failed w/ rc",B),B=Pe.xTruncate(V.pointer,1024),B&&G("truncate failed w/ rc",B),T.poke(le,0,"i64"),B=Pe.xFileSize(V.pointer,le),B&&G("xFileSize failed w/ rc",B),z("xFileSize says:",T.peek(le,"i64")),B=Pe.xWrite(V.pointer,ye,10,1),B&&G("xWrite() failed!");const k=T.scopedAlloc(16);B=Pe.xRead(V.pointer,k,6,2),T.poke(k+6,0);let U=T.cstrToJs(k);z("xRead() got:",U),U!=="sanity"&&G("Unexpected xRead() value."),Oe.xSleep&&(z("xSleep()ing before close()ing..."),Oe.xSleep(A.pointer,2e3),z("waking up from xSleep()")),B=Pe.xClose(K),z("xClose rc =",B,"sabOPView =",f.sabOPView),z("Deleting file:",Ee),Oe.xDelete(A.pointer,ye,4660),Oe.xAccess(A.pointer,ye,0,le),B=T.peek(le,"i32"),B&&G("Expecting 0 from xAccess(",Ee,") after xDelete()."),j("End of OPFS sanity checks.")}finally{V.dispose(),T.scopedAllocPop(O)}};ge.onmessage=function({data:O}){switch(O.type){case"opfs-unavailable":te(new Error(O.payload.join(" ")));break;case"opfs-async-loaded":ge.postMessage({type:"opfs-async-init",args:f});break;case"opfs-async-inited":{if(W===!0)break;try{i.vfs.installVfs({io:{struct:b,methods:Pe},vfs:{struct:A,methods:Oe}}),f.sabOPView=new Int32Array(f.sabOP),f.sabFileBufView=new Uint8Array(f.sabIO,0,f.fileBufferSize),f.sabS11nView=new Uint8Array(f.sabIO,f.sabS11nOffset,f.sabS11nSize),Z(),o.sanityChecks&&(j("Running sanity checks because of opfs-sanity-check URL arg..."),Ye()),m()?navigator.storage.getDirectory().then(V=>{ge.onerror=ge._originalOnError,delete ge._originalOnError,i.opfs=$,$.rootDirectory=V,z("End of OPFS sqlite3_vfs setup.",A),me()}).catch(te):me()}catch(V){se(V),te(V)}break}default:{const V="Unexpected message from the OPFS async worker: "+JSON.stringify(O);se(V),te(new Error(V));break}}}}))};d.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async a=>{try{let o=d.defaultProxyUri;return a.scriptInfo.sqlite3Dir&&(d.defaultProxyUri=a.scriptInfo.sqlite3Dir+o),d().catch(h=>{a.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",h.message)})}catch(o){return a.config.error("installOpfsVfs() exception:",o),Promise.reject(o)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){var re,qe,be,Pe,Oe,Ce,Ye,O,V,K,ue,le,Qt,ye;const d=i.util.toss,a=i.util.toss3,o=Object.create(null),h=i.capi,L=i.util,M=i.wasm,oe=4096,Q=512,P=4,R=8,z=Q+P,j=Q,se=z,G=oe,S=h.SQLITE_OPEN_MAIN_DB|h.SQLITE_OPEN_MAIN_JOURNAL|h.SQLITE_OPEN_SUPER_JOURNAL|h.SQLITE_OPEN_WAL,I=h.SQLITE_OPEN_MEMORY,T=".opaque",D=()=>Math.random().toString(36).slice(2),x=new TextDecoder,F=new TextEncoder,$=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),m=[i.config.error,i.config.warn,i.config.log];i.config.log;const b=i.config.warn;i.config.error;const A=new Map,W=B=>A.get(B),te=(B,k)=>{k?A.set(B,k):A.delete(B)},me=new Map,ge=B=>me.get(B),w=(B,k)=>{k?me.set(B,k):me.delete(B)},u={xCheckReservedLock:function(B,k){const U=ge(B);return U.log("xCheckReservedLock"),U.storeErr(),M.poke32(k,1),0},xClose:function(B){const k=ge(B);k.storeErr();const U=k.getOFileForS3File(B);if(U)try{k.log(`xClose ${U.path}`),k.mapS3FileToOFile(B,!1),U.sah.flush(),U.flags&h.SQLITE_OPEN_DELETEONCLOSE&&k.deletePath(U.path)}catch(J){return k.storeErr(J,h.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(B){return h.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(B,k,U){return h.SQLITE_NOTFOUND},xFileSize:function(B,k){const U=ge(B);U.log("xFileSize");const ne=U.getOFileForS3File(B).sah.getSize()-G;return M.poke64(k,BigInt(ne)),0},xLock:function(B,k){const U=ge(B);U.log(`xLock ${k}`),U.storeErr();const J=U.getOFileForS3File(B);return J.lockType=k,0},xRead:function(B,k,U,J){const ne=ge(B);ne.storeErr();const ce=ne.getOFileForS3File(B);ne.log(`xRead ${ce.path} ${U} @ ${J}`);try{const Se=ce.sah.read(M.heap8u().subarray(Number(k),Number(k)+U),{at:G+Number(J)});return Se<U?(M.heap8u().fill(0,Number(k)+Se,Number(k)+U),h.SQLITE_IOERR_SHORT_READ):0}catch(Se){return ne.storeErr(Se,h.SQLITE_IOERR)}},xSectorSize:function(B){return oe},xSync:function(B,k){const U=ge(B);U.log(`xSync ${k}`),U.storeErr();const J=U.getOFileForS3File(B);try{return J.sah.flush(),0}catch(ne){return U.storeErr(ne,h.SQLITE_IOERR)}},xTruncate:function(B,k){const U=ge(B);U.log(`xTruncate ${k}`),U.storeErr();const J=U.getOFileForS3File(B);try{return J.sah.truncate(G+Number(k)),0}catch(ne){return U.storeErr(ne,h.SQLITE_IOERR)}},xUnlock:function(B,k){const U=ge(B);U.log("xUnlock");const J=U.getOFileForS3File(B);return J.lockType=k,0},xWrite:function(B,k,U,J){const ne=ge(B);ne.storeErr();const ce=ne.getOFileForS3File(B);ne.log(`xWrite ${ce.path} ${U} ${J}`);try{const Se=ce.sah.write(M.heap8u().subarray(Number(k),Number(k)+U),{at:G+Number(J)});return U===Se?0:d("Unknown write() failure.")}catch(Se){return ne.storeErr(Se,h.SQLITE_IOERR)}}},f=new h.sqlite3_io_methods;f.$iVersion=1,i.vfs.installVfs({io:{struct:f,methods:u}});const g={xAccess:function(B,k,U,J){const ne=W(B);ne.storeErr();try{const ce=ne.getPath(k);M.poke32(J,ne.hasFilename(ce)?1:0)}catch{M.poke32(J,0)}return 0},xCurrentTime:function(B,k){return M.poke(k,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(B,k){return M.poke(k,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(B,k,U){const J=W(B);J.log(`xDelete ${M.cstrToJs(k)}`),J.storeErr();try{return J.deletePath(J.getPath(k)),0}catch(ne){return J.storeErr(ne),h.SQLITE_IOERR_DELETE}},xFullPathname:function(B,k,U,J){return M.cstrncpy(J,k,U)<U?0:h.SQLITE_CANTOPEN},xGetLastError:function(B,k,U){const J=W(B),ne=J.popErr();if(J.log(`xGetLastError ${k} e =`,ne),ne){const ce=M.scopedAllocPush();try{const[Se,Le]=M.scopedAllocCString(ne.message,!0);M.cstrncpy(U,Se,k),Le>k&&M.poke8(U+k-1,0)}catch{return h.SQLITE_NOMEM}finally{M.scopedAllocPop(ce)}}return ne?ne.sqlite3Rc||h.SQLITE_IOERR:0},xOpen:function(k,U,J,ne,ce){const Se=W(k);try{ne&=~I,Se.log(`xOpen ${M.cstrToJs(U)} ${ne}`);const Le=U&&M.peek8(U)?Se.getPath(U):D();let N=Se.getSAHForPath(Le);!N&&ne&h.SQLITE_OPEN_CREATE&&(Se.getFileCount()<Se.getCapacity()?(N=Se.nextAvailableSAH(),Se.setAssociatedPath(N,Le,ne)):d("SAH pool is full. Cannot create file",Le)),N||d("file not found:",Le);const ie={path:Le,flags:ne,sah:N};Se.mapS3FileToOFile(J,ie),ie.lockType=h.SQLITE_LOCK_NONE;const _e=new h.sqlite3_file(J);return _e.$pMethods=f.pointer,_e.dispose(),M.poke32(ce,ne),0}catch(Le){return Se.storeErr(Le),h.SQLITE_CANTOPEN}}},E=function(B){i.capi.sqlite3_vfs_find(B)&&a("VFS name is already registered:",B);const k=new h.sqlite3_vfs,U=h.sqlite3_vfs_find(null),J=U?new h.sqlite3_vfs(U):null;return k.$iVersion=2,k.$szOsFile=h.sqlite3_file.structInfo.sizeof,k.$mxPathname=Q,k.addOnDispose(k.$zName=M.allocCString(B),()=>te(k.pointer,0)),J&&(k.$xRandomness=J.$xRandomness,k.$xSleep=J.$xSleep,J.dispose()),!k.$xRandomness&&!g.xRandomness&&(g.xRandomness=function(ne,ce,Se){const Le=M.heap8u();let N=0;const ie=Number(Se);for(;N<ce;++N)Le[ie+N]=Math.random()*255e3&255;return N}),!k.$xSleep&&!g.xSleep&&(g.xSleep=(ne,ce)=>0),i.vfs.installVfs({vfs:{struct:k,methods:g}}),k};class Z{constructor(k=Object.create(null)){st(this,le);ut(this,"vfsDir");st(this,re);st(this,qe);st(this,be);st(this,Pe,new Map);st(this,Oe,new Map);st(this,Ce,new Set);st(this,Ye,new Map);st(this,O,new Uint8Array(z));st(this,V);st(this,K);st(this,ue);ft(this,ue,k.verbosity??$.verbosity),this.vfsName=k.name||$.name,ft(this,K,E(this.vfsName)),te(fe(this,K).pointer,this),this.vfsDir=k.directory||"."+this.vfsName,ft(this,V,new DataView(fe(this,O).buffer,fe(this,O).byteOffset)),this.isReady=this.reset(!!(k.clearOnInit??$.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(k.initialCapacity||$.initialCapacity)})}log(...k){$t(this,le,Qt).call(this,2,...k)}warn(...k){$t(this,le,Qt).call(this,1,...k)}error(...k){$t(this,le,Qt).call(this,0,...k)}getVfs(){return fe(this,K)}getCapacity(){return fe(this,Pe).size}getFileCount(){return fe(this,Oe).size}getFileNames(){const k=[];for(const U of fe(this,Oe).keys())k.push(U);return k}async addCapacity(k){for(let U=0;U<k;++U){const J=D(),ce=await(await fe(this,qe).getFileHandle(J,{create:!0})).createSyncAccessHandle();fe(this,Pe).set(ce,J),this.setAssociatedPath(ce,"",0)}return this.getCapacity()}async reduceCapacity(k){let U=0;for(const J of Array.from(fe(this,Ce))){if(U===k||this.getFileCount()===this.getCapacity())break;const ne=fe(this,Pe).get(J);J.close(),await fe(this,qe).removeEntry(ne),fe(this,Pe).delete(J),fe(this,Ce).delete(J),++U}return U}releaseAccessHandles(){for(const k of fe(this,Pe).keys())k.close();fe(this,Pe).clear(),fe(this,Oe).clear(),fe(this,Ce).clear()}async acquireAccessHandles(k=!1){const U=[];for await(const[J,ne]of fe(this,qe))ne.kind==="file"&&U.push([J,ne]);return Promise.all(U.map(async([J,ne])=>{try{const ce=await ne.createSyncAccessHandle();if(fe(this,Pe).set(ce,J),k)ce.truncate(G),this.setAssociatedPath(ce,"",0);else{const Se=this.getAssociatedPath(ce);Se?fe(this,Oe).set(Se,ce):fe(this,Ce).add(ce)}}catch(ce){throw this.storeErr(ce),this.releaseAccessHandles(),ce}}))}getAssociatedPath(k){k.read(fe(this,O),{at:0});const U=fe(this,V).getUint32(j);if(fe(this,O)[0]&&(U&h.SQLITE_OPEN_DELETEONCLOSE||!(U&S)))return b(`Removing file with unexpected flags ${U.toString(16)}`,fe(this,O)),this.setAssociatedPath(k,"",0),"";const J=new Uint32Array(R/4);k.read(J,{at:se});const ne=this.computeDigest(fe(this,O),U);if(J.every((ce,Se)=>ce===ne[Se])){const ce=fe(this,O).findIndex(Se=>Se===0);return ce===0&&k.truncate(G),ce?x.decode(fe(this,O).subarray(0,ce)):""}else return b("Disassociating file with bad digest."),this.setAssociatedPath(k,"",0),""}setAssociatedPath(k,U,J){const ne=F.encodeInto(U,fe(this,O));Q<=ne.written+1&&d("Path too long:",U),U&&J&&(J|=I),fe(this,O).fill(0,ne.written,Q),fe(this,V).setUint32(j,J);const ce=this.computeDigest(fe(this,O),J);k.write(fe(this,O),{at:0}),k.write(ce,{at:se}),k.flush(),U?(fe(this,Oe).set(U,k),fe(this,Ce).delete(k)):(k.truncate(G),fe(this,Ce).add(k))}computeDigest(k,U){if(U&I){let J=3735928559,ne=1103547991;for(const ce of k)J=Math.imul(J^ce,2654435761),ne=Math.imul(ne^ce,104729);return new Uint32Array([J>>>0,ne>>>0])}else return new Uint32Array([0,0])}async reset(k){await this.isReady;let U=await navigator.storage.getDirectory(),J;for(const ne of this.vfsDir.split("/"))ne&&(J=U,U=await U.getDirectoryHandle(ne,{create:!0}));return ft(this,re,U),ft(this,be,J),ft(this,qe,await fe(this,re).getDirectoryHandle(T,{create:!0})),this.releaseAccessHandles(),this.acquireAccessHandles(k)}getPath(k){return M.isPtr(k)&&(k=M.cstrToJs(k)),(k instanceof URL?k:new URL(k,"file://localhost/")).pathname}deletePath(k){const U=fe(this,Oe).get(k);return U&&(fe(this,Oe).delete(k),this.setAssociatedPath(U,"",0)),!!U}storeErr(k,U){return k&&(k.sqlite3Rc=U||h.SQLITE_IOERR,this.error(k)),this.$error=k,U}popErr(){const k=this.$error;return this.$error=void 0,k}nextAvailableSAH(){const[k]=fe(this,Ce).keys();return k}getOFileForS3File(k){return fe(this,Ye).get(k)}mapS3FileToOFile(k,U){U?(fe(this,Ye).set(k,U),w(k,this)):(fe(this,Ye).delete(k),w(k,!1))}hasFilename(k){return fe(this,Oe).has(k)}getSAHForPath(k){return fe(this,Oe).get(k)}async removeVfs(){if(!fe(this,K).pointer||!fe(this,qe))return!1;h.sqlite3_vfs_unregister(fe(this,K).pointer),fe(this,K).dispose(),delete o[this.vfsName];try{this.releaseAccessHandles(),await fe(this,re).removeEntry(T,{recursive:!0}),ft(this,qe,void 0),await fe(this,be).removeEntry(fe(this,re).name,{recursive:!0}),ft(this,re,ft(this,be,void 0))}catch(k){i.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",k)}return!0}pauseVfs(){return fe(this,Ye).size>0&&i.SQLite3Error.toss(h.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),fe(this,Pe).size>0&&(h.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return fe(this,Pe).size===0}async unpauseVfs(){return fe(this,Pe).size===0?this.acquireAccessHandles(!1).then(()=>h.sqlite3_vfs_register(fe(this,K),0),this):this}exportFile(k){const U=fe(this,Oe).get(k)||d("File not found:",k),J=U.getSize()-G,ne=new Uint8Array(J>0?J:0);if(J>0){const ce=U.read(ne,{at:G});ce!=J&&d("Expected to read "+J+" bytes but read "+ce+".")}return ne}async importDbChunked(k,U){const J=fe(this,Oe).get(k)||this.nextAvailableSAH()||d("No available handles to import to.");J.truncate(0);let ne=0,ce,Se=!1;try{for(;(ce=await U())!==void 0;)ce instanceof ArrayBuffer&&(ce=new Uint8Array(ce)),!Se&&ne===0&&ce.byteLength>=15&&(L.affirmDbHeader(ce),Se=!0),J.write(ce,{at:G+ne}),ne+=ce.byteLength;if((ne<512||ne%512!==0)&&d("Input size",ne,"is not correct for an SQLite database."),!Se){const Le=new Uint8Array(20);J.read(Le,{at:0}),L.affirmDbHeader(Le)}J.write(new Uint8Array([1,1]),{at:G+18})}catch(Le){throw this.setAssociatedPath(J,"",0),Le}return this.setAssociatedPath(J,k,h.SQLITE_OPEN_MAIN_DB),ne}importDb(k,U){if(U instanceof ArrayBuffer)U=new Uint8Array(U);else if(U instanceof Function)return this.importDbChunked(k,U);const J=fe(this,Oe).get(k)||this.nextAvailableSAH()||d("No available handles to import to."),ne=U.byteLength;(ne<512||ne%512!=0)&&d("Byte array size is invalid for an SQLite db.");const ce="SQLite format 3";for(let Le=0;Le<ce.length;++Le)ce.charCodeAt(Le)!==U[Le]&&d("Input does not contain an SQLite database header.");const Se=J.write(U,{at:G});return Se!=ne?(this.setAssociatedPath(J,"",0),d("Expected to write "+ne+" bytes but wrote "+Se+".")):(J.write(new Uint8Array([1,1]),{at:G+18}),this.setAssociatedPath(J,k,h.SQLITE_OPEN_MAIN_DB)),Se}}re=new WeakMap,qe=new WeakMap,be=new WeakMap,Pe=new WeakMap,Oe=new WeakMap,Ce=new WeakMap,Ye=new WeakMap,O=new WeakMap,V=new WeakMap,K=new WeakMap,ue=new WeakMap,le=new WeakSet,Qt=function(k,...U){fe(this,ue)>k&&m[k](this.vfsName+":",...U)};class X{constructor(k){st(this,ye);ft(this,ye,k),this.vfsName=k.vfsName}async addCapacity(k){return fe(this,ye).addCapacity(k)}async reduceCapacity(k){return fe(this,ye).reduceCapacity(k)}getCapacity(){return fe(this,ye).getCapacity(fe(this,ye))}getFileCount(){return fe(this,ye).getFileCount()}getFileNames(){return fe(this,ye).getFileNames()}async reserveMinimumCapacity(k){const U=fe(this,ye).getCapacity();return U<k?fe(this,ye).addCapacity(k-U):U}exportFile(k){return fe(this,ye).exportFile(k)}importDb(k,U){return fe(this,ye).importDb(k,U)}async wipeFiles(){return fe(this,ye).reset(!0)}unlink(k){return fe(this,ye).deletePath(k)}async removeVfs(){return fe(this,ye).removeVfs()}pauseVfs(){return fe(this,ye).pauseVfs(),this}async unpauseVfs(){return fe(this,ye).unpauseVfs().then(()=>this)}isPaused(){return fe(this,ye).isPaused()}}ye=new WeakMap;const de=async()=>{const B=await navigator.storage.getDirectory(),k=".opfs-sahpool-sync-check-"+D(),ne=(await(await B.getFileHandle(k,{create:!0})).createSyncAccessHandle()).close();return await ne,await B.removeEntry(k),ne!=null&&ne.then&&d("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};i.installOpfsSAHPoolVfs=async function(B=Object.create(null)){var U;B=Object.assign(Object.create(null),$,B||{});const k=B.name;if(B.$testThrowPhase1)throw B.$testThrowPhase1;if(o[k])try{return await o[k]}catch(J){if(B.forceReinitIfPreviouslyFailed)delete o[k];else throw J}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((U=navigator==null?void 0:navigator.storage)!=null&&U.getDirectory)?o[k]=Promise.reject(new Error("Missing required OPFS APIs.")):o[k]=de().then(async function(){if(B.$testThrowPhase2)throw B.$testThrowPhase2;const J=new Z(B);return J.isReady.then(async()=>{const ne=new X(J);if(i.oo1){const ce=i.oo1,Se=J.getVfs(),Le=function(...N){const ie=ce.DB.dbCtorHelper.normalizeArgs(...N);ie.vfs=Se.$zName,ce.DB.dbCtorHelper.call(this,ie)};Le.prototype=Object.create(ce.DB.prototype),ne.OpfsSAHPoolDb=Le}return J.log("VFS initialized."),ne}).catch(async ne=>{throw await J.removeVfs().catch(()=>{}),ne})}).catch(J=>o[k]=Promise.reject(J))}}),typeof s>"u")throw console.warn("This is not running in the context of Module.runSQLite3PostLoadInit()"),new Error("sqlite3-api-cleanup.js expects to be running in the context of its Emscripten module loader.");try{const i=Object.assign(Object.create(null),globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{},{memory:typeof ct<"u"?ct:s.wasmMemory,exports:typeof It<"u"?It:Object.prototype.hasOwnProperty.call(s,"wasmExports")?s.wasmExports:s.asm});i.wasmPtrIR=typeof i.exports.sqlite3_libversion()=="number"?"i32":"i64";const d=n;d.debugModule("Bootstrapping lib config",d);const a=globalThis.sqlite3ApiBootstrap(i);return delete globalThis.sqlite3ApiBootstrap,a}catch(i){throw console.error("sqlite3ApiBootstrap() error:",i),i}throw new Error("Maintenance required: this line should never be reached")},In?t=r:t=new Promise((n,s)=>{He=n,at=s}),t}const Gc=function(){var l,p;const e=kn;if(!e)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const t=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(l=globalThis==null?void 0:globalThis.document)==null?void 0:l.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(p=globalThis==null?void 0:globalThis.location)!=null&&p.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(t.debugModule=t.urlParams.has("sqlite3.debugModule")?(...y)=>console.warn("sqlite3.debugModule:",...y):()=>{},t.urlParams.has("sqlite3.dir"))t.sqlite3Dir=t.urlParams.get("sqlite3.dir")+"/";else if(t.moduleScript){const y=t.moduleScript.src.split("/");y.pop(),t.sqlite3Dir=y.join("/")+"/"}const r=globalThis.sqlite3InitModule=function y(...q){return e(...q).then(C=>{t.debugModule("sqlite3InitModule() sIMS =",t),t.debugModule("sqlite3InitModule() EmscriptenModule =",C);const Y=C.runSQLite3PostLoadInit(t,C,!!y.__isUnderTest);return t.debugModule("sqlite3InitModule() sqlite3 =",Y),Y}).catch(C=>{throw console.error("Exception loading sqlite3 module:",C),C})};if(r.ready=e.ready,t.moduleScript){let y=t.moduleScript.src.split("/");y.pop(),t.scriptDir=y.join("/")+"/"}return t.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",t),r}();kn=Gc;var Kc=kn;globalThis.sqlite3Worker1Promiser=function e(t=e.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const ee=t;t=Object.assign(Object.create(null),e.defaultConfig),t.onready=ee}else t=Object.assign(Object.create(null),e.defaultConfig,t);const r=Object.create(null),l=function(){},p=t.onerror||l,y=t.debug||l,q=t.generateMessageId?void 0:Object.create(null),C=t.generateMessageId||function(ee){return ee.type+"#"+(q[ee.type]=(q[ee.type]||0)+1)},Y=(...ee)=>{throw new Error(ee.join(" "))};t.worker||(t.worker=e.defaultConfig.worker),typeof t.worker=="function"&&(t.worker=t.worker());let ae,pe;return t.worker.onmessage=function(ee){ee=ee.data,y("worker1.onmessage",ee);let he=r[ee.messageId];if(!he){if(ee&&ee.type==="sqlite3-api"&&ee.result==="worker1-ready"){t.onready&&t.onready(pe);return}if(he=r[ee.type],he&&he.onrow){he.onrow(ee);return}t.onunhandled?t.onunhandled(arguments[0]):p("sqlite3Worker1Promiser() unhandled worker message:",ee);return}switch(delete r[ee.messageId],ee.type){case"error":he.reject(ee);return;case"open":ae||(ae=ee.dbId);break;case"close":ee.dbId===ae&&(ae=void 0);break}try{he.resolve(ee)}catch(Ie){he.reject(Ie)}},pe=function(){let ee;arguments.length===1?ee=arguments[0]:arguments.length===2?(ee=Object.create(null),ee.type=arguments[0],ee.args=arguments[1],ee.dbId=ee.args.dbId):Y("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!ee.dbId&&ee.type!=="open"&&(ee.dbId=ae),ee.messageId=C(ee),ee.departureTime=performance.now();const he=Object.create(null);he.message=ee;let Ie;ee.type==="exec"&&ee.args&&(typeof ee.args.callback=="function"?(Ie=ee.messageId+":row",he.onrow=ee.args.callback,ee.args.callback=Ie,r[Ie]=he):typeof ee.args.callback=="string"&&Y("exec callback may not be a string when using the Promise interface."));let Re=new Promise(function(He,at){he.resolve=He,he.reject=at,r[ee.messageId]=he,y("Posting",ee.type,"message to Worker dbId="+(ae||"default")+":",ee),t.worker.postMessage(ee)});return Ie&&(Re=Re.finally(()=>delete r[Ie])),Re}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/assets/sqlite3-worker1-HKXiBUt9.js",import.meta.url))},onerror:(...e)=>console.error("worker1 promiser error",...e)};globalThis.sqlite3Worker1Promiser.v2=(function e(t=e.defaultConfig){let r;typeof t=="function"?(r=t,t={}):typeof(t==null?void 0:t.onready)=="function"&&(r=t.onready,delete t.onready);const l=Object.create(null);t=Object.assign(t||Object.create(null),{onready:async function(y){try{r&&await r(y),l.resolve(y)}catch(q){l.reject(q)}}});const p=new Promise(function(y,q){l.resolve=y,l.reject=q});try{this.original(t)}catch(y){l.reject(y)}return p}).bind({original:sqlite3Worker1Promiser});globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig;sqlite3Worker1Promiser.v2;const Jc={fts:.35,vector:.4,entity:.15,graph:.1},pt={FTS_SEARCH:`
    SELECT
      m.gid,
      m.page_no,
      m.title,
      snippet(meta_fts, 3, '<mark>', '</mark>', '', 18) AS snippet,
      meta_fts.rank,
      (1.0 / (ABS(meta_fts.rank) + 1.0)) AS score
    FROM meta_fts
    JOIN meta_index m ON m.rowid = meta_fts.rowid
    WHERE meta_fts MATCH ?
    ORDER BY meta_fts.rank
    LIMIT ?
  `,LIST_ENTITY_FACETS:`
    SELECT
      entity_type,
      normalized_value,
      COUNT(*) AS count
    FROM entities
    WHERE entity_type = COALESCE(?, entity_type)
    GROUP BY entity_type, normalized_value
    ORDER BY count DESC, entity_type, normalized_value
    LIMIT ?
  `,LIST_ENTITY_TYPES:`
    SELECT DISTINCT entity_type, COUNT(*) AS count
    FROM entities
    GROUP BY entity_type
    ORDER BY count DESC
  `,GET_PAGE_LIST:`
    SELECT
      gid,
      doc_id,
      page_no,
      title,
      tags,
      updated_ts
    FROM meta_index
    ORDER BY page_no
    LIMIT ? OFFSET ?
  `,GET_PAGE_BLOB:`
    SELECT data, sz
    FROM sqlar
    WHERE name = ?
    LIMIT 1
  `,GET_VECTOR_META:`
    SELECT gid, model_id, dim
    FROM leann_meta
    WHERE gid = ? AND model_id = ?
    LIMIT 1
  `,GET_CACHED_VECTOR:`
    SELECT embedding
    FROM leann_vec
    WHERE gid = ? AND model_id = ?
    LIMIT 1
  `,GET_ALL_VECTORS:`
    SELECT
      lm.gid,
      lm.page_no,
      m.title,
      lv.embedding
    FROM leann_vec lv
    JOIN leann_meta lm ON lm.gid = lv.gid AND lm.model_id = lv.model_id
    JOIN meta_index m ON m.gid = lm.gid
    WHERE lv.model_id = ?
    ORDER BY lm.page_no
  `,GET_PAGE_ENTITIES:`
    SELECT
      entity_type,
      entity_text,
      normalized_value,
      confidence
    FROM entities
    WHERE gid = ?
    ORDER BY confidence DESC
  `,GET_CHECKPOINTS:`
    SELECT
      epoch,
      merkle_root,
      pages_count,
      anchors_json,
      created_ts
    FROM checkpoints
    ORDER BY epoch DESC
  `,VERIFY_PAGE:`
    SELECT
      gr.gid,
      gr.content_sha,
      gr.signer,
      gr.sig,
      gr.epoch,
      gr.merkle_root,
      m.full_text
    FROM glyph_receipts gr
    JOIN meta_index m ON m.gid = gr.gid
    WHERE gr.gid = ?
    LIMIT 1
  `,GET_GRAPH_NEIGHBORS:`
    SELECT
      n2.gid,
      n2.page_no,
      m.title,
      e.pred,
      e.weight
    FROM node_index n1
    JOIN edges e ON e.fromNode = n1.node_id
    JOIN node_index n2 ON n2.node_id = e.toNode
    JOIN meta_index m ON m.gid = n2.gid
    WHERE n1.gid = ?
    ORDER BY e.weight DESC
    LIMIT ?
  `};function Yc(e,t){if(e.length!==t.length)throw new Error("Vectors must have same length");let r=0,l=0,p=0;for(let q=0;q<e.length;q++)r+=e[q]*t[q],l+=e[q]*e[q],p+=t[q]*t[q];const y=Math.sqrt(l)*Math.sqrt(p);return y===0?0:r/y}async function Xc(e){const r=new TextEncoder().encode(e),l=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(l)).map(y=>y.toString(16).padStart(2,"0")).join("")}function eu(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function tu(e){return new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)}function mt(){return typeof navigator<"u"&&"storage"in navigator&&"getDirectory"in navigator.storage}async function nu(){if(!mt())throw new Error("OPFS not supported in this browser");return await navigator.storage.getDirectory()}async function An(){return await(await nu()).getDirectoryHandle("capsules",{create:!0})}async function ru(e){if(!mt())throw new Error("OPFS not supported");const p=await(await(await(await An()).getFileHandle(e)).getFile()).arrayBuffer();return new Uint8Array(p)}async function iu(e){if(!mt())throw new Error("OPFS not supported");await(await An()).removeEntry(e),console.log(`[OPFS] Removed file: ${e}`)}async function su(){if(!mt())return[];try{const e=await An(),t=[];for await(const[r,l]of e.entries())if(l.kind==="file"){const p=await l.getFile();t.push({path:r,size:p.size,lastModified:p.lastModified})}return t.sort((r,l)=>l.lastModified-r.lastModified)}catch(e){return console.error("[OPFS] Failed to list files:",e),[]}}const ou=["sqlar","meta_index","meta_fts","entities","node_index","edges","ledger_blocks","checkpoints","keys"];let xe=null,rt=null,vt=null;async function au(){rt||(console.log("[Worker] Initializing SQLite WASM..."),rt=await Kc({print:console.log,printErr:console.error}),console.log("[Worker] SQLite WASM initialized:",rt.version.libVersion))}function Wr(){if(!xe)return{valid:!1,missing:["no database open"]};const e=new Set,t=xe.prepare('SELECT name FROM sqlite_master WHERE type="table"');try{for(;t.step();)e.add(t.get([])[0])}finally{t.finalize()}const r=ou.filter(l=>!e.has(l));return{valid:r.length===0,missing:r}}function Zr(e,t,r){if(!xe)throw new Error("No database open");let l="unknown",p=xe.prepare("SELECT doc_id FROM meta_index LIMIT 1");try{p.step()&&(l=p.get([])[0])}finally{p.finalize()}p=xe.prepare("SELECT COUNT(*) FROM meta_index");let y=0;try{p.step()&&(y=p.get([])[0])}finally{p.finalize()}p=xe.prepare("SELECT COUNT(*) FROM entities");let q=0;try{p.step()&&(q=p.get([])[0])}finally{p.finalize()}p=xe.prepare("SELECT COUNT(*) FROM edges");let C=0;try{p.step()&&(C=p.get([])[0])}finally{p.finalize()}let Y=!1,ae,pe;p=xe.prepare(`
    SELECT name FROM sqlite_master
    WHERE type='table' AND name='leann_vec'
  `);try{if(p.step()){Y=!0;const ee=xe.prepare("SELECT model_id, dim FROM leann_meta LIMIT 1");try{if(ee.step()){const he=ee.get([]);ae=he[0],pe=he[1]}}finally{ee.finalize()}}}finally{p.finalize()}return{fileName:e,fileSize:t,docId:l,pageCount:y,entityCount:q,edgeCount:C,hasVectors:Y,vectorModel:ae,vectorDim:pe,opfsPath:r}}async function Qr(e){try{const t=await e.arrayBuffer(),r=new Uint8Array(t);xe&&(xe.close(),xe=null),xe=new rt.oo1.DB(":memory:");const l=rt.capi.sqlite3_deserialize(xe.pointer,"main",r,r.length,r.length,rt.capi.SQLITE_DESERIALIZE_FREEONCLOSE|rt.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(l!==rt.capi.SQLITE_OK)throw new Error(`Failed to deserialize database: ${l}`);const p=Wr();if(!p.valid)throw new Error(`Invalid schema. Missing tables: ${p.missing.join(", ")}`);const y=Zr(e.name,e.size);return vt=y,console.log("[Worker] Capsule opened:",y),{ok:!0,data:y}}catch(t){return console.error("[Worker] Failed to open capsule:",t),{ok:!1,error:String(t)}}}async function lu(){try{const e=await fetch("/memglyph-demo.mgx.sqlite");if(!e.ok)throw new Error(`Failed to fetch demo capsule: ${e.statusText}`);const t=await e.arrayBuffer(),r=new Blob([t],{type:"application/x-sqlite3"}),l=new File([r],"memglyph-demo.mgx.sqlite",{type:"application/x-sqlite3"});return await Qr(l)}catch(e){return console.error("[Worker] Failed to open demo capsule:",e),{ok:!1,error:String(e)}}}async function cu(e){try{if(!mt())throw new Error("OPFS not supported in this browser");const t=await ru(e);xe&&(xe.close(),xe=null),xe=new rt.oo1.DB(":memory:");const r=rt.capi.sqlite3_deserialize(xe.pointer,"main",t,t.length,t.length,rt.capi.SQLITE_DESERIALIZE_FREEONCLOSE|rt.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(r!==rt.capi.SQLITE_OK)throw new Error(`Failed to deserialize database: ${r}`);const l=Wr();if(!l.valid)throw new Error(`Invalid schema. Missing tables: ${l.missing.join(", ")}`);const p=Zr(e,t.length,e);return vt=p,console.log("[Worker] Capsule opened from OPFS:",p),Gt(p)}catch(t){return console.error("[Worker] Failed to open capsule from OPFS:",t),en(t)}}async function uu(e){try{throw xe?mt()?rt.capi.sqlite3_serialize(xe.pointer,"main",0,0)?new Error("SAVE_TO_OPFS should be handled by main thread, not worker"):new Error("Failed to serialize database"):new Error("OPFS not supported in this browser"):new Error("No database open")}catch(t){return console.error("[Worker] Failed to save to OPFS:",t),en(t)}}async function fu(e){try{if(!mt())throw new Error("OPFS not supported in this browser");return await iu(e),console.log(`[Worker] Removed file from OPFS: ${e}`),Gt(void 0)}catch(t){return console.error("[Worker] Failed to remove file from OPFS:",t),en(t)}}async function _u(){try{if(!mt())return Gt([]);const e=await su();return Gt(e)}catch(e){return console.error("[Worker] Failed to list OPFS files:",e),en(e)}}function du(){return xe?(xe.close(),xe=null,vt=null,{ok:!0,data:void 0}):{ok:!1,error:"No database open"}}function Hr(e,t){if(!xe)return{ok:!1,error:"No database open"};const r=[],l=xe.prepare(pt.FTS_SEARCH);try{for(l.bind([e,t]);l.step();){const p=l.get([]);r.push({gid:p[0],pageNo:p[1],title:p[2],snippet:p[3],rank:p[4],score:p[5]})}return{ok:!0,data:r}}catch(p){return{ok:!1,error:String(p)}}finally{l.finalize()}}function pu(e,t){if(!xe)return{ok:!1,error:"No database open"};if(!(vt!=null&&vt.hasVectors))return{ok:!1,error:"No vectors available in capsule"};const r=[],l=vt.vectorModel||"gte-small-384",p=xe.prepare(pt.GET_ALL_VECTORS);try{p.bind([l]);const y=[];for(;p.step();){const q=p.get([]),C=tu(q[3]);y.push({gid:q[0],pageNo:q[1],title:q[2],vector:C})}for(const q of y){const C=Yc(e,q.vector);r.push({gid:q.gid,pageNo:q.pageNo,title:q.title,similarity:C})}return r.sort((q,C)=>C.similarity-q.similarity),r.splice(t),{ok:!0,data:r}}catch(y){return{ok:!1,error:String(y)}}finally{p.finalize()}}function hu(e,t,r){if(!xe)return{ok:!1,error:"No database open"};const l={...Jc,...r};try{const p=Hr(e,Math.min(t*3,50));if(!p.ok)return p;const y=p.data,q=new Map;for(const pe of y)q.set(pe.gid,{gid:pe.gid,pageNo:pe.pageNo,title:pe.title,snippet:pe.snippet,ftsScore:pe.score,vectorScore:0,entityScore:0,graphScore:0});const C=e.toLowerCase().split(/\s+/).filter(pe=>pe.length>2);if(C.length>0)for(const[pe,ee]of q){const he=xe.prepare(pt.GET_PAGE_ENTITIES);try{he.bind([pe]);let Ie=0;for(;he.step();){const Re=he.get([]),He=String(Re[1]).toLowerCase();for(const at of C)if(He.includes(at)){Ie++;break}}ee.entityScore=Math.min(Ie/3,1)}finally{he.finalize()}}const Y=Array.from(q.keys()).slice(0,Math.min(10,t));for(const pe of Y){const ee=q.get(pe),he=xe.prepare(pt.GET_GRAPH_NEIGHBORS);try{he.bind([pe,5]);let Ie=0;for(;he.step();){const He=he.get([])[0];q.has(He)&&Ie++}ee.graphScore=Math.min(Ie/3,1)}finally{he.finalize()}}const ae=[];for(const[pe,ee]of q){const he=l.fts*ee.ftsScore+l.vector*ee.vectorScore+l.entity*ee.entityScore+l.graph*ee.graphScore;ae.push({gid:ee.gid,pageNo:ee.pageNo,title:ee.title,snippet:ee.snippet,scores:{fts:ee.ftsScore,vector:ee.vectorScore,entity:ee.entityScore,graph:ee.graphScore,final:he}})}return ae.sort((pe,ee)=>ee.scores.final-pe.scores.final),ae.splice(t),{ok:!0,data:ae}}catch(p){return{ok:!1,error:String(p)}}}function mu(e,t=100){if(!xe)return{ok:!1,error:"No database open"};const r=[],l=xe.prepare(pt.LIST_ENTITY_FACETS);try{for(l.bind([e||null,t]);l.step();){const p=l.get([]);r.push({entityType:p[0],normalizedValue:p[1],count:p[2]})}return{ok:!0,data:r}}catch(p){return{ok:!1,error:String(p)}}finally{l.finalize()}}function gu(e,t){if(!xe)return{ok:!1,error:"No database open"};const r=[],l=xe.prepare(pt.GET_PAGE_LIST);try{for(l.bind([e,t]);l.step();){const p=l.get([]);r.push({gid:p[0],docId:p[1],pageNo:p[2],title:p[3],tags:p[4],updatedTs:p[5]})}return{ok:!0,data:r}}catch(p){return{ok:!1,error:String(p)}}finally{l.finalize()}}function bu(e){if(!xe)return{ok:!1,error:"No database open"};const t=xe.prepare(pt.GET_PAGE_BLOB);try{return t.bind([e]),t.step()?{ok:!0,data:t.get([])[0]}:{ok:!1,error:`Blob not found: ${e}`}}catch(r){return{ok:!1,error:String(r)}}finally{t.finalize()}}async function yu(e){if(!xe)return{ok:!1,error:"No database open"};const t=xe.prepare(pt.VERIFY_PAGE);try{if(t.bind([e]),t.step()){const r=t.get([]),l=r[1],p=r[6],y=await Xc(p||"");return{ok:!0,data:{gid:r[0],contentSha:l,expectedSha:y,verified:l===y,signer:r[2],signature:r[3],epoch:r[4],merkleRoot:r[5]}}}return{ok:!1,error:`No receipt found for GID: ${e}`}}catch(r){return{ok:!1,error:String(r)}}finally{t.finalize()}}function vu(){if(!xe)return{ok:!1,error:"No database open"};const e=[],t=xe.prepare(pt.GET_CHECKPOINTS);try{for(;t.step();){const r=t.get([]);e.push({epoch:r[0],merkleRoot:r[1],pagesCount:r[2],createdTs:r[4],anchors:eu(r[3])})}return{ok:!0,data:e}}catch(r){return{ok:!1,error:String(r)}}finally{t.finalize()}}function wu(e,t,r=3,l=50){if(!xe)return{ok:!1,error:"No database open"};try{const p=[],y=[],q={},C=new Set,Y=[];for(Y.push({gid:e,distance:0}),q[e]=0;Y.length>0&&p.length<l;){const{gid:ae,distance:pe}=Y.shift();if(C.has(ae)||pe>r)continue;C.add(ae);const ee=xe.prepare("SELECT gid, page_no, title FROM meta_index WHERE gid = ?");try{if(ee.bind([ae]),ee.step()){const he=ee.get([]);p.push({gid:he[0],pageNo:he[1],title:he[2]})}}finally{ee.finalize()}if(pe<r){const he=xe.prepare(`
          SELECT
            n2.gid,
            e.pred,
            e.weight
          FROM node_index n1
          JOIN edges e ON e.fromNode = n1.node_id
          JOIN node_index n2 ON n2.node_id = e.toNode
          WHERE n1.gid = ?
          ${t?"AND e.pred = ?":""}
          ORDER BY e.weight DESC
        `);try{for(t?he.bind([ae,t]):he.bind([ae]);he.step();){const Ie=he.get([]),Re=Ie[0],He=Ie[1],at=Ie[2];y.push({fromGid:ae,toGid:Re,predicate:He,weight:at}),!C.has(Re)&&!(Re in q)&&(q[Re]=pe+1,Y.push({gid:Re,distance:pe+1}))}}finally{he.finalize()}}}return{ok:!0,data:{nodes:p,edges:y,distances:q}}}catch(p){return{ok:!1,error:String(p)}}}async function qu(e){try{switch(e.type){case"OPEN_FROM_FILE":return await Qr(e.file);case"OPEN_FROM_OPFS":return await cu(e.path);case"OPEN_DEMO":return await lu();case"SAVE_TO_OPFS":return await uu(e.path);case"REMOVE_FROM_OPFS":return await fu(e.path);case"LIST_OPFS_FILES":return await _u();case"CLOSE":return du();case"FTS_SEARCH":return Hr(e.query,e.limit||20);case"VECTOR_SEARCH":return pu(e.queryVector,e.limit||20);case"HYBRID_SEARCH":return hu(e.query,e.limit||20,e.weights);case"LIST_ENTITIES":return mu(e.entityType,e.limit||100);case"GET_PAGE_LIST":return gu(e.limit||100,e.offset||0);case"GET_PAGE_BLOB":return bu(e.name);case"VERIFY_PAGE":return await yu(e.gid);case"GET_CHECKPOINTS":return vu();case"GRAPH_HOPS":return wu(e.seedGid,e.predicate,e.maxHops||3,e.limit||50);default:return{ok:!1,error:`Unknown request type: ${e.type}`}}}catch(t){return{ok:!1,error:String(t)}}}self.onmessage=async e=>{const{id:t,request:r}=e.data;rt||await au();const l=await qu(r),p={id:t,response:l};self.postMessage(p)};self.postMessage({type:"READY"});console.log("[Worker] SQLite worker loaded and ready");
