var mr=Object.defineProperty;var $t=H=>{throw TypeError(H)};var gr=(H,j,u)=>j in H?mr(H,j,{enumerable:!0,configurable:!0,writable:!0,value:u}):H[j]=u;var Qe=(H,j,u)=>gr(H,typeof j!="symbol"?j+"":j,u),At=(H,j,u)=>j.has(H)||$t("Cannot "+u);var ne=(H,j,u)=>(At(H,j,"read from private field"),u?u.call(H):j.get(H)),ze=(H,j,u)=>j.has(H)?$t("Cannot add the same private member more than once"):j instanceof WeakSet?j.add(H):j.set(H,u),He=(H,j,u,se)=>(At(H,j,"write to private field"),se?se.call(H,u):j.set(H,u),u),ht=(H,j,u)=>(At(H,j,"access private method"),u);async function It(H={}){var Vt;var j,u=H,se=typeof window=="object",fe=typeof WorkerGlobalScope<"u";typeof process=="object"&&((Vt=process.versions)!=null&&Vt.node)&&process.type!="renderer",function(e){const n=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{console.warn("globalThis.sqlite3InitModuleState is missing")}});delete globalThis.sqlite3InitModuleState,n.debugModule("pre-js.js sqlite3InitModuleState =",n),e.locateFile=(function(s,t){return new URL(s,import.meta.url).href}).bind(n),e.instantiateWasm=(function(t,c){const i=this,r=e.locateFile(i.wasmFilename,typeof xe>"u"?"":xe);i.debugModule("instantiateWasm() uri =",r,"sIMS =",this);const _=()=>fetch(r,{credentials:"same-origin"}),T=X=>{X.imports=t,i.instantiateWasm=X,c(X.instance,X.module)};return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(_(),t).then(T):async()=>_().then(X=>X.arrayBuffer()).then(X=>WebAssembly.instantiate(X,t)).then(T))()}).bind(n)}(u);var ge="./this.program",be=import.meta.url,xe="";function We(e){return u.locateFile?u.locateFile(e,xe):xe+e}var Ce,ke;if(se||fe){try{xe=new URL(".",be).href}catch{}fe&&(ke=e=>{var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),Ce=async e=>{var n=await fetch(e,{credentials:"same-origin"});if(n.ok)return n.arrayBuffer();throw new Error(n.status+" : "+n.url)}}var ie=console.log.bind(console),Se=console.error.bind(console),Le,$e=!1,Ve,Ze,Ke,Ue,et,at,we,Ne,je,kt=!1;function Tt(){var e=Ke.buffer;Ue=new Int8Array(e),at=new Int16Array(e),et=new Uint8Array(e),we=new Int32Array(e),Ne=new Uint32Array(e),je=new BigInt64Array(e),new BigUint64Array(e)}function Yt(){if(u.wasmMemory)Ke=u.wasmMemory;else{var e=u.INITIAL_MEMORY||8388608;Ke=new WebAssembly.Memory({initial:e/65536,maximum:32768})}Tt()}function Xt(){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)_n(u.preRun.shift());Ot(Pt)}function Zt(){kt=!0,!u.noFSInit&&!a.initialized&&a.init(),ot.__wasm_call_ctors(),a.ignorePermissions=!1}function en(){if(u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;)un(u.postRun.shift());Ot(Ft)}var tt=0,ct=null;function xt(e){var n;tt++,(n=u.monitorRunDependencies)==null||n.call(u,tt)}function gt(e){var s;if(tt--,(s=u.monitorRunDependencies)==null||s.call(u,tt),tt==0&&ct){var n=ct;ct=null,n()}}function tn(e){var s;(s=u.onAbort)==null||s.call(u,e),e="Aborted("+e+")",Se(e),$e=!0,e+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(e);throw Ze==null||Ze(n),n}var yt;function nn(){return u.locateFile?We("sqlite3.wasm"):new URL("/assets/sqlite3-1f8bVu-G.wasm",import.meta.url).href}function rn(e){if(e==yt&&Le)return new Uint8Array(Le);if(ke)return ke(e);throw"both async and sync fetching of the wasm failed"}async function sn(e){if(!Le)try{var n=await Ce(e);return new Uint8Array(n)}catch{}return rn(e)}async function on(e,n){try{var s=await sn(e),t=await WebAssembly.instantiate(s,n);return t}catch(c){Se(`failed to asynchronously prepare wasm: ${c}`),tn(c)}}async function ln(e,n,s){if(!e)try{var t=fetch(n,{credentials:"same-origin"}),c=await WebAssembly.instantiateStreaming(t,s);return c}catch(i){Se(`wasm streaming compile failed: ${i}`),Se("falling back to ArrayBuffer instantiation")}return on(n,s)}function an(){return{env:Ht,wasi_snapshot_preview1:Ht}}async function cn(){function e(i,r){return ot=i.exports,_r(ot),gt(),ot}xt();function n(i){return e(i.instance)}var s=an();if(u.instantiateWasm)return new Promise((i,r)=>{u.instantiateWasm(s,(_,T)=>{i(e(_))})});yt??(yt=nn());var t=await ln(Le,yt,s),c=n(t);return c}var Ot=e=>{for(;e.length>0;)e.shift()(u)},Ft=[],un=e=>Ft.push(e),Pt=[],_n=e=>Pt.push(e),Te={isAbs:e=>e.charAt(0)==="/",splitPath:e=>{var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return n.exec(e).slice(1)},normalizeArray:(e,n)=>{for(var s=0,t=e.length-1;t>=0;t--){var c=e[t];c==="."?e.splice(t,1):c===".."?(e.splice(t,1),s++):s&&(e.splice(t,1),s--)}if(n)for(;s;s--)e.unshift("..");return e},normalize:e=>{var n=Te.isAbs(e),s=e.slice(-1)==="/";return e=Te.normalizeArray(e.split("/").filter(t=>!!t),!n).join("/"),!e&&!n&&(e="."),e&&s&&(e+="/"),(n?"/":"")+e},dirname:e=>{var n=Te.splitPath(e),s=n[0],t=n[1];return!s&&!t?".":(t&&(t=t.slice(0,-1)),s+t)},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>Te.normalize(e.join("/")),join2:(e,n)=>Te.normalize(e+"/"+n)},fn=()=>e=>crypto.getRandomValues(e),Lt=e=>{(Lt=fn())(e)},it={resolve:(...e)=>{for(var n="",s=!1,t=e.length-1;t>=-1&&!s;t--){var c=t>=0?e[t]:a.cwd();if(typeof c!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!c)return"";n=c+"/"+n,s=Te.isAbs(c)}return n=Te.normalizeArray(n.split("/").filter(i=>!!i),!s).join("/"),(s?"/":"")+n||"."},relative:(e,n)=>{e=it.resolve(e).slice(1),n=it.resolve(n).slice(1);function s(P){for(var X=0;X<P.length&&P[X]==="";X++);for(var B=P.length-1;B>=0&&P[B]==="";B--);return X>B?[]:P.slice(X,B-X+1)}for(var t=s(e.split("/")),c=s(n.split("/")),i=Math.min(t.length,c.length),r=i,_=0;_<i;_++)if(t[_]!==c[_]){r=_;break}for(var T=[],_=r;_<t.length;_++)T.push("..");return T=T.concat(c.slice(r)),T.join("/")}},Ct=new TextDecoder,Nt=(e,n,s,t)=>{for(var c=n+s;e[n]&&!(n>=c);)++n;return n},ut=(e,n=0,s,t)=>{var c=Nt(e,n,s);return Ct.decode(e.buffer?e.subarray(n,c):new Uint8Array(e.slice(n,c)))},bt=[],dt=e=>{for(var n=0,s=0;s<e.length;++s){var t=e.charCodeAt(s);t<=127?n++:t<=2047?n+=2:t>=55296&&t<=57343?(n+=4,++s):n+=3}return n},Rt=(e,n,s,t)=>{if(!(t>0))return 0;for(var c=s,i=s+t-1,r=0;r<e.length;++r){var _=e.codePointAt(r);if(_<=127){if(s>=i)break;n[s++]=_}else if(_<=2047){if(s+1>=i)break;n[s++]=192|_>>6,n[s++]=128|_&63}else if(_<=65535){if(s+2>=i)break;n[s++]=224|_>>12,n[s++]=128|_>>6&63,n[s++]=128|_&63}else{if(s+3>=i)break;n[s++]=240|_>>18,n[s++]=128|_>>12&63,n[s++]=128|_>>6&63,n[s++]=128|_&63,r++}}return n[s]=0,s-c},qt=(e,n,s)=>{var t=dt(e)+1,c=new Array(t),i=Rt(e,c,0,c.length);return c.length=i,c},dn=()=>{if(!bt.length){var e=null;if(typeof window<"u"&&typeof window.prompt=="function"&&(e=window.prompt("Input: "),e!==null&&(e+=`
`)),!e)return null;bt=qt(e)}return bt.shift()},nt={ttys:[],init(){},shutdown(){},register(e,n){nt.ttys[e]={input:[],output:[],ops:n},a.registerDevice(e,nt.stream_ops)},stream_ops:{open(e){var n=nt.ttys[e.node.rdev];if(!n)throw new a.ErrnoError(43);e.tty=n,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,n,s,t,c){if(!e.tty||!e.tty.ops.get_char)throw new a.ErrnoError(60);for(var i=0,r=0;r<t;r++){var _;try{_=e.tty.ops.get_char(e.tty)}catch{throw new a.ErrnoError(29)}if(_===void 0&&i===0)throw new a.ErrnoError(6);if(_==null)break;i++,n[s+r]=_}return i&&(e.node.atime=Date.now()),i},write(e,n,s,t,c){if(!e.tty||!e.tty.ops.put_char)throw new a.ErrnoError(60);try{for(var i=0;i<t;i++)e.tty.ops.put_char(e.tty,n[s+i])}catch{throw new a.ErrnoError(29)}return t&&(e.node.mtime=e.node.ctime=Date.now()),i}},default_tty_ops:{get_char(e){return dn()},put_char(e,n){n===null||n===10?(ie(ut(e.output)),e.output=[]):n!=0&&e.output.push(n)},fsync(e){var n;((n=e.output)==null?void 0:n.length)>0&&(ie(ut(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,n,s){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,n){n===null||n===10?(Se(ut(e.output)),e.output=[]):n!=0&&e.output.push(n)},fsync(e){var n;((n=e.output)==null?void 0:n.length)>0&&(Se(ut(e.output)),e.output=[])}}},pn=(e,n)=>et.fill(0,e,e+n),Dt=(e,n)=>Math.ceil(e/n)*n,Mt=e=>{e=Dt(e,65536);var n=Qt(65536,e);return n&&pn(n,e),n},me={ops_table:null,mount(e){return me.createNode(null,"/",16895,0)},createNode(e,n,s,t){if(a.isBlkdev(s)||a.isFIFO(s))throw new a.ErrnoError(63);me.ops_table||(me.ops_table={dir:{node:{getattr:me.node_ops.getattr,setattr:me.node_ops.setattr,lookup:me.node_ops.lookup,mknod:me.node_ops.mknod,rename:me.node_ops.rename,unlink:me.node_ops.unlink,rmdir:me.node_ops.rmdir,readdir:me.node_ops.readdir,symlink:me.node_ops.symlink},stream:{llseek:me.stream_ops.llseek}},file:{node:{getattr:me.node_ops.getattr,setattr:me.node_ops.setattr},stream:{llseek:me.stream_ops.llseek,read:me.stream_ops.read,write:me.stream_ops.write,mmap:me.stream_ops.mmap,msync:me.stream_ops.msync}},link:{node:{getattr:me.node_ops.getattr,setattr:me.node_ops.setattr,readlink:me.node_ops.readlink},stream:{}},chrdev:{node:{getattr:me.node_ops.getattr,setattr:me.node_ops.setattr},stream:a.chrdev_stream_ops}});var c=a.createNode(e,n,s,t);return a.isDir(c.mode)?(c.node_ops=me.ops_table.dir.node,c.stream_ops=me.ops_table.dir.stream,c.contents={}):a.isFile(c.mode)?(c.node_ops=me.ops_table.file.node,c.stream_ops=me.ops_table.file.stream,c.usedBytes=0,c.contents=null):a.isLink(c.mode)?(c.node_ops=me.ops_table.link.node,c.stream_ops=me.ops_table.link.stream):a.isChrdev(c.mode)&&(c.node_ops=me.ops_table.chrdev.node,c.stream_ops=me.ops_table.chrdev.stream),c.atime=c.mtime=c.ctime=Date.now(),e&&(e.contents[n]=c,e.atime=e.mtime=e.ctime=c.atime),c},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,n){var s=e.contents?e.contents.length:0;if(!(s>=n)){var t=1024*1024;n=Math.max(n,s*(s<t?2:1.125)>>>0),s!=0&&(n=Math.max(n,256));var c=e.contents;e.contents=new Uint8Array(n),e.usedBytes>0&&e.contents.set(c.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,n){if(e.usedBytes!=n)if(n==0)e.contents=null,e.usedBytes=0;else{var s=e.contents;e.contents=new Uint8Array(n),s&&e.contents.set(s.subarray(0,Math.min(n,e.usedBytes))),e.usedBytes=n}},node_ops:{getattr(e){var n={};return n.dev=a.isChrdev(e.mode)?e.id:1,n.ino=e.id,n.mode=e.mode,n.nlink=1,n.uid=0,n.gid=0,n.rdev=e.rdev,a.isDir(e.mode)?n.size=4096:a.isFile(e.mode)?n.size=e.usedBytes:a.isLink(e.mode)?n.size=e.link.length:n.size=0,n.atime=new Date(e.atime),n.mtime=new Date(e.mtime),n.ctime=new Date(e.ctime),n.blksize=4096,n.blocks=Math.ceil(n.size/n.blksize),n},setattr(e,n){for(const s of["mode","atime","mtime","ctime"])n[s]!=null&&(e[s]=n[s]);n.size!==void 0&&me.resizeFileStorage(e,n.size)},lookup(e,n){throw me.doesNotExistError||(me.doesNotExistError=new a.ErrnoError(44),me.doesNotExistError.stack="<generic error, no stack>"),me.doesNotExistError},mknod(e,n,s,t){return me.createNode(e,n,s,t)},rename(e,n,s){var t;try{t=a.lookupNode(n,s)}catch{}if(t){if(a.isDir(e.mode))for(var c in t.contents)throw new a.ErrnoError(55);a.hashRemoveNode(t)}delete e.parent.contents[e.name],n.contents[s]=e,e.name=s,n.ctime=n.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,n){delete e.contents[n],e.ctime=e.mtime=Date.now()},rmdir(e,n){var s=a.lookupNode(e,n);for(var t in s.contents)throw new a.ErrnoError(55);delete e.contents[n],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.contents)]},symlink(e,n,s){var t=me.createNode(e,n,41471,0);return t.link=s,t},readlink(e){if(!a.isLink(e.mode))throw new a.ErrnoError(28);return e.link}},stream_ops:{read(e,n,s,t,c){var i=e.node.contents;if(c>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-c,t);if(r>8&&i.subarray)n.set(i.subarray(c,c+r),s);else for(var _=0;_<r;_++)n[s+_]=i[c+_];return r},write(e,n,s,t,c,i){if(n.buffer===Ue.buffer&&(i=!1),!t)return 0;var r=e.node;if(r.mtime=r.ctime=Date.now(),n.subarray&&(!r.contents||r.contents.subarray)){if(i)return r.contents=n.subarray(s,s+t),r.usedBytes=t,t;if(r.usedBytes===0&&c===0)return r.contents=n.slice(s,s+t),r.usedBytes=t,t;if(c+t<=r.usedBytes)return r.contents.set(n.subarray(s,s+t),c),t}if(me.expandFileStorage(r,c+t),r.contents.subarray&&n.subarray)r.contents.set(n.subarray(s,s+t),c);else for(var _=0;_<t;_++)r.contents[c+_]=n[s+_];return r.usedBytes=Math.max(r.usedBytes,c+t),t},llseek(e,n,s){var t=n;if(s===1?t+=e.position:s===2&&a.isFile(e.node.mode)&&(t+=e.node.usedBytes),t<0)throw new a.ErrnoError(28);return t},mmap(e,n,s,t,c){if(!a.isFile(e.node.mode))throw new a.ErrnoError(43);var i,r,_=e.node.contents;if(!(c&2)&&_&&_.buffer===Ue.buffer)r=!1,i=_.byteOffset;else{if(r=!0,i=Mt(n),!i)throw new a.ErrnoError(48);_&&((s>0||s+n<_.length)&&(_.subarray?_=_.subarray(s,s+n):_=Array.prototype.slice.call(_,s,s+n)),Ue.set(_,i))}return{ptr:i,allocated:r}},msync(e,n,s,t,c){return me.stream_ops.write(e,n,0,t,s,!1),0}}},hn=async e=>{var n=await Ce(e);return new Uint8Array(n)},mn=(...e)=>a.createDataFile(...e),jt=[],gn=(e,n,s,t)=>{typeof Browser<"u"&&Browser.init();var c=!1;return jt.forEach(i=>{c||i.canHandle(n)&&(i.handle(e,n,s,t),c=!0)}),c},yn=(e,n,s,t,c,i,r,_,T,P)=>{var X=n?it.resolve(Te.join2(e,n)):e;function B(I){function O(x){P==null||P(),_||mn(e,n,x,t,c,T),i==null||i(),gt()}gn(I,X,O,()=>{r==null||r(),gt()})||O(I)}xt(),typeof s=="string"?hn(s).then(B,r):B(s)},bn=e=>{var n={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},s=n[e];if(typeof s>"u")throw new Error(`Unknown file open mode: ${e}`);return s},vt=(e,n)=>{var s=0;return e&&(s|=365),n&&(s|=146),s},a={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{constructor(e){Qe(this,"name","ErrnoError");this.errno=e}},FSStream:class{constructor(){Qe(this,"shared",{})}get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{constructor(e,n,s,t){Qe(this,"node_ops",{});Qe(this,"stream_ops",{});Qe(this,"readMode",365);Qe(this,"writeMode",146);Qe(this,"mounted",null);e||(e=this),this.parent=e,this.mount=e.mount,this.id=a.nextInode++,this.name=n,this.mode=s,this.rdev=t,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return a.isDir(this.mode)}get isDevice(){return a.isChrdev(this.mode)}},lookupPath(e,n={}){if(!e)throw new a.ErrnoError(44);n.follow_mount??(n.follow_mount=!0),Te.isAbs(e)||(e=a.cwd()+"/"+e);e:for(var s=0;s<40;s++){for(var t=e.split("/").filter(P=>!!P),c=a.root,i="/",r=0;r<t.length;r++){var _=r===t.length-1;if(_&&n.parent)break;if(t[r]!=="."){if(t[r]===".."){if(i=Te.dirname(i),a.isRoot(c)){e=i+"/"+t.slice(r+1).join("/"),s--;continue e}else c=c.parent;continue}i=Te.join2(i,t[r]);try{c=a.lookupNode(c,t[r])}catch(P){if((P==null?void 0:P.errno)===44&&_&&n.noent_okay)return{path:i};throw P}if(a.isMountpoint(c)&&(!_||n.follow_mount)&&(c=c.mounted.root),a.isLink(c.mode)&&(!_||n.follow)){if(!c.node_ops.readlink)throw new a.ErrnoError(52);var T=c.node_ops.readlink(c);Te.isAbs(T)||(T=Te.dirname(i)+"/"+T),e=T+"/"+t.slice(r+1).join("/");continue e}}}return{path:i,node:c}}throw new a.ErrnoError(32)},getPath(e){for(var n;;){if(a.isRoot(e)){var s=e.mount.mountpoint;return n?s[s.length-1]!=="/"?`${s}/${n}`:s+n:s}n=n?`${e.name}/${n}`:e.name,e=e.parent}},hashName(e,n){for(var s=0,t=0;t<n.length;t++)s=(s<<5)-s+n.charCodeAt(t)|0;return(e+s>>>0)%a.nameTable.length},hashAddNode(e){var n=a.hashName(e.parent.id,e.name);e.name_next=a.nameTable[n],a.nameTable[n]=e},hashRemoveNode(e){var n=a.hashName(e.parent.id,e.name);if(a.nameTable[n]===e)a.nameTable[n]=e.name_next;else for(var s=a.nameTable[n];s;){if(s.name_next===e){s.name_next=e.name_next;break}s=s.name_next}},lookupNode(e,n){var s=a.mayLookup(e);if(s)throw new a.ErrnoError(s);for(var t=a.hashName(e.id,n),c=a.nameTable[t];c;c=c.name_next){var i=c.name;if(c.parent.id===e.id&&i===n)return c}return a.lookup(e,n)},createNode(e,n,s,t){var c=new a.FSNode(e,n,s,t);return a.hashAddNode(c),c},destroyNode(e){a.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var n=["r","w","rw"][e&3];return e&512&&(n+="w"),n},nodePermissions(e,n){return a.ignorePermissions?0:n.includes("r")&&!(e.mode&292)||n.includes("w")&&!(e.mode&146)||n.includes("x")&&!(e.mode&73)?2:0},mayLookup(e){if(!a.isDir(e.mode))return 54;var n=a.nodePermissions(e,"x");return n||(e.node_ops.lookup?0:2)},mayCreate(e,n){if(!a.isDir(e.mode))return 54;try{var s=a.lookupNode(e,n);return 20}catch{}return a.nodePermissions(e,"wx")},mayDelete(e,n,s){var t;try{t=a.lookupNode(e,n)}catch(i){return i.errno}var c=a.nodePermissions(e,"wx");if(c)return c;if(s){if(!a.isDir(t.mode))return 54;if(a.isRoot(t)||a.getPath(t)===a.cwd())return 10}else if(a.isDir(t.mode))return 31;return 0},mayOpen(e,n){return e?a.isLink(e.mode)?32:a.isDir(e.mode)&&(a.flagsToPermissionString(n)!=="r"||n&576)?31:a.nodePermissions(e,a.flagsToPermissionString(n)):44},checkOpExists(e,n){if(!e)throw new a.ErrnoError(n);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=a.MAX_OPEN_FDS;e++)if(!a.streams[e])return e;throw new a.ErrnoError(33)},getStreamChecked(e){var n=a.getStream(e);if(!n)throw new a.ErrnoError(8);return n},getStream:e=>a.streams[e],createStream(e,n=-1){return e=Object.assign(new a.FSStream,e),n==-1&&(n=a.nextfd()),e.fd=n,a.streams[n]=e,e},closeStream(e){a.streams[e]=null},dupStream(e,n=-1){var t,c;var s=a.createStream(e,n);return(c=(t=s.stream_ops)==null?void 0:t.dup)==null||c.call(t,s),s},doSetAttr(e,n,s){var t=e==null?void 0:e.stream_ops.setattr,c=t?e:n;t??(t=n.node_ops.setattr),a.checkOpExists(t,63),t(c,s)},chrdev_stream_ops:{open(e){var s,t;var n=a.getDevice(e.node.rdev);e.stream_ops=n.stream_ops,(t=(s=e.stream_ops).open)==null||t.call(s,e)},llseek(){throw new a.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,n)=>e<<8|n,registerDevice(e,n){a.devices[e]={stream_ops:n}},getDevice:e=>a.devices[e],getMounts(e){for(var n=[],s=[e];s.length;){var t=s.pop();n.push(t),s.push(...t.mounts)}return n},syncfs(e,n){typeof e=="function"&&(n=e,e=!1),a.syncFSRequests++,a.syncFSRequests>1&&Se(`warning: ${a.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var s=a.getMounts(a.root.mount),t=0;function c(r){return a.syncFSRequests--,n(r)}function i(r){if(r)return i.errored?void 0:(i.errored=!0,c(r));++t>=s.length&&c(null)}s.forEach(r=>{if(!r.type.syncfs)return i(null);r.type.syncfs(r,e,i)})},mount(e,n,s){var t=s==="/",c=!s,i;if(t&&a.root)throw new a.ErrnoError(10);if(!t&&!c){var r=a.lookupPath(s,{follow_mount:!1});if(s=r.path,i=r.node,a.isMountpoint(i))throw new a.ErrnoError(10);if(!a.isDir(i.mode))throw new a.ErrnoError(54)}var _={type:e,opts:n,mountpoint:s,mounts:[]},T=e.mount(_);return T.mount=_,_.root=T,t?a.root=T:i&&(i.mounted=_,i.mount&&i.mount.mounts.push(_)),T},unmount(e){var n=a.lookupPath(e,{follow_mount:!1});if(!a.isMountpoint(n.node))throw new a.ErrnoError(28);var s=n.node,t=s.mounted,c=a.getMounts(t);Object.keys(a.nameTable).forEach(r=>{for(var _=a.nameTable[r];_;){var T=_.name_next;c.includes(_.mount)&&a.destroyNode(_),_=T}}),s.mounted=null;var i=s.mount.mounts.indexOf(t);s.mount.mounts.splice(i,1)},lookup(e,n){return e.node_ops.lookup(e,n)},mknod(e,n,s){var t=a.lookupPath(e,{parent:!0}),c=t.node,i=Te.basename(e);if(!i)throw new a.ErrnoError(28);if(i==="."||i==="..")throw new a.ErrnoError(20);var r=a.mayCreate(c,i);if(r)throw new a.ErrnoError(r);if(!c.node_ops.mknod)throw new a.ErrnoError(63);return c.node_ops.mknod(c,i,n,s)},statfs(e){return a.statfsNode(a.lookupPath(e,{follow:!0}).node)},statfsStream(e){return a.statfsNode(e.node)},statfsNode(e){var n={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:a.nextInode,ffree:a.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&Object.assign(n,e.node_ops.statfs(e.mount.opts.root)),n},create(e,n=438){return n&=4095,n|=32768,a.mknod(e,n,0)},mkdir(e,n=511){return n&=1023,n|=16384,a.mknod(e,n,0)},mkdirTree(e,n){var s=e.split("/"),t="";for(var c of s)if(c){(t||Te.isAbs(e))&&(t+="/"),t+=c;try{a.mkdir(t,n)}catch(i){if(i.errno!=20)throw i}}},mkdev(e,n,s){return typeof s>"u"&&(s=n,n=438),n|=8192,a.mknod(e,n,s)},symlink(e,n){if(!it.resolve(e))throw new a.ErrnoError(44);var s=a.lookupPath(n,{parent:!0}),t=s.node;if(!t)throw new a.ErrnoError(44);var c=Te.basename(n),i=a.mayCreate(t,c);if(i)throw new a.ErrnoError(i);if(!t.node_ops.symlink)throw new a.ErrnoError(63);return t.node_ops.symlink(t,c,e)},rename(e,n){var s=Te.dirname(e),t=Te.dirname(n),c=Te.basename(e),i=Te.basename(n),r,_,T;if(r=a.lookupPath(e,{parent:!0}),_=r.node,r=a.lookupPath(n,{parent:!0}),T=r.node,!_||!T)throw new a.ErrnoError(44);if(_.mount!==T.mount)throw new a.ErrnoError(75);var P=a.lookupNode(_,c),X=it.relative(e,t);if(X.charAt(0)!==".")throw new a.ErrnoError(28);if(X=it.relative(n,s),X.charAt(0)!==".")throw new a.ErrnoError(55);var B;try{B=a.lookupNode(T,i)}catch{}if(P!==B){var I=a.isDir(P.mode),O=a.mayDelete(_,c,I);if(O)throw new a.ErrnoError(O);if(O=B?a.mayDelete(T,i,I):a.mayCreate(T,i),O)throw new a.ErrnoError(O);if(!_.node_ops.rename)throw new a.ErrnoError(63);if(a.isMountpoint(P)||B&&a.isMountpoint(B))throw new a.ErrnoError(10);if(T!==_&&(O=a.nodePermissions(_,"w"),O))throw new a.ErrnoError(O);a.hashRemoveNode(P);try{_.node_ops.rename(P,T,i),P.parent=T}catch(x){throw x}finally{a.hashAddNode(P)}}},rmdir(e){var n=a.lookupPath(e,{parent:!0}),s=n.node,t=Te.basename(e),c=a.lookupNode(s,t),i=a.mayDelete(s,t,!0);if(i)throw new a.ErrnoError(i);if(!s.node_ops.rmdir)throw new a.ErrnoError(63);if(a.isMountpoint(c))throw new a.ErrnoError(10);s.node_ops.rmdir(s,t),a.destroyNode(c)},readdir(e){var n=a.lookupPath(e,{follow:!0}),s=n.node,t=a.checkOpExists(s.node_ops.readdir,54);return t(s)},unlink(e){var n=a.lookupPath(e,{parent:!0}),s=n.node;if(!s)throw new a.ErrnoError(44);var t=Te.basename(e),c=a.lookupNode(s,t),i=a.mayDelete(s,t,!1);if(i)throw new a.ErrnoError(i);if(!s.node_ops.unlink)throw new a.ErrnoError(63);if(a.isMountpoint(c))throw new a.ErrnoError(10);s.node_ops.unlink(s,t),a.destroyNode(c)},readlink(e){var n=a.lookupPath(e),s=n.node;if(!s)throw new a.ErrnoError(44);if(!s.node_ops.readlink)throw new a.ErrnoError(28);return s.node_ops.readlink(s)},stat(e,n){var s=a.lookupPath(e,{follow:!n}),t=s.node,c=a.checkOpExists(t.node_ops.getattr,63);return c(t)},fstat(e){var n=a.getStreamChecked(e),s=n.node,t=n.stream_ops.getattr,c=t?n:s;return t??(t=s.node_ops.getattr),a.checkOpExists(t,63),t(c)},lstat(e){return a.stat(e,!0)},doChmod(e,n,s,t){a.doSetAttr(e,n,{mode:s&4095|n.mode&-4096,ctime:Date.now(),dontFollow:t})},chmod(e,n,s){var t;if(typeof e=="string"){var c=a.lookupPath(e,{follow:!s});t=c.node}else t=e;a.doChmod(null,t,n,s)},lchmod(e,n){a.chmod(e,n,!0)},fchmod(e,n){var s=a.getStreamChecked(e);a.doChmod(s,s.node,n,!1)},doChown(e,n,s){a.doSetAttr(e,n,{timestamp:Date.now(),dontFollow:s})},chown(e,n,s,t){var c;if(typeof e=="string"){var i=a.lookupPath(e,{follow:!t});c=i.node}else c=e;a.doChown(null,c,t)},lchown(e,n,s){a.chown(e,n,s,!0)},fchown(e,n,s){var t=a.getStreamChecked(e);a.doChown(t,t.node,!1)},doTruncate(e,n,s){if(a.isDir(n.mode))throw new a.ErrnoError(31);if(!a.isFile(n.mode))throw new a.ErrnoError(28);var t=a.nodePermissions(n,"w");if(t)throw new a.ErrnoError(t);a.doSetAttr(e,n,{size:s,timestamp:Date.now()})},truncate(e,n){if(n<0)throw new a.ErrnoError(28);var s;if(typeof e=="string"){var t=a.lookupPath(e,{follow:!0});s=t.node}else s=e;a.doTruncate(null,s,n)},ftruncate(e,n){var s=a.getStreamChecked(e);if(n<0||!(s.flags&2097155))throw new a.ErrnoError(28);a.doTruncate(s,s.node,n)},utime(e,n,s){var t=a.lookupPath(e,{follow:!0}),c=t.node,i=a.checkOpExists(c.node_ops.setattr,63);i(c,{atime:n,mtime:s})},open(e,n,s=438){if(e==="")throw new a.ErrnoError(44);n=typeof n=="string"?bn(n):n,n&64?s=s&4095|32768:s=0;var t,c;if(typeof e=="object")t=e;else{c=e.endsWith("/");var i=a.lookupPath(e,{follow:!(n&131072),noent_okay:!0});t=i.node,e=i.path}var r=!1;if(n&64)if(t){if(n&128)throw new a.ErrnoError(20)}else{if(c)throw new a.ErrnoError(31);t=a.mknod(e,s|511,0),r=!0}if(!t)throw new a.ErrnoError(44);if(a.isChrdev(t.mode)&&(n&=-513),n&65536&&!a.isDir(t.mode))throw new a.ErrnoError(54);if(!r){var _=a.mayOpen(t,n);if(_)throw new a.ErrnoError(_)}n&512&&!r&&a.truncate(t,0),n&=-131713;var T=a.createStream({node:t,path:a.getPath(t),flags:n,seekable:!0,position:0,stream_ops:t.stream_ops,ungotten:[],error:!1});return T.stream_ops.open&&T.stream_ops.open(T),r&&a.chmod(t,s&511),u.logReadFiles&&!(n&1)&&(e in a.readFiles||(a.readFiles[e]=1)),T},close(e){if(a.isClosed(e))throw new a.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(n){throw n}finally{a.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,n,s){if(a.isClosed(e))throw new a.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new a.ErrnoError(70);if(s!=0&&s!=1&&s!=2)throw new a.ErrnoError(28);return e.position=e.stream_ops.llseek(e,n,s),e.ungotten=[],e.position},read(e,n,s,t,c){if(t<0||c<0)throw new a.ErrnoError(28);if(a.isClosed(e))throw new a.ErrnoError(8);if((e.flags&2097155)===1)throw new a.ErrnoError(8);if(a.isDir(e.node.mode))throw new a.ErrnoError(31);if(!e.stream_ops.read)throw new a.ErrnoError(28);var i=typeof c<"u";if(!i)c=e.position;else if(!e.seekable)throw new a.ErrnoError(70);var r=e.stream_ops.read(e,n,s,t,c);return i||(e.position+=r),r},write(e,n,s,t,c,i){if(t<0||c<0)throw new a.ErrnoError(28);if(a.isClosed(e))throw new a.ErrnoError(8);if(!(e.flags&2097155))throw new a.ErrnoError(8);if(a.isDir(e.node.mode))throw new a.ErrnoError(31);if(!e.stream_ops.write)throw new a.ErrnoError(28);e.seekable&&e.flags&1024&&a.llseek(e,0,2);var r=typeof c<"u";if(!r)c=e.position;else if(!e.seekable)throw new a.ErrnoError(70);var _=e.stream_ops.write(e,n,s,t,c,i);return r||(e.position+=_),_},mmap(e,n,s,t,c){if(t&2&&!(c&2)&&(e.flags&2097155)!==2)throw new a.ErrnoError(2);if((e.flags&2097155)===1)throw new a.ErrnoError(2);if(!e.stream_ops.mmap)throw new a.ErrnoError(43);if(!n)throw new a.ErrnoError(28);return e.stream_ops.mmap(e,n,s,t,c)},msync(e,n,s,t,c){return e.stream_ops.msync?e.stream_ops.msync(e,n,s,t,c):0},ioctl(e,n,s){if(!e.stream_ops.ioctl)throw new a.ErrnoError(59);return e.stream_ops.ioctl(e,n,s)},readFile(e,n={}){if(n.flags=n.flags||0,n.encoding=n.encoding||"binary",n.encoding!=="utf8"&&n.encoding!=="binary")throw new Error(`Invalid encoding type "${n.encoding}"`);var s=a.open(e,n.flags),t=a.stat(e),c=t.size,i=new Uint8Array(c);return a.read(s,i,0,c,0),n.encoding==="utf8"&&(i=ut(i)),a.close(s),i},writeFile(e,n,s={}){s.flags=s.flags||577;var t=a.open(e,s.flags,s.mode);if(typeof n=="string"&&(n=new Uint8Array(qt(n))),ArrayBuffer.isView(n))a.write(t,n,0,n.byteLength,void 0,s.canOwn);else throw new Error("Unsupported data type");a.close(t)},cwd:()=>a.currentPath,chdir(e){var n=a.lookupPath(e,{follow:!0});if(n.node===null)throw new a.ErrnoError(44);if(!a.isDir(n.node.mode))throw new a.ErrnoError(54);var s=a.nodePermissions(n.node,"x");if(s)throw new a.ErrnoError(s);a.currentPath=n.path},createDefaultDirectories(){a.mkdir("/tmp"),a.mkdir("/home"),a.mkdir("/home/web_user")},createDefaultDevices(){a.mkdir("/dev"),a.registerDevice(a.makedev(1,3),{read:()=>0,write:(t,c,i,r,_)=>r,llseek:()=>0}),a.mkdev("/dev/null",a.makedev(1,3)),nt.register(a.makedev(5,0),nt.default_tty_ops),nt.register(a.makedev(6,0),nt.default_tty1_ops),a.mkdev("/dev/tty",a.makedev(5,0)),a.mkdev("/dev/tty1",a.makedev(6,0));var e=new Uint8Array(1024),n=0,s=()=>(n===0&&(Lt(e),n=e.byteLength),e[--n]);a.createDevice("/dev","random",s),a.createDevice("/dev","urandom",s),a.mkdir("/dev/shm"),a.mkdir("/dev/shm/tmp")},createSpecialDirectories(){a.mkdir("/proc");var e=a.mkdir("/proc/self");a.mkdir("/proc/self/fd"),a.mount({mount(){var n=a.createNode(e,"fd",16895,73);return n.stream_ops={llseek:me.stream_ops.llseek},n.node_ops={lookup(s,t){var c=+t,i=a.getStreamChecked(c),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path},id:c+1};return r.parent=r,r},readdir(){return Array.from(a.streams.entries()).filter(([s,t])=>t).map(([s,t])=>s.toString())}},n}},{},"/proc/self/fd")},createStandardStreams(e,n,s){e?a.createDevice("/dev","stdin",e):a.symlink("/dev/tty","/dev/stdin"),n?a.createDevice("/dev","stdout",null,n):a.symlink("/dev/tty","/dev/stdout"),s?a.createDevice("/dev","stderr",null,s):a.symlink("/dev/tty1","/dev/stderr"),a.open("/dev/stdin",0),a.open("/dev/stdout",1),a.open("/dev/stderr",1)},staticInit(){a.nameTable=new Array(4096),a.mount(me,{},"/"),a.createDefaultDirectories(),a.createDefaultDevices(),a.createSpecialDirectories(),a.filesystems={MEMFS:me}},init(e,n,s){a.initialized=!0,e??(e=u.stdin),n??(n=u.stdout),s??(s=u.stderr),a.createStandardStreams(e,n,s)},quit(){a.initialized=!1;for(var e of a.streams)e&&a.close(e)},findObject(e,n){var s=a.analyzePath(e,n);return s.exists?s.object:null},analyzePath(e,n){try{var s=a.lookupPath(e,{follow:!n});e=s.path}catch{}var t={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var s=a.lookupPath(e,{parent:!0});t.parentExists=!0,t.parentPath=s.path,t.parentObject=s.node,t.name=Te.basename(e),s=a.lookupPath(e,{follow:!n}),t.exists=!0,t.path=s.path,t.object=s.node,t.name=s.node.name,t.isRoot=s.path==="/"}catch(c){t.error=c.errno}return t},createPath(e,n,s,t){e=typeof e=="string"?e:a.getPath(e);for(var c=n.split("/").reverse();c.length;){var i=c.pop();if(i){var r=Te.join2(e,i);try{a.mkdir(r)}catch(_){if(_.errno!=20)throw _}e=r}}return r},createFile(e,n,s,t,c){var i=Te.join2(typeof e=="string"?e:a.getPath(e),n),r=vt(t,c);return a.create(i,r)},createDataFile(e,n,s,t,c,i){var r=n;e&&(e=typeof e=="string"?e:a.getPath(e),r=n?Te.join2(e,n):e);var _=vt(t,c),T=a.create(r,_);if(s){if(typeof s=="string"){for(var P=new Array(s.length),X=0,B=s.length;X<B;++X)P[X]=s.charCodeAt(X);s=P}a.chmod(T,_|146);var I=a.open(T,577);a.write(I,s,0,s.length,0,i),a.close(I),a.chmod(T,_)}},createDevice(e,n,s,t){var _;var c=Te.join2(typeof e=="string"?e:a.getPath(e),n),i=vt(!!s,!!t);(_=a.createDevice).major??(_.major=64);var r=a.makedev(a.createDevice.major++,0);return a.registerDevice(r,{open(T){T.seekable=!1},close(T){var P;(P=t==null?void 0:t.buffer)!=null&&P.length&&t(10)},read(T,P,X,B,I){for(var O=0,x=0;x<B;x++){var L;try{L=s()}catch{throw new a.ErrnoError(29)}if(L===void 0&&O===0)throw new a.ErrnoError(6);if(L==null)break;O++,P[X+x]=L}return O&&(T.node.atime=Date.now()),O},write(T,P,X,B,I){for(var O=0;O<B;O++)try{t(P[X+O])}catch{throw new a.ErrnoError(29)}return B&&(T.node.mtime=T.node.ctime=Date.now()),O}}),a.mkdev(c,i,r)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{e.contents=ke(e.url),e.usedBytes=e.contents.length}catch{throw new a.ErrnoError(29)}},createLazyFile(e,n,s,t,c){class i{constructor(){Qe(this,"lengthKnown",!1);Qe(this,"chunks",[])}get(O){if(!(O>this.length-1||O<0)){var x=O%this.chunkSize,L=O/this.chunkSize|0;return this.getter(L)[x]}}setDataGetter(O){this.getter=O}cacheLength(){var O=new XMLHttpRequest;if(O.open("HEAD",s,!1),O.send(null),!(O.status>=200&&O.status<300||O.status===304))throw new Error("Couldn't load "+s+". Status: "+O.status);var x=Number(O.getResponseHeader("Content-length")),L,Y=(L=O.getResponseHeader("Accept-Ranges"))&&L==="bytes",W=(L=O.getResponseHeader("Content-Encoding"))&&L==="gzip",g=1024*1024;Y||(g=x);var q=(F,E)=>{if(F>E)throw new Error("invalid range ("+F+", "+E+") or no bytes requested!");if(E>x-1)throw new Error("only "+x+" bytes available! programmer error!");var A=new XMLHttpRequest;if(A.open("GET",s,!1),x!==g&&A.setRequestHeader("Range","bytes="+F+"-"+E),A.responseType="arraybuffer",A.overrideMimeType&&A.overrideMimeType("text/plain; charset=x-user-defined"),A.send(null),!(A.status>=200&&A.status<300||A.status===304))throw new Error("Couldn't load "+s+". Status: "+A.status);return A.response!==void 0?new Uint8Array(A.response||[]):qt(A.responseText||"")},w=this;w.setDataGetter(F=>{var E=F*g,A=(F+1)*g-1;if(A=Math.min(A,x-1),typeof w.chunks[F]>"u"&&(w.chunks[F]=q(E,A)),typeof w.chunks[F]>"u")throw new Error("doXHR failed!");return w.chunks[F]}),(W||!x)&&(g=x=1,x=this.getter(0).length,g=x,ie("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=x,this._chunkSize=g,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!fe)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var r=new i,_={isDevice:!1,contents:r}}else var _={isDevice:!1,url:s};var T=a.createFile(e,n,_,t,c);_.contents?T.contents=_.contents:_.url&&(T.contents=null,T.url=_.url),Object.defineProperties(T,{usedBytes:{get:function(){return this.contents.length}}});var P={},X=Object.keys(T.stream_ops);X.forEach(I=>{var O=T.stream_ops[I];P[I]=(...x)=>(a.forceLoadFile(T),O(...x))});function B(I,O,x,L,Y){var W=I.node.contents;if(Y>=W.length)return 0;var g=Math.min(W.length-Y,L);if(W.slice)for(var q=0;q<g;q++)O[x+q]=W[Y+q];else for(var q=0;q<g;q++)O[x+q]=W.get(Y+q);return g}return P.read=(I,O,x,L,Y)=>(a.forceLoadFile(T),B(I,O,x,L,Y)),P.mmap=(I,O,x,L,Y)=>{a.forceLoadFile(T);var W=Mt(O);if(!W)throw new a.ErrnoError(48);return B(I,Ue,W,O,x),{ptr:W,allocated:!0}},T.stream_ops=P,T}},qn=(e,n,s)=>{if(!e)return"";var t=Nt(et,e,n);return Ct.decode(et.subarray(e,t))},qe={DEFAULT_POLLMASK:5,calculateAt(e,n,s){if(Te.isAbs(n))return n;var t;if(e===-100)t=a.cwd();else{var c=qe.getStreamFromFD(e);t=c.path}if(n.length==0){if(!s)throw new a.ErrnoError(44);return t}return t+"/"+n},writeStat(e,n){we[e>>2]=n.dev,we[e+4>>2]=n.mode,Ne[e+8>>2]=n.nlink,we[e+12>>2]=n.uid,we[e+16>>2]=n.gid,we[e+20>>2]=n.rdev,je[e+24>>3]=BigInt(n.size),we[e+32>>2]=4096,we[e+36>>2]=n.blocks;var s=n.atime.getTime(),t=n.mtime.getTime(),c=n.ctime.getTime();return je[e+40>>3]=BigInt(Math.floor(s/1e3)),Ne[e+48>>2]=s%1e3*1e3*1e3,je[e+56>>3]=BigInt(Math.floor(t/1e3)),Ne[e+64>>2]=t%1e3*1e3*1e3,je[e+72>>3]=BigInt(Math.floor(c/1e3)),Ne[e+80>>2]=c%1e3*1e3*1e3,je[e+88>>3]=BigInt(n.ino),0},writeStatFs(e,n){we[e+4>>2]=n.bsize,we[e+60>>2]=n.bsize,je[e+8>>3]=BigInt(n.blocks),je[e+16>>3]=BigInt(n.bfree),je[e+24>>3]=BigInt(n.bavail),je[e+32>>3]=BigInt(n.files),je[e+40>>3]=BigInt(n.ffree),we[e+48>>2]=n.fsid,we[e+64>>2]=n.flags,we[e+56>>2]=n.namelen},doMsync(e,n,s,t,c){if(!a.isFile(n.node.mode))throw new a.ErrnoError(43);if(t&2)return 0;var i=et.slice(e,e+s);a.msync(n,i,c,s,t)},getStreamFromFD(e){var n=a.getStreamChecked(e);return n},varargs:void 0,getStr(e){var n=qn(e);return n}};function vn(e,n){try{return e=qe.getStr(e),a.chmod(e,n),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function wn(e,n,s,t){try{if(n=qe.getStr(n),n=qe.calculateAt(e,n),s&-8)return-28;var c=a.lookupPath(n,{follow:!0}),i=c.node;if(!i)return-44;var r="";return s&4&&(r+="r"),s&2&&(r+="w"),s&1&&(r+="x"),r&&a.nodePermissions(i,r)?-2:0}catch(_){if(typeof a>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function Sn(e,n){try{return a.fchmod(e,n),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function En(e,n,s){try{return a.fchown(e,n,s),0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}var pt=()=>{var e=we[+qe.varargs>>2];return qe.varargs+=4,e},st=pt;function An(e,n,s){qe.varargs=s;try{var t=qe.getStreamFromFD(e);switch(n){case 0:{var c=pt();if(c<0)return-28;for(;a.streams[c];)c++;var i;return i=a.dupStream(t,c),i.fd}case 1:case 2:return 0;case 3:return t.flags;case 4:{var c=pt();return t.flags|=c,0}case 12:{var c=st(),r=0;return at[c+r>>1]=2,0}case 13:case 14:return 0}return-28}catch(_){if(typeof a>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function In(e,n){try{return qe.writeStat(n,a.fstat(e))}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var kn=9007199254740992,Tn=-9007199254740992,_t=e=>e<Tn||e>kn?NaN:Number(e);function xn(e,n){n=_t(n);try{return isNaN(n)?-61:(a.ftruncate(e,n),0)}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var rt=(e,n,s)=>Rt(e,et,n,s);function On(e,n){try{if(n===0)return-28;var s=a.cwd(),t=dt(s)+1;return n<t?-68:(rt(s,e,n),t)}catch(c){if(typeof a>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Fn(e,n,s){qe.varargs=s;try{var t=qe.getStreamFromFD(e);switch(n){case 21509:return t.tty?0:-59;case 21505:{if(!t.tty)return-59;if(t.tty.ops.ioctl_tcgets){var c=t.tty.ops.ioctl_tcgets(t),i=st();we[i>>2]=c.c_iflag||0,we[i+4>>2]=c.c_oflag||0,we[i+8>>2]=c.c_cflag||0,we[i+12>>2]=c.c_lflag||0;for(var r=0;r<32;r++)Ue[i+r+17]=c.c_cc[r]||0;return 0}return 0}case 21510:case 21511:case 21512:return t.tty?0:-59;case 21506:case 21507:case 21508:{if(!t.tty)return-59;if(t.tty.ops.ioctl_tcsets){for(var i=st(),_=we[i>>2],T=we[i+4>>2],P=we[i+8>>2],X=we[i+12>>2],B=[],r=0;r<32;r++)B.push(Ue[i+r+17]);return t.tty.ops.ioctl_tcsets(t.tty,n,{c_iflag:_,c_oflag:T,c_cflag:P,c_lflag:X,c_cc:B})}return 0}case 21519:{if(!t.tty)return-59;var i=st();return we[i>>2]=0,0}case 21520:return t.tty?-28:-59;case 21537:case 21531:{var i=st();return a.ioctl(t,n,i)}case 21523:{if(!t.tty)return-59;if(t.tty.ops.ioctl_tiocgwinsz){var I=t.tty.ops.ioctl_tiocgwinsz(t.tty),i=st();at[i>>1]=I[0],at[i+2>>1]=I[1]}return 0}case 21524:return t.tty?0:-59;case 21515:return t.tty?0:-59;default:return-28}}catch(O){if(typeof a>"u"||O.name!=="ErrnoError")throw O;return-O.errno}}function Pn(e,n){try{return e=qe.getStr(e),qe.writeStat(n,a.lstat(e))}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Ln(e,n,s){try{return n=qe.getStr(n),n=qe.calculateAt(e,n),a.mkdir(n,s,0),0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function Cn(e,n,s,t){try{n=qe.getStr(n);var c=t&256,i=t&4096;return t=t&-6401,n=qe.calculateAt(e,n,i),qe.writeStat(s,c?a.lstat(n):a.stat(n))}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Nn(e,n,s,t){qe.varargs=t;try{n=qe.getStr(n),n=qe.calculateAt(e,n);var c=t?pt():0;return a.open(n,s,c).fd}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function Rn(e,n,s,t){try{if(n=qe.getStr(n),n=qe.calculateAt(e,n),t<=0)return-28;var c=a.readlink(n),i=Math.min(t,dt(c)),r=Ue[s+i];return rt(c,s,t+1),Ue[s+i]=r,i}catch(_){if(typeof a>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}function Dn(e){try{return e=qe.getStr(e),a.rmdir(e),0}catch(n){if(typeof a>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function Mn(e,n){try{return e=qe.getStr(e),qe.writeStat(n,a.stat(e))}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function jn(e,n,s){try{if(n=qe.getStr(n),n=qe.calculateAt(e,n),!s)a.unlink(n);else if(s===512)a.rmdir(n);else return-28;return 0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}var Bt=e=>Ne[e>>2]+we[e+4>>2]*4294967296;function Bn(e,n,s,t){try{n=qe.getStr(n),n=qe.calculateAt(e,n,!0);var c=Date.now(),i,r;if(!s)i=c,r=c;else{var _=Bt(s),T=we[s+8>>2];T==1073741823?i=c:T==1073741822?i=null:i=_*1e3+T/(1e3*1e3),s+=16,_=Bt(s),T=we[s+8>>2],T==1073741823?r=c:T==1073741822?r=null:r=_*1e3+T/(1e3*1e3)}return(r??i)!==null&&a.utime(n,i,r),0}catch(P){if(typeof a>"u"||P.name!=="ErrnoError")throw P;return-P.errno}}var zn=e=>e%4===0&&(e%100!==0||e%400===0),Wn=[0,31,60,91,121,152,182,213,244,274,305,335],Un=[0,31,59,90,120,151,181,212,243,273,304,334],Qn=e=>{var n=zn(e.getFullYear()),s=n?Wn:Un,t=s[e.getMonth()]+e.getDate()-1;return t};function Hn(e,n){e=_t(e);var s=new Date(e*1e3);we[n>>2]=s.getSeconds(),we[n+4>>2]=s.getMinutes(),we[n+8>>2]=s.getHours(),we[n+12>>2]=s.getDate(),we[n+16>>2]=s.getMonth(),we[n+20>>2]=s.getFullYear()-1900,we[n+24>>2]=s.getDay();var t=Qn(s)|0;we[n+28>>2]=t,we[n+36>>2]=-(s.getTimezoneOffset()*60);var c=new Date(s.getFullYear(),0,1),i=new Date(s.getFullYear(),6,1).getTimezoneOffset(),r=c.getTimezoneOffset(),_=(i!=r&&s.getTimezoneOffset()==Math.min(r,i))|0;we[n+32>>2]=_}function Vn(e,n,s,t,c,i,r){c=_t(c);try{var _=qe.getStreamFromFD(t),T=a.mmap(_,e,c,n,s),P=T.ptr;return we[i>>2]=T.allocated,Ne[r>>2]=P,0}catch(X){if(typeof a>"u"||X.name!=="ErrnoError")throw X;return-X.errno}}function Gn(e,n,s,t,c,i){i=_t(i);try{var r=qe.getStreamFromFD(c);s&2&&qe.doMsync(e,r,n,t,i)}catch(_){if(typeof a>"u"||_.name!=="ErrnoError")throw _;return-_.errno}}var $n=(e,n,s,t)=>{var c=new Date().getFullYear(),i=new Date(c,0,1),r=new Date(c,6,1),_=i.getTimezoneOffset(),T=r.getTimezoneOffset(),P=Math.max(_,T);Ne[e>>2]=P*60,we[n>>2]=+(_!=T);var X=O=>{var x=O>=0?"-":"+",L=Math.abs(O),Y=String(Math.floor(L/60)).padStart(2,"0"),W=String(L%60).padStart(2,"0");return`UTC${x}${Y}${W}`},B=X(_),I=X(T);T<_?(rt(B,s,17),rt(I,t,17)):(rt(B,t,17),rt(I,s,17))},zt=()=>performance.now(),Wt=()=>Date.now(),Kn=e=>e>=0&&e<=3;function Jn(e,n,s){if(!Kn(e))return 28;var t;e===0?t=Wt():t=zt();var c=Math.round(t*1e3*1e3);return je[s>>3]=BigInt(c),0}var Ut=()=>2147483648,Yn=()=>Ut(),Xn=e=>{var n=Ke.buffer.byteLength,s=(e-n+65535)/65536|0;try{return Ke.grow(s),Tt(),1}catch{}},Zn=e=>{var n=et.length;e>>>=0;var s=Ut();if(e>s)return!1;for(var t=1;t<=4;t*=2){var c=n*(1+.2/t);c=Math.min(c,e+100663296);var i=Math.min(s,Dt(Math.max(e,c),65536)),r=Xn(i);if(r)return!0}return!1},wt={},er=()=>ge||"./this.program",ft=()=>{if(!ft.strings){var e=(typeof navigator=="object"&&navigator.language||"C").replace("-","_")+".UTF-8",n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:er()};for(var s in wt)wt[s]===void 0?delete n[s]:n[s]=wt[s];var t=[];for(var s in n)t.push(`${s}=${n[s]}`);ft.strings=t}return ft.strings},tr=(e,n)=>{var s=0,t=0;for(var c of ft()){var i=n+s;Ne[e+t>>2]=i,s+=rt(c,i,1/0)+1,t+=4}return 0},nr=(e,n)=>{var s=ft();Ne[e>>2]=s.length;var t=0;for(var c of s)t+=dt(c)+1;return Ne[n>>2]=t,0};function rr(e){try{var n=qe.getStreamFromFD(e);return a.close(n),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return s.errno}}function ir(e,n){try{var s=0,t=0,c=0,i=qe.getStreamFromFD(e),r=i.tty?2:a.isDir(i.mode)?3:a.isLink(i.mode)?7:4;return Ue[n]=r,at[n+2>>1]=c,je[n+8>>3]=BigInt(s),je[n+16>>3]=BigInt(t),0}catch(_){if(typeof a>"u"||_.name!=="ErrnoError")throw _;return _.errno}}var sr=(e,n,s,t)=>{for(var c=0,i=0;i<s;i++){var r=Ne[n>>2],_=Ne[n+4>>2];n+=8;var T=a.read(e,Ue,r,_,t);if(T<0)return-1;if(c+=T,T<_)break}return c};function or(e,n,s,t){try{var c=qe.getStreamFromFD(e),i=sr(c,n,s);return Ne[t>>2]=i,0}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return r.errno}}function lr(e,n,s,t){n=_t(n);try{if(isNaN(n))return 61;var c=qe.getStreamFromFD(e);return a.llseek(c,n,s),je[t>>3]=BigInt(c.position),c.getdents&&n===0&&s===0&&(c.getdents=null),0}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function ar(e){var s;try{var n=qe.getStreamFromFD(e);return(s=n.stream_ops)!=null&&s.fsync?n.stream_ops.fsync(n):0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return t.errno}}var cr=(e,n,s,t)=>{for(var c=0,i=0;i<s;i++){var r=Ne[n>>2],_=Ne[n+4>>2];n+=8;var T=a.write(e,Ue,r,_,t);if(T<0)return-1;if(c+=T,T<_)break}return c};function ur(e,n,s,t){try{var c=qe.getStreamFromFD(e),i=cr(c,n,s);return Ne[t>>2]=i,0}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return r.errno}}a.createPreloadedFile=yn,a.staticInit(),Yt(),u.noExitRuntime&&u.noExitRuntime,u.preloadPlugins&&(jt=u.preloadPlugins),u.print&&(ie=u.print),u.printErr&&(Se=u.printErr),u.wasmBinary&&(Le=u.wasmBinary),u.arguments&&u.arguments,u.thisProgram&&(ge=u.thisProgram),u.wasmMemory=Ke;var Qt;function _r(e){u._sqlite3_status64=e.sqlite3_status64,u._sqlite3_status=e.sqlite3_status,u._sqlite3_db_status64=e.sqlite3_db_status64,u._sqlite3_msize=e.sqlite3_msize,u._sqlite3_db_status=e.sqlite3_db_status,u._sqlite3_vfs_find=e.sqlite3_vfs_find,u._sqlite3_initialize=e.sqlite3_initialize,u._sqlite3_malloc=e.sqlite3_malloc,u._sqlite3_free=e.sqlite3_free,u._sqlite3_vfs_register=e.sqlite3_vfs_register,u._sqlite3_vfs_unregister=e.sqlite3_vfs_unregister,u._sqlite3_malloc64=e.sqlite3_malloc64,u._sqlite3_realloc=e.sqlite3_realloc,u._sqlite3_realloc64=e.sqlite3_realloc64,u._sqlite3_value_text=e.sqlite3_value_text,u._sqlite3_randomness=e.sqlite3_randomness,u._sqlite3_stricmp=e.sqlite3_stricmp,u._sqlite3_strnicmp=e.sqlite3_strnicmp,u._sqlite3_uri_parameter=e.sqlite3_uri_parameter,u._sqlite3_uri_boolean=e.sqlite3_uri_boolean,u._sqlite3_serialize=e.sqlite3_serialize,u._sqlite3_prepare_v2=e.sqlite3_prepare_v2,u._sqlite3_step=e.sqlite3_step,u._sqlite3_column_int64=e.sqlite3_column_int64,u._sqlite3_reset=e.sqlite3_reset,u._sqlite3_exec=e.sqlite3_exec,u._sqlite3_column_int=e.sqlite3_column_int,u._sqlite3_finalize=e.sqlite3_finalize,u._sqlite3_file_control=e.sqlite3_file_control,u._sqlite3_column_name=e.sqlite3_column_name,u._sqlite3_column_text=e.sqlite3_column_text,u._sqlite3_column_type=e.sqlite3_column_type,u._sqlite3_errmsg=e.sqlite3_errmsg,u._sqlite3_deserialize=e.sqlite3_deserialize,u._sqlite3_clear_bindings=e.sqlite3_clear_bindings,u._sqlite3_value_blob=e.sqlite3_value_blob,u._sqlite3_value_bytes=e.sqlite3_value_bytes,u._sqlite3_value_double=e.sqlite3_value_double,u._sqlite3_value_int=e.sqlite3_value_int,u._sqlite3_value_int64=e.sqlite3_value_int64,u._sqlite3_value_subtype=e.sqlite3_value_subtype,u._sqlite3_value_pointer=e.sqlite3_value_pointer,u._sqlite3_value_type=e.sqlite3_value_type,u._sqlite3_value_nochange=e.sqlite3_value_nochange,u._sqlite3_value_frombind=e.sqlite3_value_frombind,u._sqlite3_value_dup=e.sqlite3_value_dup,u._sqlite3_value_free=e.sqlite3_value_free,u._sqlite3_result_blob=e.sqlite3_result_blob,u._sqlite3_result_error_toobig=e.sqlite3_result_error_toobig,u._sqlite3_result_error_nomem=e.sqlite3_result_error_nomem,u._sqlite3_result_double=e.sqlite3_result_double,u._sqlite3_result_error=e.sqlite3_result_error,u._sqlite3_result_int=e.sqlite3_result_int,u._sqlite3_result_int64=e.sqlite3_result_int64,u._sqlite3_result_null=e.sqlite3_result_null,u._sqlite3_result_pointer=e.sqlite3_result_pointer,u._sqlite3_result_subtype=e.sqlite3_result_subtype,u._sqlite3_result_text=e.sqlite3_result_text,u._sqlite3_result_zeroblob=e.sqlite3_result_zeroblob,u._sqlite3_result_zeroblob64=e.sqlite3_result_zeroblob64,u._sqlite3_result_error_code=e.sqlite3_result_error_code,u._sqlite3_user_data=e.sqlite3_user_data,u._sqlite3_context_db_handle=e.sqlite3_context_db_handle,u._sqlite3_vtab_nochange=e.sqlite3_vtab_nochange,u._sqlite3_vtab_in_first=e.sqlite3_vtab_in_first,u._sqlite3_vtab_in_next=e.sqlite3_vtab_in_next,u._sqlite3_aggregate_context=e.sqlite3_aggregate_context,u._sqlite3_get_auxdata=e.sqlite3_get_auxdata,u._sqlite3_set_auxdata=e.sqlite3_set_auxdata,u._sqlite3_column_count=e.sqlite3_column_count,u._sqlite3_data_count=e.sqlite3_data_count,u._sqlite3_column_blob=e.sqlite3_column_blob,u._sqlite3_column_bytes=e.sqlite3_column_bytes,u._sqlite3_column_double=e.sqlite3_column_double,u._sqlite3_column_value=e.sqlite3_column_value,u._sqlite3_column_decltype=e.sqlite3_column_decltype,u._sqlite3_column_database_name=e.sqlite3_column_database_name,u._sqlite3_column_table_name=e.sqlite3_column_table_name,u._sqlite3_column_origin_name=e.sqlite3_column_origin_name,u._sqlite3_bind_blob=e.sqlite3_bind_blob,u._sqlite3_bind_double=e.sqlite3_bind_double,u._sqlite3_bind_int=e.sqlite3_bind_int,u._sqlite3_bind_int64=e.sqlite3_bind_int64,u._sqlite3_bind_null=e.sqlite3_bind_null,u._sqlite3_bind_pointer=e.sqlite3_bind_pointer,u._sqlite3_bind_text=e.sqlite3_bind_text,u._sqlite3_bind_parameter_count=e.sqlite3_bind_parameter_count,u._sqlite3_bind_parameter_name=e.sqlite3_bind_parameter_name,u._sqlite3_bind_parameter_index=e.sqlite3_bind_parameter_index,u._sqlite3_db_handle=e.sqlite3_db_handle,u._sqlite3_stmt_readonly=e.sqlite3_stmt_readonly,u._sqlite3_stmt_isexplain=e.sqlite3_stmt_isexplain,u._sqlite3_stmt_explain=e.sqlite3_stmt_explain,u._sqlite3_stmt_busy=e.sqlite3_stmt_busy,u._sqlite3_stmt_status=e.sqlite3_stmt_status,u._sqlite3_sql=e.sqlite3_sql,u._sqlite3_expanded_sql=e.sqlite3_expanded_sql,u._sqlite3_preupdate_old=e.sqlite3_preupdate_old,u._sqlite3_preupdate_count=e.sqlite3_preupdate_count,u._sqlite3_preupdate_depth=e.sqlite3_preupdate_depth,u._sqlite3_preupdate_blobwrite=e.sqlite3_preupdate_blobwrite,u._sqlite3_preupdate_new=e.sqlite3_preupdate_new,u._sqlite3_value_numeric_type=e.sqlite3_value_numeric_type,u._sqlite3_set_authorizer=e.sqlite3_set_authorizer,u._sqlite3_strglob=e.sqlite3_strglob,u._sqlite3_strlike=e.sqlite3_strlike,u._sqlite3_auto_extension=e.sqlite3_auto_extension,u._sqlite3_cancel_auto_extension=e.sqlite3_cancel_auto_extension,u._sqlite3_reset_auto_extension=e.sqlite3_reset_auto_extension,u._sqlite3_prepare_v3=e.sqlite3_prepare_v3,u._sqlite3_create_module=e.sqlite3_create_module,u._sqlite3_create_module_v2=e.sqlite3_create_module_v2,u._sqlite3_drop_modules=e.sqlite3_drop_modules,u._sqlite3_declare_vtab=e.sqlite3_declare_vtab,u._sqlite3_vtab_on_conflict=e.sqlite3_vtab_on_conflict,u._sqlite3_vtab_collation=e.sqlite3_vtab_collation,u._sqlite3_vtab_in=e.sqlite3_vtab_in,u._sqlite3_vtab_rhs_value=e.sqlite3_vtab_rhs_value,u._sqlite3_vtab_distinct=e.sqlite3_vtab_distinct,u._sqlite3_keyword_name=e.sqlite3_keyword_name,u._sqlite3_keyword_count=e.sqlite3_keyword_count,u._sqlite3_keyword_check=e.sqlite3_keyword_check,u._sqlite3_complete=e.sqlite3_complete,u._sqlite3_libversion=e.sqlite3_libversion,u._sqlite3_libversion_number=e.sqlite3_libversion_number,u._sqlite3_shutdown=e.sqlite3_shutdown,u._sqlite3_last_insert_rowid=e.sqlite3_last_insert_rowid,u._sqlite3_set_last_insert_rowid=e.sqlite3_set_last_insert_rowid,u._sqlite3_changes64=e.sqlite3_changes64,u._sqlite3_changes=e.sqlite3_changes,u._sqlite3_total_changes64=e.sqlite3_total_changes64,u._sqlite3_total_changes=e.sqlite3_total_changes,u._sqlite3_txn_state=e.sqlite3_txn_state,u._sqlite3_close_v2=e.sqlite3_close_v2,u._sqlite3_busy_handler=e.sqlite3_busy_handler,u._sqlite3_progress_handler=e.sqlite3_progress_handler,u._sqlite3_busy_timeout=e.sqlite3_busy_timeout,u._sqlite3_interrupt=e.sqlite3_interrupt,u._sqlite3_is_interrupted=e.sqlite3_is_interrupted,u._sqlite3_create_function=e.sqlite3_create_function,u._sqlite3_create_function_v2=e.sqlite3_create_function_v2,u._sqlite3_create_window_function=e.sqlite3_create_window_function,u._sqlite3_overload_function=e.sqlite3_overload_function,u._sqlite3_trace_v2=e.sqlite3_trace_v2,u._sqlite3_commit_hook=e.sqlite3_commit_hook,u._sqlite3_update_hook=e.sqlite3_update_hook,u._sqlite3_rollback_hook=e.sqlite3_rollback_hook,u._sqlite3_preupdate_hook=e.sqlite3_preupdate_hook,u._sqlite3_set_errmsg=e.sqlite3_set_errmsg,u._sqlite3_error_offset=e.sqlite3_error_offset,u._sqlite3_errcode=e.sqlite3_errcode,u._sqlite3_extended_errcode=e.sqlite3_extended_errcode,u._sqlite3_errstr=e.sqlite3_errstr,u._sqlite3_limit=e.sqlite3_limit,u._sqlite3_open=e.sqlite3_open,u._sqlite3_open_v2=e.sqlite3_open_v2,u._sqlite3_create_collation=e.sqlite3_create_collation,u._sqlite3_create_collation_v2=e.sqlite3_create_collation_v2,u._sqlite3_collation_needed=e.sqlite3_collation_needed,u._sqlite3_get_autocommit=e.sqlite3_get_autocommit,u._sqlite3_table_column_metadata=e.sqlite3_table_column_metadata,u._sqlite3_extended_result_codes=e.sqlite3_extended_result_codes,u._sqlite3_uri_key=e.sqlite3_uri_key,u._sqlite3_uri_int64=e.sqlite3_uri_int64,u._sqlite3_db_name=e.sqlite3_db_name,u._sqlite3_db_filename=e.sqlite3_db_filename,u._sqlite3_db_readonly=e.sqlite3_db_readonly,u._sqlite3_compileoption_used=e.sqlite3_compileoption_used,u._sqlite3_compileoption_get=e.sqlite3_compileoption_get,u._sqlite3session_diff=e.sqlite3session_diff,u._sqlite3session_attach=e.sqlite3session_attach,u._sqlite3session_create=e.sqlite3session_create,u._sqlite3session_delete=e.sqlite3session_delete,u._sqlite3session_table_filter=e.sqlite3session_table_filter,u._sqlite3session_changeset=e.sqlite3session_changeset,u._sqlite3session_changeset_strm=e.sqlite3session_changeset_strm,u._sqlite3session_patchset_strm=e.sqlite3session_patchset_strm,u._sqlite3session_patchset=e.sqlite3session_patchset,u._sqlite3session_enable=e.sqlite3session_enable,u._sqlite3session_indirect=e.sqlite3session_indirect,u._sqlite3session_isempty=e.sqlite3session_isempty,u._sqlite3session_memory_used=e.sqlite3session_memory_used,u._sqlite3session_object_config=e.sqlite3session_object_config,u._sqlite3session_changeset_size=e.sqlite3session_changeset_size,u._sqlite3changeset_start=e.sqlite3changeset_start,u._sqlite3changeset_start_v2=e.sqlite3changeset_start_v2,u._sqlite3changeset_start_strm=e.sqlite3changeset_start_strm,u._sqlite3changeset_start_v2_strm=e.sqlite3changeset_start_v2_strm,u._sqlite3changeset_next=e.sqlite3changeset_next,u._sqlite3changeset_op=e.sqlite3changeset_op,u._sqlite3changeset_pk=e.sqlite3changeset_pk,u._sqlite3changeset_old=e.sqlite3changeset_old,u._sqlite3changeset_new=e.sqlite3changeset_new,u._sqlite3changeset_conflict=e.sqlite3changeset_conflict,u._sqlite3changeset_fk_conflicts=e.sqlite3changeset_fk_conflicts,u._sqlite3changeset_finalize=e.sqlite3changeset_finalize,u._sqlite3changeset_invert=e.sqlite3changeset_invert,u._sqlite3changeset_invert_strm=e.sqlite3changeset_invert_strm,u._sqlite3changeset_apply_v2=e.sqlite3changeset_apply_v2,u._sqlite3changeset_apply_v3=e.sqlite3changeset_apply_v3,u._sqlite3changeset_apply=e.sqlite3changeset_apply,u._sqlite3changeset_apply_v3_strm=e.sqlite3changeset_apply_v3_strm,u._sqlite3changeset_apply_v2_strm=e.sqlite3changeset_apply_v2_strm,u._sqlite3changeset_apply_strm=e.sqlite3changeset_apply_strm,u._sqlite3changegroup_new=e.sqlite3changegroup_new,u._sqlite3changegroup_add=e.sqlite3changegroup_add,u._sqlite3changegroup_output=e.sqlite3changegroup_output,u._sqlite3changegroup_add_strm=e.sqlite3changegroup_add_strm,u._sqlite3changegroup_output_strm=e.sqlite3changegroup_output_strm,u._sqlite3changegroup_delete=e.sqlite3changegroup_delete,u._sqlite3changeset_concat=e.sqlite3changeset_concat,u._sqlite3changeset_concat_strm=e.sqlite3changeset_concat_strm,u._sqlite3session_config=e.sqlite3session_config,u._sqlite3_sourceid=e.sqlite3_sourceid,u._sqlite3__wasm_pstack_ptr=e.sqlite3__wasm_pstack_ptr,u._sqlite3__wasm_pstack_restore=e.sqlite3__wasm_pstack_restore,u._sqlite3__wasm_pstack_alloc=e.sqlite3__wasm_pstack_alloc,u._sqlite3__wasm_pstack_remaining=e.sqlite3__wasm_pstack_remaining,u._sqlite3__wasm_pstack_quota=e.sqlite3__wasm_pstack_quota,u._sqlite3__wasm_test_struct=e.sqlite3__wasm_test_struct,u._sqlite3__wasm_enum_json=e.sqlite3__wasm_enum_json,u._sqlite3__wasm_vfs_unlink=e.sqlite3__wasm_vfs_unlink,u._sqlite3__wasm_db_vfs=e.sqlite3__wasm_db_vfs,u._sqlite3__wasm_db_reset=e.sqlite3__wasm_db_reset,u._sqlite3__wasm_db_export_chunked=e.sqlite3__wasm_db_export_chunked,u._sqlite3__wasm_db_serialize=e.sqlite3__wasm_db_serialize,u._sqlite3__wasm_vfs_create_file=e.sqlite3__wasm_vfs_create_file,u._sqlite3__wasm_posix_create_file=e.sqlite3__wasm_posix_create_file,u._sqlite3__wasm_kvvfsMakeKeyOnPstack=e.sqlite3__wasm_kvvfsMakeKeyOnPstack,u._sqlite3__wasm_kvvfs_methods=e.sqlite3__wasm_kvvfs_methods,u._sqlite3__wasm_vtab_config=e.sqlite3__wasm_vtab_config,u._sqlite3__wasm_db_config_ip=e.sqlite3__wasm_db_config_ip,u._sqlite3__wasm_db_config_pii=e.sqlite3__wasm_db_config_pii,u._sqlite3__wasm_db_config_s=e.sqlite3__wasm_db_config_s,u._sqlite3__wasm_config_i=e.sqlite3__wasm_config_i,u._sqlite3__wasm_config_ii=e.sqlite3__wasm_config_ii,u._sqlite3__wasm_config_j=e.sqlite3__wasm_config_j,u._sqlite3__wasm_qfmt_token=e.sqlite3__wasm_qfmt_token,u._sqlite3__wasm_init_wasmfs=e.sqlite3__wasm_init_wasmfs,u._sqlite3__wasm_test_intptr=e.sqlite3__wasm_test_intptr,u._sqlite3__wasm_test_voidptr=e.sqlite3__wasm_test_voidptr,u._sqlite3__wasm_test_int64_max=e.sqlite3__wasm_test_int64_max,u._sqlite3__wasm_test_int64_min=e.sqlite3__wasm_test_int64_min,u._sqlite3__wasm_test_int64_times2=e.sqlite3__wasm_test_int64_times2,u._sqlite3__wasm_test_int64_minmax=e.sqlite3__wasm_test_int64_minmax,u._sqlite3__wasm_test_int64ptr=e.sqlite3__wasm_test_int64ptr,u._sqlite3__wasm_test_stack_overflow=e.sqlite3__wasm_test_stack_overflow,u._sqlite3__wasm_test_str_hello=e.sqlite3__wasm_test_str_hello,u._sqlite3__wasm_SQLTester_strglob=e.sqlite3__wasm_SQLTester_strglob,u._malloc=e.malloc,u._free=e.free,u._realloc=e.realloc,Qt=e.emscripten_builtin_memalign,e._emscripten_stack_restore,e._emscripten_stack_alloc,e.emscripten_stack_get_current}var Ht={__syscall_chmod:vn,__syscall_faccessat:wn,__syscall_fchmod:Sn,__syscall_fchown32:En,__syscall_fcntl64:An,__syscall_fstat64:In,__syscall_ftruncate64:xn,__syscall_getcwd:On,__syscall_ioctl:Fn,__syscall_lstat64:Pn,__syscall_mkdirat:Ln,__syscall_newfstatat:Cn,__syscall_openat:Nn,__syscall_readlinkat:Rn,__syscall_rmdir:Dn,__syscall_stat64:Mn,__syscall_unlinkat:jn,__syscall_utimensat:Bn,_localtime_js:Hn,_mmap_js:Vn,_munmap_js:Gn,_tzset_js:$n,clock_time_get:Jn,emscripten_date_now:Wt,emscripten_get_heap_max:Yn,emscripten_get_now:zt,emscripten_resize_heap:Zn,environ_get:tr,environ_sizes_get:nr,fd_close:rr,fd_fdstat_get:ir,fd_read:or,fd_seek:lr,fd_sync:ar,fd_write:ur,memory:Ke},ot=await cn();function St(){if(tt>0){ct=St;return}if(Xt(),tt>0){ct=St;return}function e(){var n;u.calledRun=!0,!$e&&(Zt(),Ve==null||Ve(u),(n=u.onRuntimeInitialized)==null||n.call(u),en())}u.setStatus?(u.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>u.setStatus(""),1),e()},1)):e()}function fr(){if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.shift()()}return fr(),St(),u.runSQLite3PostLoadInit=function(e,n,s){if(delete n.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function t(c=globalThis.sqlite3ApiConfig||t.defaultConfig){if(t.sqlite3)return(t.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),t.sqlite3;const i=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},c||{});Object.assign(i,{allocExportName:i.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:i.useStdAlloc?"free":"sqlite3_free",reallocExportName:i.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(f=>{typeof i[f]=="function"&&(i[f]=i[f]())}),delete globalThis.sqlite3ApiConfig,delete t.defaultConfig;const r=Object.create(null),_=Object.create(null),T=f=>r.sqlite3_js_rc_str&&r.sqlite3_js_rc_str(f)||"Unknown result code #"+f,P=f=>typeof f=="number"&&f===(f|0)&&f<=2147483647&&f>=-2147483648;class X extends Error{constructor(...p){let b;if(p.length)if(P(p[0]))if(b=p[0],p.length===1)super(T(p[0]));else{const D=T(b);typeof p[1]=="object"?super(D,p[1]):(p[0]=D+":",super(p.join(" ")))}else p.length===2&&typeof p[1]=="object"?super(...p):super(p.join(" "));this.resultCode=b||r.SQLITE_ERROR,this.name="SQLite3Error"}}X.toss=(...f)=>{throw new X(...f)};const B=X.toss;i.wasmfsOpfsDir&&!/^\/[^/]+$/.test(i.wasmfsOpfsDir)&&B("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const I=function f(p){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),p>=f._min&&p<=f._max},O=f=>f>=-0x7fffffffn-1n&&f<=0x7fffffffn,x=function f(p){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),p>=f._min&&p<=f._max},L=f=>f&&f.constructor&&P(f.constructor.BYTES_PER_ELEMENT)?f:!1,Y=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),W=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),g=f=>Y(f)||B("Value is not of a supported TypedArray type."),q=function(f){return W(f)?_.typedArrayToString(f instanceof ArrayBuffer?new Uint8Array(f):f,0,f.length):Array.isArray(f)?f.join(""):(_.isPtr(f)&&(f=_.cstrToJs(f)),f)};class w extends Error{constructor(...p){p.length===2&&typeof p[1]=="object"?super(...p):p.length?super(p.join(" ")):super("Allocation failed."),this.resultCode=r.SQLITE_NOMEM,this.name="WasmAllocError"}}w.toss=(...f)=>{throw new w(...f)},Object.assign(r,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,p,b,D,G,le,ae,h,o)=>{},sqlite3_create_function:(f,p,b,D,G,le,ae,h)=>{},sqlite3_create_window_function:(f,p,b,D,G,le,ae,h,o,l)=>{},sqlite3_prepare_v3:(f,p,b,D,G,le)=>{},sqlite3_prepare_v2:(f,p,b,D,G)=>{},sqlite3_exec:(f,p,b,D,G)=>{},sqlite3_randomness:(f,p)=>{}});const F={affirmBindableTypedArray:g,flexibleString:q,bigIntFits32:O,bigIntFits64:I,bigIntFitsDouble:x,isBindableTypedArray:Y,isInt32:P,isSQLableTypedArray:W,isTypedArray:L,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...f){throw new Error(f.join(" "))},toss3:B,typedArrayPart:_.typedArrayPart,affirmDbHeader:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const p="SQLite format 3";p.length>f.byteLength&&B("Input does not contain an SQLite3 database header.");for(let b=0;b<p.length;++b)p.charCodeAt(b)!==f[b]&&B("Input does not contain an SQLite3 database header.")},affirmIsDb:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const p=f.byteLength;(p<512||p%512!==0)&&B("Byte array size",p,"is invalid for an SQLite3 db."),F.affirmDbHeader(f)}};Object.assign(_,{pointerIR:i.wasmPtrIR,bigIntEnabled:!!i.bigIntEnabled,exports:i.exports||B("Missing API config.exports (WASM module exports)."),memory:i.memory||i.exports.memory||B("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),functionTable:i.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),_.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),g(f);const p=_.heapForSize(f.constructor),b=_.alloc(f.byteLength||1);return p.set(f.byteLength?f:[0],Number(b)),b};{const f=i.allocExportName,p=i.deallocExportName,b=i.reallocExportName;for(const D of[f,p,b])_.exports[D]instanceof Function||B("Missing required exports[",D,"] function.");_.alloc=function D(G){return D.impl(G)||w.toss("Failed to allocate",G," bytes.")},_.alloc.impl=_.exports[f],_.realloc=function D(G,le){const ae=D.impl(_.ptr.coerce(G),le);return le?ae||w.toss("Failed to reallocate",le," bytes."):_.ptr.null},_.realloc.impl=_.exports[b],_.dealloc=function D(G){D.impl(_.ptr.coerce(G))},_.dealloc.impl=_.exports[p]}_.compileOptionUsed=function f(p){if(arguments.length){if(Array.isArray(p)){const b=Object.create(null);return p.forEach(D=>{b[D]=r.sqlite3_compileoption_used(D)}),b}else if(typeof p=="object")return Object.keys(p).forEach(b=>{p[b]=r.sqlite3_compileoption_used(b)}),p}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(ae,h){const o=f._rx.exec(ae);h[0]=o?o[1]:ae,h[1]=o?f._rxInt.test(o[2])?+o[2]:o[2]:!0});const b=Object.create(null),D=[0,0];let G=0,le;for(;le=r.sqlite3_compileoption_get(G++);)f._opt(le,D),b[D[0]]=D[1];return f._result=b}return typeof p=="string"?!!r.sqlite3_compileoption_used(p):!1},_.pstack=Object.assign(Object.create(null),{restore:_.exports.sqlite3__wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=_.sizeofIR(f))&&w.toss("Invalid value for pstack.alloc(",arguments[0],")"),_.exports.sqlite3__wasm_pstack_alloc(f)||w.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,p){typeof p=="string"&&!(p=_.sizeofIR(p))&&w.toss("Invalid size value for allocChunks(",arguments[1],")");const b=_.pstack.alloc(f*p),D=[b];let G=1,le=p;for(;G<f;++G,le+=p)D.push(_.ptr.add(b,le));return D},allocPtr:(f=1,p=!0)=>f===1?_.pstack.alloc(p?8:_.ptr.size):_.pstack.allocChunks(f,p?8:_.ptr.size),call:function(f){const p=_.pstack.pointer;try{return f(C)}finally{_.pstack.restore(p)}}}),Object.defineProperties(_.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:_.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:_.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:_.exports.sqlite3__wasm_pstack_remaining}}),r.sqlite3_randomness=(...f)=>{if(f.length===1&&F.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const p=f[0];if(p.byteLength===0)return _.exports.sqlite3_randomness(0,_.ptr.null),p;const b=_.pstack.pointer;try{let D=p.byteLength,G=0;const le=_.exports.sqlite3_randomness,ae=_.heap8u(),h=D<512?D:512,o=_.pstack.alloc(h);do{const l=D>h?h:D;le(l,o),p.set(_.typedArrayPart(ae,o,_.ptr.add(o,l)),G),D-=l,G+=l}while(D>0)}catch(D){i.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",D)}finally{_.pstack.restore(b)}return p}_.exports.sqlite3_randomness(...f)};let E;if(r.sqlite3_wasmfs_opfs_dir=function(){if(E!==void 0)return E;const f=i.wasmfsOpfsDir;if(!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!_.exports.sqlite3__wasm_init_wasmfs)return E="";try{return f&&_.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],f)===0?E=f:E=""}catch{return E=""}},r.sqlite3_wasmfs_filename_is_persistent=function(f){const p=r.sqlite3_wasmfs_opfs_dir();return p&&f?f.startsWith(p+"/"):!1},r.sqlite3_js_db_uses_vfs=function(f,p,b=0){try{const D=r.sqlite3_vfs_find(p);return D?f?D===r.sqlite3_js_db_vfs(f,b)?D:!1:D===r.sqlite3_vfs_find(0)?D:!1:!1}catch{return!1}},r.sqlite3_js_vfs_list=function(){const f=[];let p=r.sqlite3_vfs_find(_.ptr.coerce(0));for(;p;){const b=new r.sqlite3_vfs(p);f.push(_.cstrToJs(b.$zName)),p=b.$pNext,b.dispose()}return f},r.sqlite3_js_db_export=function(f,p=0){f=_.xWrap.testConvertArg("sqlite3*",f),f||B("Invalid sqlite3* argument."),_.bigIntEnabled||B("BigInt support is not enabled.");const b=_.scopedAllocPush();let D;try{const G=_.scopedAlloc(8+_.ptr.size),le=_.ptr.add(G,8),ae=p?_.isPtr(p)?p:_.scopedAllocCString(""+p):_.ptr.null;let h=_.exports.sqlite3__wasm_db_serialize(f,ae,le,G,0);h&&B("Database serialization failed with code",C.capi.sqlite3_js_rc_str(h)),D=_.peekPtr(le);const o=_.peek(G,"i64");return h=o?_.heap8u().slice(Number(D),Number(D)+Number(o)):new Uint8Array,h}finally{D&&_.exports.sqlite3_free(D),_.scopedAllocPop(b)}},r.sqlite3_js_db_vfs=(f,p=0)=>F.sqlite3__wasm_db_vfs(f,p),r.sqlite3_js_aggregate_context=(f,p)=>r.sqlite3_aggregate_context(f,p)||(p?w.toss("Cannot allocate",p,"bytes for sqlite3_aggregate_context()"):0),r.sqlite3_js_posix_create_file=function(f,p,b){let D;p&&_.isPtr(p)?D=p:p instanceof ArrayBuffer||p instanceof Uint8Array?(D=_.allocFromTypedArray(p),(arguments.length<3||!F.isInt32(b)||b<0)&&(b=p.byteLength)):X.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!F.isInt32(b)||b<0)&&X.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const G=F.sqlite3__wasm_posix_create_file(f,D,b);G&&X.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(G))}finally{D&&D!==p&&_.dealloc(D)}},r.sqlite3_js_vfs_create_file=function(f,p,b,D){i.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let G;b?_.isPtr(b)?G=b:(b instanceof ArrayBuffer&&(b=new Uint8Array(b)),b instanceof Uint8Array?(G=_.allocFromTypedArray(b),(arguments.length<4||!F.isInt32(D)||D<0)&&(D=b.byteLength)):X.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):G=0,(!F.isInt32(D)||D<0)&&(G&&G!==b&&_.dealloc(G),X.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const le=F.sqlite3__wasm_vfs_create_file(f,p,G,D);le&&X.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(le))}finally{G&&G!==b&&_.dealloc(G)}},r.sqlite3_js_sql_to_string=f=>{if(typeof f=="string")return f;const p=q(v);return p===v?void 0:p},F.isUIThread()){const f=function(p){const b=Object.create(null);return b.prefix="kvvfs-"+p,b.stores=[],(p==="session"||p==="")&&b.stores.push(globalThis.sessionStorage),(p==="local"||p==="")&&b.stores.push(globalThis.localStorage),b};r.sqlite3_js_kvvfs_clear=function(p=""){let b=0;const D=f(p);return D.stores.forEach(G=>{const le=[];let ae;for(ae=0;ae<G.length;++ae){const h=G.key(ae);h.startsWith(D.prefix)&&le.push(h)}le.forEach(h=>G.removeItem(h)),b+=le.length}),b},r.sqlite3_js_kvvfs_size=function(p=""){let b=0;const D=f(p);return D.stores.forEach(G=>{let le;for(le=0;le<G.length;++le){const ae=G.key(le);ae.startsWith(D.prefix)&&(b+=ae.length,b+=G.getItem(ae).length)}}),b*2}}r.sqlite3_db_config=(function(f,p,...b){switch(p){case r.SQLITE_DBCONFIG_ENABLE_FKEY:case r.SQLITE_DBCONFIG_ENABLE_TRIGGER:case r.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case r.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case r.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case r.SQLITE_DBCONFIG_ENABLE_QPSG:case r.SQLITE_DBCONFIG_TRIGGER_EQP:case r.SQLITE_DBCONFIG_RESET_DATABASE:case r.SQLITE_DBCONFIG_DEFENSIVE:case r.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case r.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case r.SQLITE_DBCONFIG_DQS_DML:case r.SQLITE_DBCONFIG_DQS_DDL:case r.SQLITE_DBCONFIG_ENABLE_VIEW:case r.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case r.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case r.SQLITE_DBCONFIG_STMT_SCANSTATUS:case r.SQLITE_DBCONFIG_REVERSE_SCANORDER:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case r.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=_.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(f,p,b[0],b[1]||0);case r.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=_.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(f,p,b[0],b[1],b[2]);case r.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=_.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(f,p,b[0]);default:return r.SQLITE_MISUSE}}).bind(Object.create(null)),r.sqlite3_value_to_js=function(f,p=!0){let b;const D=r.sqlite3_value_type(f);switch(D){case r.SQLITE_INTEGER:_.bigIntEnabled?(b=r.sqlite3_value_int64(f),F.bigIntFitsDouble(b)&&(b=Number(b))):b=r.sqlite3_value_double(f);break;case r.SQLITE_FLOAT:b=r.sqlite3_value_double(f);break;case r.SQLITE_TEXT:b=r.sqlite3_value_text(f);break;case r.SQLITE_BLOB:{const G=r.sqlite3_value_bytes(f),le=r.sqlite3_value_blob(f);G&&!le&&C.WasmAllocError.toss("Cannot allocate memory for blob argument of",G,"byte(s)"),b=G?_.heap8u().slice(Number(le),Number(le)+Number(G)):null;break}case r.SQLITE_NULL:b=null;break;default:p&&B(r.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",D),b=void 0}return b},r.sqlite3_values_to_js=function(f,p,b=!0){let D;const G=[];for(D=0;D<f;++D)G.push(r.sqlite3_value_to_js(_.peekPtr(_.ptr.add(p,_.ptr.size*D)),b));return G},r.sqlite3_result_error_js=function(f,p){p instanceof w?r.sqlite3_result_error_nomem(f):r.sqlite3_result_error(f,""+p,-1)},r.sqlite3_result_js=function(f,p){if(p instanceof Error){r.sqlite3_result_error_js(f,p);return}try{switch(typeof p){case"undefined":break;case"boolean":r.sqlite3_result_int(f,p?1:0);break;case"bigint":F.bigIntFits32(p)?r.sqlite3_result_int(f,Number(p)):F.bigIntFitsDouble(p)?r.sqlite3_result_double(f,Number(p)):_.bigIntEnabled?F.bigIntFits64(p)?r.sqlite3_result_int64(f,p):B("BigInt value",p.toString(),"is too BigInt for int64."):B("BigInt value",p.toString(),"is too BigInt.");break;case"number":{let b;F.isInt32(p)?b=r.sqlite3_result_int:_.bigIntEnabled&&Number.isInteger(p)&&F.bigIntFits64(BigInt(p))?b=r.sqlite3_result_int64:b=r.sqlite3_result_double,b(f,p);break}case"string":{const[b,D]=_.allocCString(p,!0);r.sqlite3_result_text(f,b,D,r.SQLITE_WASM_DEALLOC);break}case"object":if(p===null){r.sqlite3_result_null(f);break}else if(F.isBindableTypedArray(p)){const b=_.allocFromTypedArray(p);r.sqlite3_result_blob(f,b,p.byteLength,r.SQLITE_WASM_DEALLOC);break}default:B("Don't not how to handle this UDF result value:",typeof p,p)}}catch(b){r.sqlite3_result_error_js(f,b)}},r.sqlite3_column_js=function(f,p,b=!0){const D=r.sqlite3_column_value(f,p);return D===0?void 0:r.sqlite3_value_to_js(D,b)};const A=(function(f,p,b){b=r[b],this.ptr?_.pokePtr(this.ptr,0):this.ptr=_.allocPtr();const D=b(f,p,this.ptr);if(D)return X.toss(D,arguments[2]+"() failed with code "+D);const G=_.peekPtr(this.ptr);return G?r.sqlite3_value_to_js(G,!0):void 0}).bind(Object.create(null));r.sqlite3_preupdate_new_js=(f,p)=>A(f,p,"sqlite3_preupdate_new"),r.sqlite3_preupdate_old_js=(f,p)=>A(f,p,"sqlite3_preupdate_old"),r.sqlite3changeset_new_js=(f,p)=>A(f,p,"sqlite3changeset_new"),r.sqlite3changeset_old_js=(f,p)=>A(f,p,"sqlite3changeset_old");const C={WasmAllocError:w,SQLite3Error:X,capi:r,util:F,wasm:_,config:i,version:Object.create(null),client:void 0,asyncPostInit:async function f(){if(f.isReady instanceof Promise)return f.isReady;let p=t.initializersAsync;delete t.initializersAsync;const b=async()=>(C.__isUnderTest||(delete C.util,delete C.StructBinder),C),D=le=>{throw i.error("an async sqlite3 initializer failed:",le),le};if(!p||!p.length)return f.isReady=b().catch(D);p=p.map(le=>le instanceof Function?async ae=>le(C):le),p.push(b);let G=Promise.resolve(C);for(;p.length;)G=G.then(p.shift());return f.isReady=G.catch(D)},scriptInfo:void 0};try{t.initializers.forEach(f=>{f(C)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}if(delete t.initializers,t.sqlite3=C,delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig,e.debugModule("sqlite3ApiBootstrap() complete",C),C.scriptInfo=e,C.__isUnderTest=s){C.config.emscripten=n;const f=e.instantiateWasm;f&&(C.wasm.module=f.module,C.wasm.instance=f.instance,C.wasm.imports=f.imports)}return C.asyncPostInit().then(f=>(e.debugModule("sqlite3.asyncPostInit() complete",C),delete f.asyncPostInit,delete f.scriptInfo,delete f.emscripten,f))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(t){t.bigIntEnabled===void 0&&(t.bigIntEnabled=!!globalThis.BigInt64Array);const c=(...o)=>{throw new Error(o.join(" "))};t.pointerSize&&!t.pointerIR&&(t.pointerIR=t.pointerSize===4?"i32":"i64");const i=t.pointerIR??(t.pointerIR="i32"),r=t.pointerSize??(t.pointerSize=i==="i32"?4:i==="i64"?8:0);delete t.pointerSize,delete t.pointerIR,i!=="i32"&&i!=="i64"?c("Invalid pointerIR:",i):r!==8&&r!==4&&c("Invalid pointerSize:",r);const _=t.bigIntEnabled?o=>BigInt(o||0):o=>c("BigInt support is disabled in this build."),P=r===4?o=>Number(o||0):_,X=P(0),B=function(...o){let l=P(0);for(const d of o)l+=P(d);return l};{const o=Object.create(null);Object.defineProperty(t,"ptr",{enumerable:!0,get:()=>o,set:()=>c("The ptr property is read-only.")}),function l(d,m){return Object.defineProperty(o,d,{enumerable:!0,get:()=>m,set:()=>c("ptr["+d+"] is read-only.")}),l}("null",X)("size",r)("ir",i)("coerce",P)("add",B)("addn",i===4?B:(...l)=>Number(B(...l)))}t.exports||Object.defineProperty(t,"exports",{enumerable:!0,configurable:!0,get:()=>{var o;return(o=t.instance)==null?void 0:o.exports}});const I=Object.create(null);I.heapSize=0,I.memory=null,I.freeFuncIndexes=[],I.scopedAlloc=[],I.scopedAlloc.pushPtr=o=>(I.scopedAlloc[I.scopedAlloc.length-1].push(o),o),I.utf8Decoder=new TextDecoder,I.utf8Encoder=new TextEncoder("utf-8"),t.sizeofIR=o=>{switch(o){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return r;default:return(""+o).endsWith("*")?r:void 0}};const O=function(){if(!I.memory)I.memory=t.memory instanceof WebAssembly.Memory?t.memory:t.exports.memory;else if(I.heapSize===I.memory.buffer.byteLength)return I;const o=I.memory.buffer;return I.HEAP8=new Int8Array(o),I.HEAP8U=new Uint8Array(o),I.HEAP16=new Int16Array(o),I.HEAP16U=new Uint16Array(o),I.HEAP32=new Int32Array(o),I.HEAP32U=new Uint32Array(o),I.HEAP32F=new Float32Array(o),I.HEAP64F=new Float64Array(o),t.bigIntEnabled&&(typeof BigInt64Array<"u"?(I.HEAP64=new BigInt64Array(o),I.HEAP64U=new BigUint64Array(o)):c("BigInt support is enabled, but the BigInt64Array type is missing.")),I.heapSize=o.byteLength,I};t.heap8=()=>O().HEAP8,t.heap8u=()=>O().HEAP8U,t.heap16=()=>O().HEAP16,t.heap16u=()=>O().HEAP16U,t.heap32=()=>O().HEAP32,t.heap32u=()=>O().HEAP32U,t.heapForSize=function(o,l=!0){const d=I.memory&&I.heapSize===I.memory.buffer.byteLength?I:O();switch(o){case Int8Array:return d.HEAP8;case Uint8Array:return d.HEAP8U;case Int16Array:return d.HEAP16;case Uint16Array:return d.HEAP16U;case Int32Array:return d.HEAP32;case Uint32Array:return d.HEAP32U;case 8:return l?d.HEAP8U:d.HEAP8;case 16:return l?d.HEAP16U:d.HEAP16;case 32:return l?d.HEAP32U:d.HEAP32;case 64:if(d.HEAP64)return l?d.HEAP64U:d.HEAP64;break;default:if(t.bigIntEnabled){if(o===globalThis.BigUint64Array)return d.HEAP64U;if(o===globalThis.BigInt64Array)return d.HEAP64;break}}c("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const x=t.functionTable;delete t.functionTable,t.functionTable=x?()=>x:()=>t.exports.__indirect_function_table,t.functionEntry=function(o){const l=t.functionTable();return o<l.length?l.get(P(o)):void 0},t.jsFuncToWasm=function o(l,d){if(o._||(o._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:i,P:i,s:i,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(oe,K,de)=>{de<128?oe[K](de):oe[K](de%128|128,de>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:oe=>{const K=o._.rxJSig.exec(oe);return K?K[2]:oe.substr(1)},letterType:oe=>o._.sigTypes[oe]||c("Invalid signature letter:",oe),pushSigType:(oe,K)=>oe.push(o._.typeCodes[o._.letterType(K)])}),typeof l=="string"){const oe=d;d=l,l=oe}const m=o._,M=m.sigParams(d),V=[1,96];m.uleb128Encode(V,"push",M.length);for(const oe of M)m.pushSigType(V,oe);return d[0]==="v"?V.push(0):(V.push(1),m.pushSigType(V,d[0])),m.uleb128Encode(V,"unshift",V.length),V.unshift(0,97,115,109,1,0,0,0,1),V.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(V)),{e:{f:l}}).exports.f};const L=function(l,d,m){if(m&&!I.scopedAlloc.length&&c("No scopedAllocPush() scope is active."),typeof l=="string"){const K=d;d=l,l=K}(typeof d!="string"||!(l instanceof Function))&&c("Invalid arguments: expecting (function,signature) or (signature,function).");const M=t.functionTable(),V=P(M.length);let oe;for(;I.freeFuncIndexes.length&&(oe=I.freeFuncIndexes.pop(),M.get(oe));){oe=null;continue}oe||(oe=P(V),M.grow(P(1)));try{return M.set(oe,l),m&&I.scopedAlloc.pushPtr(oe),oe}catch(K){if(!(K instanceof TypeError))throw oe===V&&I.freeFuncIndexes.push(V),K}try{const K=t.jsFuncToWasm(l,d);M.set(oe,K),m&&I.scopedAlloc.pushPtr(oe)}catch(K){throw oe===V&&I.freeFuncIndexes.push(V),K}return oe};t.installFunction=(o,l)=>L(o,l,!1),t.scopedInstallFunction=(o,l)=>L(o,l,!0),t.uninstallFunction=function(o){if(!o&&o!==0)return;const l=I.freeFuncIndexes,d=t.functionTable();l.push(o);const m=d.get(o);return d.set(o,null),m},t.peek=function(l,d="i8"){d.endsWith("*")&&(d=i);const m=I.memory&&I.heapSize===I.memory.buffer.byteLength?I:O(),M=Array.isArray(l)?[]:void 0;let V;do{switch(M&&(l=arguments[0].shift()),d){case"i1":case"i8":V=m.HEAP8[Number(l)>>0];break;case"i16":V=m.HEAP16[Number(l)>>1];break;case"i32":V=m.HEAP32[Number(l)>>2];break;case"float":case"f32":V=m.HEAP32F[Number(l)>>2];break;case"double":case"f64":V=Number(m.HEAP64F[Number(l)>>3]);break;case"i64":if(m.HEAP64){V=_(m.HEAP64[Number(l)>>3]);break}default:c("Invalid type for peek():",d)}M&&M.push(V)}while(M&&arguments[0].length);return M||V},t.poke=function(o,l,d="i8"){d.endsWith("*")&&(d=i);const m=I.memory&&I.heapSize===I.memory.buffer.byteLength?I:O();for(const M of Array.isArray(o)?o:[o])switch(d){case"i1":case"i8":m.HEAP8[Number(M)>>0]=l;continue;case"i16":m.HEAP16[Number(M)>>1]=l;continue;case"i32":m.HEAP32[Number(M)>>2]=l;continue;case"float":case"f32":m.HEAP32F[Number(M)>>2]=l;continue;case"double":case"f64":m.HEAP64F[Number(M)>>3]=l;continue;case"i64":if(m.HEAP64){m.HEAP64[Number(M)>>3]=_(l);continue}default:c("Invalid type for poke(): "+d)}return this},t.peekPtr=(...o)=>t.peek(o.length===1?o[0]:o,i),t.pokePtr=(o,l=0)=>t.poke(o,l,i),t.peek8=(...o)=>t.peek(o.length===1?o[0]:o,"i8"),t.poke8=(o,l)=>t.poke(o,l,"i8"),t.peek16=(...o)=>t.peek(o.length===1?o[0]:o,"i16"),t.poke16=(o,l)=>t.poke(o,l,"i16"),t.peek32=(...o)=>t.peek(o.length===1?o[0]:o,"i32"),t.poke32=(o,l)=>t.poke(o,l,"i32"),t.peek64=(...o)=>t.peek(o.length===1?o[0]:o,"i64"),t.poke64=(o,l)=>t.poke(o,l,"i64"),t.peek32f=(...o)=>t.peek(o.length===1?o[0]:o,"f32"),t.poke32f=(o,l)=>t.poke(o,l,"f32"),t.peek64f=(...o)=>t.peek(o.length===1?o[0]:o,"f64"),t.poke64f=(o,l)=>t.poke(o,l,"f64"),t.getMemValue=t.peek,t.getPtrValue=t.peekPtr,t.setMemValue=t.poke,t.setPtrValue=t.pokePtr,t.isPtr32=o=>typeof o=="number"&&o>=0&&o===(o|0),t.isPtr64=o=>typeof o=="bigint"?o>=0:t.isPtr32(o),t.isPtr=r===4?t.isPtr32:t.isPtr64,t.cstrlen=function(o){if(!o||!t.isPtr(o))return null;o=Number(o);const l=O().HEAP8U;let d=o;for(;l[d]!==0;++d);return Number(d-o)};const Y=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,W=o=>o.buffer instanceof Y;t.isSharedTypedArray=W;const g=(o,l,d)=>(r===8&&(typeof l=="bigint"&&(l=Number(l)),typeof d=="bigint"&&(d=Number(d))),W(o)?o.slice(l,d):o.subarray(l,d));t.typedArrayPart=g;const q=(o,l,d)=>I.utf8Decoder.decode(g(o,l,d));t.typedArrayToString=q,t.cstrToJs=function(o){const l=t.cstrlen(o);return l?q(O().HEAP8U,Number(o),Number(o)+l):l===null?l:""},t.jstrlen=function(o){if(typeof o!="string")return null;const l=o.length;let d=0;for(let m=0;m<l;++m){let M=o.charCodeAt(m);M>=55296&&M<=57343&&(M=65536+((M&1023)<<10)|o.charCodeAt(++m)&1023),M<=127?++d:M<=2047?d+=2:M<=65535?d+=3:d+=4}return d},t.jstrcpy=function(o,l,d=0,m=-1,M=!0){if((!l||!(l instanceof Int8Array)&&!(l instanceof Uint8Array))&&c("jstrcpy() target must be an Int8Array or Uint8Array."),m=Number(m),d=Number(d),m<0&&(m=l.length-d),!(m>0)||!(d>=0))return 0;let V=0,oe=o.length;const K=d,de=d+m-(M?1:0);for(;V<oe&&d<de;++V){let ce=o.charCodeAt(V);if(ce>=55296&&ce<=57343&&(ce=65536+((ce&1023)<<10)|o.charCodeAt(++V)&1023),ce<=127){if(d>=de)break;l[d++]=ce}else if(ce<=2047){if(d+1>=de)break;l[d++]=192|ce>>6,l[d++]=128|ce&63}else if(ce<=65535){if(d+2>=de)break;l[d++]=224|ce>>12,l[d++]=128|ce>>6&63,l[d++]=128|ce&63}else{if(d+3>=de)break;l[d++]=240|ce>>18,l[d++]=128|ce>>12&63,l[d++]=128|ce>>6&63,l[d++]=128|ce&63}}return M&&(l[d++]=0),d-K},t.cstrncpy=function(o,l,d){if((!o||!l)&&c("cstrncpy() does not accept NULL strings."),d<0)d=t.cstrlen(strPtr)+1;else if(!(d>0))return 0;const m=t.heap8u();let M=0,V;const oe=Number(o),K=Number(l);for(;M<d&&(V=m[K+M]);++M)m[oe+M]=V;return M<d&&(m[oe+M++]=0),M},t.jstrToUintArray=(o,l=!1)=>I.utf8Encoder.encode(l?o+"\0":o);const w=(o,l)=>{(!(o.alloc instanceof Function)||!(o.dealloc instanceof Function))&&c("Object is missing alloc() and/or dealloc() function(s)","required by",l+"().")},F=function(o,l,d,m){if(w(t,m),typeof o!="string")return null;const M=I.utf8Encoder.encode(o),V=d(M.length+1);let oe=V;try{const K=O().HEAP8U;return K.set(M,Number(V)),K[B(V,M.length)]=0,oe=X,l?[V,M.length]:V}finally{oe&&t.dealloc(oe)}};t.allocCString=(o,l=!1)=>F(o,l,t.alloc,"allocCString()"),t.scopedAllocPush=function(){w(t,"scopedAllocPush");const o=[];return I.scopedAlloc.push(o),o},t.scopedAllocPop=function(o){w(t,"scopedAllocPop");const l=arguments.length?I.scopedAlloc.indexOf(o):I.scopedAlloc.length-1;l<0&&c("Invalid state object for scopedAllocPop()."),arguments.length===0&&(o=I.scopedAlloc[l]),I.scopedAlloc.splice(l,1);for(let d;d=o.pop();)t.functionEntry(d)?t.uninstallFunction(d):t.dealloc(d)},t.scopedAlloc=function(o){I.scopedAlloc.length||c("No scopedAllocPush() scope is active.");const l=P(t.alloc(o));return I.scopedAlloc.pushPtr(l)},Object.defineProperty(t.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>I.scopedAlloc.length,set:()=>c("The 'active' property is read-only.")}),t.scopedAllocCString=(o,l=!1)=>F(o,l,t.scopedAlloc,"scopedAllocCString()");const E=function(o,l){const d=t[o?"scopedAlloc":"alloc"]((l.length+1)*t.ptr.size);let m=0;return l.forEach(M=>{t.pokePtr(B(d,t.ptr.size*m++),t[o?"scopedAllocCString":"allocCString"](""+M))}),t.pokePtr(B(d,t.ptr.size*m),0),d};t.scopedAllocMainArgv=o=>E(!0,o),t.allocMainArgv=o=>E(!1,o),t.cArgvToJs=(o,l)=>{const d=[];for(let m=0;m<o;++m){const M=t.peekPtr(B(l,t.ptr.size*m));d.push(M?t.cstrToJs(M):null)}return d},t.scopedAllocCall=function(o){t.scopedAllocPush();try{return o()}finally{t.scopedAllocPop()}};const A=function(o,l,d){w(t,d);const m=l?"i64":i;let M=t[d](o*(l?8:r));if(t.poke(M,0,m),o===1)return M;const V=[M];for(let oe=1;oe<o;++oe)M=B(M,l?8:r),V[oe]=M,t.poke(M,0,m);return V};t.allocPtr=(o=1,l=!0)=>A(o,l,"alloc"),t.scopedAllocPtr=(o=1,l=!0)=>A(o,l,"scopedAlloc"),t.xGet=function(o){return t.exports[o]||c("Cannot find exported symbol:",o)};const C=(o,l)=>c(o+"() requires",l,"argument(s).");t.xCall=function(o,...l){const d=o instanceof Function?o:t.xGet(o);return d instanceof Function||c("Exported symbol",o,"is not a function."),d.length!==l.length&&C(d===o?d.name:o,d.length),arguments.length===2&&Array.isArray(arguments[1])?d.apply(null,arguments[1]):d.apply(null,l)},I.xWrap=Object.create(null),I.xWrap.convert=Object.create(null),I.xWrap.convert.arg=new Map,I.xWrap.convert.result=new Map;const f=I.xWrap.convert.arg,p=I.xWrap.convert.result,b=P;f.set("i64",_).set("i32",o=>o|0).set("i16",o=>(o|0)&65535).set("i8",o=>(o|0)&255).set("f32",o=>Number(o).valueOf()).set("float",f.get("f32")).set("f64",f.get("f32")).set("double",f.get("f64")).set("int",f.get("i32")).set("null",o=>o).set(null,f.get("null")).set("**",b).set("*",b),p.set("*",b).set("pointer",b).set("number",o=>Number(o)).set("void",o=>{}).set(void 0,p.get("void")).set("null",o=>o).set(null,p.get("null"));for(const o of["i8","i16","i32","i64","int","f32","float","f64","double"])f.set(o+"*",b),p.set(o+"*",b),p.set(o,f.get(o)||c("Maintenance required: missing arg converter for",o));const D=o=>typeof o=="string"?t.scopedAllocCString(o):P(o);f.set("string",D).set("utf8",D),p.set("string",o=>t.cstrToJs(o)).set("utf8",p.get("string")).set("string:dealloc",o=>{try{return o?t.cstrToJs(o):null}finally{t.dealloc(o)}}).set("utf8:dealloc",p.get("string:dealloc")).set("json",o=>JSON.parse(t.cstrToJs(o))).set("json:dealloc",o=>{try{return o?JSON.parse(t.cstrToJs(o)):null}finally{t.dealloc(o)}});const G=class{constructor(o){this.name=o.name||"unnamed adapter"}convertArg(o,l,d){c("AbstractArgAdapter must be subclassed.")}};f.FuncPtrAdapter=class Je extends G{constructor(l){super(l),f.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",l),this.name=l.name||"unnamed",this.signature=l.signature,l.contextKey instanceof Function&&(this.contextKey=l.contextKey,l.bindScope||(l.bindScope="context")),this.bindScope=l.bindScope||c("FuncPtrAdapter options requires a bindScope (explicit or implied)."),Je.bindScopes.indexOf(l.bindScope)<0&&c("Invalid options.bindScope ("+l.bindMod+") for FuncPtrAdapter. Expecting one of: ("+Je.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=l.callProxy instanceof Function?l.callProxy:void 0}contextKey(l,d){return this}contextMap(l){const d=this.__cmap||(this.__cmap=new Map);let m=d.get(l);return m===void 0&&d.set(l,m=[]),m}convertArg(l,d,m){let M=this.singleton;if(!M&&this.isContext&&(M=this.contextMap(this.contextKey(d,m))),M&&M.length===2&&M[0]===l)return M[1];if(l instanceof Function){this.callProxy&&(l=this.callProxy(l));const V=L(l,this.signature,this.isTransient);if(Je.debugFuncInstall&&Je.debugOut("FuncPtrAdapter installed",this,this.contextKey(d,m),"@"+V,l),M){if(M[1]){Je.debugFuncInstall&&Je.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,m),"@"+M[1],l);try{I.scopedAlloc.pushPtr(M[1])}catch{}}M[0]=arguments[0]||X,M[1]=V}return V}else if(t.isPtr(l)||l===null||l===void 0){if(M&&M[1]&&M[1]!==l){Je.debugFuncInstall&&Je.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,m),"@"+M[1],l);try{I.scopedAlloc.pushPtr(M[1])}catch{}M[0]=M[1]=l||X}return l||X}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},f.FuncPtrAdapter.warnOnUse=!1,f.FuncPtrAdapter.debugFuncInstall=!1,f.FuncPtrAdapter.debugOut=console.debug.bind(console),f.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const le=o=>f.get(o)||c("Argument adapter not found:",o),ae=o=>p.get(o)||c("Result adapter not found:",o);I.xWrap.convertArg=(o,...l)=>le(o)(...l),I.xWrap.convertArgNoCheck=(o,...l)=>f.get(o)(...l),I.xWrap.convertResult=(o,l)=>o===null?l:o?ae(o)(l):void 0,I.xWrap.convertResultNoCheck=(o,l)=>o===null?l:o?p.get(o)(l):void 0,t.xWrap=function o(l,d,...m){arguments.length===3&&Array.isArray(arguments[2])&&(m=arguments[2]),t.isPtr(l)&&(l=t.functionEntry(l)||c("Function pointer not found in WASM function table."));const M=l instanceof Function,V=M?l:t.xGet(l);if(M&&(l=V.name||"unnamed function"),m.length!==V.length&&C(l,V.length),V.length===0&&(d===null||d==="null"))return V;ae(d);for(const K of m)K instanceof G?f.set(K,(...de)=>K.convertArg(...de)):le(K);const oe=I.xWrap;return V.length===0?(...K)=>K.length?C(l,V.length):oe.convertResult(d,V.call(null)):function(...K){K.length!==V.length&&C(l,V.length);const de=t.scopedAllocPush();try{let ce=0;for(o.debug&&console.debug("xWrap() preparing: resultType ",d,"xf",V,"argTypes",m,"args",K);ce<K.length;++ce)K[ce]=oe.convertArgNoCheck(m[ce],K[ce],K,ce);return o.debug&&console.debug("xWrap() calling: resultType ",d,"xf",V,"argTypes",m,"args",K),oe.convertResultNoCheck(d,V.apply(null,K))}finally{t.scopedAllocPop(de)}}};const h=function(o,l,d,m,M,V){if(typeof d=="string"){if(l===1)return V.get(d);if(l===2){if(m)m instanceof Function||c(M,"requires a function argument.");else return V.delete(d),o;return V.set(d,m),o}}c("Invalid arguments to",M)};return t.xWrap.resultAdapter=function o(l,d){return h(o,arguments.length,l,d,"resultAdapter()",p)},t.xWrap.argAdapter=function o(l,d){return h(o,arguments.length,l,d,"argAdapter()",f)},t.xWrap.FuncPtrAdapter=f.FuncPtrAdapter,t.xCallWrapped=function(o,l,d,...m){return Array.isArray(arguments[3])&&(m=arguments[3]),t.xWrap(o,l,d||[]).apply(null,m||[])},t.xWrap.testConvertArg=I.xWrap.convertArg,t.xWrap.testConvertResult=I.xWrap.convertResult,t},globalThis.WhWasmUtilInstaller.yawl=(function(t){const c=()=>fetch(t.uri,{credentials:"same-origin"}),i=this,r=function(T){var P,X;if(t.wasmUtilTarget){const B=(...O)=>{throw new Error(O.join(" "))},I=t.wasmUtilTarget;if(I.module=T.module,I.instance=T.instance,I.instance.exports.memory||(I.memory=((X=(P=t==null?void 0:t.imports)==null?void 0:P.env)==null?void 0:X.memory)||B("Missing 'memory' object!")),!I.alloc&&T.instance.exports.malloc){const O=T.instance.exports;I.alloc=function(x){return O.malloc(x)||B("Allocation of",x,"bytes failed.")},I.dealloc=function(x){O.free(x)}}i(I)}return T.config=t,t.onload&&t.onload(T),T};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(c(),t.imports||{}).then(r):()=>c().then(T=>T.arrayBuffer()).then(T=>WebAssembly.instantiate(T,t.imports||{})).then(r)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function t(c){const i=(...k)=>{throw new Error(k.join(" "))};!(c.heap instanceof WebAssembly.Memory)&&!(c.heap instanceof Function)&&i("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(k){c[k]instanceof Function||i("Config option '"+k+"' must be a function.")});const r=c.heap,_=t,T=r||(()=>new Uint8Array(r.buffer)),P=c.alloc,X=c.dealloc,B=c.log||console.debug.bind(console),I=c.memberPrefix||"",O=c.memberSuffix||"",x=globalThis.BigInt,L=globalThis.BigInt64Array,Y=c.bigIntEnabled??!!L,W=c.pointerIR||c.ptrIR||"i32",g=c.ptrSize||(W==="i32"?4:8);W!=="i32"&&W!=="i64"&&i("Invalid pointer representation:",W),g!==4&&g!==8&&i("Invalid pointer size:",g);const q=Y&&x?k=>x(k||0):k=>i("BigInt support is disabled in this build."),w=W=="i32"?Number:q,F=w(0),E=function(...k){let J=F;for(let re=0;re<k.length;++re)J+=w(k[re]);return J};_.debugFlags||(_.__makeDebugFlags=function(k=null){k&&k.__flags&&(k=k.__flags);const J=function re(_e){return arguments.length===0?re.__flags:(_e<0?(delete re.__flags.getter,delete re.__flags.setter,delete re.__flags.alloc,delete re.__flags.dealloc):(re.__flags.getter=(1&_e)!==0,re.__flags.setter=(2&_e)!==0,re.__flags.alloc=(4&_e)!==0,re.__flags.dealloc=(8&_e)!==0),re._flags)};return Object.defineProperty(J,"__flags",{iterable:!1,writable:!1,value:Object.create(k)}),k||J(0),J},_.debugFlags=_.__makeDebugFlags());const A=function(){const k=new ArrayBuffer(2);return new DataView(k).setInt16(0,256,!0),new Int16Array(k)[0]===256}(),C=k=>k[1]==="(",f=k=>k==="P",p=k=>C(k)?"p":k[0],b=function(k){switch(p(k)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return W;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",k)},D=L?()=>!0:()=>i("BigInt64Array is not available."),G=function(k){switch(p(k)){case"p":case"P":case"s":{switch(g){case 4:return"getInt32";case 8:return D()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return D()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",k)},le=function(k){switch(p(k)){case"p":case"P":case"s":{switch(g){case 4:return"setInt32";case 8:return D()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return D()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",k)},ae=function(k){switch(p(k)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return q;case"p":case"P":case"s":switch(g){case 4:return Number;case 8:return q}break}i("Unhandled DataView set wrapper for signature:",k)},h=(k,J)=>k+"::"+J,o=function(k,J){return()=>i(h(k,J),"is read-only.")},l=new WeakMap,d="(pointer-is-external)",m=k=>typeof k=="number"&&k===(k|0)&&k>=0,V=g===4?m:k=>typeof k=="bigint"&&k>=0||m(k),oe=function(k,J,re){if(re||(re=l.get(J)),re){if(l.delete(J),Array.isArray(J.ondispose)){let _e;for(;_e=J.ondispose.shift();)try{_e instanceof Function?_e.call(J):_e instanceof ee?_e.dispose():V(_e)&&X(_e)}catch(Oe){console.warn("ondispose() for",k.structName,"@",re,"threw. NOT propagating it.",Oe)}}else if(J.ondispose instanceof Function)try{J.ondispose()}catch(_e){console.warn("ondispose() for",k.structName,"@",re,"threw. NOT propagating it.",_e)}delete J.ondispose,k.debugFlags.__flags.dealloc&&B("debug.dealloc:",J[d]?"EXTERNAL":"",k.structName,"instance:",k.structInfo.sizeof,"bytes @"+re),J[d]||X(re)}},K=k=>({configurable:!1,writable:!1,iterable:!1,value:k}),de=function(k,J,re){let _e=!re;re?Object.defineProperty(J,d,K(re)):(re=P(k.structInfo.sizeof),re||i("Allocation of",k.structName,"structure failed."));try{k.debugFlags.__flags.alloc&&B("debug.alloc:",_e?"":"EXTERNAL",k.structName,"instance:",k.structInfo.sizeof,"bytes @"+re),_e&&T().fill(0,Number(re),Number(re)+k.structInfo.sizeof),l.set(J,re)}catch(Oe){throw oe(k,J,re),Oe}},ce=function(){const k=this.pointer;return k?new Uint8Array(T().slice(Number(k),Number(k)+this.structInfo.sizeof)):null},ye=K(k=>I+k+O),Ie=function(k,J,re=!0){let _e=k.members[J];if(!_e&&(I||O)){for(const Oe of Object.values(k.members))if(Oe.key===J){_e=Oe;break}!_e&&re&&i(h(k.name,J),"is not a mapped struct member.")}return _e},Re=function k(J,re,_e=!1){k._||(k._=De=>De.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const Oe=Ie(J.structInfo,re,!0);return _e?k._(Oe.signature):Oe.signature},S={configurable:!1,enumerable:!1,get:function(){return l.get(this)},set:()=>i("Cannot assign the 'pointer' property of a struct.")},z=K(function(){const k=[];for(const J of Object.keys(this.structInfo.members))k.push(this.memberKey(J));return k}),U=new TextDecoder("utf-8"),te=new TextEncoder,Z=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,pe=function(k,J,re){return g===8&&(J=Number(J),re=Number(re)),U.decode(k.buffer instanceof Z?k.slice(J,re):k.subarray(J,re))},ue=function(k,J,re=!1){const _e=Ie(k.structInfo,J,re);return _e&&_e.signature.length===1&&_e.signature[0]==="s"?_e:!1},R=function(k){k.signature!=="s"&&i("Invalid member type signature for C-string value:",JSON.stringify(k))},y=function(J,re){const _e=Ie(J.structInfo,re,!0);R(_e);const Oe=J[_e.key];if(!Oe)return null;let De=Oe;const Me=T();for(;Me[De]!==0;++De);return Oe===De?"":pe(Me,Oe,De)},N=function(k,...J){k.ondispose?Array.isArray(k.ondispose)||(k.ondispose=[k.ondispose]):k.ondispose=[],k.ondispose.push(...J)},Q=function(k){const J=te.encode(k),re=P(J.length+1);re||i("Allocation error while duplicating string:",k);const _e=T();return _e.set(J,Number(re)),_e[E(re,J.length)]=0,re},$=function(k,J,re){const _e=Ie(k.structInfo,J,!0);R(_e);const Oe=Q(re);return k[_e.key]=Oe,N(k,Oe),k},ee=function(J,re){arguments[2]!==K&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:K(J),structInfo:K(re)})};ee.prototype=Object.create(null,{dispose:K(function(){oe(this.constructor,this)}),lookupMember:K(function(k,J=!0){return Ie(this.structInfo,k,J)}),memberToJsString:K(function(k){return y(this,k)}),memberIsString:K(function(k,J=!0){return ue(this,k,J)}),memberKey:ye,memberKeys:z,memberSignature:K(function(k,J=!1){return Re(this,k,J)}),memoryDump:K(ce),pointer:S,setMemberCString:K(function(k,J){return $(this,k,J)})}),Object.assign(ee.prototype,{addOnDispose:function(...k){return N(this,...k),this}}),Object.defineProperties(ee,{allocCString:K(Q),isA:K(k=>k instanceof ee),hasExternalPointer:K(k=>k instanceof ee&&!!k[d]),memberKey:ye});const he=function k(J,re,_e){if(!k._){k._={getters:{},setters:{},sw:{}};const Be=["i","c","C","p","P","s","f","d","v()"];Y&&Be.push("j"),Be.forEach(function(Ge){k._.getters[Ge]=G(Ge),k._.setters[Ge]=le(Ge),k._.sw[Ge]=ae(Ge)});const dr=/^[ipPsjfdcC]$/,pr=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;k.sigCheck=function(Ge,hr,Gt,Et){Object.prototype.hasOwnProperty.call(Ge,Gt)&&i(Ge.structName,"already has a property named",Gt+"."),dr.test(Et)||pr.test(Et)||i("Malformed signature for",h(Ge.structName,hr)+":",Et)}}const Oe=J.memberKey(re);k.sigCheck(J.prototype,re,Oe,_e.signature),_e.key=Oe,_e.name=re;const De=p(_e.signature),Me=h(J.prototype.structName,Oe),Pe=J.prototype.debugFlags.__flags,Fe=Object.create(null);Fe.configurable=!1,Fe.enumerable=!1,Fe.get=function(){Pe.getter&&B("debug.getter:",k._.getters[De],"for",b(De),Me,"@",this.pointer,"+",_e.offset,"sz",_e.sizeof);let Be=new DataView(T().buffer,Number(this.pointer)+_e.offset,_e.sizeof)[k._.getters[De]](0,A);return Pe.getter&&B("debug.getter:",Me,"result =",Be),Be},_e.readOnly?Fe.set=o(J.prototype.structName,Oe):Fe.set=function(Be){if(Pe.setter&&B("debug.setter:",k._.setters[De],"for",b(De),Me,"@",this.pointer,"+",_e.offset,"sz",_e.sizeof,Be),this.pointer||i("Cannot set struct property on disposed instance."),Be===null)Be=F;else for(;!V(Be);){if(f(_e.signature)&&Be instanceof ee){Be=Be.pointer||F,Pe.setter&&B("debug.setter:",Me,"resolved to",Be);break}i("Invalid value for pointer-type",Me+".")}new DataView(T().buffer,Number(this.pointer)+_e.offset,_e.sizeof)[k._.setters[De]](0,k._.sw[De](Be),A)},Object.defineProperty(J.prototype,Oe,Fe)},Ee=function k(J,re){arguments.length===1?(re=J,J=re.name):re.name||(re.name=J),J||i("Struct name is required.");let _e=!1;Object.keys(re.members).forEach(Pe=>{const Fe=re.members[Pe];Fe.sizeof?Fe.sizeof===1?Fe.signature==="c"||Fe.signature==="C"||i("Unexpected sizeof==1 member",h(re.name,Pe),"with signature",Fe.signature):(Fe.sizeof%4!==0&&(console.warn("Invalid struct member description =",Fe,"from",re),i(J,"member",Pe,"sizeof is not aligned. sizeof="+Fe.sizeof)),Fe.offset%4!==0&&(console.warn("Invalid struct member description =",Fe,"from",re),i(J,"member",Pe,"offset is not aligned. offset="+Fe.offset))):i(J,"member",Pe,"is missing sizeof."),(!_e||_e.offset<Fe.offset)&&(_e=Fe)}),_e?re.sizeof<_e.offset+_e.sizeof&&i("Invalid struct config:",J,"max member offset ("+_e.offset+") ","extends past end of struct (sizeof="+re.sizeof+")."):i("No member property descriptions found.");const Oe=K(_.__makeDebugFlags(k.debugFlags)),De=w(0),Me=function Pe(Fe){Fe=w(Fe),this instanceof Pe?arguments.length?((Number.isNaN(Fe)||Fe<=De)&&i("Invalid pointer value",arguments[0],"for",J,"constructor."),de(Pe,this,Fe)):de(Pe,this):i("The",J,"constructor may only be called via 'new'.")};return Object.defineProperties(Me,{debugFlags:Oe,isA:K(Pe=>Pe instanceof Me),memberKey:ye,memberKeys:z,methodInfoForKey:K(function(Pe){}),structInfo:K(re),structName:K(J)}),Me.prototype=new ee(J,re,K),Object.defineProperties(Me.prototype,{debugFlags:Oe,constructor:K(Me)}),Object.keys(re.members).forEach(Pe=>he(Me,Pe,re.members[Pe])),Me};return Ee.StructType=ee,Ee.config=c,Ee.allocCString=Q,Ee.debugFlags||(Ee.debugFlags=_.__makeDebugFlags(_.debugFlags)),Ee},globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=(...g)=>{throw new Error(g.join(" "))},i=t.capi,r=t.wasm,_=t.util;globalThis.WhWasmUtilInstaller(r),delete globalThis.WhWasmUtilInstaller;const T={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(g,q)=>g[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:g=>g[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new r.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:g=>{let q;return(w,F,E,A)=>{try{const C=r.cArgvToJs(F,E);return q||(q=r.cArgvToJs(F,A)),g(C,q)|0}catch(C){return C.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:g=>g[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(g,q)=>g[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:g=>g[0],callProxy:g=>(q,w,F,E,A)=>{g(q,w,r.cstrToJs(F),r.cstrToJs(E),A)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(r.exports.sqlite3_progress_handler&&T.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(g,q)=>g[0]}),"*"]]),r.exports.sqlite3_stmt_explain&&T.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),r.exports.sqlite3_set_authorizer&&T.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(g,q)=>g[0],callProxy:g=>(q,w,F,E,A,C)=>{try{return F=F&&r.cstrToJs(F),E=E&&r.cstrToJs(E),A=A&&r.cstrToJs(A),C=C&&r.cstrToJs(C),g(q,w,F,E,A,C)|0}catch(f){return f.resultCode||i.SQLITE_ERROR}}}),"*"]]),r.exports.sqlite3_column_origin_name&&T.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),r.bigIntEnabled&&r.exports.sqlite3_declare_vtab&&T.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),r.bigIntEnabled&&r.exports.sqlite3_preupdate_hook&&T.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:g=>g[0],callProxy:g=>(q,w,F,E,A,C,f)=>{g(q,w,F,r.cstrToJs(E),r.cstrToJs(A),C,f)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),r.bigIntEnabled&&r.exports.sqlite3changegroup_add&&r.exports.sqlite3session_create&&r.exports.sqlite3_preupdate_hook){const g={signature:"i(ps)",callProxy:q=>(w,F)=>{try{return q(w,r.cstrToJs(F))|0}catch(E){return E.resultCode||i.SQLITE_ERROR}}};T.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...g}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xFilter",...g,contextKey:(q,w)=>q[0]}),"*"]])}t.StructBinder=globalThis.Jaccwabyt({heap:r.heap8u,alloc:r.alloc,dealloc:r.dealloc,bigIntEnabled:r.bigIntEnabled,pointerIR:r.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const g=r.xWrap.argAdapter("string");r.xWrap.argAdapter("string:flexible",E=>g(_.flexibleString(E))),r.xWrap.argAdapter("string:static",(function(E){return r.isPtr(E)?E:(E=""+E,this[E]||(this[E]=r.allocCString(E)))}).bind(Object.create(null)));const q=r.xWrap.argAdapter("*"),w=function(){};r.xWrap.argAdapter("sqlite3_filename",q)("sqlite3_context*",q)("sqlite3_value*",q)("void*",q)("sqlite3_changegroup*",q)("sqlite3_changeset_iter*",q)("sqlite3_session*",q)("sqlite3_stmt*",E=>{var A;return q(E instanceof(((A=t==null?void 0:t.oo1)==null?void 0:A.Stmt)||w)?E.pointer:E)})("sqlite3*",E=>{var A;return q(E instanceof(((A=t==null?void 0:t.oo1)==null?void 0:A.DB)||w)?E.pointer:E)})("sqlite3_vfs*",E=>typeof E=="string"?i.sqlite3_vfs_find(E)||t.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",E):q(E instanceof(i.sqlite3_vfs||w)?E.pointer:E)),r.exports.sqlite3_declare_vtab&&r.xWrap.argAdapter("sqlite3_index_info*",E=>q(E instanceof(i.sqlite3_index_info||w)?E.pointer:E))("sqlite3_module*",E=>q(E instanceof(i.sqlite3_module||w)?E.pointer:E));const F=r.xWrap.resultAdapter("*");r.xWrap.resultAdapter("sqlite3*",F)("sqlite3_context*",F)("sqlite3_stmt*",F)("sqlite3_value*",F)("sqlite3_vfs*",F)("void*",F);for(const E of T.core)i[E[0]]=r.xWrap.apply(null,E);for(const E of T.wasmInternal)_[E[0]]=r.xWrap.apply(null,E);for(const E of T.int64)i[E[0]]=r.bigIntEnabled?r.xWrap.apply(null,E):()=>c(E[0]+"() is unavailable due to lack","of BigInt support in this build.");delete T.core,delete T.int64,delete T.wasmInternal,_.sqlite3__wasm_db_error=function(E,A,C){return E?(A instanceof t.WasmAllocError?(A=i.SQLITE_NOMEM,C=0):A instanceof Error&&(C=C||""+A,A=A.resultCode||i.SQLITE_ERROR),i.sqlite3_set_errmsg(E,A,C)||A):i.SQLITE_MISUSE}}{const g=r.xCall("sqlite3__wasm_enum_json");g||c("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),r.ctype=JSON.parse(r.cstrToJs(g));const q=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];r.bigIntEnabled&&q.push("serialize","session","vtab");for(const E of q)for(const A of Object.entries(r.ctype[E]))i[A[0]]=A[1];r.functionEntry(i.SQLITE_WASM_DEALLOC)||c("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const w=Object.create(null);for(const E of["resultCodes"])for(const A of Object.entries(r.ctype[E]))w[A[1]]=A[0];i.sqlite3_js_rc_str=E=>w[E];const F=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!_.isUIThread(),sqlite3_index_info:!r.bigIntEnabled,sqlite3_index_constraint:!r.bigIntEnabled,sqlite3_index_orderby:!r.bigIntEnabled,sqlite3_index_constraint_usage:!r.bigIntEnabled});for(const E of r.ctype.structs)F[E.name]||(i[E.name]=t.StructBinder(E));if(i.sqlite3_index_info){for(const E of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[E]=i[E],delete i[E];i.sqlite3_vtab_config=r.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const P=(g,q,w)=>_.sqlite3__wasm_db_error(g,i.SQLITE_MISUSE,q+"() requires "+w+" argument"+(w===1?"":"s")+"."),X=g=>_.sqlite3__wasm_db_error(g,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),B=g=>r.xWrap.argAdapter("sqlite3*")(g),I=g=>r.isPtr(g)?r.cstrToJs(g):g,O=(function(g,q){g=B(g);let w=this.dbMap.get(g);if(q)!w&&q>0&&this.dbMap.set(g,w=Object.create(null));else return this.dbMap.delete(g),w;return w}).bind(Object.assign(Object.create(null),{dbMap:new Map}));O.addCollation=function(g,q){const w=O(g,1);w.collation||(w.collation=new Set),w.collation.add(I(q).toLowerCase())},O._addUDF=function(g,q,w,F){q=I(q).toLowerCase();let E=F.get(q);E||F.set(q,E=new Set),E.add(w<0?-1:w)},O.addFunction=function(g,q,w){const F=O(g,1);F.udf||(F.udf=new Map),this._addUDF(g,q,w,F.udf)},r.exports.sqlite3_create_window_function&&(O.addWindowFunc=function(g,q,w){const F=O(g,1);F.wudf||(F.wudf=new Map),this._addUDF(g,q,w,F.wudf)}),O.cleanup=function(g){g=B(g);for(const F of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[E,A]=F;if(!r.exports[E])continue;const f=[g];f.length=A;try{i[E](...f)}catch(p){t.config.warn("close-time call of",E+"(",f,") threw:",p)}}const q=O(g,0);if(!q)return;if(q.collation){for(const F of q.collation)try{i.sqlite3_create_collation_v2(g,F,i.SQLITE_UTF8,0,0,0)}catch{}delete q.collation}let w;for(w=0;w<2;++w){const F=w?q.wudf:q.udf;if(!F)continue;const E=w?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const A of F){const C=A[0],f=A[1],p=[g,C,0,i.SQLITE_UTF8,0,0,0,0,0];w&&p.push(0);for(const b of f)try{p[2]=b,E.apply(null,p)}catch{}f.clear()}F.clear()}delete q.udf,delete q.wudf};{const g=r.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(q){if(arguments.length!==1)return P(q,"sqlite3_close_v2",1);if(q)try{O.cleanup(q)}catch{}return g(q)}}if(i.sqlite3session_create){const g=r.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(q){if(arguments.length!==1)return P(pDb,"sqlite3session_delete",1);q&&i.sqlite3session_table_filter(q,0,0),g(q)}}{const g=(w,F)=>"argv["+F+"]:"+w[0]+":"+r.cstrToJs(w[1]).toLowerCase(),q=r.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new r.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:g}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:g})]);i.sqlite3_create_collation_v2=function(w,F,E,A,C,f){if(arguments.length!==6)return P(w,"sqlite3_create_collation_v2",6);if(!(E&15))E|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(E&15))return X(w);try{const p=q(w,F,E,A,C,f);return p===0&&C instanceof Function&&O.addCollation(w,F),p}catch(p){return _.sqlite3__wasm_db_error(w,p)}},i.sqlite3_create_collation=(w,F,E,A,C)=>arguments.length===5?i.sqlite3_create_collation_v2(w,F,E,A,C,0):P(w,"sqlite3_create_collation",5)}{const g=function(E,A){return E[0]+":"+(E[2]<0?-1:E[2])+":"+A+":"+r.cstrToJs(E[1]).toLowerCase()},q=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:g,callProxy:E=>(A,C,f)=>{try{E(A,...i.sqlite3_values_to_js(C,f))}catch(p){i.sqlite3_result_error_js(A,p)}}},xFinalAndValue:{signature:"v(p)",contextKey:g,callProxy:E=>A=>{try{i.sqlite3_result_js(A,E(A))}catch(C){i.sqlite3_result_error_js(A,C)}}},xFunc:{signature:"v(pip)",contextKey:g,callProxy:E=>(A,C,f)=>{try{i.sqlite3_result_js(A,E(A,...i.sqlite3_values_to_js(C,f)))}catch(p){i.sqlite3_result_error_js(A,p)}}},xDestroy:{signature:"v(p)",contextKey:g,callProxy:E=>A=>{try{E(A)}catch(C){console.error("UDF xDestroy method threw:",C)}}}}),w=r.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xFunc",...q.xFunc}),new r.xWrap.FuncPtrAdapter({name:"xStep",...q.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...q.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...q.xDestroy})]),F=r.exports.sqlite3_create_window_function?r.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xStep",...q.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...q.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xValue",...q.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xInverse",...q.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...q.xDestroy})]):void 0;i.sqlite3_create_function_v2=function E(A,C,f,p,b,D,G,le,ae){if(E.length!==arguments.length)return P(A,"sqlite3_create_function_v2",E.length);if(!(p&15))p|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(p&15))return X(A);try{const h=w(A,C,f,p,b,D,G,le,ae);return h===0&&(D instanceof Function||G instanceof Function||le instanceof Function||ae instanceof Function)&&O.addFunction(A,C,f),h}catch(h){return console.error("sqlite3_create_function_v2() setup threw:",h),_.sqlite3__wasm_db_error(A,h,"Creation of UDF threw: "+h)}},i.sqlite3_create_function=function E(A,C,f,p,b,D,G,le){return E.length===arguments.length?i.sqlite3_create_function_v2(A,C,f,p,b,D,G,le,0):P(A,"sqlite3_create_function",E.length)},F?i.sqlite3_create_window_function=function E(A,C,f,p,b,D,G,le,ae,h){if(E.length!==arguments.length)return P(A,"sqlite3_create_window_function",E.length);if(!(p&15))p|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(p&15))return X(A);try{const o=F(A,C,f,p,b,D,G,le,ae,h);return o===0&&(D instanceof Function||G instanceof Function||le instanceof Function||ae instanceof Function||h instanceof Function)&&O.addWindowFunc(A,C,f),o}catch(o){return console.error("sqlite3_create_window_function() setup threw:",o),_.sqlite3__wasm_db_error(A,o,"Creation of UDF threw: "+o)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const g=(w,F)=>(typeof w=="string"?F=-1:_.isSQLableTypedArray(w)?(F=w.byteLength,w=r.typedArrayToString(w instanceof ArrayBuffer?new Uint8Array(w):w)):Array.isArray(w)&&(w=w.join(""),F=-1),[w,F]),q={basic:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function w(F,E,A,C,f,p){if(w.length!==arguments.length)return P(F,"sqlite3_prepare_v3",w.length);const[b,D]=g(E,Number(A));switch(typeof b){case"string":return q.basic(F,b,D,C,f,null);case typeof r.ptr.null:return q.full(F,r.ptr.coerce(b),D,C,f,p);default:return _.sqlite3__wasm_db_error(F,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof b)}},i.sqlite3_prepare_v2=function w(F,E,A,C,f){return w.length===arguments.length?i.sqlite3_prepare_v3(F,E,A,0,C,f):P(F,"sqlite3_prepare_v2",w.length)}}{const g=r.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),q=r.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function w(F,E,A,C,f){if(w.length!==arguments.length)return P(i.sqlite3_db_handle(F),"sqlite3_bind_text",w.length);if(r.isPtr(A)||A===null)return g(F,E,A,C,f);A instanceof ArrayBuffer?A=new Uint8Array(A):Array.isArray(pMem)&&(A=pMem.join(""));let p,b;try{if(_.isSQLableTypedArray(A))p=r.allocFromTypedArray(A),b=A.byteLength;else if(typeof A=="string")[p,b]=r.allocCString(A);else return _.sqlite3__wasm_db_error(i.sqlite3_db_handle(F),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return g(F,E,p,b,i.SQLITE_WASM_DEALLOC)}catch(D){return r.dealloc(p),_.sqlite3__wasm_db_error(i.sqlite3_db_handle(F),D)}},i.sqlite3_bind_blob=function w(F,E,A,C,f){if(w.length!==arguments.length)return P(i.sqlite3_db_handle(F),"sqlite3_bind_blob",w.length);if(r.isPtr(A)||A===null)return q(F,E,A,C,f);A instanceof ArrayBuffer?A=new Uint8Array(A):Array.isArray(A)&&(A=A.join(""));let p,b;try{if(_.isBindableTypedArray(A))p=r.allocFromTypedArray(A),b=C>=0?C:A.byteLength;else if(typeof A=="string")[p,b]=r.allocCString(A);else return _.sqlite3__wasm_db_error(i.sqlite3_db_handle(F),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return q(F,E,p,b,i.SQLITE_WASM_DEALLOC)}catch(D){return r.dealloc(p),_.sqlite3__wasm_db_error(i.sqlite3_db_handle(F),D)}}}i.sqlite3_config=function(g,...q){if(arguments.length<2)return i.SQLITE_MISUSE;switch(g){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return r.exports.sqlite3__wasm_config_i(g,q[0]);case i.SQLITE_CONFIG_LOOKASIDE:return r.exports.sqlite3__wasm_config_ii(g,q[0],q[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return r.exports.sqlite3__wasm_config_j(g,q[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const g=new Set;i.sqlite3_auto_extension=function(q){if(q instanceof Function)q=r.installFunction("i(ppp)",q);else if(arguments.length!==1||!r.isPtr(q))return i.SQLITE_MISUSE;const w=r.exports.sqlite3_auto_extension(q);return q!==arguments[0]&&(w===0?g.add(q):r.uninstallFunction(q)),w},i.sqlite3_cancel_auto_extension=function(q){return!q||arguments.length!==1||!r.isPtr(q)?0:r.exports.sqlite3_cancel_auto_extension(q)},i.sqlite3_reset_auto_extension=function(){r.exports.sqlite3_reset_auto_extension();for(const q of g)r.uninstallFunction(q);g.clear()}}const x=i.sqlite3_vfs_find("kvvfs");if(x)if(_.isUIThread()){const g=new i.sqlite3_kvvfs_methods(r.exports.sqlite3__wasm_kvvfs_methods());delete i.sqlite3_kvvfs_methods;const q=r.exports.sqlite3__wasm_kvvfsMakeKeyOnPstack,w=r.pstack,F=A=>r.peek(A)===115?sessionStorage:localStorage,E={xRead:(A,C,f,p)=>{const b=w.pointer,D=r.scopedAllocPush();try{const G=q(A,C);if(!G)return-3;const le=r.cstrToJs(G),ae=F(A).getItem(le);if(!ae)return-1;const h=ae.length;if(p<=0)return h;if(p===1)return r.poke(f,0),h;const o=r.scopedAllocCString(ae);return p>h+1&&(p=h+1),r.heap8u().copyWithin(Number(f),Number(o),r.ptr.addn(o,p,-1)),r.poke(r.ptr.add(f,p,-1),0),p-1}catch(G){return t.config.error("kvstorageRead()",G),-2}finally{w.restore(b),r.scopedAllocPop(D)}},xWrite:(A,C,f)=>{const p=w.pointer;try{const b=q(A,C);if(!b)return 1;const D=r.cstrToJs(b);return F(A).setItem(D,r.cstrToJs(f)),0}catch(b){return t.config.error("kvstorageWrite()",b),i.SQLITE_IOERR}finally{w.restore(p)}},xDelete:(A,C)=>{const f=w.pointer;try{const p=q(A,C);return p?(F(A).removeItem(r.cstrToJs(p)),0):1}catch(p){return t.config.error("kvstorageDelete()",p),i.SQLITE_IOERR}finally{w.restore(f)}}};for(const A of Object.keys(E))g[g.memberKey(A)]=r.installFunction(g.memberSignature(A),E[A])}else i.sqlite3_vfs_unregister(x);r.xWrap.FuncPtrAdapter.warnOnUse=!0;const L=t.StructBinder,Y=function g(q,w,F,E=g.installMethodArgcCheck){if(q instanceof L.StructType?!(F instanceof Function)&&!r.isPtr(F)&&c("Usage error: expecting a Function or WASM pointer to one."):c("Usage error: target object is-not-a StructType."),arguments.length===1)return(p,b)=>g(q,p,b,E);g.argcProxy||(g.argcProxy=function(p,b,D,G){return function(...le){return D.length!==arguments.length&&c("Argument mismatch for",p.structInfo.name+"::"+b+": Native signature is:",G),D.apply(this,le)}},g.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((p,b)=>{if(r.isPtr(p))try{r.uninstallFunction(p)}catch{}}),delete this.ondispose.__removeFuncList)});const A=q.memberSignature(w);A.length<2&&c("Member",w,"does not have a function pointer signature:",A);const C=q.memberKey(w),f=E&&!r.isPtr(F)?g.argcProxy(q,C,F,A):F;if(r.isPtr(f))f&&!r.functionEntry(f)&&c("Pointer",f,"is not a WASM function table entry."),q[C]=f;else{const p=r.installFunction(f,q.memberSignature(w));q[C]=p,(!q.ondispose||!q.ondispose.__removeFuncList)&&(q.addOnDispose("ondispose.__removeFuncList handler",g.removeFuncList),q.ondispose.__removeFuncList=[]),q.ondispose.__removeFuncList.push(C,p)}return(p,b)=>g(q,p,b,E)};Y.installMethodArgcCheck=!1;const W=function(g,q,w=Y.installMethodArgcCheck){const F=new Map;for(const E of Object.keys(q)){const A=q[E],C=F.get(A);if(C){const f=g.memberKey(E);g[f]=g[g.memberKey(C)]}else Y(g,E,A,w),F.set(A,E)}return g};L.StructType.prototype.installMethod=function(q,w,F=Y.installMethodArgcCheck){return arguments.length<3&&q&&typeof q=="object"?W(this,...arguments):Y(this,...arguments)},L.StructType.prototype.installMethods=function(g,q=Y.installMethodArgcCheck){return W(this,g,q)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){t.version={libVersion:"3.51.0",libVersionNumber:3051e3,sourceId:"2025-11-04 19:38:17 fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",downloadVersion:351e4,scm:{"sha3-256":"fb2c931ae597f8d00a37574ff67aeed3eced4e5547f9120744ae4bfa8e74527b",branch:"trunk",tags:"release major-release version-3.51.0",datetime:"2025-11-04T19:38:17.314Z"}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=(...h)=>{throw new t.SQLite3Error(...h)},i=t.capi,r=t.wasm,_=t.util,T=new WeakMap,P=new Set,X=new WeakMap,B=(h,o,l)=>{const d=Object.getOwnPropertyDescriptor(h,o);return d?d.value:l},I=function(h,o){return o&&(h instanceof Y&&(h=h.pointer),c(o,"sqlite3 result code",o+":",h?i.sqlite3_errmsg(h):i.sqlite3_errstr(o))),arguments[0]},O=r.installFunction("i(ippp)",(function(h,o,l,d){i.SQLITE_TRACE_STMT===h&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+o+":",r.cstrToJs(d))}).bind({counter:0})),x=Object.create(null),L=function h(...o){if(!h._name2vfs){h._name2vfs=Object.create(null);const m=typeof importScripts=="function"?M=>c("The VFS for",M,"is only available in the main window thread."):!1;h._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:m||(()=>"local")},h._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:m||(()=>"session")}}const l=h.normalizeArgs(...o);let d;if(d=l["sqlite3*"])l["sqlite3*:takeOwnership"]||P.add(this),this.filename=i.sqlite3_db_filename(d,"main");else{let m=l.filename,M=l.vfs,V=l.flags;(typeof m!="string"&&!r.isPtr(m)||typeof V!="string"||M&&typeof M!="string"&&!r.isPtr(M))&&(t.config.error("Invalid DB ctor args",l,arguments),c("Invalid arguments for DB constructor:",arguments,"opts:",l));let oe=r.isPtr(m)?r.cstrToJs(m):m;const K=h._name2vfs[oe];K&&(M=K.vfs,m=oe=K.filename(oe));let de=0;V.indexOf("c")>=0&&(de|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),V.indexOf("w")>=0&&(de|=i.SQLITE_OPEN_READWRITE),de===0&&(de|=i.SQLITE_OPEN_READONLY),de|=i.SQLITE_OPEN_EXRESCODE;const ce=r.pstack.pointer;try{const ve=r.pstack.allocPtr();let ye=i.sqlite3_open_v2(m,ve,de,M||r.ptr.null);d=r.peekPtr(ve),I(d,ye),i.sqlite3_extended_result_codes(d,1),V.indexOf("t")>=0&&i.sqlite3_trace_v2(d,i.SQLITE_TRACE_STMT,O,d)}catch(ve){throw d&&i.sqlite3_close_v2(d),ve}finally{r.pstack.restore(ce)}this.filename=oe}if(T.set(this,d),X.set(this,Object.create(null)),!l["sqlite3*"])try{const m=i.sqlite3_js_db_vfs(d)||c("Internal error: cannot get VFS for new db handle."),M=x[m];M&&(M instanceof Function?M(this,t):I(d,i.sqlite3_exec(d,M,0,0,0)))}catch(m){throw this.close(),m}};L.setVfsPostOpenCallback=function(h,o){o instanceof Function||c("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),x[h]=o},L.normalizeArgs=function(h=":memory:",o="c",l=null){const d={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(d,arguments[0]),d.flags===void 0&&(d.flags="c"),d.vfs===void 0&&(d.vfs=null),d.filename===void 0&&(d.filename=":memory:")):(d.filename=h,d.flags=o,d.vfs=l),d};const Y=function(...h){L.apply(this,h)};Y.dbCtorHelper=L;const W={null:1,number:2,string:3,boolean:4,blob:5};r.bigIntEnabled&&(W.bigint=W.number);const g=function(){W!==arguments[2]&&c(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],T.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&P.add(this)},q=function(h){return h.pointer||c("DB has been closed."),h},w=function(h,o){return(o!==(o|0)||o<0||o>=h.columnCount)&&c("Column index",o,"is out of range."),h},F=function(h,o){const l=Object.create(null);switch(l.opt=Object.create(null),o.length){case 1:typeof o[0]=="string"||_.isSQLableTypedArray(o[0])||Array.isArray(o[0])?l.sql=o[0]:o[0]&&typeof o[0]=="object"&&(l.opt=o[0],l.sql=l.opt.sql);break;case 2:l.sql=o[0],l.opt=o[1];break;default:c("Invalid argument count for exec().")}l.sql=_.flexibleString(l.sql),typeof l.sql!="string"&&c("Missing SQL argument or unsupported SQL value type.");const d=l.opt;switch(d.returnValue){case"resultRows":d.resultRows||(d.resultRows=[]),l.returnVal=()=>d.resultRows;break;case"saveSql":d.saveSql||(d.saveSql=[]),l.returnVal=()=>d.saveSql;break;case void 0:case"this":l.returnVal=()=>h;break;default:c("Invalid returnValue value:",d.returnValue)}if(!d.callback&&!d.returnValue&&d.rowMode!==void 0&&(d.resultRows||(d.resultRows=[]),l.returnVal=()=>d.resultRows),d.callback||d.resultRows)switch(d.rowMode===void 0?"array":d.rowMode){case"object":l.cbArg=(m,M)=>{M.columnNames||(M.columnNames=m.getColumnNames([]));const V=m.get([]),oe=Object.create(null);for(const K in M.columnNames)oe[M.columnNames[K]]=V[K];return oe};break;case"array":l.cbArg=m=>m.get([]);break;case"stmt":Array.isArray(d.resultRows)&&c("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),l.cbArg=m=>m;break;default:if(_.isInt32(d.rowMode)){l.cbArg=m=>m.get(d.rowMode);break}else if(typeof d.rowMode=="string"&&d.rowMode.length>1&&d.rowMode[0]==="$"){const m=d.rowMode.substr(1);l.cbArg=M=>{const V=M.get(Object.create(null))[m];return V===void 0?c(i.SQLITE_NOTFOUND,"exec(): unknown result column:",m):V};break}c("Invalid rowMode:",d.rowMode)}return l},E=(h,o,l,...d)=>{const m=h.prepare(o);try{const M=m.bind(l).step()?m.get(...d):void 0;return m.reset(),M}finally{m.finalize()}},A=(h,o,l,d)=>h.exec({sql:o,bind:l,rowMode:d,returnValue:"resultRows"});Y.checkRc=(h,o)=>I(h,o),Y.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return q(this)},close:function(){const h=this.pointer;if(h){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(X.get(this)).forEach((o,l)=>{if(l&&l.pointer)try{l.finalize()}catch{}}),T.delete(this),X.delete(this),P.delete(this)||i.sqlite3_close_v2(h),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(h=!1,o=!1){const l=q(this).pointer;return h?o?i.sqlite3_total_changes64(l):i.sqlite3_total_changes(l):o?i.sqlite3_changes64(l):i.sqlite3_changes(l)},dbFilename:function(h="main"){return i.sqlite3_db_filename(q(this).pointer,h)},dbName:function(h=0){return i.sqlite3_db_name(q(this).pointer,h)},dbVfsName:function(h=0){let o;const l=i.sqlite3_js_db_vfs(q(this).pointer,h);if(l){const d=new i.sqlite3_vfs(l);try{o=r.cstrToJs(d.$zName)}finally{d.dispose()}}return o},prepare:function(h){q(this);const o=r.pstack.pointer;let l,d;try{l=r.pstack.alloc(8),Y.checkRc(this,i.sqlite3_prepare_v2(this.pointer,h,-1,l,null)),d=r.peekPtr(l)}finally{r.pstack.restore(o)}d||c("Cannot prepare empty SQL.");const m=new g(this,d,W);return X.get(this)[d]=m,m},exec:function(){q(this);const h=F(this,arguments);if(!h.sql)return c("exec() requires an SQL string.");const o=h.opt,l=o.callback,d=Array.isArray(o.resultRows)?o.resultRows:void 0;let m,M=o.bind,V=!!(h.cbArg||o.columnNames||d);const oe=r.scopedAllocPush(),K=Array.isArray(o.saveSql)?o.saveSql:void 0;try{const de=_.isSQLableTypedArray(h.sql);let ce=de?h.sql.byteLength:r.jstrlen(h.sql);const ve=r.scopedAlloc(2*r.ptr.size+(ce+1)),ye=r.ptr.add(ve,r.ptr.size);let Ie=r.ptr.add(ye,r.ptr.size);const Re=r.ptr.add(Ie,ce);for(de?r.heap8().set(h.sql,Ie):r.jstrcpy(h.sql,r.heap8(),Ie,ce,!1),r.poke(r.ptr.add(Ie,ce),0);Ie&&r.peek(Ie,"i8");){r.pokePtr([ve,ye],0),Y.checkRc(this,i.sqlite3_prepare_v3(this.pointer,Ie,ce,0,ve,ye));const S=r.peekPtr(ve);if(Ie=r.peekPtr(ye),ce=Number(r.ptr.add(Re,-Ie)),!!S){if(K&&K.push(i.sqlite3_sql(S).trim()),m=new g(this,S,W),M&&m.parameterCount&&(m.bind(M),M=null),V&&m.columnCount){let z=Array.isArray(o.columnNames)?0:1;if(V=!1,h.cbArg||d){const U=Object.create(null);for(;m.step();D.delete(m)){z++===0&&m.getColumnNames(U.columnNames=o.columnNames||[]),D.add(m);const te=h.cbArg(m,U);if(d&&d.push(te),l&&l.call(o,te,m)===!1)break}D.delete(m)}z===0&&m.getColumnNames(o.columnNames)}else m.step();m.reset().finalize(),m=null}}}finally{r.scopedAllocPop(oe),m&&(D.delete(m),m.finalize())}return h.returnVal()},createFunction:function(o,l,d){const m=U=>U instanceof Function;switch(arguments.length){case 1:d=o,o=d.name,l=d.xFunc||0;break;case 2:m(l)||(d=l,l=d.xFunc||0);break}d||(d={}),typeof o!="string"&&c("Invalid arguments: missing function name.");let M=d.xStep||0,V=d.xFinal||0;const oe=d.xValue||0,K=d.xInverse||0;let de;m(l)?(de=!1,(m(M)||m(V))&&c("Ambiguous arguments: scalar or aggregate?"),M=V=null):m(M)?(m(V)||c("Missing xFinal() callback for aggregate or window UDF."),l=null):m(V)?c("Missing xStep() callback for aggregate or window UDF."):c("Missing function-type properties."),de===!1?(m(oe)||m(K))&&c("xValue and xInverse are not permitted for non-window UDFs."):m(oe)?(m(K)||c("xInverse must be provided if xValue is."),de=!0):m(K)&&c("xValue must be provided if xInverse is.");const ce=d.pApp;ce!=null&&!r.isPtr(ce)&&c("Invalid value for pApp property. Must be a legal WASM pointer value.");const ve=d.xDestroy||0;ve&&!m(ve)&&c("xDestroy property must be a function.");let ye=0;B(d,"deterministic")&&(ye|=i.SQLITE_DETERMINISTIC),B(d,"directOnly")&&(ye|=i.SQLITE_DIRECTONLY),B(d,"innocuous")&&(ye|=i.SQLITE_INNOCUOUS),o=o.toLowerCase();const Ie=l||M,Re=B(d,"arity"),S=typeof Re=="number"?Re:Ie.length?Ie.length-1:0;let z;return de?z=i.sqlite3_create_window_function(this.pointer,o,S,i.SQLITE_UTF8|ye,ce||0,M,V,oe,K,ve):z=i.sqlite3_create_function_v2(this.pointer,o,S,i.SQLITE_UTF8|ye,ce||0,l,M,V,ve),Y.checkRc(this,z),this},selectValue:function(h,o,l){return E(this,h,o,0,l)},selectValues:function(h,o,l){const d=this.prepare(h),m=[];try{for(d.bind(o);d.step();)m.push(d.get(0,l));d.reset()}finally{d.finalize()}return m},selectArray:function(h,o){return E(this,h,o,[])},selectObject:function(h,o){return E(this,h,o,{})},selectArrays:function(h,o){return A(this,h,o,"array")},selectObjects:function(h,o){return A(this,h,o,"object")},openStatementCount:function(){return this.pointer?Object.keys(X.get(this)).length:0},transaction:function(h){let o="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&c(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),o+=" "+arguments[0],h=arguments[1]),q(this).exec(o);try{const l=h(this);return this.exec("COMMIT"),l}catch(l){throw this.exec("ROLLBACK"),l}},savepoint:function(h){q(this).exec("SAVEPOINT oo1");try{const o=h(this);return this.exec("RELEASE oo1"),o}catch(o){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),o}},checkRc:function(h){return I(this,h)}},Y.wrapHandle=function(h,o=!1){if(!h||!r.isPtr(h))throw new t.SQLite3Error(i.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new Y({"sqlite3*":h,"sqlite3*:takeOwnership":!!o})};const C=function(h){return h.pointer||c("Stmt has been closed."),h},f=function(h){let o=W[h==null?"null":typeof h];switch(o){case W.boolean:case W.null:case W.number:case W.string:return o;case W.bigint:return r.bigIntEnabled?o:void 0;default:return _.isBindableTypedArray(h)?W.blob:void 0}},p=function(h){return f(h)||c("Unsupported bind() argument type:",typeof h)},b=function(h,o){const l=typeof o=="number"?o:i.sqlite3_bind_parameter_index(h.pointer,o);return l===0||!_.isInt32(l)?c("Invalid bind() parameter name: "+o):(l<1||l>h.parameterCount)&&c("Bind index",o,"is out of range."),l},D=new Set,G=new Set,le=function(h,o){return D.has(h)&&c("Operation is illegal when statement is locked:",o),h},ae=function h(o,l,d,m){le(C(o),"bind()"),h._||(h._tooBigInt=V=>c("BigInt value is too big to store without precision loss:",V),h._={string:function(V,oe,K,de){const[ce,ve]=r.allocCString(K,!0);return(de?i.sqlite3_bind_blob:i.sqlite3_bind_text)(V.pointer,oe,ce,ve,i.SQLITE_WASM_DEALLOC)}}),p(m),l=b(o,l);let M=0;switch(m==null?W.null:d){case W.null:M=i.sqlite3_bind_null(o.pointer,l);break;case W.string:M=h._.string(o,l,m,!1);break;case W.number:{let V;_.isInt32(m)?V=i.sqlite3_bind_int:typeof m=="bigint"?_.bigIntFits64(m)?r.bigIntEnabled?V=i.sqlite3_bind_int64:_.bigIntFitsDouble(m)?(m=Number(m),V=i.sqlite3_bind_double):h._tooBigInt(m):h._tooBigInt(m):(m=Number(m),r.bigIntEnabled&&Number.isInteger(m)?V=i.sqlite3_bind_int64:V=i.sqlite3_bind_double),M=V(o.pointer,l,m);break}case W.boolean:M=i.sqlite3_bind_int(o.pointer,l,m?1:0);break;case W.blob:{if(typeof m=="string"){M=h._.string(o,l,m,!0);break}else m instanceof ArrayBuffer?m=new Uint8Array(m):_.isBindableTypedArray(m)||c("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const V=r.alloc(m.byteLength||1);r.heap8().set(m.byteLength?m:[0],Number(V)),M=i.sqlite3_bind_blob(o.pointer,l,V,m.byteLength,i.SQLITE_WASM_DEALLOC);break}default:t.config.warn("Unsupported bind() argument type:",m),c("Unsupported bind() argument type: "+typeof m)}return M&&Y.checkRc(o.db.pointer,M),o};g.prototype={finalize:function(){const h=this.pointer;if(h){le(this,"finalize()");const o=P.delete(this)?0:i.sqlite3_finalize(h);return delete X.get(this.db)[h],T.delete(this),D.delete(this),G.delete(this),delete this.parameterCount,delete this.db,o}},clearBindings:function(){return le(C(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),G.delete(this),this},reset:function(h){le(this,"reset()"),h&&this.clearBindings();const o=i.sqlite3_reset(C(this).pointer);return G.delete(this),I(this.db,o),this},bind:function(){C(this);let h,o;switch(arguments.length){case 1:h=1,o=arguments[0];break;case 2:h=arguments[0],o=arguments[1];break;default:c("Invalid bind() arguments.")}return o===void 0?this:(this.parameterCount||c("This statement has no bindable parameters."),G.delete(this),o===null?ae(this,h,W.null,o):Array.isArray(o)?(arguments.length!==1&&c("When binding an array, an index argument is not permitted."),o.forEach((l,d)=>ae(this,d+1,p(l),l)),this):(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),typeof o=="object"&&!_.isBindableTypedArray(o)?(arguments.length!==1&&c("When binding an object, an index argument is not permitted."),Object.keys(o).forEach(l=>ae(this,l,p(o[l]),o[l])),this):ae(this,h,p(o),o)))},bindAsBlob:function(h,o){C(this),arguments.length===1&&(o=h,h=1);const l=p(o);return W.string!==l&&W.blob!==l&&W.null!==l&&c("Invalid value type for bindAsBlob()"),ae(this,h,W.blob,o)},step:function(){le(this,"step()");const h=i.sqlite3_step(C(this).pointer);switch(h){case i.SQLITE_DONE:return G.delete(this),!1;case i.SQLITE_ROW:return G.add(this),!0;default:G.delete(this),t.config.warn("sqlite3_step() rc=",h,i.sqlite3_js_rc_str(h),"SQL =",i.sqlite3_sql(this.pointer)),Y.checkRc(this.db.pointer,h)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const h=this.step();return this.reset(),h}finally{try{this.finalize()}catch{}}},get:function(h,o){if(G.has(C(this))||c("Stmt.step() has not (recently) returned true."),Array.isArray(h)){let l=0;const d=this.columnCount;for(;l<d;)h[l]=this.get(l++);return h}else if(h&&typeof h=="object"){let l=0;const d=this.columnCount;for(;l<d;)h[i.sqlite3_column_name(this.pointer,l)]=this.get(l++);return h}switch(w(this,h),o===void 0?i.sqlite3_column_type(this.pointer,h):o){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(r.bigIntEnabled){const l=i.sqlite3_column_int64(this.pointer,h);return l>=Number.MIN_SAFE_INTEGER&&l<=Number.MAX_SAFE_INTEGER?Number(l).valueOf():l}else{const l=i.sqlite3_column_double(this.pointer,h);return(l>Number.MAX_SAFE_INTEGER||l<Number.MIN_SAFE_INTEGER)&&c("Integer is out of range for JS integer range: "+l),_.isInt32(l)?l|0:l}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,h);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,h);case i.SQLITE_BLOB:{const l=i.sqlite3_column_bytes(this.pointer,h),d=i.sqlite3_column_blob(this.pointer,h),m=new Uint8Array(l);return l&&(m.set(r.heap8u().slice(Number(d),Number(d)+l),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(m.buffer)),m}default:c("Don't know how to translate","type of result column #"+h+".")}c("Not reached.")},getInt:function(h){return this.get(h,i.SQLITE_INTEGER)},getFloat:function(h){return this.get(h,i.SQLITE_FLOAT)},getString:function(h){return this.get(h,i.SQLITE_TEXT)},getBlob:function(h){return this.get(h,i.SQLITE_BLOB)},getJSON:function(h){const o=this.get(h,i.SQLITE_STRING);return o===null?o:JSON.parse(o)},getColumnName:function(h){return i.sqlite3_column_name(w(C(this),h).pointer,h)},getColumnNames:function(h=[]){w(C(this),0);const o=this.columnCount;for(let l=0;l<o;++l)h.push(i.sqlite3_column_name(this.pointer,l));return h},getParamIndex:function(h){return C(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,h):void 0},getParamName:function(h){return C(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,h):void 0},isBusy:function(){return i.sqlite3_stmt_busy(C(this))!==0},isReadOnly:function(){return i.sqlite3_stmt_readonly(C(this))!==0}};{const h={enumerable:!0,get:function(){return T.get(this)},set:()=>c("The pointer property is read-only.")};Object.defineProperty(g.prototype,"pointer",h),Object.defineProperty(Y.prototype,"pointer",h)}if(Object.defineProperty(g.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>c("The columnCount property is read-only.")}),Object.defineProperty(g.prototype,"parameterCount",{enumerable:!1,get:function(){return i.sqlite3_bind_parameter_count(this.pointer)},set:()=>c("The parameterCount property is read-only.")}),g.wrapHandle=function(h,o,l=!1){if(!(h instanceof Y)||!h.pointer)throw new t.SQLite3Error(t.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!o||!r.isPtr(o))throw new t.SQLite3Error(t.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new g(h,o,W,!!l)},t.oo1={DB:Y,Stmt:g},_.isUIThread()){t.oo1.JsStorageDb=function(o="session"){const l=L.normalizeArgs(...arguments);o=l.filename,o!=="session"&&o!=="local"&&c("JsStorageDb db name must be one of 'session' or 'local'."),l.vfs="kvvfs",L.call(this,l)};const h=t.oo1.JsStorageDb;h.prototype=Object.create(Y.prototype),h.clearStorage=i.sqlite3_js_kvvfs_clear,h.prototype.clearStorage=function(){return h.clearStorage(q(this).filename)},h.storageSize=i.sqlite3_js_kvvfs_size,h.prototype.storageSize=function(){return h.storageSize(q(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=t.util;t.initWorker1API=(function(){const i=(...x)=>{throw new Error(x.join(" "))};globalThis.WorkerGlobalScope instanceof Function||i("initWorker1API() must be run from a Worker thread.");const r=this.sqlite3||i("Missing this.sqlite3 object."),_=r.oo1.DB,T=function(x){let L=P.idMap.get(x);return L||(L="db#"+ ++P.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),P.idMap.set(x,L),L)},P={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(x){const L=new _(x);return this.dbs[T(L)]=L,this.dbList.indexOf(L)<0&&this.dbList.push(L),L},close:function(x,L){if(x){delete this.dbs[T(x)];const Y=x.filename,W=c.sqlite3__wasm_db_vfs(x.pointer,0);x.close();const g=this.dbList.indexOf(x);g>=0&&this.dbList.splice(g,1),L&&Y&&W&&c.sqlite3__wasm_vfs_unlink(W,Y)}},post:function(x,L){L&&L.length?(globalThis.postMessage(x,Array.from(L)),L.length=0):globalThis.postMessage(x)},dbs:Object.create(null),getDb:function(x,L=!0){return this.dbs[x]||(L?i("Unknown (or closed) DB ID:",x):void 0)}},X=function(x=P.dbList[0]){return x&&x.pointer?x:i("DB is not opened.")},B=function(x,L=!0){const Y=P.getDb(x.dbId,!1)||P.dbList[0];return L?X(Y):Y},I=function(){return P.dbList[0]&&T(P.dbList[0])},O={open:function(x){const L=Object.create(null),Y=x.args||Object.create(null);Y.simulateError&&i("Throwing because of simulateError flag.");const W=Object.create(null);L.vfs=Y.vfs,L.filename=Y.filename||"";const g=P.open(L);return W.filename=g.filename,W.persistent=!!r.capi.sqlite3_js_db_uses_vfs(g.pointer,"opfs"),W.dbId=T(g),W.vfs=g.dbVfsName(),W},close:function(x){const L=B(x,!1),Y={filename:L&&L.filename};if(L){const W=x.args&&typeof x.args=="object"?!!x.args.unlink:!1;P.close(L,W)}return Y},exec:function(x){const L=typeof x.args=="string"?{sql:x.args}:x.args||Object.create(null);L.rowMode==="stmt"?i("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):L.sql||i("'exec' requires input SQL.");const Y=B(x);(L.callback||Array.isArray(L.resultRows))&&(Y._blobXfer=P.xfer);const W=L.callback;let g=0;const q=!!L.columnNames;typeof W=="string"&&(q||(L.columnNames=[]),L.callback=function(w,F){P.post({type:W,columnNames:L.columnNames,rowNumber:++g,row:w},P.xfer)});try{const w=L.countChanges?Y.changes(!0,L.countChanges===64):void 0;Y.exec(L),w!==void 0&&(L.changeCount=Y.changes(!0,L.countChanges===64)-w);const F=L.lastInsertRowId?r.capi.sqlite3_last_insert_rowid(Y):void 0;F!==void 0&&(L.lastInsertRowId=F),L.callback instanceof Function&&(L.callback=W,P.post({type:W,columnNames:L.columnNames,rowNumber:null,row:void 0}))}finally{delete Y._blobXfer,L.callback&&(L.callback=W)}return L},"config-get":function(){const x=Object.create(null),L=r.config;return["bigIntEnabled"].forEach(function(Y){Object.getOwnPropertyDescriptor(L,Y)&&(x[Y]=L[Y])}),x.version=r.version,x.vfsList=r.capi.sqlite3_js_vfs_list(),x},export:function(x){const L=B(x),Y={byteArray:r.capi.sqlite3_js_db_export(L.pointer),filename:L.filename,mimetype:"application/x-sqlite3"};return P.xfer.push(Y.byteArray.buffer),Y},toss:function(x){i("Testing worker exception")}};globalThis.onmessage=async function(x){x=x.data;let L,Y=x.dbId,W=x.type;const g=performance.now();try{O.hasOwnProperty(W)&&O[W]instanceof Function?L=await O[W](x):i("Unknown db worker message type:",x.type)}catch(q){W="error",L={operation:x.type,message:q.message,errorClass:q.name,input:x},q.stack&&(L.stack=typeof q.stack=="string"?q.stack.split(/\n\s*/):q.stack)}Y||(Y=L.dbId||I()),P.post({type:W,dbId:Y,messageId:x.messageId,workerReceivedTime:g,workerRespondTime:performance.now(),departureTime:x.departureTime,result:L},P.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:t})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=t.wasm,i=t.capi,r=t.util.toss3,_=Object.create(null);t.vfs=_,i.sqlite3_vfs.prototype.registerVfs=function(T=!1){this instanceof t.capi.sqlite3_vfs||r("Expecting a sqlite3_vfs-type argument.");const P=i.sqlite3_vfs_register(this,T?1:0);return P&&r("sqlite3_vfs_register(",this,") failed with rc",P),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&r("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},_.installVfs=function(T){let P=0;const X=["io","vfs"];for(const B of X){const I=T[B];I&&(++P,I.struct.installMethods(I.methods,!!I.applyArgcCheck),B==="vfs"&&(!I.struct.$zName&&typeof I.name=="string"&&I.struct.addOnDispose(I.struct.$zName=c.allocCString(I.name)),I.struct.registerVfs(!!I.asDefault)))}return P||r("Misuse: installVfs() options object requires at least","one of:",X),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){if(!t.wasm.exports.sqlite3_declare_vtab)return;const c=t.wasm,i=t.capi,r=t.util.toss3,_=Object.create(null);t.vtab=_;const T=i.sqlite3_index_info;T.prototype.nthConstraint=function(B,I=!1){if(B<0||B>=this.$nConstraint)return!1;const O=c.ptr.add(this.$aConstraint,T.sqlite3_index_constraint.structInfo.sizeof*B);return I?O:new T.sqlite3_index_constraint(O)},T.prototype.nthConstraintUsage=function(B,I=!1){if(B<0||B>=this.$nConstraint)return!1;const O=c.ptr.add(this.$aConstraintUsage,T.sqlite3_index_constraint_usage.structInfo.sizeof*B);return I?O:new T.sqlite3_index_constraint_usage(O)},T.prototype.nthOrderBy=function(B,I=!1){if(B<0||B>=this.$nOrderBy)return!1;const O=c.ptr.add(this.$aOrderBy,T.sqlite3_index_orderby.structInfo.sizeof*B);return I?O:new T.sqlite3_index_orderby(O)};const P=function(B,I){return(function(O,x=!1){if(arguments.length===0&&(O=new I),O instanceof I)return this.set(O.pointer,O),O;c.isPtr(O)||t.SQLite3Error.toss("Invalid argument to",B+"()");let L=this.get(O);return x&&this.delete(O),L}).bind(new Map)},X=function(B,I){const O=P(B,I);return Object.assign(Object.create(null),{StructType:I,create:x=>{const L=O();return c.pokePtr(x,L.pointer),L},get:x=>O(x),unget:x=>O(x,!0),dispose:x=>{const L=O(x,!0);L&&L.dispose()}})};_.xVtab=X("xVtab",i.sqlite3_vtab),_.xCursor=X("xCursor",i.sqlite3_vtab_cursor),_.xIndexInfo=B=>new i.sqlite3_index_info(B),_.xError=function B(I,O,x){if(B.errorReporter instanceof Function)try{B.errorReporter("sqlite3_module::"+I+"(): "+O.message)}catch{}let L;return O instanceof t.WasmAllocError?L=i.SQLITE_NOMEM:arguments.length>2?L=x:O instanceof t.SQLite3Error&&(L=O.resultCode),L||i.SQLITE_ERROR},_.xError.errorReporter=t.config.error.bind(t.config),_.xRowid=(B,I)=>c.poke(B,I,"i64"),_.setupModule=function(B){let I=!1;const O=this instanceof i.sqlite3_module?this:B.struct||(I=new i.sqlite3_module);try{const x=B.methods||r("Missing 'methods' object.");for(const L of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const Y=L[0],W=L[1];x[Y]===!0?x[Y]=x[W]:x[W]===!0&&(x[W]=x[Y])}if(B.catchExceptions){const L=function(g,q){return["xConnect","xCreate"].indexOf(g)>=0?function(w,F,E,A,C,f){try{return q(...arguments)||0}catch(p){return p instanceof t.WasmAllocError||(c.dealloc(c.peekPtr(f)),c.pokePtr(f,c.allocCString(p.message))),_.xError(g,p)}}:function(...w){try{return q(...w)||0}catch(F){return _.xError(g,F)}}},Y=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],W=Object.create(null);for(const g of Y){const q=x[g];if(q instanceof Function)g==="xConnect"&&x.xCreate===q?W[g]=x.xCreate:g==="xCreate"&&x.xConnect===q?W[g]=x.xConnect:W[g]=L(g,q);else continue}O.installMethods(W,!1)}else O.installMethods(x,!!B.applyArgcCheck);if(O.$iVersion===0){let L;typeof B.iVersion=="number"?L=B.iVersion:O.$xIntegrity?L=4:O.$xShadowName?L=3:O.$xSavePoint||O.$xRelease||O.$xRollbackTo?L=2:L=1,O.$iVersion=L}}catch(x){throw I&&I.dispose(),x}return O},i.sqlite3_module.prototype.setupModule=function(B){return _.setupModule.call(this,B)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){const c=function i(r){var P;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((P=navigator==null?void 0:navigator.storage)!=null&&P.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!r||typeof r!="object")&&(r=Object.create(null));const _=new URL(globalThis.location.href).searchParams;return _.has("opfs-disable")?Promise.resolve(t):(r.verbose===void 0&&(r.verbose=_.has("opfs-verbose")?+_.get("opfs-verbose")||2:1),r.sanityChecks===void 0&&(r.sanityChecks=_.has("opfs-sanity-check")),r.proxyUri===void 0&&(r.proxyUri=i.defaultProxyUri),typeof r.proxyUri=="function"&&(r.proxyUri=r.proxyUri()),new Promise(function(X,B){const I=[t.config.error,t.config.warn,t.config.log],O=(S,...z)=>{r.verbose>S&&I[S]("OPFS syncer:",...z)},x=(...S)=>O(2,...S),L=(...S)=>O(1,...S),Y=(...S)=>O(0,...S),W=t.util.toss,g=t.capi,q=t.util,w=t.wasm,F=g.sqlite3_vfs,E=g.sqlite3_file,A=g.sqlite3_io_methods,C=Object.create(null),f=()=>{var S;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((S=navigator==null?void 0:navigator.storage)==null?void 0:S.getDirectory)};C.metrics={dump:function(){let S,z=0,U=0,te=0;for(S in l.opIds){const Z=d[S];z+=Z.count,U+=Z.time,te+=Z.wait,Z.avgTime=Z.count&&Z.time?Z.time/Z.count:0,Z.avgWait=Z.count&&Z.wait?Z.wait/Z.count:0}t.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",d,`
Total of`,z,"op(s) for",U,"ms (incl. "+te+" ms of waiting on the async side)"),t.config.log("Serialization metrics:",d.s11n),ae.postMessage({type:"opfs-async-metrics"})},reset:function(){let S;const z=te=>te.count=te.time=te.wait=0;for(S in l.opIds)z(d[S]=Object.create(null));let U=d.s11n=Object.create(null);U=U.serialize=Object.create(null),U.count=U.time=0,U=d.s11n.deserialize=Object.create(null),U.count=U.time=0}};const p=new A,b=new F().addOnDispose(()=>p.dispose());let D;const G=S=>(D=!0,b.dispose(),B(S)),le=()=>(D=!1,X(t)),ae=new Worker(new URL(r.proxyUri,import.meta.url));setTimeout(()=>{D===void 0&&G(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),ae._originalOnError=ae.onerror,ae.onerror=function(S){Y("Error initializing OPFS asyncer:",S),G(new Error("Loading OPFS async Worker failed for unknown reasons."))};const h=g.sqlite3_vfs_find(null),o=h?new F(h):null;p.$iVersion=1,b.$iVersion=2,b.$szOsFile=g.sqlite3_file.structInfo.sizeof,b.$mxPathname=1024,b.$zName=w.allocCString("opfs"),b.$xDlOpen=b.$xDlError=b.$xDlSym=b.$xDlClose=null,b.addOnDispose("$zName",b.$zName,"cleanup default VFS wrapper",()=>o?o.dispose():null);const l=Object.create(null);l.verbose=r.verbose,l.littleEndian=(()=>{const S=new ArrayBuffer(2);return new DataView(S).setInt16(0,256,!0),new Int16Array(S)[0]===256})(),l.asyncIdleWaitTime=150,l.asyncS11nExceptions=1,l.fileBufferSize=1024*64,l.sabS11nOffset=l.fileBufferSize,l.sabS11nSize=b.$mxPathname*2,l.sabIO=new SharedArrayBuffer(l.fileBufferSize+l.sabS11nSize),l.opIds=Object.create(null);const d=Object.create(null);{let S=0;l.opIds.whichOp=S++,l.opIds.rc=S++,l.opIds.xAccess=S++,l.opIds.xClose=S++,l.opIds.xDelete=S++,l.opIds.xDeleteNoWait=S++,l.opIds.xFileSize=S++,l.opIds.xLock=S++,l.opIds.xOpen=S++,l.opIds.xRead=S++,l.opIds.xSleep=S++,l.opIds.xSync=S++,l.opIds.xTruncate=S++,l.opIds.xUnlock=S++,l.opIds.xWrite=S++,l.opIds.mkdir=S++,l.opIds["opfs-async-metrics"]=S++,l.opIds["opfs-async-shutdown"]=S++,l.opIds.retry=S++,l.sabOP=new SharedArrayBuffer(S*4),C.metrics.reset()}l.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(S=>{(l.sq3Codes[S]=g[S])===void 0&&W("Maintenance required: not found:",S)}),l.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const m=(S,...z)=>{const U=l.opIds[S]||W("Invalid op ID:",S);l.s11n.serialize(...z),Atomics.store(l.sabOPView,l.opIds.rc,-1),Atomics.store(l.sabOPView,l.opIds.whichOp,U),Atomics.notify(l.sabOPView,l.opIds.whichOp);const te=performance.now();for(;Atomics.wait(l.sabOPView,l.opIds.rc,-1)!=="not-equal";);const Z=Atomics.load(l.sabOPView,l.opIds.rc);if(d[S].wait+=performance.now()-te,Z&&l.asyncS11nExceptions){const pe=l.s11n.deserialize();pe&&Y(S+"() async error:",...pe)}return Z};C.debug={asyncShutdown:()=>{L("Shutting down OPFS async listener. The OPFS VFS will no longer work."),m("opfs-async-shutdown")},asyncRestart:()=>{L("Attempting to restart OPFS VFS async listener. Might work, might not."),ae.postMessage({type:"opfs-async-restart"})}};const M=()=>{if(l.s11n)return l.s11n;const S=new TextDecoder,z=new TextEncoder("utf-8"),U=new Uint8Array(l.sabIO,l.sabS11nOffset,l.sabS11nSize),te=new DataView(l.sabIO,l.sabS11nOffset,l.sabS11nSize);l.s11n=Object.create(null);const Z=Object.create(null);Z.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},Z.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},Z.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},Z.string={id:4};const pe=R=>Z[typeof R]||W("Maintenance required: this value type cannot be serialized.",R),ue=R=>{switch(R){case Z.number.id:return Z.number;case Z.bigint.id:return Z.bigint;case Z.boolean.id:return Z.boolean;case Z.string.id:return Z.string;default:W("Invalid type ID:",R)}};return l.s11n.deserialize=function(R=!1){++d.s11n.deserialize.count;const y=performance.now(),N=U[0],Q=N?[]:null;if(N){const $=[];let ee=1,he,Ee,k;for(he=0;he<N;++he,++ee)$.push(ue(U[ee]));for(he=0;he<N;++he){const J=$[he];J.getter?(k=te[J.getter](ee,l.littleEndian),ee+=J.size):(Ee=te.getInt32(ee,l.littleEndian),ee+=4,k=S.decode(U.slice(ee,ee+Ee)),ee+=Ee),Q.push(k)}}return R&&(U[0]=0),d.s11n.deserialize.time+=performance.now()-y,Q},l.s11n.serialize=function(...R){const y=performance.now();if(++d.s11n.serialize.count,R.length){const N=[];let Q=0,$=1;for(U[0]=R.length&255;Q<R.length;++Q,++$)N.push(pe(R[Q])),U[$]=N[Q].id;for(Q=0;Q<R.length;++Q){const ee=N[Q];if(ee.setter)te[ee.setter]($,R[Q],l.littleEndian),$+=ee.size;else{const he=z.encode(R[Q]);te.setInt32($,he.byteLength,l.littleEndian),$+=4,U.set(he,$),$+=he.byteLength}}}else U[0]=0;d.s11n.serialize.time+=performance.now()-y},l.s11n},V=function S(z=16){S._chars||(S._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",S._n=S._chars.length);const U=[];let te=0;for(;te<z;++te){const Z=Math.random()*(S._n*64)%S._n|0;U[te]=S._chars[Z]}return U.join("")},oe=Object.create(null),K=Object.create(null);K.op=void 0,K.start=void 0;const de=S=>{K.start=performance.now(),K.op=S,++d[S].count},ce=()=>d[K.op].time+=performance.now()-K.start,ve={xCheckReservedLock:function(S,z){return w.poke(z,0,"i32"),0},xClose:function(S){de("xClose");let z=0;const U=oe[S];return U&&(delete oe[S],z=m("xClose",S),U.sq3File&&U.sq3File.dispose()),ce(),z},xDeviceCharacteristics:function(S){return g.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(S,z,U){return g.SQLITE_NOTFOUND},xFileSize:function(S,z){de("xFileSize");let U=m("xFileSize",S);if(U==0)try{const te=l.s11n.deserialize()[0];w.poke(z,te,"i64")}catch(te){Y("Unexpected error reading xFileSize() result:",te),U=l.sq3Codes.SQLITE_IOERR}return ce(),U},xLock:function(S,z){de("xLock");const U=oe[S];let te=0;return U.lockType?U.lockType=z:(te=m("xLock",S,z),te===0&&(U.lockType=z)),ce(),te},xRead:function(S,z,U,te){de("xRead");const Z=oe[S];let pe;try{pe=m("xRead",S,U,Number(te)),(pe===0||g.SQLITE_IOERR_SHORT_READ===pe)&&w.heap8u().set(Z.sabView.subarray(0,U),Number(z))}catch(ue){Y("xRead(",arguments,") failed:",ue,Z),pe=g.SQLITE_IOERR_READ}return ce(),pe},xSync:function(S,z){de("xSync"),++d.xSync.count;const U=m("xSync",S,z);return ce(),U},xTruncate:function(S,z){de("xTruncate");const U=m("xTruncate",S,Number(z));return ce(),U},xUnlock:function(S,z){de("xUnlock");const U=oe[S];let te=0;return g.SQLITE_LOCK_NONE===z&&U.lockType&&(te=m("xUnlock",S,z)),te===0&&(U.lockType=z),ce(),te},xWrite:function(S,z,U,te){de("xWrite");const Z=oe[S];let pe;try{Z.sabView.set(w.heap8u().subarray(Number(z),Number(z)+U)),pe=m("xWrite",S,U,Number(te))}catch(ue){Y("xWrite(",arguments,") failed:",ue,Z),pe=g.SQLITE_IOERR_WRITE}return ce(),pe}},ye={xAccess:function(S,z,U,te){de("xAccess");const Z=m("xAccess",w.cstrToJs(z));return w.poke(te,Z?0:1,"i32"),ce(),0},xCurrentTime:function(S,z){return w.poke(z,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(S,z){return w.poke(z,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(S,z,U){de("xDelete");const te=m("xDelete",w.cstrToJs(z),U,!1);return ce(),te},xFullPathname:function(S,z,U,te){return w.cstrncpy(te,z,U)<U?0:g.SQLITE_CANTOPEN},xGetLastError:function(S,z,U){return L("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(z,U,te,Z,pe){de("xOpen");let ue=0;U===0?U=V():w.isPtr(U)&&(g.sqlite3_uri_boolean(U,"opfs-unlock-asap",0)&&(ue|=l.opfsFlags.OPFS_UNLOCK_ASAP),g.sqlite3_uri_boolean(U,"delete-before-open",0)&&(ue|=l.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),U=w.cstrToJs(U));const R=Object.create(null);R.fid=te,R.filename=U,R.sab=new SharedArrayBuffer(l.fileBufferSize),R.flags=Z,R.readOnly=!(t.SQLITE_OPEN_CREATE&Z)&&!!(Z&g.SQLITE_OPEN_READONLY);const y=m("xOpen",te,U,Z,ue);return y||(R.readOnly&&w.poke(pe,g.SQLITE_OPEN_READONLY,"i32"),oe[te]=R,R.sabView=l.sabFileBufView,R.sq3File=new E(te),R.sq3File.$pMethods=p.pointer,R.lockType=g.SQLITE_LOCK_NONE),ce(),y}};o&&(b.$xRandomness=o.$xRandomness,b.$xSleep=o.$xSleep),b.$xRandomness||(ye.xRandomness=function(S,z,U){const te=w.heap8u();let Z=0;const pe=Number(U);for(;Z<z;++Z)te[pe+Z]=Math.random()*255e3&255;return Z}),b.$xSleep||(ye.xSleep=function(S,z){return Atomics.wait(l.sabOPView,l.opIds.xSleep,0,z),0}),C.getResolvedPath=function(S,z){const U=new URL(S,"file://irrelevant").pathname;return z?U.split("/").filter(te=>!!te):U},C.getDirForFilename=async function(z,U=!1){const te=C.getResolvedPath(z,!0),Z=te.pop();let pe=C.rootDirectory;for(const ue of te)ue&&(pe=await pe.getDirectoryHandle(ue,{create:!!U}));return[pe,Z]},C.mkdir=async function(S){try{return await C.getDirForFilename(S+"/filepart",!0),!0}catch{return!1}},C.entryExists=async function(S){try{const[z,U]=await C.getDirForFilename(S);return await z.getFileHandle(U),!0}catch{return!1}},C.randomFilename=V,C.treeList=async function(){const S=async function U(te,Z){Z.name=te.name,Z.dirs=[],Z.files=[];for await(const pe of te.values())if(pe.kind==="directory"){const ue=Object.create(null);Z.dirs.push(ue),await U(pe,ue)}else Z.files.push(pe.name)},z=Object.create(null);return await S(C.rootDirectory,z),z},C.rmfr=async function(){const S=C.rootDirectory,z={recurse:!0};for await(const U of S.values())S.removeEntry(U.name,z)},C.unlink=async function(S,z=!1,U=!1){try{const[te,Z]=await C.getDirForFilename(S,!1);return await te.removeEntry(Z,{recursive:z}),!0}catch(te){if(U)throw new Error("unlink(",arguments[0],") failed: "+te.message,{cause:te});return!1}},C.traverse=async function(S){const z={recursive:!0,directory:C.rootDirectory};typeof S=="function"&&(S={callback:S}),S=Object.assign(z,S||{}),async function te(Z,pe){for await(const ue of Z.values()){if(S.callback(ue,Z,pe)===!1)return!1;if(S.recursive&&ue.kind==="directory"&&await te(ue,pe+1)===!1)break}}(S.directory,0)};const Ie=async function(S,z){const[U,te]=await C.getDirForFilename(S,!0);let pe=await(await U.getFileHandle(te,{create:!0})).createSyncAccessHandle(),ue=0,R,y=!1;try{for(pe.truncate(0);(R=await z())!==void 0;)R instanceof ArrayBuffer&&(R=new Uint8Array(R)),!y&&ue===0&&R.byteLength>=15&&(q.affirmDbHeader(R),y=!0),pe.write(R,{at:ue}),ue+=R.byteLength;if((ue<512||ue%512!==0)&&W("Input size",ue,"is not correct for an SQLite database."),!y){const N=new Uint8Array(20);pe.read(N,{at:0}),q.affirmDbHeader(N)}return pe.write(new Uint8Array([1,1]),{at:18}),ue}catch(N){throw await pe.close(),pe=void 0,await U.removeEntry(te).catch(()=>{}),N}finally{pe&&await pe.close()}};if(C.importDb=async function(S,z){if(z instanceof Function)return Ie(S,z);z instanceof ArrayBuffer&&(z=new Uint8Array(z)),q.affirmIsDb(z);const U=z.byteLength,[te,Z]=await C.getDirForFilename(S,!0);let pe,ue=0;try{return pe=await(await te.getFileHandle(Z,{create:!0})).createSyncAccessHandle(),pe.truncate(0),ue=pe.write(z,{at:0}),ue!=U&&W("Expected to write "+U+" bytes but wrote "+ue+"."),pe.write(new Uint8Array([1,1]),{at:18}),ue}catch(R){throw pe&&(await pe.close(),pe=void 0),await te.removeEntry(Z).catch(()=>{}),R}finally{pe&&await pe.close()}},t.oo1){const S=function(...z){const U=t.oo1.DB.dbCtorHelper.normalizeArgs(...z);U.vfs=b.$zName,t.oo1.DB.dbCtorHelper.call(this,U)};S.prototype=Object.create(t.oo1.DB.prototype),t.oo1.OpfsDb=S,S.importDb=C.importDb,t.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(b.pointer,function(z,U){U.capi.sqlite3_busy_timeout(z,1e4)})}const Re=function(){const S=w.scopedAllocPush(),z=new E;try{const U=z.pointer,te=g.SQLITE_OPEN_CREATE|g.SQLITE_OPEN_READWRITE|g.SQLITE_OPEN_MAIN_DB,Z=w.scopedAlloc(8),pe="/sanity/check/file"+V(8),ue=w.scopedAllocCString(pe);let R;if(l.s11n.serialize("This is  string."),R=l.s11n.deserialize(),x("deserialize() says:",R),R[0]!=="This is  string."&&W("String d13n error."),ye.xAccess(b.pointer,ue,0,Z),R=w.peek(Z,"i32"),x("xAccess(",pe,") exists ?=",R),R=ye.xOpen(b.pointer,ue,U,te,Z),x("open rc =",R,"state.sabOPView[xOpen] =",l.sabOPView[l.opIds.xOpen]),R!==0){Y("open failed with code",R);return}ye.xAccess(b.pointer,ue,0,Z),R=w.peek(Z,"i32"),R||W("xAccess() failed to detect file."),R=ve.xSync(z.pointer,0),R&&W("sync failed w/ rc",R),R=ve.xTruncate(z.pointer,1024),R&&W("truncate failed w/ rc",R),w.poke(Z,0,"i64"),R=ve.xFileSize(z.pointer,Z),R&&W("xFileSize failed w/ rc",R),x("xFileSize says:",w.peek(Z,"i64")),R=ve.xWrite(z.pointer,ue,10,1),R&&W("xWrite() failed!");const y=w.scopedAlloc(16);R=ve.xRead(z.pointer,y,6,2),w.poke(y+6,0);let N=w.cstrToJs(y);x("xRead() got:",N),N!=="sanity"&&W("Unexpected xRead() value."),ye.xSleep&&(x("xSleep()ing before close()ing..."),ye.xSleep(b.pointer,2e3),x("waking up from xSleep()")),R=ve.xClose(U),x("xClose rc =",R,"sabOPView =",l.sabOPView),x("Deleting file:",pe),ye.xDelete(b.pointer,ue,4660),ye.xAccess(b.pointer,ue,0,Z),R=w.peek(Z,"i32"),R&&W("Expecting 0 from xAccess(",pe,") after xDelete()."),L("End of OPFS sanity checks.")}finally{z.dispose(),w.scopedAllocPop(S)}};ae.onmessage=function({data:S}){switch(S.type){case"opfs-unavailable":G(new Error(S.payload.join(" ")));break;case"opfs-async-loaded":ae.postMessage({type:"opfs-async-init",args:l});break;case"opfs-async-inited":{if(D===!0)break;try{t.vfs.installVfs({io:{struct:p,methods:ve},vfs:{struct:b,methods:ye}}),l.sabOPView=new Int32Array(l.sabOP),l.sabFileBufView=new Uint8Array(l.sabIO,0,l.fileBufferSize),l.sabS11nView=new Uint8Array(l.sabIO,l.sabS11nOffset,l.sabS11nSize),M(),r.sanityChecks&&(L("Running sanity checks because of opfs-sanity-check URL arg..."),Re()),f()?navigator.storage.getDirectory().then(z=>{ae.onerror=ae._originalOnError,delete ae._originalOnError,t.opfs=C,C.rootDirectory=z,x("End of OPFS sqlite3_vfs setup.",b),le()}).catch(G):le()}catch(z){Y(z),G(z)}break}default:{const z="Unexpected message from the OPFS async worker: "+JSON.stringify(S);Y(z),G(new Error(z));break}}}}))};c.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async i=>{try{let r=c.defaultProxyUri;return i.scriptInfo.sqlite3Dir&&(c.defaultProxyUri=i.scriptInfo.sqlite3Dir+r),c().catch(_=>{i.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",_.message)})}catch(r){return i.config.error("installOpfsVfs() exception:",r),Promise.reject(r)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(t){var K,de,ce,ve,ye,Ie,Re,S,z,U,te,Z,mt,ue;const c=t.util.toss,i=t.util.toss3,r=Object.create(null),_=t.capi,T=t.util,P=t.wasm,X=4096,B=512,I=4,O=8,x=B+I,L=B,Y=x,W=X,g=_.SQLITE_OPEN_MAIN_DB|_.SQLITE_OPEN_MAIN_JOURNAL|_.SQLITE_OPEN_SUPER_JOURNAL|_.SQLITE_OPEN_WAL,q=_.SQLITE_OPEN_MEMORY,w=".opaque",F=()=>Math.random().toString(36).slice(2),E=new TextDecoder,A=new TextEncoder,C=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),f=[t.config.error,t.config.warn,t.config.log];t.config.log;const p=t.config.warn;t.config.error;const b=new Map,D=R=>b.get(R),G=(R,y)=>{y?b.set(R,y):b.delete(R)},le=new Map,ae=R=>le.get(R),h=(R,y)=>{y?le.set(R,y):le.delete(R)},o={xCheckReservedLock:function(R,y){const N=ae(R);return N.log("xCheckReservedLock"),N.storeErr(),P.poke32(y,1),0},xClose:function(R){const y=ae(R);y.storeErr();const N=y.getOFileForS3File(R);if(N)try{y.log(`xClose ${N.path}`),y.mapS3FileToOFile(R,!1),N.sah.flush(),N.flags&_.SQLITE_OPEN_DELETEONCLOSE&&y.deletePath(N.path)}catch(Q){return y.storeErr(Q,_.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(R){return _.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(R,y,N){return _.SQLITE_NOTFOUND},xFileSize:function(R,y){const N=ae(R);N.log("xFileSize");const $=N.getOFileForS3File(R).sah.getSize()-W;return P.poke64(y,BigInt($)),0},xLock:function(R,y){const N=ae(R);N.log(`xLock ${y}`),N.storeErr();const Q=N.getOFileForS3File(R);return Q.lockType=y,0},xRead:function(R,y,N,Q){const $=ae(R);$.storeErr();const ee=$.getOFileForS3File(R);$.log(`xRead ${ee.path} ${N} @ ${Q}`);try{const he=ee.sah.read(P.heap8u().subarray(Number(y),Number(y)+N),{at:W+Number(Q)});return he<N?(P.heap8u().fill(0,Number(y)+he,Number(y)+N),_.SQLITE_IOERR_SHORT_READ):0}catch(he){return $.storeErr(he,_.SQLITE_IOERR)}},xSectorSize:function(R){return X},xSync:function(R,y){const N=ae(R);N.log(`xSync ${y}`),N.storeErr();const Q=N.getOFileForS3File(R);try{return Q.sah.flush(),0}catch($){return N.storeErr($,_.SQLITE_IOERR)}},xTruncate:function(R,y){const N=ae(R);N.log(`xTruncate ${y}`),N.storeErr();const Q=N.getOFileForS3File(R);try{return Q.sah.truncate(W+Number(y)),0}catch($){return N.storeErr($,_.SQLITE_IOERR)}},xUnlock:function(R,y){const N=ae(R);N.log("xUnlock");const Q=N.getOFileForS3File(R);return Q.lockType=y,0},xWrite:function(R,y,N,Q){const $=ae(R);$.storeErr();const ee=$.getOFileForS3File(R);$.log(`xWrite ${ee.path} ${N} ${Q}`);try{const he=ee.sah.write(P.heap8u().subarray(Number(y),Number(y)+N),{at:W+Number(Q)});return N===he?0:c("Unknown write() failure.")}catch(he){return $.storeErr(he,_.SQLITE_IOERR)}}},l=new _.sqlite3_io_methods;l.$iVersion=1,t.vfs.installVfs({io:{struct:l,methods:o}});const d={xAccess:function(R,y,N,Q){const $=D(R);$.storeErr();try{const ee=$.getPath(y);P.poke32(Q,$.hasFilename(ee)?1:0)}catch{P.poke32(Q,0)}return 0},xCurrentTime:function(R,y){return P.poke(y,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(R,y){return P.poke(y,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(R,y,N){const Q=D(R);Q.log(`xDelete ${P.cstrToJs(y)}`),Q.storeErr();try{return Q.deletePath(Q.getPath(y)),0}catch($){return Q.storeErr($),_.SQLITE_IOERR_DELETE}},xFullPathname:function(R,y,N,Q){return P.cstrncpy(Q,y,N)<N?0:_.SQLITE_CANTOPEN},xGetLastError:function(R,y,N){const Q=D(R),$=Q.popErr();if(Q.log(`xGetLastError ${y} e =`,$),$){const ee=P.scopedAllocPush();try{const[he,Ee]=P.scopedAllocCString($.message,!0);P.cstrncpy(N,he,y),Ee>y&&P.poke8(N+y-1,0)}catch{return _.SQLITE_NOMEM}finally{P.scopedAllocPop(ee)}}return $?$.sqlite3Rc||_.SQLITE_IOERR:0},xOpen:function(y,N,Q,$,ee){const he=D(y);try{$&=~q,he.log(`xOpen ${P.cstrToJs(N)} ${$}`);const Ee=N&&P.peek8(N)?he.getPath(N):F();let k=he.getSAHForPath(Ee);!k&&$&_.SQLITE_OPEN_CREATE&&(he.getFileCount()<he.getCapacity()?(k=he.nextAvailableSAH(),he.setAssociatedPath(k,Ee,$)):c("SAH pool is full. Cannot create file",Ee)),k||c("file not found:",Ee);const J={path:Ee,flags:$,sah:k};he.mapS3FileToOFile(Q,J),J.lockType=_.SQLITE_LOCK_NONE;const re=new _.sqlite3_file(Q);return re.$pMethods=l.pointer,re.dispose(),P.poke32(ee,$),0}catch(Ee){return he.storeErr(Ee),_.SQLITE_CANTOPEN}}},m=function(R){t.capi.sqlite3_vfs_find(R)&&i("VFS name is already registered:",R);const y=new _.sqlite3_vfs,N=_.sqlite3_vfs_find(null),Q=N?new _.sqlite3_vfs(N):null;return y.$iVersion=2,y.$szOsFile=_.sqlite3_file.structInfo.sizeof,y.$mxPathname=B,y.addOnDispose(y.$zName=P.allocCString(R),()=>G(y.pointer,0)),Q&&(y.$xRandomness=Q.$xRandomness,y.$xSleep=Q.$xSleep,Q.dispose()),!y.$xRandomness&&!d.xRandomness&&(d.xRandomness=function($,ee,he){const Ee=P.heap8u();let k=0;const J=Number(he);for(;k<ee;++k)Ee[J+k]=Math.random()*255e3&255;return k}),!y.$xSleep&&!d.xSleep&&(d.xSleep=($,ee)=>0),t.vfs.installVfs({vfs:{struct:y,methods:d}}),y};class M{constructor(y=Object.create(null)){ze(this,Z);Qe(this,"vfsDir");ze(this,K);ze(this,de);ze(this,ce);ze(this,ve,new Map);ze(this,ye,new Map);ze(this,Ie,new Set);ze(this,Re,new Map);ze(this,S,new Uint8Array(x));ze(this,z);ze(this,U);ze(this,te);He(this,te,y.verbosity??C.verbosity),this.vfsName=y.name||C.name,He(this,U,m(this.vfsName)),G(ne(this,U).pointer,this),this.vfsDir=y.directory||"."+this.vfsName,He(this,z,new DataView(ne(this,S).buffer,ne(this,S).byteOffset)),this.isReady=this.reset(!!(y.clearOnInit??C.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(y.initialCapacity||C.initialCapacity)})}log(...y){ht(this,Z,mt).call(this,2,...y)}warn(...y){ht(this,Z,mt).call(this,1,...y)}error(...y){ht(this,Z,mt).call(this,0,...y)}getVfs(){return ne(this,U)}getCapacity(){return ne(this,ve).size}getFileCount(){return ne(this,ye).size}getFileNames(){const y=[];for(const N of ne(this,ye).keys())y.push(N);return y}async addCapacity(y){for(let N=0;N<y;++N){const Q=F(),ee=await(await ne(this,de).getFileHandle(Q,{create:!0})).createSyncAccessHandle();ne(this,ve).set(ee,Q),this.setAssociatedPath(ee,"",0)}return this.getCapacity()}async reduceCapacity(y){let N=0;for(const Q of Array.from(ne(this,Ie))){if(N===y||this.getFileCount()===this.getCapacity())break;const $=ne(this,ve).get(Q);Q.close(),await ne(this,de).removeEntry($),ne(this,ve).delete(Q),ne(this,Ie).delete(Q),++N}return N}releaseAccessHandles(){for(const y of ne(this,ve).keys())y.close();ne(this,ve).clear(),ne(this,ye).clear(),ne(this,Ie).clear()}async acquireAccessHandles(y=!1){const N=[];for await(const[Q,$]of ne(this,de))$.kind==="file"&&N.push([Q,$]);return Promise.all(N.map(async([Q,$])=>{try{const ee=await $.createSyncAccessHandle();if(ne(this,ve).set(ee,Q),y)ee.truncate(W),this.setAssociatedPath(ee,"",0);else{const he=this.getAssociatedPath(ee);he?ne(this,ye).set(he,ee):ne(this,Ie).add(ee)}}catch(ee){throw this.storeErr(ee),this.releaseAccessHandles(),ee}}))}getAssociatedPath(y){y.read(ne(this,S),{at:0});const N=ne(this,z).getUint32(L);if(ne(this,S)[0]&&(N&_.SQLITE_OPEN_DELETEONCLOSE||!(N&g)))return p(`Removing file with unexpected flags ${N.toString(16)}`,ne(this,S)),this.setAssociatedPath(y,"",0),"";const Q=new Uint32Array(O/4);y.read(Q,{at:Y});const $=this.computeDigest(ne(this,S),N);if(Q.every((ee,he)=>ee===$[he])){const ee=ne(this,S).findIndex(he=>he===0);return ee===0&&y.truncate(W),ee?E.decode(ne(this,S).subarray(0,ee)):""}else return p("Disassociating file with bad digest."),this.setAssociatedPath(y,"",0),""}setAssociatedPath(y,N,Q){const $=A.encodeInto(N,ne(this,S));B<=$.written+1&&c("Path too long:",N),N&&Q&&(Q|=q),ne(this,S).fill(0,$.written,B),ne(this,z).setUint32(L,Q);const ee=this.computeDigest(ne(this,S),Q);y.write(ne(this,S),{at:0}),y.write(ee,{at:Y}),y.flush(),N?(ne(this,ye).set(N,y),ne(this,Ie).delete(y)):(y.truncate(W),ne(this,Ie).add(y))}computeDigest(y,N){if(N&q){let Q=3735928559,$=1103547991;for(const ee of y)Q=Math.imul(Q^ee,2654435761),$=Math.imul($^ee,104729);return new Uint32Array([Q>>>0,$>>>0])}else return new Uint32Array([0,0])}async reset(y){await this.isReady;let N=await navigator.storage.getDirectory(),Q;for(const $ of this.vfsDir.split("/"))$&&(Q=N,N=await N.getDirectoryHandle($,{create:!0}));return He(this,K,N),He(this,ce,Q),He(this,de,await ne(this,K).getDirectoryHandle(w,{create:!0})),this.releaseAccessHandles(),this.acquireAccessHandles(y)}getPath(y){return P.isPtr(y)&&(y=P.cstrToJs(y)),(y instanceof URL?y:new URL(y,"file://localhost/")).pathname}deletePath(y){const N=ne(this,ye).get(y);return N&&(ne(this,ye).delete(y),this.setAssociatedPath(N,"",0)),!!N}storeErr(y,N){return y&&(y.sqlite3Rc=N||_.SQLITE_IOERR,this.error(y)),this.$error=y,N}popErr(){const y=this.$error;return this.$error=void 0,y}nextAvailableSAH(){const[y]=ne(this,Ie).keys();return y}getOFileForS3File(y){return ne(this,Re).get(y)}mapS3FileToOFile(y,N){N?(ne(this,Re).set(y,N),h(y,this)):(ne(this,Re).delete(y),h(y,!1))}hasFilename(y){return ne(this,ye).has(y)}getSAHForPath(y){return ne(this,ye).get(y)}async removeVfs(){if(!ne(this,U).pointer||!ne(this,de))return!1;_.sqlite3_vfs_unregister(ne(this,U).pointer),ne(this,U).dispose(),delete r[this.vfsName];try{this.releaseAccessHandles(),await ne(this,K).removeEntry(w,{recursive:!0}),He(this,de,void 0),await ne(this,ce).removeEntry(ne(this,K).name,{recursive:!0}),He(this,K,He(this,ce,void 0))}catch(y){t.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",y)}return!0}pauseVfs(){return ne(this,Re).size>0&&t.SQLite3Error.toss(_.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),ne(this,ve).size>0&&(_.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return ne(this,ve).size===0}async unpauseVfs(){return ne(this,ve).size===0?this.acquireAccessHandles(!1).then(()=>_.sqlite3_vfs_register(ne(this,U),0),this):this}exportFile(y){const N=ne(this,ye).get(y)||c("File not found:",y),Q=N.getSize()-W,$=new Uint8Array(Q>0?Q:0);if(Q>0){const ee=N.read($,{at:W});ee!=Q&&c("Expected to read "+Q+" bytes but read "+ee+".")}return $}async importDbChunked(y,N){const Q=ne(this,ye).get(y)||this.nextAvailableSAH()||c("No available handles to import to.");Q.truncate(0);let $=0,ee,he=!1;try{for(;(ee=await N())!==void 0;)ee instanceof ArrayBuffer&&(ee=new Uint8Array(ee)),!he&&$===0&&ee.byteLength>=15&&(T.affirmDbHeader(ee),he=!0),Q.write(ee,{at:W+$}),$+=ee.byteLength;if(($<512||$%512!==0)&&c("Input size",$,"is not correct for an SQLite database."),!he){const Ee=new Uint8Array(20);Q.read(Ee,{at:0}),T.affirmDbHeader(Ee)}Q.write(new Uint8Array([1,1]),{at:W+18})}catch(Ee){throw this.setAssociatedPath(Q,"",0),Ee}return this.setAssociatedPath(Q,y,_.SQLITE_OPEN_MAIN_DB),$}importDb(y,N){if(N instanceof ArrayBuffer)N=new Uint8Array(N);else if(N instanceof Function)return this.importDbChunked(y,N);const Q=ne(this,ye).get(y)||this.nextAvailableSAH()||c("No available handles to import to."),$=N.byteLength;($<512||$%512!=0)&&c("Byte array size is invalid for an SQLite db.");const ee="SQLite format 3";for(let Ee=0;Ee<ee.length;++Ee)ee.charCodeAt(Ee)!==N[Ee]&&c("Input does not contain an SQLite database header.");const he=Q.write(N,{at:W});return he!=$?(this.setAssociatedPath(Q,"",0),c("Expected to write "+$+" bytes but wrote "+he+".")):(Q.write(new Uint8Array([1,1]),{at:W+18}),this.setAssociatedPath(Q,y,_.SQLITE_OPEN_MAIN_DB)),he}}K=new WeakMap,de=new WeakMap,ce=new WeakMap,ve=new WeakMap,ye=new WeakMap,Ie=new WeakMap,Re=new WeakMap,S=new WeakMap,z=new WeakMap,U=new WeakMap,te=new WeakMap,Z=new WeakSet,mt=function(y,...N){ne(this,te)>y&&f[y](this.vfsName+":",...N)};class V{constructor(y){ze(this,ue);He(this,ue,y),this.vfsName=y.vfsName}async addCapacity(y){return ne(this,ue).addCapacity(y)}async reduceCapacity(y){return ne(this,ue).reduceCapacity(y)}getCapacity(){return ne(this,ue).getCapacity(ne(this,ue))}getFileCount(){return ne(this,ue).getFileCount()}getFileNames(){return ne(this,ue).getFileNames()}async reserveMinimumCapacity(y){const N=ne(this,ue).getCapacity();return N<y?ne(this,ue).addCapacity(y-N):N}exportFile(y){return ne(this,ue).exportFile(y)}importDb(y,N){return ne(this,ue).importDb(y,N)}async wipeFiles(){return ne(this,ue).reset(!0)}unlink(y){return ne(this,ue).deletePath(y)}async removeVfs(){return ne(this,ue).removeVfs()}pauseVfs(){return ne(this,ue).pauseVfs(),this}async unpauseVfs(){return ne(this,ue).unpauseVfs().then(()=>this)}isPaused(){return ne(this,ue).isPaused()}}ue=new WeakMap;const oe=async()=>{const R=await navigator.storage.getDirectory(),y=".opfs-sahpool-sync-check-"+F(),$=(await(await R.getFileHandle(y,{create:!0})).createSyncAccessHandle()).close();return await $,await R.removeEntry(y),$!=null&&$.then&&c("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};t.installOpfsSAHPoolVfs=async function(R=Object.create(null)){var N;R=Object.assign(Object.create(null),C,R||{});const y=R.name;if(R.$testThrowPhase1)throw R.$testThrowPhase1;if(r[y])try{return await r[y]}catch(Q){if(R.forceReinitIfPreviouslyFailed)delete r[y];else throw Q}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((N=navigator==null?void 0:navigator.storage)!=null&&N.getDirectory)?r[y]=Promise.reject(new Error("Missing required OPFS APIs.")):r[y]=oe().then(async function(){if(R.$testThrowPhase2)throw R.$testThrowPhase2;const Q=new M(R);return Q.isReady.then(async()=>{const $=new V(Q);if(t.oo1){const ee=t.oo1,he=Q.getVfs(),Ee=function(...k){const J=ee.DB.dbCtorHelper.normalizeArgs(...k);J.vfs=he.$zName,ee.DB.dbCtorHelper.call(this,J)};Ee.prototype=Object.create(ee.DB.prototype),$.OpfsSAHPoolDb=Ee}return Q.log("VFS initialized."),$}).catch(async $=>{throw await Q.removeVfs().catch(()=>{}),$})}).catch(Q=>r[y]=Promise.reject(Q))}}),typeof n>"u")throw console.warn("This is not running in the context of Module.runSQLite3PostLoadInit()"),new Error("sqlite3-api-cleanup.js expects to be running in the context of its Emscripten module loader.");try{const t=Object.assign(Object.create(null),globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{},{memory:typeof Ke<"u"?Ke:n.wasmMemory,exports:typeof ot<"u"?ot:Object.prototype.hasOwnProperty.call(n,"wasmExports")?n.wasmExports:n.asm});t.wasmPtrIR=typeof t.exports.sqlite3_libversion()=="number"?"i32":"i64";const c=e;c.debugModule("Bootstrapping lib config",c);const i=globalThis.sqlite3ApiBootstrap(t);return delete globalThis.sqlite3ApiBootstrap,i}catch(t){throw console.error("sqlite3ApiBootstrap() error:",t),t}throw new Error("Maintenance required: this line should never be reached")},kt?j=u:j=new Promise((e,n)=>{Ve=e,Ze=n}),j}const yr=function(){var se,fe;const H=It;if(!H)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const j=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(se=globalThis==null?void 0:globalThis.document)==null?void 0:se.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(fe=globalThis==null?void 0:globalThis.location)!=null&&fe.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(j.debugModule=j.urlParams.has("sqlite3.debugModule")?(...ge)=>console.warn("sqlite3.debugModule:",...ge):()=>{},j.urlParams.has("sqlite3.dir"))j.sqlite3Dir=j.urlParams.get("sqlite3.dir")+"/";else if(j.moduleScript){const ge=j.moduleScript.src.split("/");ge.pop(),j.sqlite3Dir=ge.join("/")+"/"}const u=globalThis.sqlite3InitModule=function ge(...be){return H(...be).then(xe=>{j.debugModule("sqlite3InitModule() sIMS =",j),j.debugModule("sqlite3InitModule() EmscriptenModule =",xe);const We=xe.runSQLite3PostLoadInit(j,xe,!!ge.__isUnderTest);return j.debugModule("sqlite3InitModule() sqlite3 =",We),We}).catch(xe=>{throw console.error("Exception loading sqlite3 module:",xe),xe})};if(u.ready=H.ready,j.moduleScript){let ge=j.moduleScript.src.split("/");ge.pop(),j.scriptDir=ge.join("/")+"/"}return j.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",j),u}();It=yr;var br=It;globalThis.sqlite3Worker1Promiser=function H(j=H.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const ie=j;j=Object.assign(Object.create(null),H.defaultConfig),j.onready=ie}else j=Object.assign(Object.create(null),H.defaultConfig,j);const u=Object.create(null),se=function(){},fe=j.onerror||se,ge=j.debug||se,be=j.generateMessageId?void 0:Object.create(null),xe=j.generateMessageId||function(ie){return ie.type+"#"+(be[ie.type]=(be[ie.type]||0)+1)},We=(...ie)=>{throw new Error(ie.join(" "))};j.worker||(j.worker=H.defaultConfig.worker),typeof j.worker=="function"&&(j.worker=j.worker());let Ce,ke;return j.worker.onmessage=function(ie){ie=ie.data,ge("worker1.onmessage",ie);let Se=u[ie.messageId];if(!Se){if(ie&&ie.type==="sqlite3-api"&&ie.result==="worker1-ready"){j.onready&&j.onready(ke);return}if(Se=u[ie.type],Se&&Se.onrow){Se.onrow(ie);return}j.onunhandled?j.onunhandled(arguments[0]):fe("sqlite3Worker1Promiser() unhandled worker message:",ie);return}switch(delete u[ie.messageId],ie.type){case"error":Se.reject(ie);return;case"open":Ce||(Ce=ie.dbId);break;case"close":ie.dbId===Ce&&(Ce=void 0);break}try{Se.resolve(ie)}catch(Le){Se.reject(Le)}},ke=function(){let ie;arguments.length===1?ie=arguments[0]:arguments.length===2?(ie=Object.create(null),ie.type=arguments[0],ie.args=arguments[1],ie.dbId=ie.args.dbId):We("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!ie.dbId&&ie.type!=="open"&&(ie.dbId=Ce),ie.messageId=xe(ie),ie.departureTime=performance.now();const Se=Object.create(null);Se.message=ie;let Le;ie.type==="exec"&&ie.args&&(typeof ie.args.callback=="function"?(Le=ie.messageId+":row",Se.onrow=ie.args.callback,ie.args.callback=Le,u[Le]=Se):typeof ie.args.callback=="string"&&We("exec callback may not be a string when using the Promise interface."));let $e=new Promise(function(Ve,Ze){Se.resolve=Ve,Se.reject=Ze,u[ie.messageId]=Se,ge("Posting",ie.type,"message to Worker dbId="+(Ce||"default")+":",ie),j.worker.postMessage(ie)});return Le&&($e=$e.finally(()=>delete u[Le])),$e}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/assets/sqlite3-worker1-HKXiBUt9.js",import.meta.url))},onerror:(...H)=>console.error("worker1 promiser error",...H)};globalThis.sqlite3Worker1Promiser.v2=(function H(j=H.defaultConfig){let u;typeof j=="function"?(u=j,j={}):typeof(j==null?void 0:j.onready)=="function"&&(u=j.onready,delete j.onready);const se=Object.create(null);j=Object.assign(j||Object.create(null),{onready:async function(ge){try{u&&await u(ge),se.resolve(ge)}catch(be){se.reject(be)}}});const fe=new Promise(function(ge,be){se.resolve=ge,se.reject=be});try{this.original(j)}catch(ge){se.reject(ge)}return fe}).bind({original:sqlite3Worker1Promiser});globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig;sqlite3Worker1Promiser.v2;const qr={fts:.35,vector:.4,entity:.15,graph:.1},Xe={FTS_SEARCH:`
    SELECT
      m.gid,
      m.page_no,
      m.title,
      snippet(meta_fts, 3, '<mark>', '</mark>', '', 18) AS snippet,
      meta_fts.rank,
      (1.0 / (ABS(meta_fts.rank) + 1.0)) AS score
    FROM meta_fts
    JOIN meta_index m ON m.rowid = meta_fts.rowid
    WHERE meta_fts MATCH ?
    ORDER BY meta_fts.rank
    LIMIT ?
  `,LIST_ENTITY_FACETS:`
    SELECT
      entity_type,
      normalized_value,
      COUNT(*) AS count
    FROM entities
    WHERE entity_type = COALESCE(?, entity_type)
    GROUP BY entity_type, normalized_value
    ORDER BY count DESC, entity_type, normalized_value
    LIMIT ?
  `,LIST_ENTITY_TYPES:`
    SELECT DISTINCT entity_type, COUNT(*) AS count
    FROM entities
    GROUP BY entity_type
    ORDER BY count DESC
  `,GET_PAGE_LIST:`
    SELECT
      gid,
      doc_id,
      page_no,
      title,
      tags,
      updated_ts
    FROM meta_index
    ORDER BY page_no
    LIMIT ? OFFSET ?
  `,GET_PAGE_BLOB:`
    SELECT data, sz
    FROM sqlar
    WHERE name = ?
    LIMIT 1
  `,GET_VECTOR_META:`
    SELECT gid, model_id, dim
    FROM leann_meta
    WHERE gid = ? AND model_id = ?
    LIMIT 1
  `,GET_CACHED_VECTOR:`
    SELECT embedding
    FROM leann_vec
    WHERE gid = ? AND model_id = ?
    LIMIT 1
  `,GET_ALL_VECTORS:`
    SELECT
      lm.gid,
      lm.page_no,
      m.title,
      lv.embedding
    FROM leann_vec lv
    JOIN leann_meta lm ON lm.gid = lv.gid AND lm.model_id = lv.model_id
    JOIN meta_index m ON m.gid = lm.gid
    WHERE lv.model_id = ?
    ORDER BY lm.page_no
  `,GET_PAGE_ENTITIES:`
    SELECT
      entity_type,
      entity_text,
      normalized_value,
      confidence
    FROM entities
    WHERE gid = ?
    ORDER BY confidence DESC
  `,GET_CHECKPOINTS:`
    SELECT
      epoch,
      merkle_root,
      pages_count,
      anchors_json,
      created_ts
    FROM checkpoints
    ORDER BY epoch DESC
  `,VERIFY_PAGE:`
    SELECT
      gr.gid,
      gr.content_sha,
      gr.signer,
      gr.sig,
      gr.epoch,
      gr.merkle_root,
      m.full_text
    FROM glyph_receipts gr
    JOIN meta_index m ON m.gid = gr.gid
    WHERE gr.gid = ?
    LIMIT 1
  `,GET_GRAPH_NEIGHBORS:`
    SELECT
      n2.gid,
      n2.page_no,
      m.title,
      e.pred,
      e.weight
    FROM node_index n1
    JOIN edges e ON e.fromNode = n1.node_id
    JOIN node_index n2 ON n2.node_id = e.toNode
    JOIN meta_index m ON m.gid = n2.gid
    WHERE n1.gid = ?
    ORDER BY e.weight DESC
    LIMIT ?
  `};function vr(H,j){if(H.length!==j.length)throw new Error("Vectors must have same length");let u=0,se=0,fe=0;for(let be=0;be<H.length;be++)u+=H[be]*j[be],se+=H[be]*H[be],fe+=j[be]*j[be];const ge=Math.sqrt(se)*Math.sqrt(fe);return ge===0?0:u/ge}async function wr(H){const u=new TextEncoder().encode(H),se=await crypto.subtle.digest("SHA-256",u);return Array.from(new Uint8Array(se)).map(ge=>ge.toString(16).padStart(2,"0")).join("")}function Sr(H){if(!H)return null;try{return JSON.parse(H)}catch{return null}}function Er(H){return new Float32Array(H.buffer,H.byteOffset,H.byteLength/4)}const Ar=["sqlar","meta_index","meta_fts","entities","node_index","edges","ledger_blocks","checkpoints","keys"];let Ae=null,Ye=null,lt=null;async function Ir(){Ye||(console.log("[Worker] Initializing SQLite WASM..."),Ye=await br({print:console.log,printErr:console.error}),console.log("[Worker] SQLite WASM initialized:",Ye.version.libVersion))}function kr(){if(!Ae)return{valid:!1,missing:["no database open"]};const H=new Set,j=Ae.prepare('SELECT name FROM sqlite_master WHERE type="table"');try{for(;j.step();)H.add(j.get([])[0])}finally{j.finalize()}const u=Ar.filter(se=>!H.has(se));return{valid:u.length===0,missing:u}}function Tr(H,j){if(!Ae)throw new Error("No database open");let u="unknown",se=Ae.prepare("SELECT doc_id FROM meta_index LIMIT 1");try{se.step()&&(u=se.get([])[0])}finally{se.finalize()}se=Ae.prepare("SELECT COUNT(*) FROM meta_index");let fe=0;try{se.step()&&(fe=se.get([])[0])}finally{se.finalize()}se=Ae.prepare("SELECT COUNT(*) FROM entities");let ge=0;try{se.step()&&(ge=se.get([])[0])}finally{se.finalize()}se=Ae.prepare("SELECT COUNT(*) FROM edges");let be=0;try{se.step()&&(be=se.get([])[0])}finally{se.finalize()}let xe=!1,We,Ce;se=Ae.prepare(`
    SELECT name FROM sqlite_master
    WHERE type='table' AND name='leann_vec'
  `);try{if(se.step()){xe=!0;const ke=Ae.prepare("SELECT model_id, dim FROM leann_meta LIMIT 1");try{if(ke.step()){const ie=ke.get([]);We=ie[0],Ce=ie[1]}}finally{ke.finalize()}}}finally{se.finalize()}return{fileName:H,fileSize:j,docId:u,pageCount:fe,entityCount:ge,edgeCount:be,hasVectors:xe,vectorModel:We,vectorDim:Ce}}async function Kt(H){try{const j=await H.arrayBuffer(),u=new Uint8Array(j);Ae&&(Ae.close(),Ae=null),Ae=new Ye.oo1.DB(":memory:");const se=Ye.capi.sqlite3_deserialize(Ae.pointer,"main",u,u.length,u.length,Ye.capi.SQLITE_DESERIALIZE_FREEONCLOSE|Ye.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(se!==Ye.capi.SQLITE_OK)throw new Error(`Failed to deserialize database: ${se}`);const fe=kr();if(!fe.valid)throw new Error(`Invalid schema. Missing tables: ${fe.missing.join(", ")}`);const ge=Tr(H.name,H.size);return lt=ge,console.log("[Worker] Capsule opened:",ge),{ok:!0,data:ge}}catch(j){return console.error("[Worker] Failed to open capsule:",j),{ok:!1,error:String(j)}}}async function xr(){try{const H=await fetch("/memglyph-demo.mgx.sqlite");if(!H.ok)throw new Error(`Failed to fetch demo capsule: ${H.statusText}`);const j=await H.arrayBuffer(),u=new Blob([j],{type:"application/x-sqlite3"}),se=new File([u],"memglyph-demo.mgx.sqlite",{type:"application/x-sqlite3"});return await Kt(se)}catch(H){return console.error("[Worker] Failed to open demo capsule:",H),{ok:!1,error:String(H)}}}function Or(){return Ae?(Ae.close(),Ae=null,lt=null,{ok:!0,data:void 0}):{ok:!1,error:"No database open"}}function Jt(H,j){if(!Ae)return{ok:!1,error:"No database open"};const u=[],se=Ae.prepare(Xe.FTS_SEARCH);try{for(se.bind([H,j]);se.step();){const fe=se.get([]);u.push({gid:fe[0],pageNo:fe[1],title:fe[2],snippet:fe[3],rank:fe[4],score:fe[5]})}return{ok:!0,data:u}}catch(fe){return{ok:!1,error:String(fe)}}finally{se.finalize()}}function Fr(H,j){if(!Ae)return{ok:!1,error:"No database open"};if(!(lt!=null&&lt.hasVectors))return{ok:!1,error:"No vectors available in capsule"};const u=[],se=lt.vectorModel||"gte-small-384",fe=Ae.prepare(Xe.GET_ALL_VECTORS);try{fe.bind([se]);const ge=[];for(;fe.step();){const be=fe.get([]),xe=Er(be[3]);ge.push({gid:be[0],pageNo:be[1],title:be[2],vector:xe})}for(const be of ge){const xe=vr(H,be.vector);u.push({gid:be.gid,pageNo:be.pageNo,title:be.title,similarity:xe})}return u.sort((be,xe)=>xe.similarity-be.similarity),u.splice(j),{ok:!0,data:u}}catch(ge){return{ok:!1,error:String(ge)}}finally{fe.finalize()}}function Pr(H,j,u){if(!Ae)return{ok:!1,error:"No database open"};const se={...qr,...u};try{const fe=Jt(H,Math.min(j*3,50));if(!fe.ok)return fe;const ge=fe.data,be=new Map;for(const ke of ge)be.set(ke.gid,{gid:ke.gid,pageNo:ke.pageNo,title:ke.title,snippet:ke.snippet,ftsScore:ke.score,vectorScore:0,entityScore:0,graphScore:0});const xe=H.toLowerCase().split(/\s+/).filter(ke=>ke.length>2);if(xe.length>0)for(const[ke,ie]of be){const Se=Ae.prepare(Xe.GET_PAGE_ENTITIES);try{Se.bind([ke]);let Le=0;for(;Se.step();){const $e=Se.get([]),Ve=String($e[1]).toLowerCase();for(const Ze of xe)if(Ve.includes(Ze)){Le++;break}}ie.entityScore=Math.min(Le/3,1)}finally{Se.finalize()}}const We=Array.from(be.keys()).slice(0,Math.min(10,j));for(const ke of We){const ie=be.get(ke),Se=Ae.prepare(Xe.GET_GRAPH_NEIGHBORS);try{Se.bind([ke,5]);let Le=0;for(;Se.step();){const Ve=Se.get([])[0];be.has(Ve)&&Le++}ie.graphScore=Math.min(Le/3,1)}finally{Se.finalize()}}const Ce=[];for(const[ke,ie]of be){const Se=se.fts*ie.ftsScore+se.vector*ie.vectorScore+se.entity*ie.entityScore+se.graph*ie.graphScore;Ce.push({gid:ie.gid,pageNo:ie.pageNo,title:ie.title,snippet:ie.snippet,scores:{fts:ie.ftsScore,vector:ie.vectorScore,entity:ie.entityScore,graph:ie.graphScore,final:Se}})}return Ce.sort((ke,ie)=>ie.scores.final-ke.scores.final),Ce.splice(j),{ok:!0,data:Ce}}catch(fe){return{ok:!1,error:String(fe)}}}function Lr(H,j=100){if(!Ae)return{ok:!1,error:"No database open"};const u=[],se=Ae.prepare(Xe.LIST_ENTITY_FACETS);try{for(se.bind([H||null,j]);se.step();){const fe=se.get([]);u.push({entityType:fe[0],normalizedValue:fe[1],count:fe[2]})}return{ok:!0,data:u}}catch(fe){return{ok:!1,error:String(fe)}}finally{se.finalize()}}function Cr(H,j){if(!Ae)return{ok:!1,error:"No database open"};const u=[],se=Ae.prepare(Xe.GET_PAGE_LIST);try{for(se.bind([H,j]);se.step();){const fe=se.get([]);u.push({gid:fe[0],docId:fe[1],pageNo:fe[2],title:fe[3],tags:fe[4],updatedTs:fe[5]})}return{ok:!0,data:u}}catch(fe){return{ok:!1,error:String(fe)}}finally{se.finalize()}}function Nr(H){if(!Ae)return{ok:!1,error:"No database open"};const j=Ae.prepare(Xe.GET_PAGE_BLOB);try{return j.bind([H]),j.step()?{ok:!0,data:j.get([])[0]}:{ok:!1,error:`Blob not found: ${H}`}}catch(u){return{ok:!1,error:String(u)}}finally{j.finalize()}}async function Rr(H){if(!Ae)return{ok:!1,error:"No database open"};const j=Ae.prepare(Xe.VERIFY_PAGE);try{if(j.bind([H]),j.step()){const u=j.get([]),se=u[1],fe=u[6],ge=await wr(fe||"");return{ok:!0,data:{gid:u[0],contentSha:se,expectedSha:ge,verified:se===ge,signer:u[2],signature:u[3],epoch:u[4],merkleRoot:u[5]}}}return{ok:!1,error:`No receipt found for GID: ${H}`}}catch(u){return{ok:!1,error:String(u)}}finally{j.finalize()}}function Dr(){if(!Ae)return{ok:!1,error:"No database open"};const H=[],j=Ae.prepare(Xe.GET_CHECKPOINTS);try{for(;j.step();){const u=j.get([]);H.push({epoch:u[0],merkleRoot:u[1],pagesCount:u[2],createdTs:u[4],anchors:Sr(u[3])})}return{ok:!0,data:H}}catch(u){return{ok:!1,error:String(u)}}finally{j.finalize()}}async function Mr(H){try{switch(H.type){case"OPEN_FROM_FILE":return await Kt(H.file);case"OPEN_DEMO":return await xr();case"CLOSE":return Or();case"FTS_SEARCH":return Jt(H.query,H.limit||20);case"VECTOR_SEARCH":return Fr(H.queryVector,H.limit||20);case"HYBRID_SEARCH":return Pr(H.query,H.limit||20,H.weights);case"LIST_ENTITIES":return Lr(H.entityType,H.limit||100);case"GET_PAGE_LIST":return Cr(H.limit||100,H.offset||0);case"GET_PAGE_BLOB":return Nr(H.name);case"VERIFY_PAGE":return await Rr(H.gid);case"GET_CHECKPOINTS":return Dr();case"GRAPH_HOPS":return{ok:!1,error:"GRAPH_HOPS not yet implemented"};default:return{ok:!1,error:`Unknown request type: ${H.type}`}}}catch(j){return{ok:!1,error:String(j)}}}self.onmessage=async H=>{const{id:j,request:u}=H.data;Ye||await Ir();const se=await Mr(u),fe={id:j,response:se};self.postMessage(fe)};self.postMessage({type:"READY"});console.log("[Worker] SQLite worker loaded and ready");
